import{a as h,b as V,o as B,A as l,O as s,q as Y,u as v,aj as U,ak as z,R as L,af as N,$ as b,a0 as j,m as i,Y as d,B as c}from"./index-DWUfVN7j.js";import{i as F,g as O}from"./image-D8bf4J46.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const J=y=>(b("data-v-01433e81"),y=y(),j(),y),X={class:"msgBox"},$={class:"left"},H=["src"],K={style:{"padding-left":"9px"}},Q={style:{"font-size":"16px"}},W={style:{"margin-top":"6px","font-size":"14px"}},Z={class:"right"},ee=J(()=>s("div",{class:"title"}," 系统通知 ",-1)),te={class:"msgContent"},se={style:{height:"50vh","overflow-y":"auto"}},oe={key:0,class:"leftChat"},ae=["src"],le={class:"chatMsg"},ie={key:0},ne={key:1},de=["src"],ce={key:1,class:"rightChat"},re={class:"chatMsg"},pe={key:0},_e={key:1},ue=["src"],he={key:2},ye={style:{"font-size":"16px",color:"#333","font-weight":"600"}},ge={style:{"font-size":"16px",color:"#333","font-weight":"600","margin-top":"10px"}},fe=["src"],ve={style:{height:"11vh"}},xe={__name:"msg",setup(y){const x=h(""),E=h(""),m=h(""),S=h([]),T=h([]),r=V("chat"),o=V("TencentCloudChat");function R(n){n.data.forEach(t=>{if(t.type!==o.TYPES.MSG_TEXT){if(t.type!==o.TYPES.MSG_IMAGE){if(t.type!==o.TYPES.MSG_SOUND){if(t.type!==o.TYPES.MSG_VIDEO){if(t.type!==o.TYPES.MSG_FILE){if(t.type!==o.TYPES.MSG_CUSTOM){if(t.type!==o.TYPES.MSG_MERGER){if(t.type!==o.TYPES.MSG_LOCATION){if(t.type!==o.TYPES.MSG_GRP_TIP){if(t.type===o.TYPES.MSG_GRP_SYS_NOTICE){const{operationType:e,userDefinedField:f}=t.payload}}}}}}}}}}})}function g(n){return JSON.parse(n)}function D(){r.getConversationList({type:o.TYPES.CONV_C2C}).then(function(a){const t=a.data.conversationList;S.value=t,console.log(t),t.length&&(x.value=t[0].userProfile.userID,M())})}function M(){r.getMessageList({conversationID:"C2C"+x.value}).then(function(a){const t=a.data.messageList;a.data.nextReqMessageID,a.data.isCompleted,T.value=t,console.log(t)})}function A(){let n=r.createTextMessage({to:String(x.value),conversationType:o.TYPES.CONV_C2C,payload:{text:m.value},needReadReceipt:!0});r.sendMessage(n).then(function(t){console.log(t),M()}).catch(function(t){console.warn("sendMessage error:",t)})}return B(()=>{r.on(o.EVENT.MESSAGE_RECEIVED,R),D()}),(n,a)=>{const t=z;return i(),l("div",X,[s("div",$,[s("div",null,[Y(t,{modelValue:E.value,"onUpdate:modelValue":a[0]||(a[0]=e=>E.value=e),size:"large",placeholder:"Please Input","prefix-icon":v(U)},null,8,["modelValue","prefix-icon"])]),(i(!0),l(L,null,N(S.value,(e,f)=>{var p,_,u;return i(),l("div",{class:"item",key:f},[s("img",{src:v(F)+((p=e.userProfile)==null?void 0:p.avatar),style:{width:"48px",height:"48px","border-radius":"50%"},alt:""},null,8,H),s("div",K,[s("div",Q,d((_=e.userProfile)==null?void 0:_.nick),1),s("div",W,d((u=e.lastMessage)==null?void 0:u.messageForShow),1)])])}),128))]),s("div",Z,[ee,s("div",te,[s("div",se,[(i(!0),l(L,null,N(T.value,(e,f)=>{var p,_,u,I,C,P,w,k,G;return i(),l("div",{key:f},[e.flow=="in"?(i(),l("div",oe,[s("img",{src:v(O)(e.avatar),style:{width:"48px",height:"48px"},alt:""},null,8,ae),s("div",le,[e.type=="TIMTextElem"?(i(),l("div",ie,d((p=e.payload)==null?void 0:p.text),1)):c("",!0),e.type=="TIMImageElem"?(i(),l("div",ne,[s("img",{src:(_=e.payload)==null?void 0:_.imageInfoArray[0].imageUrl,style:{width:"200px",height:"200px"},alt:""},null,8,de)])):c("",!0)])])):c("",!0),e.flow=="out"?(i(),l("div",ce,[s("div",re,[e.type=="TIMTextElem"?(i(),l("div",pe,d((u=e.payload)==null?void 0:u.text),1)):c("",!0),e.type=="TIMImageElem"?(i(),l("div",_e,[s("img",{src:(I=e.payload)==null?void 0:I.imageInfoArray[0].imageUrl,style:{width:"200px",height:"200px"},alt:""},null,8,ue)])):c("",!0),e.type=="TIMCustomElem"&&((C=e.payload)==null?void 0:C.description)=="post"?(i(),l("div",he,[s("div",ye,d(g((P=e.payload)==null?void 0:P.data).position_name),1),s("div",ge,d(g((w=e.payload)==null?void 0:w.data).minimum_salary)+"-"+d(g((k=e.payload)==null?void 0:k.data).maximum_salary),1),s("div",null,d(g((G=e.payload)==null?void 0:G.data).position_type),1)])):c("",!0)]),s("img",{src:v(O)(e.avatar),style:{width:"48px",height:"48px"},alt:""},null,8,fe)])):c("",!0)])}),128))]),s("div",ve,[s("div",null,[Y(t,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=e=>m.value=e),type:"textarea",rows:4,placeholder:"Please input"},null,8,["modelValue"])]),s("div",{style:{display:"flex","align-items":"center","justify-content":"flex-end","margin-top":"12px"}},[s("div",{onClick:A,style:{"background-color":"#47BADE",width:"86px",height:"40px","border-radius":"5px",display:"flex","align-items":"center","justify-content":"center",color:"white"},class:""},"发送")])])])])])}}},Te=q(xe,[["__scopeId","data-v-01433e81"]]);export{Te as default};
