const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-frCAkURD.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/index-BIjeLACL.js","assets/scrollbar-Cjuo0UNJ.js","assets/scrollbar-DSMC3cbr.css","assets/switch-C7tJyPEO.js","assets/switch-Bttmon0I.css","assets/avatar-BSokOxsS.js","assets/avatar-AU-_zdUf.css","assets/image-D8bf4J46.js","assets/refs-DsqHKrYt.js","assets/index-BAeRJDos.css","assets/index-Da_wutfp.js","assets/pagination-D8PxtIaT.js","assets/select-Bxy_RUlS.js","assets/isEqual-DKd_bL8G.js","assets/select-ZkYxEejf.css","assets/pagination-CK_0ZyTY.css","assets/empty-Bc2e1yHd.js","assets/empty-iVBaPuAw.css","assets/index-ajB-Jzrq.css","assets/detail-CBxfjG0Z.js","assets/detail-hEVszDaA.css","assets/home-L_G3e8fb.js","assets/progress-BisTk5Np.js","assets/progress-p0WgdF_-.css","assets/message-mY8KK5KY.js","assets/message-B_WOri6Q.css","assets/home-AfDy-_7X.css","assets/application-CljZexRh.js","assets/select-v2-DV5M1woe.js","assets/select-v2-BswC5buD.css","assets/application-CSSS6jjO.css","assets/applicationHistory-DLGz7rJ6.js","assets/applicationHistory-CI8Ul8m-.css","assets/management-HsV665n9.js","assets/management-C2yvBEUX.css","assets/preview-Di1yKhVx.js","assets/preview-DJkXRqP6.css","assets/modification-C7jEDDc2.js","assets/modification-DWqV07tW.css","assets/login-wLuivaeD.js","assets/login-sqSZBUI5.css","assets/msg-BPGTQxBt.js","assets/msg-B9glMDMD.css","assets/404-0S_-LR7k.js","assets/result-L5Kfd-GZ.js","assets/result-BmZgHHkw.css","assets/404-fE19U-_-.css","assets/403-CoPBdEEQ.js","assets/403-D0CFbdQB.css"])))=>i.map(i=>d[i]);
(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))c(p);new MutationObserver(p=>{for(const f of p)if(f.type==="childList")for(const v of f.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&c(v)}).observe(document,{childList:!0,subtree:!0});function u(p){const f={};return p.integrity&&(f.integrity=p.integrity),p.referrerPolicy&&(f.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?f.credentials="include":p.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function c(p){if(p.ep)return;p.ep=!0;const f=u(p);fetch(p.href,f)}})();/**
* @vue/shared v3.4.23
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Vd(o,i){const u=new Set(o.split(","));return i?c=>u.has(c.toLowerCase()):c=>u.has(c)}const Gt={},sr=[],cn=()=>{},bM=()=>!1,cc=o=>o.charCodeAt(0)===111&&o.charCodeAt(1)===110&&(o.charCodeAt(2)>122||o.charCodeAt(2)<97),Bd=o=>o.startsWith("onUpdate:"),un=Object.assign,Hd=(o,i)=>{const u=o.indexOf(i);u>-1&&o.splice(u,1)},GM=Object.prototype.hasOwnProperty,ft=(o,i)=>GM.call(o,i),He=Array.isArray,rr=o=>zi(o)==="[object Map]",M_=o=>zi(o)==="[object Set]",pO=o=>zi(o)==="[object Date]",Ze=o=>typeof o=="function",Ct=o=>typeof o=="string",Ls=o=>typeof o=="symbol",Tt=o=>o!==null&&typeof o=="object",C_=o=>(Tt(o)||Ze(o))&&Ze(o.then)&&Ze(o.catch),T_=Object.prototype.toString,zi=o=>T_.call(o),wM=o=>zi(o).slice(8,-1),E_=o=>zi(o)==="[object Object]",Kd=o=>Ct(o)&&o!=="NaN"&&o[0]!=="-"&&""+parseInt(o,10)===o,Mi=Vd(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),uc=o=>{const i=Object.create(null);return u=>i[u]||(i[u]=o(u))},UM=/-(\w)/g,to=uc(o=>o.replace(UM,(i,u)=>u?u.toUpperCase():"")),FM=/\B([A-Z])/g,Rs=uc(o=>o.replace(FM,"-$1").toLowerCase()),lc=uc(o=>o.charAt(0).toUpperCase()+o.slice(1)),Fl=uc(o=>o?`on${lc(o)}`:""),Qo=(o,i)=>!Object.is(o,i),wa=(o,i)=>{for(let u=0;u<o.length;u++)o[u](i)},D_=(o,i,u)=>{Object.defineProperty(o,i,{configurable:!0,enumerable:!1,value:u})},ld=o=>{const i=parseFloat(o);return isNaN(i)?o:i},xM=o=>{const i=Ct(o)?Number(o):NaN;return isNaN(i)?o:i};let _h;const S_=()=>_h||(_h=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function So(o){if(He(o)){const i={};for(let u=0;u<o.length;u++){const c=o[u],p=Ct(c)?HM(c):So(c);if(p)for(const f in p)i[f]=p[f]}return i}else if(Ct(o)||Tt(o))return o}const qM=/;(?![^(]*\))/g,VM=/:([^]+)/,BM=/\/\*[^]*?\*\//g;function HM(o){const i={};return o.replace(BM,"").split(qM).forEach(u=>{if(u){const c=u.split(VM);c.length>1&&(i[c[0].trim()]=c[1].trim())}}),i}function nt(o){let i="";if(Ct(o))i=o;else if(He(o))for(let u=0;u<o.length;u++){const c=nt(o[u]);c&&(i+=c+" ")}else if(Tt(o))for(const u in o)o[u]&&(i+=u+" ");return i.trim()}function fO(o){if(!o)return null;let{class:i,style:u}=o;return i&&!Ct(i)&&(o.class=nt(i)),u&&(o.style=So(u)),o}const KM="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",jM=Vd(KM);function L_(o){return!!o||o===""}const Qn=o=>Ct(o)?o:o==null?"":He(o)||Tt(o)&&(o.toString===T_||!Ze(o.toString))?JSON.stringify(o,R_,2):String(o),R_=(o,i)=>i&&i.__v_isRef?R_(o,i.value):rr(i)?{[`Map(${i.size})`]:[...i.entries()].reduce((u,[c,p],f)=>(u[xl(c,f)+" =>"]=p,u),{})}:M_(i)?{[`Set(${i.size})`]:[...i.values()].map(u=>xl(u))}:Ls(i)?xl(i):Tt(i)&&!He(i)&&!E_(i)?String(i):i,xl=(o,i="")=>{var u;return Ls(o)?`Symbol(${(u=o.description)!=null?u:i})`:o};/**
* @vue/reactivity v3.4.23
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let qn;class k_{constructor(i=!1){this.detached=i,this._active=!0,this.effects=[],this.cleanups=[],this.parent=qn,!i&&qn&&(this.index=(qn.scopes||(qn.scopes=[])).push(this)-1)}get active(){return this._active}run(i){if(this._active){const u=qn;try{return qn=this,i()}finally{qn=u}}}on(){qn=this}off(){qn=this.parent}stop(i){if(this._active){let u,c;for(u=0,c=this.effects.length;u<c;u++)this.effects[u].stop();for(u=0,c=this.cleanups.length;u<c;u++)this.cleanups[u]();if(this.scopes)for(u=0,c=this.scopes.length;u<c;u++)this.scopes[u].stop(!0);if(!this.detached&&this.parent&&!i){const p=this.parent.scopes.pop();p&&p!==this&&(this.parent.scopes[this.index]=p,p.index=this.index)}this.parent=void 0,this._active=!1}}}function A_(o){return new k_(o)}function WM(o,i=qn){i&&i.active&&i.effects.push(o)}function Wd(){return qn}function Yd(o){qn&&qn.cleanups.push(o)}let Ms;class zd{constructor(i,u,c,p){this.fn=i,this.trigger=u,this.scheduler=c,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,WM(this,p)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,ts();for(let i=0;i<this._depsLength;i++){const u=this.deps[i];if(u.computed&&(YM(u.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),ns()}return this._dirtyLevel>=4}set dirty(i){this._dirtyLevel=i?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let i=Xo,u=Ms;try{return Xo=!0,Ms=this,this._runnings++,mh(this),this.fn()}finally{vh(this),this._runnings--,Ms=u,Xo=i}}stop(){var i;this.active&&(mh(this),vh(this),(i=this.onStop)==null||i.call(this),this.active=!1)}}function YM(o){return o.value}function mh(o){o._trackId++,o._depsLength=0}function vh(o){if(o.deps.length>o._depsLength){for(let i=o._depsLength;i<o.deps.length;i++)O_(o.deps[i],o);o.deps.length=o._depsLength}}function O_(o,i){const u=o.get(i);u!==void 0&&i._trackId!==u&&(o.delete(i),o.size===0&&o.cleanup())}let Xo=!0,dd=0;const N_=[];function ts(){N_.push(Xo),Xo=!1}function ns(){const o=N_.pop();Xo=o===void 0?!0:o}function $d(){dd++}function Jd(){for(dd--;!dd&&pd.length;)pd.shift()()}function P_(o,i,u){if(i.get(o)!==o._trackId){i.set(o,o._trackId);const c=o.deps[o._depsLength];c!==i?(c&&O_(c,o),o.deps[o._depsLength++]=i):o._depsLength++}}const pd=[];function b_(o,i,u){$d();for(const c of o.keys()){let p;c._dirtyLevel<i&&(p??(p=o.get(c)===c._trackId))&&(c._shouldSchedule||(c._shouldSchedule=c._dirtyLevel===0),c._dirtyLevel=i),c._shouldSchedule&&(p??(p=o.get(c)===c._trackId))&&(c.trigger(),(!c._runnings||c.allowRecurse)&&c._dirtyLevel!==2&&(c._shouldSchedule=!1,c.scheduler&&pd.push(c.scheduler)))}Jd()}const G_=(o,i)=>{const u=new Map;return u.cleanup=o,u.computed=i,u},Wa=new WeakMap,Cs=Symbol(""),fd=Symbol("");function On(o,i,u){if(Xo&&Ms){let c=Wa.get(o);c||Wa.set(o,c=new Map);let p=c.get(u);p||c.set(u,p=G_(()=>c.delete(u))),P_(Ms,p)}}function Eo(o,i,u,c,p,f){const v=Wa.get(o);if(!v)return;let y=[];if(i==="clear")y=[...v.values()];else if(u==="length"&&He(o)){const C=Number(c);v.forEach((T,L)=>{(L==="length"||!Ls(L)&&L>=C)&&y.push(T)})}else switch(u!==void 0&&y.push(v.get(u)),i){case"add":He(o)?Kd(u)&&y.push(v.get("length")):(y.push(v.get(Cs)),rr(o)&&y.push(v.get(fd)));break;case"delete":He(o)||(y.push(v.get(Cs)),rr(o)&&y.push(v.get(fd)));break;case"set":rr(o)&&y.push(v.get(Cs));break}$d();for(const C of y)C&&b_(C,4);Jd()}function zM(o,i){var u;return(u=Wa.get(o))==null?void 0:u.get(i)}const $M=Vd("__proto__,__v_isRef,__isVue"),w_=new Set(Object.getOwnPropertyNames(Symbol).filter(o=>o!=="arguments"&&o!=="caller").map(o=>Symbol[o]).filter(Ls)),yh=JM();function JM(){const o={};return["includes","indexOf","lastIndexOf"].forEach(i=>{o[i]=function(...u){const c=_t(this);for(let f=0,v=this.length;f<v;f++)On(c,"get",f+"");const p=c[i](...u);return p===-1||p===!1?c[i](...u.map(_t)):p}}),["push","pop","shift","unshift","splice"].forEach(i=>{o[i]=function(...u){ts(),$d();const c=_t(this)[i].apply(this,u);return Jd(),ns(),c}}),o}function XM(o){Ls(o)||(o=String(o));const i=_t(this);return On(i,"has",o),i.hasOwnProperty(o)}class U_{constructor(i=!1,u=!1){this._isReadonly=i,this._isShallow=u}get(i,u,c){const p=this._isReadonly,f=this._isShallow;if(u==="__v_isReactive")return!p;if(u==="__v_isReadonly")return p;if(u==="__v_isShallow")return f;if(u==="__v_raw")return c===(p?f?lC:V_:f?q_:x_).get(i)||Object.getPrototypeOf(i)===Object.getPrototypeOf(c)?i:void 0;const v=He(i);if(!p){if(v&&ft(yh,u))return Reflect.get(yh,u,c);if(u==="hasOwnProperty")return XM}const y=Reflect.get(i,u,c);return(Ls(u)?w_.has(u):$M(u))||(p||On(i,"get",u),f)?y:Wt(y)?v&&Kd(u)?y:y.value:Tt(y)?p?Qd(y):ks(y):y}}class F_ extends U_{constructor(i=!1){super(!1,i)}set(i,u,c,p){let f=i[u];if(!this._isShallow){const C=bi(f);if(!Ya(c)&&!bi(c)&&(f=_t(f),c=_t(c)),!He(i)&&Wt(f)&&!Wt(c))return C?!1:(f.value=c,!0)}const v=He(i)&&Kd(u)?Number(u)<i.length:ft(i,u),y=Reflect.set(i,u,c,p);return i===_t(p)&&(v?Qo(c,f)&&Eo(i,"set",u,c):Eo(i,"add",u,c)),y}deleteProperty(i,u){const c=ft(i,u);i[u];const p=Reflect.deleteProperty(i,u);return p&&c&&Eo(i,"delete",u,void 0),p}has(i,u){const c=Reflect.has(i,u);return(!Ls(u)||!w_.has(u))&&On(i,"has",u),c}ownKeys(i){return On(i,"iterate",He(i)?"length":Cs),Reflect.ownKeys(i)}}class ZM extends U_{constructor(i=!1){super(!0,i)}set(i,u){return!0}deleteProperty(i,u){return!0}}const QM=new F_,eC=new ZM,tC=new F_(!0),Xd=o=>o,dc=o=>Reflect.getPrototypeOf(o);function Ma(o,i,u=!1,c=!1){o=o.__v_raw;const p=_t(o),f=_t(i);u||(Qo(i,f)&&On(p,"get",i),On(p,"get",f));const{has:v}=dc(p),y=c?Xd:u?tp:Gi;if(v.call(p,i))return y(o.get(i));if(v.call(p,f))return y(o.get(f));o!==p&&o.get(i)}function Ca(o,i=!1){const u=this.__v_raw,c=_t(u),p=_t(o);return i||(Qo(o,p)&&On(c,"has",o),On(c,"has",p)),o===p?u.has(o):u.has(o)||u.has(p)}function Ta(o,i=!1){return o=o.__v_raw,!i&&On(_t(o),"iterate",Cs),Reflect.get(o,"size",o)}function Ih(o){o=_t(o);const i=_t(this);return dc(i).has.call(i,o)||(i.add(o),Eo(i,"add",o,o)),this}function Mh(o,i){i=_t(i);const u=_t(this),{has:c,get:p}=dc(u);let f=c.call(u,o);f||(o=_t(o),f=c.call(u,o));const v=p.call(u,o);return u.set(o,i),f?Qo(i,v)&&Eo(u,"set",o,i):Eo(u,"add",o,i),this}function Ch(o){const i=_t(this),{has:u,get:c}=dc(i);let p=u.call(i,o);p||(o=_t(o),p=u.call(i,o)),c&&c.call(i,o);const f=i.delete(o);return p&&Eo(i,"delete",o,void 0),f}function Th(){const o=_t(this),i=o.size!==0,u=o.clear();return i&&Eo(o,"clear",void 0,void 0),u}function Ea(o,i){return function(c,p){const f=this,v=f.__v_raw,y=_t(v),C=i?Xd:o?tp:Gi;return!o&&On(y,"iterate",Cs),v.forEach((T,L)=>c.call(p,C(T),C(L),f))}}function Da(o,i,u){return function(...c){const p=this.__v_raw,f=_t(p),v=rr(f),y=o==="entries"||o===Symbol.iterator&&v,C=o==="keys"&&v,T=p[o](...c),L=u?Xd:i?tp:Gi;return!i&&On(f,"iterate",C?fd:Cs),{next(){const{value:R,done:k}=T.next();return k?{value:R,done:k}:{value:y?[L(R[0]),L(R[1])]:L(R),done:k}},[Symbol.iterator](){return this}}}}function wo(o){return function(...i){return o==="delete"?!1:o==="clear"?void 0:this}}function nC(){const o={get(f){return Ma(this,f)},get size(){return Ta(this)},has:Ca,add:Ih,set:Mh,delete:Ch,clear:Th,forEach:Ea(!1,!1)},i={get(f){return Ma(this,f,!1,!0)},get size(){return Ta(this)},has:Ca,add:Ih,set:Mh,delete:Ch,clear:Th,forEach:Ea(!1,!0)},u={get(f){return Ma(this,f,!0)},get size(){return Ta(this,!0)},has(f){return Ca.call(this,f,!0)},add:wo("add"),set:wo("set"),delete:wo("delete"),clear:wo("clear"),forEach:Ea(!0,!1)},c={get(f){return Ma(this,f,!0,!0)},get size(){return Ta(this,!0)},has(f){return Ca.call(this,f,!0)},add:wo("add"),set:wo("set"),delete:wo("delete"),clear:wo("clear"),forEach:Ea(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(f=>{o[f]=Da(f,!1,!1),u[f]=Da(f,!0,!1),i[f]=Da(f,!1,!0),c[f]=Da(f,!0,!0)}),[o,u,i,c]}const[oC,sC,rC,iC]=nC();function Zd(o,i){const u=i?o?iC:rC:o?sC:oC;return(c,p,f)=>p==="__v_isReactive"?!o:p==="__v_isReadonly"?o:p==="__v_raw"?c:Reflect.get(ft(u,p)&&p in c?u:c,p,f)}const aC={get:Zd(!1,!1)},cC={get:Zd(!1,!0)},uC={get:Zd(!0,!1)},x_=new WeakMap,q_=new WeakMap,V_=new WeakMap,lC=new WeakMap;function dC(o){switch(o){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function pC(o){return o.__v_skip||!Object.isExtensible(o)?0:dC(wM(o))}function ks(o){return bi(o)?o:ep(o,!1,QM,aC,x_)}function B_(o){return ep(o,!1,tC,cC,q_)}function Qd(o){return ep(o,!0,eC,uC,V_)}function ep(o,i,u,c,p){if(!Tt(o)||o.__v_raw&&!(i&&o.__v_isReactive))return o;const f=p.get(o);if(f)return f;const v=pC(o);if(v===0)return o;const y=new Proxy(o,v===2?c:u);return p.set(o,y),y}function Ts(o){return bi(o)?Ts(o.__v_raw):!!(o&&o.__v_isReactive)}function bi(o){return!!(o&&o.__v_isReadonly)}function Ya(o){return!!(o&&o.__v_isShallow)}function H_(o){return o?!!o.__v_raw:!1}function _t(o){const i=o&&o.__v_raw;return i?_t(i):o}function pc(o){return Object.isExtensible(o)&&D_(o,"__v_skip",!0),o}const Gi=o=>Tt(o)?ks(o):o,tp=o=>Tt(o)?Qd(o):o;class K_{constructor(i,u,c,p){this.getter=i,this._setter=u,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new zd(()=>i(this._value),()=>Ua(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!p,this.__v_isReadonly=c}get value(){const i=_t(this);return(!i._cacheable||i.effect.dirty)&&Qo(i._value,i._value=i.effect.run())&&Ua(i,4),W_(i),i.effect._dirtyLevel>=2&&Ua(i,2),i._value}set value(i){this._setter(i)}get _dirty(){return this.effect.dirty}set _dirty(i){this.effect.dirty=i}}function j_(o,i,u=!1){let c,p;const f=Ze(o);return f?(c=o,p=cn):(c=o.get,p=o.set),new K_(c,p,f||!p,u)}function W_(o){var i;Xo&&Ms&&(o=_t(o),P_(Ms,(i=o.dep)!=null?i:o.dep=G_(()=>o.dep=void 0,o instanceof K_?o:void 0)))}function Ua(o,i=4,u){o=_t(o);const c=o.dep;c&&b_(c,i)}function Wt(o){return!!(o&&o.__v_isRef===!0)}function pt(o){return Y_(o,!1)}function Ci(o){return Y_(o,!0)}function Y_(o,i){return Wt(o)?o:new fC(o,i)}class fC{constructor(i,u){this.__v_isShallow=u,this.dep=void 0,this.__v_isRef=!0,this._rawValue=u?i:_t(i),this._value=u?i:Gi(i)}get value(){return W_(this),this._value}set value(i){const u=this.__v_isShallow||Ya(i)||bi(i);i=u?i:_t(i),Qo(i,this._rawValue)&&(this._rawValue=i,this._value=u?i:Gi(i),Ua(this,4))}}function ge(o){return Wt(o)?o.value:o}const hC={get:(o,i,u)=>ge(Reflect.get(o,i,u)),set:(o,i,u,c)=>{const p=o[i];return Wt(p)&&!Wt(u)?(p.value=u,!0):Reflect.set(o,i,u,c)}};function z_(o){return Ts(o)?o:new Proxy(o,hC)}function $_(o){const i=He(o)?new Array(o.length):{};for(const u in o)i[u]=J_(o,u);return i}class gC{constructor(i,u,c){this._object=i,this._key=u,this._defaultValue=c,this.__v_isRef=!0}get value(){const i=this._object[this._key];return i===void 0?this._defaultValue:i}set value(i){this._object[this._key]=i}get dep(){return zM(_t(this._object),this._key)}}class _C{constructor(i){this._getter=i,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function za(o,i,u){return Wt(o)?o:Ze(o)?new _C(o):Tt(o)&&arguments.length>1?J_(o,i,u):pt(o)}function J_(o,i,u){const c=o[i];return Wt(c)?c:new gC(o,i,u)}/**
* @vue/runtime-core v3.4.23
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Zo(o,i,u,c){try{return c?o(...c):o()}catch(p){$i(p,i,u)}}function Kn(o,i,u,c){if(Ze(o)){const p=Zo(o,i,u,c);return p&&C_(p)&&p.catch(f=>{$i(f,i,u)}),p}if(He(o)){const p=[];for(let f=0;f<o.length;f++)p.push(Kn(o[f],i,u,c));return p}}function $i(o,i,u,c=!0){const p=i?i.vnode:null;if(i){let f=i.parent;const v=i.proxy,y=`https://vuejs.org/error-reference/#runtime-${u}`;for(;f;){const T=f.ec;if(T){for(let L=0;L<T.length;L++)if(T[L](o,v,y)===!1)return}f=f.parent}const C=i.appContext.config.errorHandler;if(C){ts(),Zo(C,null,10,[o,v,y]),ns();return}}mC(o,u,p,c)}function mC(o,i,u,c=!0){console.error(o)}let wi=!1,hd=!1;const _n=[];let go=0;const ir=[];let jo=null,hs=0;const X_=Promise.resolve();let np=null;function dn(o){const i=np||X_;return o?i.then(this?o.bind(this):o):i}function vC(o){let i=go+1,u=_n.length;for(;i<u;){const c=i+u>>>1,p=_n[c],f=Ui(p);f<o||f===o&&p.pre?i=c+1:u=c}return i}function fc(o){(!_n.length||!_n.includes(o,wi&&o.allowRecurse?go+1:go))&&(o.id==null?_n.push(o):_n.splice(vC(o.id),0,o),Z_())}function Z_(){!wi&&!hd&&(hd=!0,np=X_.then(em))}function yC(o){const i=_n.indexOf(o);i>go&&_n.splice(i,1)}function IC(o){He(o)?ir.push(...o):(!jo||!jo.includes(o,o.allowRecurse?hs+1:hs))&&ir.push(o),Z_()}function Eh(o,i,u=wi?go+1:0){for(;u<_n.length;u++){const c=_n[u];if(c&&c.pre){if(o&&c.id!==o.uid)continue;_n.splice(u,1),u--,c()}}}function Q_(o){if(ir.length){const i=[...new Set(ir)].sort((u,c)=>Ui(u)-Ui(c));if(ir.length=0,jo){jo.push(...i);return}for(jo=i,hs=0;hs<jo.length;hs++)jo[hs]();jo=null,hs=0}}const Ui=o=>o.id==null?1/0:o.id,MC=(o,i)=>{const u=Ui(o)-Ui(i);if(u===0){if(o.pre&&!i.pre)return-1;if(i.pre&&!o.pre)return 1}return u};function em(o){hd=!1,wi=!0,_n.sort(MC);try{for(go=0;go<_n.length;go++){const i=_n[go];i&&i.active!==!1&&Zo(i,null,14)}}finally{go=0,_n.length=0,Q_(),wi=!1,np=null,(_n.length||ir.length)&&em()}}function CC(o,i,...u){if(o.isUnmounted)return;const c=o.vnode.props||Gt;let p=u;const f=i.startsWith("update:"),v=f&&i.slice(7);if(v&&v in c){const L=`${v==="modelValue"?"model":v}Modifiers`,{number:R,trim:k}=c[L]||Gt;k&&(p=u.map(x=>Ct(x)?x.trim():x)),R&&(p=u.map(ld))}let y,C=c[y=Fl(i)]||c[y=Fl(to(i))];!C&&f&&(C=c[y=Fl(Rs(i))]),C&&Kn(C,o,6,p);const T=c[y+"Once"];if(T){if(!o.emitted)o.emitted={};else if(o.emitted[y])return;o.emitted[y]=!0,Kn(T,o,6,p)}}function tm(o,i,u=!1){const c=i.emitsCache,p=c.get(o);if(p!==void 0)return p;const f=o.emits;let v={},y=!1;if(!Ze(o)){const C=T=>{const L=tm(T,i,!0);L&&(y=!0,un(v,L))};!u&&i.mixins.length&&i.mixins.forEach(C),o.extends&&C(o.extends),o.mixins&&o.mixins.forEach(C)}return!f&&!y?(Tt(o)&&c.set(o,null),null):(He(f)?f.forEach(C=>v[C]=null):un(v,f),Tt(o)&&c.set(o,v),v)}function hc(o,i){return!o||!cc(i)?!1:(i=i.slice(2).replace(/Once$/,""),ft(o,i[0].toLowerCase()+i.slice(1))||ft(o,Rs(i))||ft(o,i))}let tn=null,gc=null;function $a(o){const i=tn;return tn=o,gc=o&&o.type.__scopeId||null,i}function hO(o){gc=o}function gO(){gc=null}function qt(o,i=tn,u){if(!i||o._n)return o;const c=(...p)=>{c._d&&xh(-1);const f=$a(i);let v;try{v=o(...p)}finally{$a(f),c._d&&xh(1)}return v};return c._n=!0,c._c=!0,c._d=!0,c}function Dh(o){const{type:i,vnode:u,proxy:c,withProxy:p,props:f,propsOptions:[v],slots:y,attrs:C,emit:T,render:L,renderCache:R,data:k,setupState:x,ctx:N,inheritAttrs:G}=o;let V,z;const te=$a(o);try{if(u.shapeFlag&4){const Ne=p||c,Le=Ne;V=ho(L.call(Le,Ne,R,f,x,k,N)),z=C}else{const Ne=i;V=ho(Ne.length>1?Ne(f,{attrs:C,slots:y,emit:T}):Ne(f,null)),z=i.props?C:TC(C)}}catch(Ne){Li.length=0,$i(Ne,o,1),V=kt(jn)}let q=V;if(z&&G!==!1){const Ne=Object.keys(z),{shapeFlag:Le}=q;Ne.length&&Le&7&&(v&&Ne.some(Bd)&&(z=EC(z,v)),q=es(q,z))}return u.dirs&&(q=es(q),q.dirs=q.dirs?q.dirs.concat(u.dirs):u.dirs),u.transition&&(q.transition=u.transition),V=q,$a(te),V}const TC=o=>{let i;for(const u in o)(u==="class"||u==="style"||cc(u))&&((i||(i={}))[u]=o[u]);return i},EC=(o,i)=>{const u={};for(const c in o)(!Bd(c)||!(c.slice(9)in i))&&(u[c]=o[c]);return u};function DC(o,i,u){const{props:c,children:p,component:f}=o,{props:v,children:y,patchFlag:C}=i,T=f.emitsOptions;if(i.dirs||i.transition)return!0;if(u&&C>=0){if(C&1024)return!0;if(C&16)return c?Sh(c,v,T):!!v;if(C&8){const L=i.dynamicProps;for(let R=0;R<L.length;R++){const k=L[R];if(v[k]!==c[k]&&!hc(T,k))return!0}}}else return(p||y)&&(!y||!y.$stable)?!0:c===v?!1:c?v?Sh(c,v,T):!0:!!v;return!1}function Sh(o,i,u){const c=Object.keys(i);if(c.length!==Object.keys(o).length)return!0;for(let p=0;p<c.length;p++){const f=c[p];if(i[f]!==o[f]&&!hc(u,f))return!0}return!1}function SC({vnode:o,parent:i},u){for(;i;){const c=i.subTree;if(c.suspense&&c.suspense.activeBranch===o&&(c.el=o.el),c===o)(o=i.vnode).el=u,i=i.parent;else break}}const op="components",LC="directives";function fs(o,i){return sp(op,o,!0,i)||o}const nm=Symbol.for("v-ndc");function Rn(o){return Ct(o)?sp(op,o,!1)||o:o||nm}function _O(o){return sp(LC,o)}function sp(o,i,u=!0,c=!1){const p=tn||on;if(p){const f=p.type;if(o===op){const y=T0(f,!1);if(y&&(y===i||y===to(i)||y===lc(to(i))))return f}const v=Lh(p[o]||f[o],i)||Lh(p.appContext[o],i);return!v&&c?f:v}}function Lh(o,i){return o&&(o[i]||o[to(i)]||o[lc(to(i))])}const RC=o=>o.__isSuspense;function kC(o,i){i&&i.pendingBranch?He(o)?i.effects.push(...o):i.effects.push(o):IC(o)}const AC=Symbol.for("v-scx"),OC=()=>bt(AC);function NC(o,i){return rp(o,null,i)}const Sa={};function Ht(o,i,u){return rp(o,i,u)}function rp(o,i,{immediate:u,deep:c,flush:p,once:f,onTrack:v,onTrigger:y}=Gt){if(i&&f){const Se=i;i=(...Ue)=>{Se(...Ue),Le()}}const C=on,T=Se=>c===!0?Se:_s(Se,c===!1?1:void 0);let L,R=!1,k=!1;if(Wt(o)?(L=()=>o.value,R=Ya(o)):Ts(o)?(L=()=>T(o),R=!0):He(o)?(k=!0,R=o.some(Se=>Ts(Se)||Ya(Se)),L=()=>o.map(Se=>{if(Wt(Se))return Se.value;if(Ts(Se))return T(Se);if(Ze(Se))return Zo(Se,C,2)})):Ze(o)?i?L=()=>Zo(o,C,2):L=()=>(x&&x(),Kn(o,C,3,[N])):L=cn,i&&c){const Se=L;L=()=>_s(Se())}let x,N=Se=>{x=q.onStop=()=>{Zo(Se,C,4),x=q.onStop=void 0}},G;if(Qi)if(N=cn,i?u&&Kn(i,C,3,[L(),k?[]:void 0,N]):L(),p==="sync"){const Se=OC();G=Se.__watcherHandles||(Se.__watcherHandles=[])}else return cn;let V=k?new Array(o.length).fill(Sa):Sa;const z=()=>{if(!(!q.active||!q.dirty))if(i){const Se=q.run();(c||R||(k?Se.some((Ue,ve)=>Qo(Ue,V[ve])):Qo(Se,V)))&&(x&&x(),Kn(i,C,3,[Se,V===Sa?void 0:k&&V[0]===Sa?[]:V,N]),V=Se)}else q.run()};z.allowRecurse=!!i;let te;p==="sync"?te=z:p==="post"?te=()=>Ln(z,C&&C.suspense):(z.pre=!0,C&&(z.id=C.uid),te=()=>fc(z));const q=new zd(L,cn,te),Ne=Wd(),Le=()=>{q.stop(),Ne&&Hd(Ne.effects,q)};return i?u?z():V=q.run():p==="post"?Ln(q.run.bind(q),C&&C.suspense):q.run(),G&&G.push(Le),Le}function PC(o,i,u){const c=this.proxy,p=Ct(o)?o.includes(".")?om(c,o):()=>c[o]:o.bind(c,c);let f;Ze(i)?f=i:(f=i.handler,u=i);const v=Zi(this),y=rp(p,f.bind(c),u);return v(),y}function om(o,i){const u=i.split(".");return()=>{let c=o;for(let p=0;p<u.length&&c;p++)c=c[u[p]];return c}}function _s(o,i,u=0,c){if(!Tt(o)||o.__v_skip)return o;if(i&&i>0){if(u>=i)return o;u++}if(c=c||new Set,c.has(o))return o;if(c.add(o),Wt(o))_s(o.value,i,u,c);else if(He(o))for(let p=0;p<o.length;p++)_s(o[p],i,u,c);else if(M_(o)||rr(o))o.forEach(p=>{_s(p,i,u,c)});else if(E_(o))for(const p in o)_s(o[p],i,u,c);return o}function Ti(o,i){if(tn===null)return o;const u=mc(tn)||tn.proxy,c=o.dirs||(o.dirs=[]);for(let p=0;p<i.length;p++){let[f,v,y,C=Gt]=i[p];f&&(Ze(f)&&(f={mounted:f,updated:f}),f.deep&&_s(v),c.push({dir:f,instance:u,value:v,oldValue:void 0,arg:y,modifiers:C}))}return o}function us(o,i,u,c){const p=o.dirs,f=i&&i.dirs;for(let v=0;v<p.length;v++){const y=p[v];f&&(y.oldValue=f[v].value);let C=y.dir[c];C&&(ts(),Kn(C,u,8,[o.el,y,o,i]),ns())}}const Wo=Symbol("_leaveCb"),La=Symbol("_enterCb");function sm(){const o={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return so(()=>{o.isMounted=!0}),As(()=>{o.isUnmounting=!0}),o}const Hn=[Function,Array],rm={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Hn,onEnter:Hn,onAfterEnter:Hn,onEnterCancelled:Hn,onBeforeLeave:Hn,onLeave:Hn,onAfterLeave:Hn,onLeaveCancelled:Hn,onBeforeAppear:Hn,onAppear:Hn,onAfterAppear:Hn,onAppearCancelled:Hn},bC={name:"BaseTransition",props:rm,setup(o,{slots:i}){const u=Nn(),c=sm();return()=>{const p=i.default&&ip(i.default(),!0);if(!p||!p.length)return;let f=p[0];if(p.length>1){for(const k of p)if(k.type!==jn){f=k;break}}const v=_t(o),{mode:y}=v;if(c.isLeaving)return ql(f);const C=Rh(f);if(!C)return ql(f);const T=Fi(C,v,c,u);xi(C,T);const L=u.subTree,R=L&&Rh(L);if(R&&R.type!==jn&&!gs(C,R)){const k=Fi(R,v,c,u);if(xi(R,k),y==="out-in")return c.isLeaving=!0,k.afterLeave=()=>{c.isLeaving=!1,u.update.active!==!1&&(u.effect.dirty=!0,u.update())},ql(f);y==="in-out"&&C.type!==jn&&(k.delayLeave=(x,N,G)=>{const V=im(c,R);V[String(R.key)]=R,x[Wo]=()=>{N(),x[Wo]=void 0,delete T.delayedLeave},T.delayedLeave=G})}return f}}},GC=bC;function im(o,i){const{leavingVNodes:u}=o;let c=u.get(i.type);return c||(c=Object.create(null),u.set(i.type,c)),c}function Fi(o,i,u,c){const{appear:p,mode:f,persisted:v=!1,onBeforeEnter:y,onEnter:C,onAfterEnter:T,onEnterCancelled:L,onBeforeLeave:R,onLeave:k,onAfterLeave:x,onLeaveCancelled:N,onBeforeAppear:G,onAppear:V,onAfterAppear:z,onAppearCancelled:te}=i,q=String(o.key),Ne=im(u,o),Le=(ve,ye)=>{ve&&Kn(ve,c,9,ye)},Se=(ve,ye)=>{const $=ye[1];Le(ve,ye),He(ve)?ve.every(I=>I.length<=1)&&$():ve.length<=1&&$()},Ue={mode:f,persisted:v,beforeEnter(ve){let ye=y;if(!u.isMounted)if(p)ye=G||y;else return;ve[Wo]&&ve[Wo](!0);const $=Ne[q];$&&gs(o,$)&&$.el[Wo]&&$.el[Wo](),Le(ye,[ve])},enter(ve){let ye=C,$=T,I=L;if(!u.isMounted)if(p)ye=V||C,$=z||T,I=te||L;else return;let W=!1;const Z=ve[La]=X=>{W||(W=!0,X?Le(I,[ve]):Le($,[ve]),Ue.delayedLeave&&Ue.delayedLeave(),ve[La]=void 0)};ye?Se(ye,[ve,Z]):Z()},leave(ve,ye){const $=String(o.key);if(ve[La]&&ve[La](!0),u.isUnmounting)return ye();Le(R,[ve]);let I=!1;const W=ve[Wo]=Z=>{I||(I=!0,ye(),Z?Le(N,[ve]):Le(x,[ve]),ve[Wo]=void 0,Ne[$]===o&&delete Ne[$])};Ne[$]=o,k?Se(k,[ve,W]):W()},clone(ve){return Fi(ve,i,u,c)}};return Ue}function ql(o){if(Ji(o))return o=es(o),o.children=null,o}function Rh(o){return Ji(o)?o.children?o.children[0]:void 0:o}function xi(o,i){o.shapeFlag&6&&o.component?xi(o.component.subTree,i):o.shapeFlag&128?(o.ssContent.transition=i.clone(o.ssContent),o.ssFallback.transition=i.clone(o.ssFallback)):o.transition=i}function ip(o,i=!1,u){let c=[],p=0;for(let f=0;f<o.length;f++){let v=o[f];const y=u==null?v.key:String(u)+String(v.key!=null?v.key:f);v.type===an?(v.patchFlag&128&&p++,c=c.concat(ip(v.children,i,y))):(i||v.type!==jn)&&c.push(y!=null?es(v,{key:y}):v)}if(p>1)for(let f=0;f<c.length;f++)c[f].patchFlag=-2;return c}/*! #__NO_SIDE_EFFECTS__ */function ut(o,i){return Ze(o)?un({name:o.name},i,{setup:o}):o}const Ei=o=>!!o.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function wC(o){Ze(o)&&(o={loader:o});const{loader:i,loadingComponent:u,errorComponent:c,delay:p=200,timeout:f,suspensible:v=!0,onError:y}=o;let C=null,T,L=0;const R=()=>(L++,C=null,k()),k=()=>{let x;return C||(x=C=i().catch(N=>{if(N=N instanceof Error?N:new Error(String(N)),y)return new Promise((G,V)=>{y(N,()=>G(R()),()=>V(N),L+1)});throw N}).then(N=>x!==C&&C?C:(N&&(N.__esModule||N[Symbol.toStringTag]==="Module")&&(N=N.default),T=N,N)))};return ut({name:"AsyncComponentWrapper",__asyncLoader:k,get __asyncResolved(){return T},setup(){const x=on;if(T)return()=>Vl(T,x);const N=te=>{C=null,$i(te,x,13,!c)};if(v&&x.suspense||Qi)return k().then(te=>()=>Vl(te,x)).catch(te=>(N(te),()=>c?kt(c,{error:te}):null));const G=pt(!1),V=pt(),z=pt(!!p);return p&&setTimeout(()=>{z.value=!1},p),f!=null&&setTimeout(()=>{if(!G.value&&!V.value){const te=new Error(`Async component timed out after ${f}ms.`);N(te),V.value=te}},f),k().then(()=>{G.value=!0,x.parent&&Ji(x.parent.vnode)&&(x.parent.effect.dirty=!0,fc(x.parent.update))}).catch(te=>{N(te),V.value=te}),()=>{if(G.value&&T)return Vl(T,x);if(V.value&&c)return kt(c,{error:V.value});if(u&&!z.value)return kt(u)}}})}function Vl(o,i){const{ref:u,props:c,children:p,ce:f}=i.vnode,v=kt(o,c,p);return v.ref=u,v.ce=f,delete i.vnode.ce,v}const Ji=o=>o.type.__isKeepAlive;function UC(o,i){am(o,"a",i)}function FC(o,i){am(o,"da",i)}function am(o,i,u=on){const c=o.__wdc||(o.__wdc=()=>{let p=u;for(;p;){if(p.isDeactivated)return;p=p.parent}return o()});if(_c(i,c,u),u){let p=u.parent;for(;p&&p.parent;)Ji(p.parent.vnode)&&xC(c,i,u,p),p=p.parent}}function xC(o,i,u,c){const p=_c(i,o,c,!0);ap(()=>{Hd(c[i],p)},u)}function _c(o,i,u=on,c=!1){if(u){const p=u[o]||(u[o]=[]),f=i.__weh||(i.__weh=(...v)=>{if(u.isUnmounted)return;ts();const y=Zi(u),C=Kn(i,u,o,v);return y(),ns(),C});return c?p.unshift(f):p.push(f),f}}const Ro=o=>(i,u=on)=>(!Qi||o==="sp")&&_c(o,(...c)=>i(...c),u),qC=Ro("bm"),so=Ro("m"),VC=Ro("bu"),cm=Ro("u"),As=Ro("bum"),ap=Ro("um"),BC=Ro("sp"),HC=Ro("rtg"),KC=Ro("rtc");function jC(o,i=on){_c("ec",o,i)}function mO(o,i,u,c){let p;const f=u;if(He(o)||Ct(o)){p=new Array(o.length);for(let v=0,y=o.length;v<y;v++)p[v]=i(o[v],v,void 0,f)}else if(typeof o=="number"){p=new Array(o);for(let v=0;v<o;v++)p[v]=i(v+1,v,void 0,f)}else if(Tt(o))if(o[Symbol.iterator])p=Array.from(o,(v,y)=>i(v,y,void 0,f));else{const v=Object.keys(o);p=new Array(v.length);for(let y=0,C=v.length;y<C;y++){const T=v[y];p[y]=i(o[T],T,y,f)}}else p=[];return p}function vO(o,i){for(let u=0;u<i.length;u++){const c=i[u];if(He(c))for(let p=0;p<c.length;p++)o[c[p].name]=c[p].fn;else c&&(o[c.name]=c.key?(...p)=>{const f=c.fn(...p);return f&&(f.key=c.key),f}:c.fn)}return o}function Tn(o,i,u={},c,p){if(tn.isCE||tn.parent&&Ei(tn.parent)&&tn.parent.isCE)return i!=="default"&&(u.name=i),kt("slot",u,c&&c());let f=o[i];f&&f._c&&(f._d=!1),be();const v=f&&um(f(u)),y=Mt(an,{key:u.key||v&&v.key||`_${i}`},v||(c?c():[]),v&&o._===1?64:-2);return!p&&y.scopeId&&(y.slotScopeIds=[y.scopeId+"-s"]),f&&f._c&&(f._d=!0),y}function um(o){return o.some(i=>no(i)?!(i.type===jn||i.type===an&&!um(i.children)):!0)?o:null}const gd=o=>o?Sm(o)?mc(o)||o.proxy:gd(o.parent):null,Di=un(Object.create(null),{$:o=>o,$el:o=>o.vnode.el,$data:o=>o.data,$props:o=>o.props,$attrs:o=>o.attrs,$slots:o=>o.slots,$refs:o=>o.refs,$parent:o=>gd(o.parent),$root:o=>gd(o.root),$emit:o=>o.emit,$options:o=>fm(o),$forceUpdate:o=>o.f||(o.f=()=>{o.effect.dirty=!0,fc(o.update)}),$nextTick:o=>o.n||(o.n=dn.bind(o.proxy)),$watch:o=>PC.bind(o)}),Bl=(o,i)=>o!==Gt&&!o.__isScriptSetup&&ft(o,i),WC={get({_:o},i){if(i==="__v_skip")return!0;const{ctx:u,setupState:c,data:p,props:f,accessCache:v,type:y,appContext:C}=o;let T;if(i[0]!=="$"){const x=v[i];if(x!==void 0)switch(x){case 1:return c[i];case 2:return p[i];case 4:return u[i];case 3:return f[i]}else{if(Bl(c,i))return v[i]=1,c[i];if(p!==Gt&&ft(p,i))return v[i]=2,p[i];if((T=o.propsOptions[0])&&ft(T,i))return v[i]=3,f[i];if(u!==Gt&&ft(u,i))return v[i]=4,u[i];_d&&(v[i]=0)}}const L=Di[i];let R,k;if(L)return i==="$attrs"&&On(o.attrs,"get",""),L(o);if((R=y.__cssModules)&&(R=R[i]))return R;if(u!==Gt&&ft(u,i))return v[i]=4,u[i];if(k=C.config.globalProperties,ft(k,i))return k[i]},set({_:o},i,u){const{data:c,setupState:p,ctx:f}=o;return Bl(p,i)?(p[i]=u,!0):c!==Gt&&ft(c,i)?(c[i]=u,!0):ft(o.props,i)||i[0]==="$"&&i.slice(1)in o?!1:(f[i]=u,!0)},has({_:{data:o,setupState:i,accessCache:u,ctx:c,appContext:p,propsOptions:f}},v){let y;return!!u[v]||o!==Gt&&ft(o,v)||Bl(i,v)||(y=f[0])&&ft(y,v)||ft(c,v)||ft(Di,v)||ft(p.config.globalProperties,v)},defineProperty(o,i,u){return u.get!=null?o._.accessCache[i]=0:ft(u,"value")&&this.set(o,i,u.value,null),Reflect.defineProperty(o,i,u)}};function lm(){return dm().slots}function YC(){return dm().attrs}function dm(){const o=Nn();return o.setupContext||(o.setupContext=Rm(o))}function kh(o){return He(o)?o.reduce((i,u)=>(i[u]=null,i),{}):o}let _d=!0;function zC(o){const i=fm(o),u=o.proxy,c=o.ctx;_d=!1,i.beforeCreate&&Ah(i.beforeCreate,o,"bc");const{data:p,computed:f,methods:v,watch:y,provide:C,inject:T,created:L,beforeMount:R,mounted:k,beforeUpdate:x,updated:N,activated:G,deactivated:V,beforeDestroy:z,beforeUnmount:te,destroyed:q,unmounted:Ne,render:Le,renderTracked:Se,renderTriggered:Ue,errorCaptured:ve,serverPrefetch:ye,expose:$,inheritAttrs:I,components:W,directives:Z,filters:X}=i;if(T&&$C(T,c,null),v)for(const ue in v){const re=v[ue];Ze(re)&&(c[ue]=re.bind(u))}if(p){const ue=p.call(u,u);Tt(ue)&&(o.data=ks(ue))}if(_d=!0,f)for(const ue in f){const re=f[ue],Ee=Ze(re)?re.bind(u,u):Ze(re.get)?re.get.bind(u,u):cn,P=!Ze(re)&&Ze(re.set)?re.set.bind(u):cn,he=Oe({get:Ee,set:P});Object.defineProperty(c,ue,{enumerable:!0,configurable:!0,get:()=>he.value,set:Fe=>he.value=Fe})}if(y)for(const ue in y)pm(y[ue],c,u,ue);if(C){const ue=Ze(C)?C.call(u):C;Reflect.ownKeys(ue).forEach(re=>{Do(re,ue[re])})}L&&Ah(L,o,"c");function Y(ue,re){He(re)?re.forEach(Ee=>ue(Ee.bind(u))):re&&ue(re.bind(u))}if(Y(qC,R),Y(so,k),Y(VC,x),Y(cm,N),Y(UC,G),Y(FC,V),Y(jC,ve),Y(KC,Se),Y(HC,Ue),Y(As,te),Y(ap,Ne),Y(BC,ye),He($))if($.length){const ue=o.exposed||(o.exposed={});$.forEach(re=>{Object.defineProperty(ue,re,{get:()=>u[re],set:Ee=>u[re]=Ee})})}else o.exposed||(o.exposed={});Le&&o.render===cn&&(o.render=Le),I!=null&&(o.inheritAttrs=I),W&&(o.components=W),Z&&(o.directives=Z)}function $C(o,i,u=cn){He(o)&&(o=md(o));for(const c in o){const p=o[c];let f;Tt(p)?"default"in p?f=bt(p.from||c,p.default,!0):f=bt(p.from||c):f=bt(p),Wt(f)?Object.defineProperty(i,c,{enumerable:!0,configurable:!0,get:()=>f.value,set:v=>f.value=v}):i[c]=f}}function Ah(o,i,u){Kn(He(o)?o.map(c=>c.bind(i.proxy)):o.bind(i.proxy),i,u)}function pm(o,i,u,c){const p=c.includes(".")?om(u,c):()=>u[c];if(Ct(o)){const f=i[o];Ze(f)&&Ht(p,f)}else if(Ze(o))Ht(p,o.bind(u));else if(Tt(o))if(He(o))o.forEach(f=>pm(f,i,u,c));else{const f=Ze(o.handler)?o.handler.bind(u):i[o.handler];Ze(f)&&Ht(p,f,o)}}function fm(o){const i=o.type,{mixins:u,extends:c}=i,{mixins:p,optionsCache:f,config:{optionMergeStrategies:v}}=o.appContext,y=f.get(i);let C;return y?C=y:!p.length&&!u&&!c?C=i:(C={},p.length&&p.forEach(T=>Ja(C,T,v,!0)),Ja(C,i,v)),Tt(i)&&f.set(i,C),C}function Ja(o,i,u,c=!1){const{mixins:p,extends:f}=i;f&&Ja(o,f,u,!0),p&&p.forEach(v=>Ja(o,v,u,!0));for(const v in i)if(!(c&&v==="expose")){const y=JC[v]||u&&u[v];o[v]=y?y(o[v],i[v]):i[v]}return o}const JC={data:Oh,props:Nh,emits:Nh,methods:Ii,computed:Ii,beforeCreate:Mn,created:Mn,beforeMount:Mn,mounted:Mn,beforeUpdate:Mn,updated:Mn,beforeDestroy:Mn,beforeUnmount:Mn,destroyed:Mn,unmounted:Mn,activated:Mn,deactivated:Mn,errorCaptured:Mn,serverPrefetch:Mn,components:Ii,directives:Ii,watch:ZC,provide:Oh,inject:XC};function Oh(o,i){return i?o?function(){return un(Ze(o)?o.call(this,this):o,Ze(i)?i.call(this,this):i)}:i:o}function XC(o,i){return Ii(md(o),md(i))}function md(o){if(He(o)){const i={};for(let u=0;u<o.length;u++)i[o[u]]=o[u];return i}return o}function Mn(o,i){return o?[...new Set([].concat(o,i))]:i}function Ii(o,i){return o?un(Object.create(null),o,i):i}function Nh(o,i){return o?He(o)&&He(i)?[...new Set([...o,...i])]:un(Object.create(null),kh(o),kh(i??{})):i}function ZC(o,i){if(!o)return i;if(!i)return o;const u=un(Object.create(null),o);for(const c in i)u[c]=Mn(o[c],i[c]);return u}function hm(){return{app:null,config:{isNativeTag:bM,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let QC=0;function e0(o,i){return function(c,p=null){Ze(c)||(c=un({},c)),p!=null&&!Tt(p)&&(p=null);const f=hm(),v=new WeakSet;let y=!1;const C=f.app={_uid:QC++,_component:c,_props:p,_container:null,_context:f,_instance:null,version:D0,get config(){return f.config},set config(T){},use(T,...L){return v.has(T)||(T&&Ze(T.install)?(v.add(T),T.install(C,...L)):Ze(T)&&(v.add(T),T(C,...L))),C},mixin(T){return f.mixins.includes(T)||f.mixins.push(T),C},component(T,L){return L?(f.components[T]=L,C):f.components[T]},directive(T,L){return L?(f.directives[T]=L,C):f.directives[T]},mount(T,L,R){if(!y){const k=kt(c,p);return k.appContext=f,R===!0?R="svg":R===!1&&(R=void 0),o(k,T,R),y=!0,C._container=T,T.__vue_app__=C,mc(k.component)||k.component.proxy}},unmount(){y&&(o(null,C._container),delete C._container.__vue_app__)},provide(T,L){return f.provides[T]=L,C},runWithContext(T){const L=ar;ar=C;try{return T()}finally{ar=L}}};return C}}let ar=null;function Do(o,i){if(on){let u=on.provides;const c=on.parent&&on.parent.provides;c===u&&(u=on.provides=Object.create(c)),u[o]=i}}function bt(o,i,u=!1){const c=on||tn;if(c||ar){const p=c?c.parent==null?c.vnode.appContext&&c.vnode.appContext.provides:c.parent.provides:ar._context.provides;if(p&&o in p)return p[o];if(arguments.length>1)return u&&Ze(i)?i.call(c&&c.proxy):i}}function t0(){return!!(on||tn||ar)}const gm=Object.create(null),vd=()=>Object.create(gm),_m=o=>Object.getPrototypeOf(o)===gm;function n0(o,i,u,c=!1){const p={},f=vd();o.propsDefaults=Object.create(null),mm(o,i,p,f);for(const v in o.propsOptions[0])v in p||(p[v]=void 0);u?o.props=c?p:B_(p):o.type.props?o.props=p:o.props=f,o.attrs=f}function o0(o,i,u,c){const{props:p,attrs:f,vnode:{patchFlag:v}}=o,y=_t(p),[C]=o.propsOptions;let T=!1;if((c||v>0)&&!(v&16)){if(v&8){const L=o.vnode.dynamicProps;for(let R=0;R<L.length;R++){let k=L[R];if(hc(o.emitsOptions,k))continue;const x=i[k];if(C)if(ft(f,k))x!==f[k]&&(f[k]=x,T=!0);else{const N=to(k);p[N]=yd(C,y,N,x,o,!1)}else x!==f[k]&&(f[k]=x,T=!0)}}}else{mm(o,i,p,f)&&(T=!0);let L;for(const R in y)(!i||!ft(i,R)&&((L=Rs(R))===R||!ft(i,L)))&&(C?u&&(u[R]!==void 0||u[L]!==void 0)&&(p[R]=yd(C,y,R,void 0,o,!0)):delete p[R]);if(f!==y)for(const R in f)(!i||!ft(i,R))&&(delete f[R],T=!0)}T&&Eo(o.attrs,"set","")}function mm(o,i,u,c){const[p,f]=o.propsOptions;let v=!1,y;if(i)for(let C in i){if(Mi(C))continue;const T=i[C];let L;p&&ft(p,L=to(C))?!f||!f.includes(L)?u[L]=T:(y||(y={}))[L]=T:hc(o.emitsOptions,C)||(!(C in c)||T!==c[C])&&(c[C]=T,v=!0)}if(f){const C=_t(u),T=y||Gt;for(let L=0;L<f.length;L++){const R=f[L];u[R]=yd(p,C,R,T[R],o,!ft(T,R))}}return v}function yd(o,i,u,c,p,f){const v=o[u];if(v!=null){const y=ft(v,"default");if(y&&c===void 0){const C=v.default;if(v.type!==Function&&!v.skipFactory&&Ze(C)){const{propsDefaults:T}=p;if(u in T)c=T[u];else{const L=Zi(p);c=T[u]=C.call(null,i),L()}}else c=C}v[0]&&(f&&!y?c=!1:v[1]&&(c===""||c===Rs(u))&&(c=!0))}return c}function vm(o,i,u=!1){const c=i.propsCache,p=c.get(o);if(p)return p;const f=o.props,v={},y=[];let C=!1;if(!Ze(o)){const L=R=>{C=!0;const[k,x]=vm(R,i,!0);un(v,k),x&&y.push(...x)};!u&&i.mixins.length&&i.mixins.forEach(L),o.extends&&L(o.extends),o.mixins&&o.mixins.forEach(L)}if(!f&&!C)return Tt(o)&&c.set(o,sr),sr;if(He(f))for(let L=0;L<f.length;L++){const R=to(f[L]);Ph(R)&&(v[R]=Gt)}else if(f)for(const L in f){const R=to(L);if(Ph(R)){const k=f[L],x=v[R]=He(k)||Ze(k)?{type:k}:un({},k);if(x){const N=wh(Boolean,x.type),G=wh(String,x.type);x[0]=N>-1,x[1]=G<0||N<G,(N>-1||ft(x,"default"))&&y.push(R)}}}const T=[v,y];return Tt(o)&&c.set(o,T),T}function Ph(o){return o[0]!=="$"&&!Mi(o)}function bh(o){return o===null?"null":typeof o=="function"?o.name||"":typeof o=="object"&&o.constructor&&o.constructor.name||""}function Gh(o,i){return bh(o)===bh(i)}function wh(o,i){return He(i)?i.findIndex(u=>Gh(u,o)):Ze(i)&&Gh(i,o)?0:-1}const ym=o=>o[0]==="_"||o==="$stable",cp=o=>He(o)?o.map(ho):[ho(o)],s0=(o,i,u)=>{if(i._n)return i;const c=qt((...p)=>cp(i(...p)),u);return c._c=!1,c},Im=(o,i,u)=>{const c=o._ctx;for(const p in o){if(ym(p))continue;const f=o[p];if(Ze(f))i[p]=s0(p,f,c);else if(f!=null){const v=cp(f);i[p]=()=>v}}},Mm=(o,i)=>{const u=cp(i);o.slots.default=()=>u},r0=(o,i)=>{if(o.vnode.shapeFlag&32){const u=i._;u?(o.slots=_t(i),D_(o.slots,"_",u)):Im(i,o.slots=vd())}else o.slots=vd(),i&&Mm(o,i)},i0=(o,i,u)=>{const{vnode:c,slots:p}=o;let f=!0,v=Gt;if(c.shapeFlag&32){const y=i._;y?u&&y===1?f=!1:(un(p,i),!u&&y===1&&delete p._):(f=!i.$stable,Im(i,p)),v=i}else i&&(Mm(o,i),v={default:1});if(f)for(const y in p)!ym(y)&&v[y]==null&&delete p[y]};function Id(o,i,u,c,p=!1){if(He(o)){o.forEach((k,x)=>Id(k,i&&(He(i)?i[x]:i),u,c,p));return}if(Ei(c)&&!p)return;const f=c.shapeFlag&4?mc(c.component)||c.component.proxy:c.el,v=p?null:f,{i:y,r:C}=o,T=i&&i.r,L=y.refs===Gt?y.refs={}:y.refs,R=y.setupState;if(T!=null&&T!==C&&(Ct(T)?(L[T]=null,ft(R,T)&&(R[T]=null)):Wt(T)&&(T.value=null)),Ze(C))Zo(C,y,12,[v,L]);else{const k=Ct(C),x=Wt(C);if(k||x){const N=()=>{if(o.f){const G=k?ft(R,C)?R[C]:L[C]:C.value;p?He(G)&&Hd(G,f):He(G)?G.includes(f)||G.push(f):k?(L[C]=[f],ft(R,C)&&(R[C]=L[C])):(C.value=[f],o.k&&(L[o.k]=C.value))}else k?(L[C]=v,ft(R,C)&&(R[C]=v)):x&&(C.value=v,o.k&&(L[o.k]=v))};v?(N.id=-1,Ln(N,u)):N()}}}const Ln=kC;function a0(o){return c0(o)}function c0(o,i){const u=S_();u.__VUE__=!0;const{insert:c,remove:p,patchProp:f,createElement:v,createText:y,createComment:C,setText:T,setElementText:L,parentNode:R,nextSibling:k,setScopeId:x=cn,insertStaticContent:N}=o,G=(b,w,j,ce=null,ee=null,pe=null,Te=void 0,le=null,Ie=!!w.dynamicChildren)=>{if(b===w)return;b&&!gs(b,w)&&(ce=ie(b),Fe(b,ee,pe,!0),b=null),w.patchFlag===-2&&(Ie=!1,w.dynamicChildren=null);const{type:Me,ref:we,shapeFlag:Ye}=w;switch(Me){case Xi:V(b,w,j,ce);break;case jn:z(b,w,j,ce);break;case Kl:b==null&&te(w,j,ce,Te);break;case an:W(b,w,j,ce,ee,pe,Te,le,Ie);break;default:Ye&1?Le(b,w,j,ce,ee,pe,Te,le,Ie):Ye&6?Z(b,w,j,ce,ee,pe,Te,le,Ie):(Ye&64||Ye&128)&&Me.process(b,w,j,ce,ee,pe,Te,le,Ie,Re)}we!=null&&ee&&Id(we,b&&b.ref,pe,w||b,!w)},V=(b,w,j,ce)=>{if(b==null)c(w.el=y(w.children),j,ce);else{const ee=w.el=b.el;w.children!==b.children&&T(ee,w.children)}},z=(b,w,j,ce)=>{b==null?c(w.el=C(w.children||""),j,ce):w.el=b.el},te=(b,w,j,ce)=>{[b.el,b.anchor]=N(b.children,w,j,ce,b.el,b.anchor)},q=({el:b,anchor:w},j,ce)=>{let ee;for(;b&&b!==w;)ee=k(b),c(b,j,ce),b=ee;c(w,j,ce)},Ne=({el:b,anchor:w})=>{let j;for(;b&&b!==w;)j=k(b),p(b),b=j;p(w)},Le=(b,w,j,ce,ee,pe,Te,le,Ie)=>{w.type==="svg"?Te="svg":w.type==="math"&&(Te="mathml"),b==null?Se(w,j,ce,ee,pe,Te,le,Ie):ye(b,w,ee,pe,Te,le,Ie)},Se=(b,w,j,ce,ee,pe,Te,le)=>{let Ie,Me;const{props:we,shapeFlag:Ye,transition:qe,dirs:ae}=b;if(Ie=b.el=v(b.type,pe,we&&we.is,we),Ye&8?L(Ie,b.children):Ye&16&&ve(b.children,Ie,null,ce,ee,Hl(b,pe),Te,le),ae&&us(b,null,ce,"created"),Ue(Ie,b,b.scopeId,Te,ce),we){for(const et in we)et!=="value"&&!Mi(et)&&f(Ie,et,null,we[et],pe,b.children,ce,ee,at);"value"in we&&f(Ie,"value",null,we.value,pe),(Me=we.onVnodeBeforeMount)&&po(Me,ce,b)}ae&&us(b,null,ce,"beforeMount");const Ge=u0(ee,qe);Ge&&qe.beforeEnter(Ie),c(Ie,w,j),((Me=we&&we.onVnodeMounted)||Ge||ae)&&Ln(()=>{Me&&po(Me,ce,b),Ge&&qe.enter(Ie),ae&&us(b,null,ce,"mounted")},ee)},Ue=(b,w,j,ce,ee)=>{if(j&&x(b,j),ce)for(let pe=0;pe<ce.length;pe++)x(b,ce[pe]);if(ee){let pe=ee.subTree;if(w===pe){const Te=ee.vnode;Ue(b,Te,Te.scopeId,Te.slotScopeIds,ee.parent)}}},ve=(b,w,j,ce,ee,pe,Te,le,Ie=0)=>{for(let Me=Ie;Me<b.length;Me++){const we=b[Me]=le?Yo(b[Me]):ho(b[Me]);G(null,we,w,j,ce,ee,pe,Te,le)}},ye=(b,w,j,ce,ee,pe,Te)=>{const le=w.el=b.el;let{patchFlag:Ie,dynamicChildren:Me,dirs:we}=w;Ie|=b.patchFlag&16;const Ye=b.props||Gt,qe=w.props||Gt;let ae;if(j&&ls(j,!1),(ae=qe.onVnodeBeforeUpdate)&&po(ae,j,w,b),we&&us(w,b,j,"beforeUpdate"),j&&ls(j,!0),Me?$(b.dynamicChildren,Me,le,j,ce,Hl(w,ee),pe):Te||re(b,w,le,null,j,ce,Hl(w,ee),pe,!1),Ie>0){if(Ie&16)I(le,w,Ye,qe,j,ce,ee);else if(Ie&2&&Ye.class!==qe.class&&f(le,"class",null,qe.class,ee),Ie&4&&f(le,"style",Ye.style,qe.style,ee),Ie&8){const Ge=w.dynamicProps;for(let et=0;et<Ge.length;et++){const Dt=Ge[et],Xt=Ye[Dt],bn=qe[Dt];(bn!==Xt||Dt==="value")&&f(le,Dt,Xt,bn,ee,b.children,j,ce,at)}}Ie&1&&b.children!==w.children&&L(le,w.children)}else!Te&&Me==null&&I(le,w,Ye,qe,j,ce,ee);((ae=qe.onVnodeUpdated)||we)&&Ln(()=>{ae&&po(ae,j,w,b),we&&us(w,b,j,"updated")},ce)},$=(b,w,j,ce,ee,pe,Te)=>{for(let le=0;le<w.length;le++){const Ie=b[le],Me=w[le],we=Ie.el&&(Ie.type===an||!gs(Ie,Me)||Ie.shapeFlag&70)?R(Ie.el):j;G(Ie,Me,we,null,ce,ee,pe,Te,!0)}},I=(b,w,j,ce,ee,pe,Te)=>{if(j!==ce){if(j!==Gt)for(const le in j)!Mi(le)&&!(le in ce)&&f(b,le,j[le],null,Te,w.children,ee,pe,at);for(const le in ce){if(Mi(le))continue;const Ie=ce[le],Me=j[le];Ie!==Me&&le!=="value"&&f(b,le,Me,Ie,Te,w.children,ee,pe,at)}"value"in ce&&f(b,"value",j.value,ce.value,Te)}},W=(b,w,j,ce,ee,pe,Te,le,Ie)=>{const Me=w.el=b?b.el:y(""),we=w.anchor=b?b.anchor:y("");let{patchFlag:Ye,dynamicChildren:qe,slotScopeIds:ae}=w;ae&&(le=le?le.concat(ae):ae),b==null?(c(Me,j,ce),c(we,j,ce),ve(w.children||[],j,we,ee,pe,Te,le,Ie)):Ye>0&&Ye&64&&qe&&b.dynamicChildren?($(b.dynamicChildren,qe,j,ee,pe,Te,le),(w.key!=null||ee&&w===ee.subTree)&&up(b,w,!0)):re(b,w,j,we,ee,pe,Te,le,Ie)},Z=(b,w,j,ce,ee,pe,Te,le,Ie)=>{w.slotScopeIds=le,b==null?w.shapeFlag&512?ee.ctx.activate(w,j,ce,Te,Ie):X(w,j,ce,ee,pe,Te,Ie):Q(b,w,Ie)},X=(b,w,j,ce,ee,pe,Te)=>{const le=b.component=y0(b,ce,ee);if(Ji(b)&&(le.ctx.renderer=Re),I0(le),le.asyncDep){if(ee&&ee.registerDep(le,Y),!b.el){const Ie=le.subTree=kt(jn);z(null,Ie,w,j)}}else Y(le,b,w,j,ee,pe,Te)},Q=(b,w,j)=>{const ce=w.component=b.component;if(DC(b,w,j))if(ce.asyncDep&&!ce.asyncResolved){ue(ce,w,j);return}else ce.next=w,yC(ce.update),ce.effect.dirty=!0,ce.update();else w.el=b.el,ce.vnode=w},Y=(b,w,j,ce,ee,pe,Te)=>{const le=()=>{if(b.isMounted){let{next:we,bu:Ye,u:qe,parent:ae,vnode:Ge}=b;{const Gn=Cm(b);if(Gn){we&&(we.el=Ge.el,ue(b,we,Te)),Gn.asyncDep.then(()=>{b.isUnmounted||le()});return}}let et=we,Dt;ls(b,!1),we?(we.el=Ge.el,ue(b,we,Te)):we=Ge,Ye&&wa(Ye),(Dt=we.props&&we.props.onVnodeBeforeUpdate)&&po(Dt,ae,we,Ge),ls(b,!0);const Xt=Dh(b),bn=b.subTree;b.subTree=Xt,G(bn,Xt,R(bn.el),ie(bn),b,ee,pe),we.el=Xt.el,et===null&&SC(b,Xt.el),qe&&Ln(qe,ee),(Dt=we.props&&we.props.onVnodeUpdated)&&Ln(()=>po(Dt,ae,we,Ge),ee)}else{let we;const{el:Ye,props:qe}=w,{bm:ae,m:Ge,parent:et}=b,Dt=Ei(w);ls(b,!1),ae&&wa(ae),!Dt&&(we=qe&&qe.onVnodeBeforeMount)&&po(we,et,w),ls(b,!0);{const Xt=b.subTree=Dh(b);G(null,Xt,j,ce,b,ee,pe),w.el=Xt.el}if(Ge&&Ln(Ge,ee),!Dt&&(we=qe&&qe.onVnodeMounted)){const Xt=w;Ln(()=>po(we,et,Xt),ee)}(w.shapeFlag&256||et&&Ei(et.vnode)&&et.vnode.shapeFlag&256)&&b.a&&Ln(b.a,ee),b.isMounted=!0,w=j=ce=null}},Ie=b.effect=new zd(le,cn,()=>fc(Me),b.scope),Me=b.update=()=>{Ie.dirty&&Ie.run()};Me.id=b.uid,ls(b,!0),Me()},ue=(b,w,j)=>{w.component=b;const ce=b.vnode.props;b.vnode=w,b.next=null,o0(b,w.props,ce,j),i0(b,w.children,j),ts(),Eh(b),ns()},re=(b,w,j,ce,ee,pe,Te,le,Ie=!1)=>{const Me=b&&b.children,we=b?b.shapeFlag:0,Ye=w.children,{patchFlag:qe,shapeFlag:ae}=w;if(qe>0){if(qe&128){P(Me,Ye,j,ce,ee,pe,Te,le,Ie);return}else if(qe&256){Ee(Me,Ye,j,ce,ee,pe,Te,le,Ie);return}}ae&8?(we&16&&at(Me,ee,pe),Ye!==Me&&L(j,Ye)):we&16?ae&16?P(Me,Ye,j,ce,ee,pe,Te,le,Ie):at(Me,ee,pe,!0):(we&8&&L(j,""),ae&16&&ve(Ye,j,ce,ee,pe,Te,le,Ie))},Ee=(b,w,j,ce,ee,pe,Te,le,Ie)=>{b=b||sr,w=w||sr;const Me=b.length,we=w.length,Ye=Math.min(Me,we);let qe;for(qe=0;qe<Ye;qe++){const ae=w[qe]=Ie?Yo(w[qe]):ho(w[qe]);G(b[qe],ae,j,null,ee,pe,Te,le,Ie)}Me>we?at(b,ee,pe,!0,!1,Ye):ve(w,j,ce,ee,pe,Te,le,Ie,Ye)},P=(b,w,j,ce,ee,pe,Te,le,Ie)=>{let Me=0;const we=w.length;let Ye=b.length-1,qe=we-1;for(;Me<=Ye&&Me<=qe;){const ae=b[Me],Ge=w[Me]=Ie?Yo(w[Me]):ho(w[Me]);if(gs(ae,Ge))G(ae,Ge,j,null,ee,pe,Te,le,Ie);else break;Me++}for(;Me<=Ye&&Me<=qe;){const ae=b[Ye],Ge=w[qe]=Ie?Yo(w[qe]):ho(w[qe]);if(gs(ae,Ge))G(ae,Ge,j,null,ee,pe,Te,le,Ie);else break;Ye--,qe--}if(Me>Ye){if(Me<=qe){const ae=qe+1,Ge=ae<we?w[ae].el:ce;for(;Me<=qe;)G(null,w[Me]=Ie?Yo(w[Me]):ho(w[Me]),j,Ge,ee,pe,Te,le,Ie),Me++}}else if(Me>qe)for(;Me<=Ye;)Fe(b[Me],ee,pe,!0),Me++;else{const ae=Me,Ge=Me,et=new Map;for(Me=Ge;Me<=qe;Me++){const fn=w[Me]=Ie?Yo(w[Me]):ho(w[Me]);fn.key!=null&&et.set(fn.key,Me)}let Dt,Xt=0;const bn=qe-Ge+1;let Gn=!1,bs=0;const ko=new Array(bn);for(Me=0;Me<bn;Me++)ko[Me]=0;for(Me=ae;Me<=Ye;Me++){const fn=b[Me];if(Xt>=bn){Fe(fn,ee,pe,!0);continue}let Bn;if(fn.key!=null)Bn=et.get(fn.key);else for(Dt=Ge;Dt<=qe;Dt++)if(ko[Dt-Ge]===0&&gs(fn,w[Dt])){Bn=Dt;break}Bn===void 0?Fe(fn,ee,pe,!0):(ko[Bn-Ge]=Me+1,Bn>=bs?bs=Bn:Gn=!0,G(fn,w[Bn],j,null,ee,pe,Te,le,Ie),Xt++)}const yr=Gn?l0(ko):sr;for(Dt=yr.length-1,Me=bn-1;Me>=0;Me--){const fn=Ge+Me,Bn=w[fn],Ir=fn+1<we?w[fn+1].el:ce;ko[Me]===0?G(null,Bn,j,Ir,ee,pe,Te,le,Ie):Gn&&(Dt<0||Me!==yr[Dt]?he(Bn,j,Ir,2):Dt--)}}},he=(b,w,j,ce,ee=null)=>{const{el:pe,type:Te,transition:le,children:Ie,shapeFlag:Me}=b;if(Me&6){he(b.component.subTree,w,j,ce);return}if(Me&128){b.suspense.move(w,j,ce);return}if(Me&64){Te.move(b,w,j,Re);return}if(Te===an){c(pe,w,j);for(let Ye=0;Ye<Ie.length;Ye++)he(Ie[Ye],w,j,ce);c(b.anchor,w,j);return}if(Te===Kl){q(b,w,j);return}if(ce!==2&&Me&1&&le)if(ce===0)le.beforeEnter(pe),c(pe,w,j),Ln(()=>le.enter(pe),ee);else{const{leave:Ye,delayLeave:qe,afterLeave:ae}=le,Ge=()=>c(pe,w,j),et=()=>{Ye(pe,()=>{Ge(),ae&&ae()})};qe?qe(pe,Ge,et):et()}else c(pe,w,j)},Fe=(b,w,j,ce=!1,ee=!1)=>{const{type:pe,props:Te,ref:le,children:Ie,dynamicChildren:Me,shapeFlag:we,patchFlag:Ye,dirs:qe}=b;if(le!=null&&Id(le,null,j,b,!0),we&256){w.ctx.deactivate(b);return}const ae=we&1&&qe,Ge=!Ei(b);let et;if(Ge&&(et=Te&&Te.onVnodeBeforeUnmount)&&po(et,w,b),we&6)ht(b.component,j,ce);else{if(we&128){b.suspense.unmount(j,ce);return}ae&&us(b,null,w,"beforeUnmount"),we&64?b.type.remove(b,w,j,ee,Re,ce):Me&&(pe!==an||Ye>0&&Ye&64)?at(Me,w,j,!1,!0):(pe===an&&Ye&384||!ee&&we&16)&&at(Ie,w,j),ce&&$e(b)}(Ge&&(et=Te&&Te.onVnodeUnmounted)||ae)&&Ln(()=>{et&&po(et,w,b),ae&&us(b,null,w,"unmounted")},j)},$e=b=>{const{type:w,el:j,anchor:ce,transition:ee}=b;if(w===an){Xe(j,ce);return}if(w===Kl){Ne(b);return}const pe=()=>{p(j),ee&&!ee.persisted&&ee.afterLeave&&ee.afterLeave()};if(b.shapeFlag&1&&ee&&!ee.persisted){const{leave:Te,delayLeave:le}=ee,Ie=()=>Te(j,pe);le?le(b.el,pe,Ie):Ie()}else pe()},Xe=(b,w)=>{let j;for(;b!==w;)j=k(b),p(b),b=j;p(w)},ht=(b,w,j)=>{const{bum:ce,scope:ee,update:pe,subTree:Te,um:le}=b;ce&&wa(ce),ee.stop(),pe&&(pe.active=!1,Fe(Te,b,w,j)),le&&Ln(le,w),Ln(()=>{b.isUnmounted=!0},w),w&&w.pendingBranch&&!w.isUnmounted&&b.asyncDep&&!b.asyncResolved&&b.suspenseId===w.pendingId&&(w.deps--,w.deps===0&&w.resolve())},at=(b,w,j,ce=!1,ee=!1,pe=0)=>{for(let Te=pe;Te<b.length;Te++)Fe(b[Te],w,j,ce,ee)},ie=b=>b.shapeFlag&6?ie(b.component.subTree):b.shapeFlag&128?b.suspense.next():k(b.anchor||b.el);let Ce=!1;const De=(b,w,j)=>{b==null?w._vnode&&Fe(w._vnode,null,null,!0):G(w._vnode||null,b,w,null,null,null,j),Ce||(Ce=!0,Eh(),Q_(),Ce=!1),w._vnode=b},Re={p:G,um:Fe,m:he,r:$e,mt:X,mc:ve,pc:re,pbc:$,n:ie,o};return{render:De,hydrate:void 0,createApp:e0(De)}}function Hl({type:o,props:i},u){return u==="svg"&&o==="foreignObject"||u==="mathml"&&o==="annotation-xml"&&i&&i.encoding&&i.encoding.includes("html")?void 0:u}function ls({effect:o,update:i},u){o.allowRecurse=i.allowRecurse=u}function u0(o,i){return(!o||o&&!o.pendingBranch)&&i&&!i.persisted}function up(o,i,u=!1){const c=o.children,p=i.children;if(He(c)&&He(p))for(let f=0;f<c.length;f++){const v=c[f];let y=p[f];y.shapeFlag&1&&!y.dynamicChildren&&((y.patchFlag<=0||y.patchFlag===32)&&(y=p[f]=Yo(p[f]),y.el=v.el),u||up(v,y)),y.type===Xi&&(y.el=v.el)}}function l0(o){const i=o.slice(),u=[0];let c,p,f,v,y;const C=o.length;for(c=0;c<C;c++){const T=o[c];if(T!==0){if(p=u[u.length-1],o[p]<T){i[c]=p,u.push(c);continue}for(f=0,v=u.length-1;f<v;)y=f+v>>1,o[u[y]]<T?f=y+1:v=y;T<o[u[f]]&&(f>0&&(i[c]=u[f-1]),u[f]=c)}}for(f=u.length,v=u[f-1];f-- >0;)u[f]=v,v=i[v];return u}function Cm(o){const i=o.subTree.component;if(i)return i.asyncDep&&!i.asyncResolved?i:Cm(i)}const d0=o=>o.__isTeleport,Si=o=>o&&(o.disabled||o.disabled===""),Uh=o=>typeof SVGElement<"u"&&o instanceof SVGElement,Fh=o=>typeof MathMLElement=="function"&&o instanceof MathMLElement,Md=(o,i)=>{const u=o&&o.to;return Ct(u)?i?i(u):null:u},p0={name:"Teleport",__isTeleport:!0,process(o,i,u,c,p,f,v,y,C,T){const{mc:L,pc:R,pbc:k,o:{insert:x,querySelector:N,createText:G,createComment:V}}=T,z=Si(i.props);let{shapeFlag:te,children:q,dynamicChildren:Ne}=i;if(o==null){const Le=i.el=G(""),Se=i.anchor=G("");x(Le,u,c),x(Se,u,c);const Ue=i.target=Md(i.props,N),ve=i.targetAnchor=G("");Ue&&(x(ve,Ue),v==="svg"||Uh(Ue)?v="svg":(v==="mathml"||Fh(Ue))&&(v="mathml"));const ye=($,I)=>{te&16&&L(q,$,I,p,f,v,y,C)};z?ye(u,Se):Ue&&ye(Ue,ve)}else{i.el=o.el;const Le=i.anchor=o.anchor,Se=i.target=o.target,Ue=i.targetAnchor=o.targetAnchor,ve=Si(o.props),ye=ve?u:Se,$=ve?Le:Ue;if(v==="svg"||Uh(Se)?v="svg":(v==="mathml"||Fh(Se))&&(v="mathml"),Ne?(k(o.dynamicChildren,Ne,ye,p,f,v,y),up(o,i,!0)):C||R(o,i,ye,$,p,f,v,y,!1),z)ve?i.props&&o.props&&i.props.to!==o.props.to&&(i.props.to=o.props.to):Ra(i,u,Le,T,1);else if((i.props&&i.props.to)!==(o.props&&o.props.to)){const I=i.target=Md(i.props,N);I&&Ra(i,I,null,T,0)}else ve&&Ra(i,Se,Ue,T,1)}Tm(i)},remove(o,i,u,c,{um:p,o:{remove:f}},v){const{shapeFlag:y,children:C,anchor:T,targetAnchor:L,target:R,props:k}=o;if(R&&f(L),v&&f(T),y&16){const x=v||!Si(k);for(let N=0;N<C.length;N++){const G=C[N];p(G,i,u,x,!!G.dynamicChildren)}}},move:Ra,hydrate:f0};function Ra(o,i,u,{o:{insert:c},m:p},f=2){f===0&&c(o.targetAnchor,i,u);const{el:v,anchor:y,shapeFlag:C,children:T,props:L}=o,R=f===2;if(R&&c(v,i,u),(!R||Si(L))&&C&16)for(let k=0;k<T.length;k++)p(T[k],i,u,2);R&&c(y,i,u)}function f0(o,i,u,c,p,f,{o:{nextSibling:v,parentNode:y,querySelector:C}},T){const L=i.target=Md(i.props,C);if(L){const R=L._lpa||L.firstChild;if(i.shapeFlag&16)if(Si(i.props))i.anchor=T(v(o),i,y(o),u,c,p,f),i.targetAnchor=R;else{i.anchor=v(o);let k=R;for(;k;)if(k=v(k),k&&k.nodeType===8&&k.data==="teleport anchor"){i.targetAnchor=k,L._lpa=i.targetAnchor&&v(i.targetAnchor);break}T(R,i,L,u,c,p,f)}Tm(i)}return i.anchor&&v(i.anchor)}const yO=p0;function Tm(o){const i=o.ctx;if(i&&i.ut){let u=o.children[0].el;for(;u&&u!==o.targetAnchor;)u.nodeType===1&&u.setAttribute("data-v-owner",i.uid),u=u.nextSibling;i.ut()}}const an=Symbol.for("v-fgt"),Xi=Symbol.for("v-txt"),jn=Symbol.for("v-cmt"),Kl=Symbol.for("v-stc"),Li=[];let eo=null;function be(o=!1){Li.push(eo=o?null:[])}function h0(){Li.pop(),eo=Li[Li.length-1]||null}let qi=1;function xh(o){qi+=o}function Em(o){return o.dynamicChildren=qi>0?eo||sr:null,h0(),qi>0&&eo&&eo.push(o),o}function it(o,i,u,c,p,f){return Em(ze(o,i,u,c,p,f,!0))}function Mt(o,i,u,c,p){return Em(kt(o,i,u,c,p,!0))}function no(o){return o?o.__v_isVNode===!0:!1}function gs(o,i){return o.type===i.type&&o.key===i.key}const Dm=({key:o})=>o??null,Fa=({ref:o,ref_key:i,ref_for:u})=>(typeof o=="number"&&(o=""+o),o!=null?Ct(o)||Wt(o)||Ze(o)?{i:tn,r:o,k:i,f:!!u}:o:null);function ze(o,i=null,u=null,c=0,p=null,f=o===an?0:1,v=!1,y=!1){const C={__v_isVNode:!0,__v_skip:!0,type:o,props:i,key:i&&Dm(i),ref:i&&Fa(i),scopeId:gc,slotScopeIds:null,children:u,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:f,patchFlag:c,dynamicProps:p,dynamicChildren:null,appContext:null,ctx:tn};return y?(lp(C,u),f&128&&o.normalize(C)):u&&(C.shapeFlag|=Ct(u)?8:16),qi>0&&!v&&eo&&(C.patchFlag>0||f&6)&&C.patchFlag!==32&&eo.push(C),C}const kt=g0;function g0(o,i=null,u=null,c=0,p=null,f=!1){if((!o||o===nm)&&(o=jn),no(o)){const y=es(o,i,!0);return u&&lp(y,u),qi>0&&!f&&eo&&(y.shapeFlag&6?eo[eo.indexOf(o)]=y:eo.push(y)),y.patchFlag|=-2,y}if(E0(o)&&(o=o.__vccOpts),i){i=_0(i);let{class:y,style:C}=i;y&&!Ct(y)&&(i.class=nt(y)),Tt(C)&&(H_(C)&&!He(C)&&(C=un({},C)),i.style=So(C))}const v=Ct(o)?1:RC(o)?128:d0(o)?64:Tt(o)?4:Ze(o)?2:0;return ze(o,i,u,c,p,v,f,!0)}function _0(o){return o?H_(o)||_m(o)?un({},o):o:null}function es(o,i,u=!1){const{props:c,ref:p,patchFlag:f,children:v}=o,y=i?cr(c||{},i):c;return{__v_isVNode:!0,__v_skip:!0,type:o.type,props:y,key:y&&Dm(y),ref:i&&i.ref?u&&p?He(p)?p.concat(Fa(i)):[p,Fa(i)]:Fa(i):p,scopeId:o.scopeId,slotScopeIds:o.slotScopeIds,children:v,target:o.target,targetAnchor:o.targetAnchor,staticCount:o.staticCount,shapeFlag:o.shapeFlag,patchFlag:i&&o.type!==an?f===-1?16:f|16:f,dynamicProps:o.dynamicProps,dynamicChildren:o.dynamicChildren,appContext:o.appContext,dirs:o.dirs,transition:o.transition,component:o.component,suspense:o.suspense,ssContent:o.ssContent&&es(o.ssContent),ssFallback:o.ssFallback&&es(o.ssFallback),el:o.el,anchor:o.anchor,ctx:o.ctx,ce:o.ce}}function xa(o=" ",i=0){return kt(Xi,null,o,i)}function Rt(o="",i=!1){return i?(be(),Mt(jn,null,o)):kt(jn,null,o)}function ho(o){return o==null||typeof o=="boolean"?kt(jn):He(o)?kt(an,null,o.slice()):typeof o=="object"?Yo(o):kt(Xi,null,String(o))}function Yo(o){return o.el===null&&o.patchFlag!==-1||o.memo?o:es(o)}function lp(o,i){let u=0;const{shapeFlag:c}=o;if(i==null)i=null;else if(He(i))u=16;else if(typeof i=="object")if(c&65){const p=i.default;p&&(p._c&&(p._d=!1),lp(o,p()),p._c&&(p._d=!0));return}else{u=32;const p=i._;!p&&!_m(i)?i._ctx=tn:p===3&&tn&&(tn.slots._===1?i._=1:(i._=2,o.patchFlag|=1024))}else Ze(i)?(i={default:i,_ctx:tn},u=32):(i=String(i),c&64?(u=16,i=[xa(i)]):u=8);o.children=i,o.shapeFlag|=u}function cr(...o){const i={};for(let u=0;u<o.length;u++){const c=o[u];for(const p in c)if(p==="class")i.class!==c.class&&(i.class=nt([i.class,c.class]));else if(p==="style")i.style=So([i.style,c.style]);else if(cc(p)){const f=i[p],v=c[p];v&&f!==v&&!(He(f)&&f.includes(v))&&(i[p]=f?[].concat(f,v):v)}else p!==""&&(i[p]=c[p])}return i}function po(o,i,u,c=null){Kn(o,i,7,[u,c])}const m0=hm();let v0=0;function y0(o,i,u){const c=o.type,p=(i?i.appContext:o.appContext)||m0,f={uid:v0++,vnode:o,type:c,parent:i,appContext:p,root:null,next:null,subTree:null,effect:null,update:null,scope:new k_(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:i?i.provides:Object.create(p.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:vm(c,p),emitsOptions:tm(c,p),emit:null,emitted:null,propsDefaults:Gt,inheritAttrs:c.inheritAttrs,ctx:Gt,data:Gt,props:Gt,attrs:Gt,slots:Gt,refs:Gt,setupState:Gt,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:u,suspenseId:u?u.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return f.ctx={_:f},f.root=i?i.root:f,f.emit=CC.bind(null,f),o.ce&&o.ce(f),f}let on=null;const Nn=()=>on||tn;let Xa,Cd;{const o=S_(),i=(u,c)=>{let p;return(p=o[u])||(p=o[u]=[]),p.push(c),f=>{p.length>1?p.forEach(v=>v(f)):p[0](f)}};Xa=i("__VUE_INSTANCE_SETTERS__",u=>on=u),Cd=i("__VUE_SSR_SETTERS__",u=>Qi=u)}const Zi=o=>{const i=on;return Xa(o),o.scope.on(),()=>{o.scope.off(),Xa(i)}},qh=()=>{on&&on.scope.off(),Xa(null)};function Sm(o){return o.vnode.shapeFlag&4}let Qi=!1;function I0(o,i=!1){i&&Cd(i);const{props:u,children:c}=o.vnode,p=Sm(o);n0(o,u,p,i),r0(o,c);const f=p?M0(o,i):void 0;return i&&Cd(!1),f}function M0(o,i){const u=o.type;o.accessCache=Object.create(null),o.proxy=new Proxy(o.ctx,WC);const{setup:c}=u;if(c){const p=o.setupContext=c.length>1?Rm(o):null,f=Zi(o);ts();const v=Zo(c,o,0,[o.props,p]);if(ns(),f(),C_(v)){if(v.then(qh,qh),i)return v.then(y=>{Vh(o,y)}).catch(y=>{$i(y,o,0)});o.asyncDep=v}else Vh(o,v)}else Lm(o)}function Vh(o,i,u){Ze(i)?o.type.__ssrInlineRender?o.ssrRender=i:o.render=i:Tt(i)&&(o.setupState=z_(i)),Lm(o)}function Lm(o,i,u){const c=o.type;o.render||(o.render=c.render||cn);{const p=Zi(o);ts();try{zC(o)}finally{ns(),p()}}}const C0={get(o,i){return On(o,"get",""),o[i]}};function Rm(o){const i=u=>{o.exposed=u||{}};return{attrs:new Proxy(o.attrs,C0),slots:o.slots,emit:o.emit,expose:i}}function mc(o){if(o.exposed)return o.exposeProxy||(o.exposeProxy=new Proxy(z_(pc(o.exposed)),{get(i,u){if(u in i)return i[u];if(u in Di)return Di[u](o)},has(i,u){return u in i||u in Di}}))}function T0(o,i=!0){return Ze(o)?o.displayName||o.name:o.name||i&&o.__name}function E0(o){return Ze(o)&&"__vccOpts"in o}const Oe=(o,i)=>j_(o,i,Qi);function vc(o,i,u){const c=arguments.length;return c===2?Tt(i)&&!He(i)?no(i)?kt(o,null,[i]):kt(o,i):kt(o,null,i):(c>3?u=Array.prototype.slice.call(arguments,2):c===3&&no(u)&&(u=[u]),kt(o,i,u))}const D0="3.4.23",S0=cn;/**
* @vue/runtime-dom v3.4.23
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const L0="http://www.w3.org/2000/svg",R0="http://www.w3.org/1998/Math/MathML",zo=typeof document<"u"?document:null,Bh=zo&&zo.createElement("template"),k0={insert:(o,i,u)=>{i.insertBefore(o,u||null)},remove:o=>{const i=o.parentNode;i&&i.removeChild(o)},createElement:(o,i,u,c)=>{const p=i==="svg"?zo.createElementNS(L0,o):i==="mathml"?zo.createElementNS(R0,o):zo.createElement(o,u?{is:u}:void 0);return o==="select"&&c&&c.multiple!=null&&p.setAttribute("multiple",c.multiple),p},createText:o=>zo.createTextNode(o),createComment:o=>zo.createComment(o),setText:(o,i)=>{o.nodeValue=i},setElementText:(o,i)=>{o.textContent=i},parentNode:o=>o.parentNode,nextSibling:o=>o.nextSibling,querySelector:o=>zo.querySelector(o),setScopeId(o,i){o.setAttribute(i,"")},insertStaticContent(o,i,u,c,p,f){const v=u?u.previousSibling:i.lastChild;if(p&&(p===f||p.nextSibling))for(;i.insertBefore(p.cloneNode(!0),u),!(p===f||!(p=p.nextSibling)););else{Bh.innerHTML=c==="svg"?`<svg>${o}</svg>`:c==="mathml"?`<math>${o}</math>`:o;const y=Bh.content;if(c==="svg"||c==="mathml"){const C=y.firstChild;for(;C.firstChild;)y.appendChild(C.firstChild);y.removeChild(C)}i.insertBefore(y,u)}return[v?v.nextSibling:i.firstChild,u?u.previousSibling:i.lastChild]}},Uo="transition",gi="animation",lr=Symbol("_vtc"),yc=(o,{slots:i})=>vc(GC,Am(o),i);yc.displayName="Transition";const km={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},A0=yc.props=un({},rm,km),ds=(o,i=[])=>{He(o)?o.forEach(u=>u(...i)):o&&o(...i)},Hh=o=>o?He(o)?o.some(i=>i.length>1):o.length>1:!1;function Am(o){const i={};for(const W in o)W in km||(i[W]=o[W]);if(o.css===!1)return i;const{name:u="v",type:c,duration:p,enterFromClass:f=`${u}-enter-from`,enterActiveClass:v=`${u}-enter-active`,enterToClass:y=`${u}-enter-to`,appearFromClass:C=f,appearActiveClass:T=v,appearToClass:L=y,leaveFromClass:R=`${u}-leave-from`,leaveActiveClass:k=`${u}-leave-active`,leaveToClass:x=`${u}-leave-to`}=o,N=O0(p),G=N&&N[0],V=N&&N[1],{onBeforeEnter:z,onEnter:te,onEnterCancelled:q,onLeave:Ne,onLeaveCancelled:Le,onBeforeAppear:Se=z,onAppear:Ue=te,onAppearCancelled:ve=q}=i,ye=(W,Z,X)=>{Vo(W,Z?L:y),Vo(W,Z?T:v),X&&X()},$=(W,Z)=>{W._isLeaving=!1,Vo(W,R),Vo(W,x),Vo(W,k),Z&&Z()},I=W=>(Z,X)=>{const Q=W?Ue:te,Y=()=>ye(Z,W,X);ds(Q,[Z,Y]),Kh(()=>{Vo(Z,W?C:f),To(Z,W?L:y),Hh(Q)||jh(Z,c,G,Y)})};return un(i,{onBeforeEnter(W){ds(z,[W]),To(W,f),To(W,v)},onBeforeAppear(W){ds(Se,[W]),To(W,C),To(W,T)},onEnter:I(!1),onAppear:I(!0),onLeave(W,Z){W._isLeaving=!0;const X=()=>$(W,Z);To(W,R),Nm(),To(W,k),Kh(()=>{W._isLeaving&&(Vo(W,R),To(W,x),Hh(Ne)||jh(W,c,V,X))}),ds(Ne,[W,X])},onEnterCancelled(W){ye(W,!1),ds(q,[W])},onAppearCancelled(W){ye(W,!0),ds(ve,[W])},onLeaveCancelled(W){$(W),ds(Le,[W])}})}function O0(o){if(o==null)return null;if(Tt(o))return[jl(o.enter),jl(o.leave)];{const i=jl(o);return[i,i]}}function jl(o){return xM(o)}function To(o,i){i.split(/\s+/).forEach(u=>u&&o.classList.add(u)),(o[lr]||(o[lr]=new Set)).add(i)}function Vo(o,i){i.split(/\s+/).forEach(c=>c&&o.classList.remove(c));const u=o[lr];u&&(u.delete(i),u.size||(o[lr]=void 0))}function Kh(o){requestAnimationFrame(()=>{requestAnimationFrame(o)})}let N0=0;function jh(o,i,u,c){const p=o._endId=++N0,f=()=>{p===o._endId&&c()};if(u)return setTimeout(f,u);const{type:v,timeout:y,propCount:C}=Om(o,i);if(!v)return c();const T=v+"end";let L=0;const R=()=>{o.removeEventListener(T,k),f()},k=x=>{x.target===o&&++L>=C&&R()};setTimeout(()=>{L<C&&R()},y+1),o.addEventListener(T,k)}function Om(o,i){const u=window.getComputedStyle(o),c=N=>(u[N]||"").split(", "),p=c(`${Uo}Delay`),f=c(`${Uo}Duration`),v=Wh(p,f),y=c(`${gi}Delay`),C=c(`${gi}Duration`),T=Wh(y,C);let L=null,R=0,k=0;i===Uo?v>0&&(L=Uo,R=v,k=f.length):i===gi?T>0&&(L=gi,R=T,k=C.length):(R=Math.max(v,T),L=R>0?v>T?Uo:gi:null,k=L?L===Uo?f.length:C.length:0);const x=L===Uo&&/\b(transform|all)(,|$)/.test(c(`${Uo}Property`).toString());return{type:L,timeout:R,propCount:k,hasTransform:x}}function Wh(o,i){for(;o.length<i.length;)o=o.concat(o);return Math.max(...i.map((u,c)=>Yh(u)+Yh(o[c])))}function Yh(o){return o==="auto"?0:Number(o.slice(0,-1).replace(",","."))*1e3}function Nm(){return document.body.offsetHeight}function P0(o,i,u){const c=o[lr];c&&(i=(i?[i,...c]:[...c]).join(" ")),i==null?o.removeAttribute("class"):u?o.setAttribute("class",i):o.className=i}const Za=Symbol("_vod"),Pm=Symbol("_vsh"),Ri={beforeMount(o,{value:i},{transition:u}){o[Za]=o.style.display==="none"?"":o.style.display,u&&i?u.beforeEnter(o):_i(o,i)},mounted(o,{value:i},{transition:u}){u&&i&&u.enter(o)},updated(o,{value:i,oldValue:u},{transition:c}){!i!=!u&&(c?i?(c.beforeEnter(o),_i(o,!0),c.enter(o)):c.leave(o,()=>{_i(o,!1)}):_i(o,i))},beforeUnmount(o,{value:i}){_i(o,i)}};function _i(o,i){o.style.display=i?o[Za]:"none",o[Pm]=!i}const b0=Symbol(""),G0=/(^|;)\s*display\s*:/;function w0(o,i,u){const c=o.style,p=Ct(u);let f=!1;if(u&&!p){if(i)if(Ct(i))for(const v of i.split(";")){const y=v.slice(0,v.indexOf(":")).trim();u[y]==null&&qa(c,y,"")}else for(const v in i)u[v]==null&&qa(c,v,"");for(const v in u)v==="display"&&(f=!0),qa(c,v,u[v])}else if(p){if(i!==u){const v=c[b0];v&&(u+=";"+v),c.cssText=u,f=G0.test(u)}}else i&&o.removeAttribute("style");Za in o&&(o[Za]=f?c.display:"",o[Pm]&&(c.display="none"))}const zh=/\s*!important$/;function qa(o,i,u){if(He(u))u.forEach(c=>qa(o,i,c));else if(u==null&&(u=""),i.startsWith("--"))o.setProperty(i,u);else{const c=U0(o,i);zh.test(u)?o.setProperty(Rs(c),u.replace(zh,""),"important"):o[c]=u}}const $h=["Webkit","Moz","ms"],Wl={};function U0(o,i){const u=Wl[i];if(u)return u;let c=to(i);if(c!=="filter"&&c in o)return Wl[i]=c;c=lc(c);for(let p=0;p<$h.length;p++){const f=$h[p]+c;if(f in o)return Wl[i]=f}return i}const Jh="http://www.w3.org/1999/xlink";function F0(o,i,u,c,p){if(c&&i.startsWith("xlink:"))u==null?o.removeAttributeNS(Jh,i.slice(6,i.length)):o.setAttributeNS(Jh,i,u);else{const f=jM(i);u==null||f&&!L_(u)?o.removeAttribute(i):o.setAttribute(i,f?"":u)}}function x0(o,i,u,c,p,f,v){if(i==="innerHTML"||i==="textContent"){c&&v(c,p,f),o[i]=u??"";return}const y=o.tagName;if(i==="value"&&y!=="PROGRESS"&&!y.includes("-")){const T=y==="OPTION"?o.getAttribute("value")||"":o.value,L=u??"";(T!==L||!("_value"in o))&&(o.value=L),u==null&&o.removeAttribute(i),o._value=u;return}let C=!1;if(u===""||u==null){const T=typeof o[i];T==="boolean"?u=L_(u):u==null&&T==="string"?(u="",C=!0):T==="number"&&(u=0,C=!0)}try{o[i]=u}catch{}C&&o.removeAttribute(i)}function er(o,i,u,c){o.addEventListener(i,u,c)}function q0(o,i,u,c){o.removeEventListener(i,u,c)}const Xh=Symbol("_vei");function V0(o,i,u,c,p=null){const f=o[Xh]||(o[Xh]={}),v=f[i];if(c&&v)v.value=c;else{const[y,C]=B0(i);if(c){const T=f[i]=j0(c,p);er(o,y,T,C)}else v&&(q0(o,y,v,C),f[i]=void 0)}}const Zh=/(?:Once|Passive|Capture)$/;function B0(o){let i;if(Zh.test(o)){i={};let c;for(;c=o.match(Zh);)o=o.slice(0,o.length-c[0].length),i[c[0].toLowerCase()]=!0}return[o[2]===":"?o.slice(3):Rs(o.slice(2)),i]}let Yl=0;const H0=Promise.resolve(),K0=()=>Yl||(H0.then(()=>Yl=0),Yl=Date.now());function j0(o,i){const u=c=>{if(!c._vts)c._vts=Date.now();else if(c._vts<=u.attached)return;Kn(W0(c,u.value),i,5,[c])};return u.value=o,u.attached=K0(),u}function W0(o,i){if(He(i)){const u=o.stopImmediatePropagation;return o.stopImmediatePropagation=()=>{u.call(o),o._stopped=!0},i.map(c=>p=>!p._stopped&&c&&c(p))}else return i}const Qh=o=>o.charCodeAt(0)===111&&o.charCodeAt(1)===110&&o.charCodeAt(2)>96&&o.charCodeAt(2)<123,Y0=(o,i,u,c,p,f,v,y,C)=>{const T=p==="svg";i==="class"?P0(o,c,T):i==="style"?w0(o,u,c):cc(i)?Bd(i)||V0(o,i,u,c,v):(i[0]==="."?(i=i.slice(1),!0):i[0]==="^"?(i=i.slice(1),!1):z0(o,i,c,T))?x0(o,i,c,f,v,y,C):(i==="true-value"?o._trueValue=c:i==="false-value"&&(o._falseValue=c),F0(o,i,c,T))};function z0(o,i,u,c){if(c)return!!(i==="innerHTML"||i==="textContent"||i in o&&Qh(i)&&Ze(u));if(i==="spellcheck"||i==="draggable"||i==="translate"||i==="form"||i==="list"&&o.tagName==="INPUT"||i==="type"&&o.tagName==="TEXTAREA")return!1;if(i==="width"||i==="height"){const p=o.tagName;if(p==="IMG"||p==="VIDEO"||p==="CANVAS"||p==="SOURCE")return!1}return Qh(i)&&Ct(u)?!1:i in o}const bm=new WeakMap,Gm=new WeakMap,Qa=Symbol("_moveCb"),eg=Symbol("_enterCb"),wm={name:"TransitionGroup",props:un({},A0,{tag:String,moveClass:String}),setup(o,{slots:i}){const u=Nn(),c=sm();let p,f;return cm(()=>{if(!p.length)return;const v=o.moveClass||`${o.name||"v"}-move`;if(!Q0(p[0].el,u.vnode.el,v))return;p.forEach(J0),p.forEach(X0);const y=p.filter(Z0);Nm(),y.forEach(C=>{const T=C.el,L=T.style;To(T,v),L.transform=L.webkitTransform=L.transitionDuration="";const R=T[Qa]=k=>{k&&k.target!==T||(!k||/transform$/.test(k.propertyName))&&(T.removeEventListener("transitionend",R),T[Qa]=null,Vo(T,v))};T.addEventListener("transitionend",R)})}),()=>{const v=_t(o),y=Am(v);let C=v.tag||an;if(p=[],f)for(let T=0;T<f.length;T++){const L=f[T];L.el&&L.el instanceof Element&&(p.push(L),xi(L,Fi(L,y,c,u)),bm.set(L,L.el.getBoundingClientRect()))}f=i.default?ip(i.default()):[];for(let T=0;T<f.length;T++){const L=f[T];L.key!=null&&xi(L,Fi(L,y,c,u))}return kt(C,null,f)}}},$0=o=>delete o.mode;wm.props;const IO=wm;function J0(o){const i=o.el;i[Qa]&&i[Qa](),i[eg]&&i[eg]()}function X0(o){Gm.set(o,o.el.getBoundingClientRect())}function Z0(o){const i=bm.get(o),u=Gm.get(o),c=i.left-u.left,p=i.top-u.top;if(c||p){const f=o.el.style;return f.transform=f.webkitTransform=`translate(${c}px,${p}px)`,f.transitionDuration="0s",o}}function Q0(o,i,u){const c=o.cloneNode(),p=o[lr];p&&p.forEach(y=>{y.split(/\s+/).forEach(C=>C&&c.classList.remove(C))}),u.split(/\s+/).forEach(y=>y&&c.classList.add(y)),c.style.display="none";const f=i.nodeType===1?i:i.parentNode;f.appendChild(c);const{hasTransform:v}=Om(c);return f.removeChild(c),v}const tg=o=>{const i=o.props["onUpdate:modelValue"]||!1;return He(i)?u=>wa(i,u):i};function eT(o){o.target.composing=!0}function ng(o){const i=o.target;i.composing&&(i.composing=!1,i.dispatchEvent(new Event("input")))}const zl=Symbol("_assign"),MO={created(o,{modifiers:{lazy:i,trim:u,number:c}},p){o[zl]=tg(p);const f=c||p.props&&p.props.type==="number";er(o,i?"change":"input",v=>{if(v.target.composing)return;let y=o.value;u&&(y=y.trim()),f&&(y=ld(y)),o[zl](y)}),u&&er(o,"change",()=>{o.value=o.value.trim()}),i||(er(o,"compositionstart",eT),er(o,"compositionend",ng),er(o,"change",ng))},mounted(o,{value:i}){o.value=i??""},beforeUpdate(o,{value:i,modifiers:{lazy:u,trim:c,number:p}},f){if(o[zl]=tg(f),o.composing)return;const v=(p||o.type==="number")&&!/^0\d/.test(o.value)?ld(o.value):o.value,y=i??"";v!==y&&(document.activeElement===o&&o.type!=="range"&&(u||c&&o.value.trim()===y)||(o.value=y))}},tT=["ctrl","shift","alt","meta"],nT={stop:o=>o.stopPropagation(),prevent:o=>o.preventDefault(),self:o=>o.target!==o.currentTarget,ctrl:o=>!o.ctrlKey,shift:o=>!o.shiftKey,alt:o=>!o.altKey,meta:o=>!o.metaKey,left:o=>"button"in o&&o.button!==0,middle:o=>"button"in o&&o.button!==1,right:o=>"button"in o&&o.button!==2,exact:(o,i)=>tT.some(u=>o[`${u}Key`]&&!i.includes(u))},or=(o,i)=>{const u=o._withMods||(o._withMods={}),c=i.join(".");return u[c]||(u[c]=(p,...f)=>{for(let v=0;v<i.length;v++){const y=nT[i[v]];if(y&&y(p,i))return}return o(p,...f)})},oT={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},ka=(o,i)=>{const u=o._withKeys||(o._withKeys={}),c=i.join(".");return u[c]||(u[c]=p=>{if(!("key"in p))return;const f=Rs(p.key);if(i.some(v=>v===f||oT[v]===f))return o(p)})},sT=un({patchProp:Y0},k0);let og;function Um(){return og||(og=a0(sT))}const ec=(...o)=>{Um().render(...o)},rT=(...o)=>{const i=Um().createApp(...o),{mount:u}=i;return i.mount=c=>{const p=aT(c);if(!p)return;const f=i._component;!Ze(f)&&!f.render&&!f.template&&(f.template=p.innerHTML),p.innerHTML="";const v=u(p,!1,iT(p));return p instanceof Element&&(p.removeAttribute("v-cloak"),p.setAttribute("data-v-app","")),v},i};function iT(o){if(o instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&o instanceof MathMLElement)return"mathml"}function aT(o){return Ct(o)?document.querySelector(o):o}const cT="modulepreload",uT=function(o){return"/"+o},sg={},Cn=function(i,u,c){let p=Promise.resolve();if(u&&u.length>0){document.getElementsByTagName("link");const v=document.querySelector("meta[property=csp-nonce]"),y=(v==null?void 0:v.nonce)||(v==null?void 0:v.getAttribute("nonce"));p=Promise.allSettled(u.map(C=>{if(C=uT(C),C in sg)return;sg[C]=!0;const T=C.endsWith(".css"),L=T?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${C}"]${L}`))return;const R=document.createElement("link");if(R.rel=T?"stylesheet":cT,T||(R.as="script"),R.crossOrigin="",R.href=C,y&&R.setAttribute("nonce",y),document.head.appendChild(R),T)return new Promise((k,x)=>{R.addEventListener("load",k),R.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${C}`)))})}))}function f(v){const y=new Event("vite:preloadError",{cancelable:!0});if(y.payload=v,window.dispatchEvent(y),!y.defaultPrevented)throw v}return p.then(v=>{for(const y of v||[])y.status==="rejected"&&f(y.reason);return i().catch(f)})},lT='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',dT=o=>getComputedStyle(o).position==="fixed"?!1:o.offsetParent!==null,rg=o=>Array.from(o.querySelectorAll(lT)).filter(i=>pT(i)&&dT(i)),pT=o=>{if(o.tabIndex>0||o.tabIndex===0&&o.getAttribute("tabIndex")!==null)return!0;if(o.disabled)return!1;switch(o.nodeName){case"A":return!!o.href&&o.rel!=="ignore";case"INPUT":return!(o.type==="hidden"||o.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}};var ig;const Pn=typeof window<"u",fT=o=>typeof o<"u",hT=o=>typeof o=="function",gT=o=>typeof o=="string",Fm=()=>{},_T=Pn&&((ig=window==null?void 0:window.navigator)==null?void 0:ig.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function dp(o){return typeof o=="function"?o():ge(o)}function mT(o){return o}function Ic(o){return Wd()?(Yd(o),!0):!1}function vT(o,i=!0){Nn()?so(o):i?o():dn(o)}function yT(o,i,u={}){const{immediate:c=!0}=u,p=pt(!1);let f=null;function v(){f&&(clearTimeout(f),f=null)}function y(){p.value=!1,v()}function C(...T){v(),p.value=!0,f=setTimeout(()=>{p.value=!1,f=null,o(...T)},dp(i))}return c&&(p.value=!0,Pn&&C()),Ic(y),{isPending:Qd(p),start:C,stop:y}}function ms(o){var i;const u=dp(o);return(i=u==null?void 0:u.$el)!=null?i:u}const Mc=Pn?window:void 0;function ki(...o){let i,u,c,p;if(gT(o[0])||Array.isArray(o[0])?([u,c,p]=o,i=Mc):[i,u,c,p]=o,!i)return Fm;Array.isArray(u)||(u=[u]),Array.isArray(c)||(c=[c]);const f=[],v=()=>{f.forEach(L=>L()),f.length=0},y=(L,R,k,x)=>(L.addEventListener(R,k,x),()=>L.removeEventListener(R,k,x)),C=Ht(()=>[ms(i),dp(p)],([L,R])=>{v(),L&&f.push(...u.flatMap(k=>c.map(x=>y(L,k,x,R))))},{immediate:!0,flush:"post"}),T=()=>{C(),v()};return Ic(T),T}let ag=!1;function CO(o,i,u={}){const{window:c=Mc,ignore:p=[],capture:f=!0,detectIframe:v=!1}=u;if(!c)return;_T&&!ag&&(ag=!0,Array.from(c.document.body.children).forEach(k=>k.addEventListener("click",Fm)));let y=!0;const C=k=>p.some(x=>{if(typeof x=="string")return Array.from(c.document.querySelectorAll(x)).some(N=>N===k.target||k.composedPath().includes(N));{const N=ms(x);return N&&(k.target===N||k.composedPath().includes(N))}}),L=[ki(c,"click",k=>{const x=ms(o);if(!(!x||x===k.target||k.composedPath().includes(x))){if(k.detail===0&&(y=!C(k)),!y){y=!0;return}i(k)}},{passive:!0,capture:f}),ki(c,"pointerdown",k=>{const x=ms(o);x&&(y=!k.composedPath().includes(x)&&!C(k))},{passive:!0}),v&&ki(c,"blur",k=>{var x;const N=ms(o);((x=c.document.activeElement)==null?void 0:x.tagName)==="IFRAME"&&!(N!=null&&N.contains(c.document.activeElement))&&i(k)})].filter(Boolean);return()=>L.forEach(k=>k())}function xm(o,i=!1){const u=pt(),c=()=>u.value=!!o();return c(),vT(c,i),u}function IT(o){return JSON.parse(JSON.stringify(o))}const cg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ug="__vueuse_ssr_handlers__";cg[ug]=cg[ug]||{};var lg=Object.getOwnPropertySymbols,MT=Object.prototype.hasOwnProperty,CT=Object.prototype.propertyIsEnumerable,TT=(o,i)=>{var u={};for(var c in o)MT.call(o,c)&&i.indexOf(c)<0&&(u[c]=o[c]);if(o!=null&&lg)for(var c of lg(o))i.indexOf(c)<0&&CT.call(o,c)&&(u[c]=o[c]);return u};function ET(o,i,u={}){const c=u,{window:p=Mc}=c,f=TT(c,["window"]);let v;const y=xm(()=>p&&"ResizeObserver"in p),C=()=>{v&&(v.disconnect(),v=void 0)},T=Ht(()=>ms(o),R=>{C(),y.value&&p&&R&&(v=new ResizeObserver(i),v.observe(R,f))},{immediate:!0,flush:"post"}),L=()=>{C(),T()};return Ic(L),{isSupported:y,stop:L}}var dg=Object.getOwnPropertySymbols,DT=Object.prototype.hasOwnProperty,ST=Object.prototype.propertyIsEnumerable,LT=(o,i)=>{var u={};for(var c in o)DT.call(o,c)&&i.indexOf(c)<0&&(u[c]=o[c]);if(o!=null&&dg)for(var c of dg(o))i.indexOf(c)<0&&ST.call(o,c)&&(u[c]=o[c]);return u};function TO(o,i,u={}){const c=u,{window:p=Mc}=c,f=LT(c,["window"]);let v;const y=xm(()=>p&&"MutationObserver"in p),C=()=>{v&&(v.disconnect(),v=void 0)},T=Ht(()=>ms(o),R=>{C(),y.value&&p&&R&&(v=new MutationObserver(i),v.observe(R,f))},{immediate:!0}),L=()=>{C(),T()};return Ic(L),{isSupported:y,stop:L}}var pg;(function(o){o.UP="UP",o.RIGHT="RIGHT",o.DOWN="DOWN",o.LEFT="LEFT",o.NONE="NONE"})(pg||(pg={}));var RT=Object.defineProperty,fg=Object.getOwnPropertySymbols,kT=Object.prototype.hasOwnProperty,AT=Object.prototype.propertyIsEnumerable,hg=(o,i,u)=>i in o?RT(o,i,{enumerable:!0,configurable:!0,writable:!0,value:u}):o[i]=u,OT=(o,i)=>{for(var u in i||(i={}))kT.call(i,u)&&hg(o,u,i[u]);if(fg)for(var u of fg(i))AT.call(i,u)&&hg(o,u,i[u]);return o};const NT={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};OT({linear:mT},NT);function EO(o,i,u,c={}){var p,f,v;const{clone:y=!1,passive:C=!1,eventName:T,deep:L=!1,defaultValue:R}=c,k=Nn(),x=(k==null?void 0:k.emit)||((p=k==null?void 0:k.$emit)==null?void 0:p.bind(k))||((v=(f=k==null?void 0:k.proxy)==null?void 0:f.$emit)==null?void 0:v.bind(k==null?void 0:k.proxy));let N=T;N=T||N||`update:${i.toString()}`;const G=z=>y?hT(y)?y(z):IT(z):z,V=()=>fT(o[i])?G(o[i]):R;if(C){const z=V(),te=pt(z);return Ht(()=>o[i],q=>te.value=G(q)),Ht(te,q=>{(q!==o[i]||L)&&x(N,q)},{deep:L}),te}else return Oe({get(){return V()},set(z){x(N,z)}})}const PT=()=>Pn&&/firefox/i.test(window.navigator.userAgent);var bT=typeof global=="object"&&global&&global.Object===Object&&global,GT=typeof self=="object"&&self&&self.Object===Object&&self,pp=bT||GT||Function("return this")(),dr=pp.Symbol,qm=Object.prototype,wT=qm.hasOwnProperty,UT=qm.toString,mi=dr?dr.toStringTag:void 0;function FT(o){var i=wT.call(o,mi),u=o[mi];try{o[mi]=void 0;var c=!0}catch{}var p=UT.call(o);return c&&(i?o[mi]=u:delete o[mi]),p}var xT=Object.prototype,qT=xT.toString;function VT(o){return qT.call(o)}var BT="[object Null]",HT="[object Undefined]",gg=dr?dr.toStringTag:void 0;function Vm(o){return o==null?o===void 0?HT:BT:gg&&gg in Object(o)?FT(o):VT(o)}function KT(o){return o!=null&&typeof o=="object"}var jT="[object Symbol]";function fp(o){return typeof o=="symbol"||KT(o)&&Vm(o)==jT}function WT(o,i){for(var u=-1,c=o==null?0:o.length,p=Array(c);++u<c;)p[u]=i(o[u],u,o);return p}var hp=Array.isArray,_g=dr?dr.prototype:void 0,mg=_g?_g.toString:void 0;function Bm(o){if(typeof o=="string")return o;if(hp(o))return WT(o,Bm)+"";if(fp(o))return mg?mg.call(o):"";var i=o+"";return i=="0"&&1/o==-1/0?"-0":i}function Hm(o){var i=typeof o;return o!=null&&(i=="object"||i=="function")}var YT="[object AsyncFunction]",zT="[object Function]",$T="[object GeneratorFunction]",JT="[object Proxy]";function XT(o){if(!Hm(o))return!1;var i=Vm(o);return i==zT||i==$T||i==YT||i==JT}var $l=pp["__core-js_shared__"],vg=function(){var o=/[^.]+$/.exec($l&&$l.keys&&$l.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}();function ZT(o){return!!vg&&vg in o}var QT=Function.prototype,eE=QT.toString;function tE(o){if(o!=null){try{return eE.call(o)}catch{}try{return o+""}catch{}}return""}var nE=/[\\^$.*+?()[\]{}|]/g,oE=/^\[object .+?Constructor\]$/,sE=Function.prototype,rE=Object.prototype,iE=sE.toString,aE=rE.hasOwnProperty,cE=RegExp("^"+iE.call(aE).replace(nE,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function uE(o){if(!Hm(o)||ZT(o))return!1;var i=XT(o)?cE:oE;return i.test(tE(o))}function lE(o,i){return o==null?void 0:o[i]}function Km(o,i){var u=lE(o,i);return uE(u)?u:void 0}function dE(o,i){return o===i||o!==o&&i!==i}var pE=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,fE=/^\w*$/;function hE(o,i){if(hp(o))return!1;var u=typeof o;return u=="number"||u=="symbol"||u=="boolean"||o==null||fp(o)?!0:fE.test(o)||!pE.test(o)||i!=null&&o in Object(i)}var Vi=Km(Object,"create");function gE(){this.__data__=Vi?Vi(null):{},this.size=0}function _E(o){var i=this.has(o)&&delete this.__data__[o];return this.size-=i?1:0,i}var mE="__lodash_hash_undefined__",vE=Object.prototype,yE=vE.hasOwnProperty;function IE(o){var i=this.__data__;if(Vi){var u=i[o];return u===mE?void 0:u}return yE.call(i,o)?i[o]:void 0}var ME=Object.prototype,CE=ME.hasOwnProperty;function TE(o){var i=this.__data__;return Vi?i[o]!==void 0:CE.call(i,o)}var EE="__lodash_hash_undefined__";function DE(o,i){var u=this.__data__;return this.size+=this.has(o)?0:1,u[o]=Vi&&i===void 0?EE:i,this}function Ds(o){var i=-1,u=o==null?0:o.length;for(this.clear();++i<u;){var c=o[i];this.set(c[0],c[1])}}Ds.prototype.clear=gE;Ds.prototype.delete=_E;Ds.prototype.get=IE;Ds.prototype.has=TE;Ds.prototype.set=DE;function SE(){this.__data__=[],this.size=0}function Cc(o,i){for(var u=o.length;u--;)if(dE(o[u][0],i))return u;return-1}var LE=Array.prototype,RE=LE.splice;function kE(o){var i=this.__data__,u=Cc(i,o);if(u<0)return!1;var c=i.length-1;return u==c?i.pop():RE.call(i,u,1),--this.size,!0}function AE(o){var i=this.__data__,u=Cc(i,o);return u<0?void 0:i[u][1]}function OE(o){return Cc(this.__data__,o)>-1}function NE(o,i){var u=this.__data__,c=Cc(u,o);return c<0?(++this.size,u.push([o,i])):u[c][1]=i,this}function gr(o){var i=-1,u=o==null?0:o.length;for(this.clear();++i<u;){var c=o[i];this.set(c[0],c[1])}}gr.prototype.clear=SE;gr.prototype.delete=kE;gr.prototype.get=AE;gr.prototype.has=OE;gr.prototype.set=NE;var PE=Km(pp,"Map");function bE(){this.size=0,this.__data__={hash:new Ds,map:new(PE||gr),string:new Ds}}function GE(o){var i=typeof o;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?o!=="__proto__":o===null}function Tc(o,i){var u=o.__data__;return GE(i)?u[typeof i=="string"?"string":"hash"]:u.map}function wE(o){var i=Tc(this,o).delete(o);return this.size-=i?1:0,i}function UE(o){return Tc(this,o).get(o)}function FE(o){return Tc(this,o).has(o)}function xE(o,i){var u=Tc(this,o),c=u.size;return u.set(o,i),this.size+=u.size==c?0:1,this}function Os(o){var i=-1,u=o==null?0:o.length;for(this.clear();++i<u;){var c=o[i];this.set(c[0],c[1])}}Os.prototype.clear=bE;Os.prototype.delete=wE;Os.prototype.get=UE;Os.prototype.has=FE;Os.prototype.set=xE;var qE="Expected a function";function gp(o,i){if(typeof o!="function"||i!=null&&typeof i!="function")throw new TypeError(qE);var u=function(){var c=arguments,p=i?i.apply(this,c):c[0],f=u.cache;if(f.has(p))return f.get(p);var v=o.apply(this,c);return u.cache=f.set(p,v)||f,v};return u.cache=new(gp.Cache||Os),u}gp.Cache=Os;var VE=500;function BE(o){var i=gp(o,function(c){return u.size===VE&&u.clear(),c}),u=i.cache;return i}var HE=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,KE=/\\(\\)?/g,jE=BE(function(o){var i=[];return o.charCodeAt(0)===46&&i.push(""),o.replace(HE,function(u,c,p,f){i.push(p?f.replace(KE,"$1"):c||u)}),i});function WE(o){return o==null?"":Bm(o)}function YE(o,i){return hp(o)?o:hE(o,i)?[o]:jE(WE(o))}function zE(o){if(typeof o=="string"||fp(o))return o;var i=o+"";return i=="0"&&1/o==-1/0?"-0":i}function $E(o,i){i=YE(i,o);for(var u=0,c=i.length;o!=null&&u<c;)o=o[zE(i[u++])];return u&&u==c?o:void 0}function JE(o,i,u){var c=o==null?void 0:$E(o,i);return c===void 0?u:c}function jm(o){for(var i=-1,u=o==null?0:o.length,c={};++i<u;){var p=o[i];c[p[0]]=p[1]}return c}function Wm(o){return o==null}const Ym=o=>o===void 0,DO=o=>typeof o=="boolean",tc=o=>typeof o=="number",SO=o=>!o&&o!==0||He(o)&&o.length===0||Tt(o)&&!Object.keys(o).length,nc=o=>typeof Element>"u"?!1:o instanceof Element,XE=o=>Ct(o)?!Number.isNaN(Number(o)):!1,yg=o=>Object.keys(o),LO=o=>Object.entries(o);class ZE extends Error{constructor(i){super(i),this.name="ElementPlusError"}}function QE(o,i){throw new ZE(`[${o}] ${i}`)}function RO(o,i){}const zm=(o="")=>o.split(" ").filter(i=>!!i.trim()),Ig=(o,i)=>{if(!o||!i)return!1;if(i.includes(" "))throw new Error("className should not contain space.");return o.classList.contains(i)},eD=(o,i)=>{!o||!i.trim()||o.classList.add(...zm(i))},tD=(o,i)=>{!o||!i.trim()||o.classList.remove(...zm(i))},nD=(o,i)=>{var u;if(!Pn||!o||!i)return"";let c=to(i);c==="float"&&(c="cssFloat");try{const p=o.style[c];if(p)return p;const f=(u=document.defaultView)==null?void 0:u.getComputedStyle(o,"");return f?f[c]:""}catch{return o.style[c]}};function Td(o,i="px"){if(!o)return"";if(tc(o)||XE(o))return`${o}${i}`;if(Ct(o))return o}let Aa;const oD=o=>{var i;if(!Pn)return 0;if(Aa!==void 0)return Aa;const u=document.createElement("div");u.className=`${o}-scrollbar__wrap`,u.style.visibility="hidden",u.style.width="100px",u.style.position="absolute",u.style.top="-9999px",document.body.appendChild(u);const c=u.offsetWidth;u.style.overflow="scroll";const p=document.createElement("div");p.style.width="100%",u.appendChild(p);const f=p.offsetWidth;return(i=u.parentNode)==null||i.removeChild(u),Aa=c-f,Aa};function kO(o,i){if(!Pn)return;if(!i){o.scrollTop=0;return}const u=[];let c=i.offsetParent;for(;c!==null&&o!==c&&o.contains(c);)u.push(c),c=c.offsetParent;const p=i.offsetTop+u.reduce((C,T)=>C+T.offsetTop,0),f=p+i.offsetHeight,v=o.scrollTop,y=v+o.clientHeight;p<v?o.scrollTop=p:f>y&&(o.scrollTop=f-o.clientHeight)}/*! Element Plus Icons Vue v2.3.1 */var sD=ut({name:"ArrowDown",__name:"arrow-down",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"})]))}}),AO=sD,rD=ut({name:"ArrowLeft",__name:"arrow-left",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"})]))}}),OO=rD,iD=ut({name:"ArrowRight",__name:"arrow-right",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"})]))}}),NO=iD,aD=ut({name:"ArrowUp",__name:"arrow-up",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0"})]))}}),PO=aD,cD=ut({name:"Calendar",__name:"calendar",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M128 384v512h768V192H768v32a32 32 0 1 1-64 0v-32H320v32a32 32 0 0 1-64 0v-32H128v128h768v64zm192-256h384V96a32 32 0 1 1 64 0v32h160a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h160V96a32 32 0 0 1 64 0zm-32 384h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64"})]))}}),bO=cD,uD=ut({name:"Check",__name:"check",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"})]))}}),GO=uD,lD=ut({name:"CircleCheckFilled",__name:"circle-check-filled",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),wO=lD,dD=ut({name:"CircleCheck",__name:"circle-check",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),ze("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"})]))}}),pD=dD,fD=ut({name:"CircleCloseFilled",__name:"circle-close-filled",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336z"})]))}}),$m=fD,hD=ut({name:"CircleClose",__name:"circle-close",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248z"}),ze("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"})]))}}),Jm=hD,gD=ut({name:"Clock",__name:"clock",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),ze("path",{fill:"currentColor",d:"M480 256a32 32 0 0 1 32 32v256a32 32 0 0 1-64 0V288a32 32 0 0 1 32-32"}),ze("path",{fill:"currentColor",d:"M480 512h256q32 0 32 32t-32 32H480q-32 0-32-32t32-32"})]))}}),UO=gD,_D=ut({name:"Close",__name:"close",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})]))}}),Xm=_D,mD=ut({name:"DArrowLeft",__name:"d-arrow-left",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"})]))}}),FO=mD,vD=ut({name:"DArrowRight",__name:"d-arrow-right",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L764.736 512 452.864 192a30.592 30.592 0 0 1 0-42.688m-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L508.736 512 196.864 192a30.592 30.592 0 0 1 0-42.688z"})]))}}),xO=vD,yD=ut({name:"Delete",__name:"delete",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"})]))}}),qO=yD,ID=ut({name:"Document",__name:"document",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640zm-26.496-64L640 154.496V320zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32m160 448h384v64H320zm0-192h160v64H320zm0 384h384v64H320z"})]))}}),VO=ID,MD=ut({name:"Hide",__name:"hide",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2zM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"}),ze("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"})]))}}),CD=MD,TD=ut({name:"InfoFilled",__name:"info-filled",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64m67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344M590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"})]))}}),Zm=TD,ED=ut({name:"Loading",__name:"loading",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})]))}}),Qm=ED,DD=ut({name:"MoreFilled",__name:"more-filled",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224"})]))}}),BO=DD,SD=ut({name:"Search",__name:"search",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704"})]))}}),HO=SD,LD=ut({name:"SuccessFilled",__name:"success-filled",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),ev=LD,RD=ut({name:"View",__name:"view",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352m0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448m0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160"})]))}}),kD=RD,AD=ut({name:"WarningFilled",__name:"warning-filled",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256m0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4"})]))}}),tv=AD,OD=ut({name:"ZoomIn",__name:"zoom-in",setup(o){return(i,u)=>(be(),it("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ze("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704m-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64z"})]))}}),KO=OD;const nv="__epPropKey",En=o=>o,ND=o=>Tt(o)&&!!o[nv],ov=(o,i)=>{if(!Tt(o)||ND(o))return o;const{values:u,required:c,default:p,type:f,validator:v}=o,C={type:f,required:!!c,validator:u||v?T=>{let L=!1,R=[];if(u&&(R=Array.from(u),ft(o,"default")&&R.push(p),L||(L=R.includes(T))),v&&(L||(L=v(T))),!L&&R.length>0){const k=[...new Set(R)].map(x=>JSON.stringify(x)).join(", ");S0(`Invalid prop: validation failed${i?` for prop "${i}"`:""}. Expected one of [${k}], got value ${JSON.stringify(T)}.`)}return L}:void 0,[nv]:!0};return ft(o,"default")&&(C.default=p),C},Ns=o=>jm(Object.entries(o).map(([i,u])=>[i,ov(u,i)])),Bi=En([String,Object,Function]),PD={Close:Xm},bD={Close:Xm,SuccessFilled:ev,InfoFilled:Zm,WarningFilled:tv,CircleCloseFilled:$m},oc={success:ev,warning:tv,error:$m,info:Zm},GD={validating:Qm,success:pD,error:Jm},Ec=(o,i)=>{if(o.install=u=>{for(const c of[o,...Object.values(i??{})])u.component(c.name,c)},i)for(const[u,c]of Object.entries(i))o[u]=c;return o},wD=(o,i)=>(o.install=u=>{o._context=u._context,u.config.globalProperties[i]=o},o),UD=o=>(o.install=cn,o),ur={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},Ed="update:modelValue",jO="change",WO="input",sv=["","default","small","large"],FD=o=>["",...sv].includes(o);var Va=(o=>(o[o.TEXT=1]="TEXT",o[o.CLASS=2]="CLASS",o[o.STYLE=4]="STYLE",o[o.PROPS=8]="PROPS",o[o.FULL_PROPS=16]="FULL_PROPS",o[o.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",o[o.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",o[o.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",o[o.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",o[o.NEED_PATCH=512]="NEED_PATCH",o[o.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",o[o.HOISTED=-1]="HOISTED",o[o.BAIL=-2]="BAIL",o))(Va||{});const Jl=o=>{const i=He(o)?o:[o],u=[];return i.forEach(c=>{var p;He(c)?u.push(...Jl(c)):no(c)&&He(c.children)?u.push(...Jl(c.children)):(u.push(c),no(c)&&((p=c.component)!=null&&p.subTree)&&u.push(...Jl(c.component.subTree)))}),u},xD=o=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(o),qD=o=>o,VD=["class","style"],BD=/^on[A-Z]/,HD=(o={})=>{const{excludeListeners:i=!1,excludeKeys:u}=o,c=Oe(()=>((u==null?void 0:u.value)||[]).concat(VD)),p=Nn();return Oe(p?()=>{var f;return jm(Object.entries((f=p.proxy)==null?void 0:f.$attrs).filter(([v])=>!c.value.includes(v)&&!(i&&BD.test(v))))}:()=>({}))},KD=({from:o,replacement:i,scope:u,version:c,ref:p,type:f="API"},v)=>{Ht(()=>ge(v),y=>{},{immediate:!0})},jD=(o,i,u,c)=>{let p={offsetX:0,offsetY:0};const f=C=>{const T=C.clientX,L=C.clientY,{offsetX:R,offsetY:k}=p,x=o.value.getBoundingClientRect(),N=x.left,G=x.top,V=x.width,z=x.height,te=document.documentElement.clientWidth,q=document.documentElement.clientHeight,Ne=-N+R,Le=-G+k,Se=te-N-V+R,Ue=q-G-z+k,ve=$=>{let I=R+$.clientX-T,W=k+$.clientY-L;c!=null&&c.value||(I=Math.min(Math.max(I,Ne),Se),W=Math.min(Math.max(W,Le),Ue)),p={offsetX:I,offsetY:W},o.value&&(o.value.style.transform=`translate(${Td(I)}, ${Td(W)})`)},ye=()=>{document.removeEventListener("mousemove",ve),document.removeEventListener("mouseup",ye)};document.addEventListener("mousemove",ve),document.addEventListener("mouseup",ye)},v=()=>{i.value&&o.value&&i.value.addEventListener("mousedown",f)},y=()=>{i.value&&o.value&&i.value.removeEventListener("mousedown",f)};so(()=>{NC(()=>{u.value?v():y()})}),As(()=>{y()})};var WD={name:"en",el:{breadcrumb:{label:"Breadcrumb"},colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const YD=o=>(i,u)=>zD(i,u,ge(o)),zD=(o,i,u)=>JE(u,o,o).replace(/\{(\w+)\}/g,(c,p)=>{var f;return`${(f=i==null?void 0:i[p])!=null?f:`{${p}}`}`}),$D=o=>{const i=Oe(()=>ge(o).name),u=Wt(o)?o:pt(o);return{lang:i,locale:u,t:YD(o)}},rv=Symbol("localeContextKey"),JD=o=>{const i=o||bt(rv,pt());return $D(Oe(()=>i.value||WD))},Ba="el",XD="is-",ps=(o,i,u,c,p)=>{let f=`${o}-${i}`;return u&&(f+=`-${u}`),c&&(f+=`__${c}`),p&&(f+=`--${p}`),f},iv=Symbol("namespaceContextKey"),av=o=>{const i=o||(Nn()?bt(iv,pt(Ba)):pt(Ba));return Oe(()=>ge(i)||Ba)},Lo=(o,i)=>{const u=av(i);return{namespace:u,b:(G="")=>ps(u.value,o,G,"",""),e:G=>G?ps(u.value,o,"",G,""):"",m:G=>G?ps(u.value,o,"","",G):"",be:(G,V)=>G&&V?ps(u.value,o,G,V,""):"",em:(G,V)=>G&&V?ps(u.value,o,"",G,V):"",bm:(G,V)=>G&&V?ps(u.value,o,G,"",V):"",bem:(G,V,z)=>G&&V&&z?ps(u.value,o,G,V,z):"",is:(G,...V)=>{const z=V.length>=1?V[0]:!0;return G&&z?`${XD}${G}`:""},cssVar:G=>{const V={};for(const z in G)G[z]&&(V[`--${u.value}-${z}`]=G[z]);return V},cssVarName:G=>`--${u.value}-${G}`,cssVarBlock:G=>{const V={};for(const z in G)G[z]&&(V[`--${u.value}-${o}-${z}`]=G[z]);return V},cssVarBlockName:G=>`--${u.value}-${o}-${G}`}},ZD=(o,i={})=>{Wt(o)||QE("[useLockscreen]","You need to pass a ref param to this function");const u=i.ns||Lo("popup"),c=j_(()=>u.bm("parent","hidden"));if(!Pn||Ig(document.body,c.value))return;let p=0,f=!1,v="0";const y=()=>{setTimeout(()=>{tD(document==null?void 0:document.body,c.value),f&&document&&(document.body.style.width=v)},200)};Ht(o,C=>{if(!C){y();return}f=!Ig(document.body,c.value),f&&(v=document.body.style.width),p=oD(u.namespace.value);const T=document.documentElement.clientHeight<document.body.scrollHeight,L=nD(document.body,"overflowY");p>0&&(T||L==="scroll")&&f&&(document.body.style.width=`calc(100% - ${p}px)`),eD(document.body,c.value)}),Yd(()=>y())},cv=o=>{const i=Nn();return Oe(()=>{var u,c;return(c=(u=i==null?void 0:i.proxy)==null?void 0:u.$props)==null?void 0:c[o]})},uv=o=>{if(!o)return{onClick:cn,onMousedown:cn,onMouseup:cn};let i=!1,u=!1;return{onClick:v=>{i&&u&&o(v),i=u=!1},onMousedown:v=>{i=v.target===v.currentTarget},onMouseup:v=>{u=v.target===v.currentTarget}}},Mg={prefix:Math.floor(Math.random()*1e4),current:0},QD=Symbol("elIdInjection"),eS=()=>Nn()?bt(QD,Mg):Mg,Dd=o=>{const i=eS(),u=av();return Oe(()=>ge(o)||`${u.value}-id-${i.prefix}-${i.current++}`)};let tr=[];const Cg=o=>{const i=o;i.key===ur.esc&&tr.forEach(u=>u(i))},tS=o=>{so(()=>{tr.length===0&&document.addEventListener("keydown",Cg),Pn&&tr.push(o)}),As(()=>{tr=tr.filter(i=>i!==o),tr.length===0&&Pn&&document.removeEventListener("keydown",Cg)})},Tg={current:0},Eg=pt(0),lv=2e3,Dg=Symbol("elZIndexContextKey"),dv=Symbol("zIndexContextKey"),nS=o=>{const i=Nn()?bt(Dg,Tg):Tg,u=o||(Nn()?bt(dv,void 0):void 0),c=Oe(()=>{const v=ge(u);return tc(v)?v:lv}),p=Oe(()=>c.value+Eg.value),f=()=>(i.current++,Eg.value=i.current,p.value);return!Pn&&bt(Dg),{initialZIndex:c,currentZIndex:p,nextZIndex:f}};function oS(o){const i=pt();function u(){if(o.value==null)return;const{selectionStart:p,selectionEnd:f,value:v}=o.value;if(p==null||f==null)return;const y=v.slice(0,Math.max(0,p)),C=v.slice(Math.max(0,f));i.value={selectionStart:p,selectionEnd:f,value:v,beforeTxt:y,afterTxt:C}}function c(){if(o.value==null||i.value==null)return;const{value:p}=o.value,{beforeTxt:f,afterTxt:v,selectionStart:y}=i.value;if(f==null||v==null||y==null)return;let C=p.length;if(p.endsWith(v))C=p.length-v.length;else if(p.startsWith(f))C=f.length;else{const T=f[y-1],L=p.indexOf(T,y-1);L!==-1&&(C=L+1)}o.value.setSelectionRange(C,C)}return[u,c]}const _p=ov({type:String,values:sv,required:!1}),pv=Symbol("size"),sS=()=>{const o=bt(pv,{});return Oe(()=>ge(o.size)||"")};function rS(o,{afterFocus:i,beforeBlur:u,afterBlur:c}={}){const p=Nn(),{emit:f}=p,v=Ci(),y=pt(!1),C=R=>{y.value||(y.value=!0,f("focus",R),i==null||i())},T=R=>{var k;Ze(u)&&u(R)||R.relatedTarget&&((k=v.value)!=null&&k.contains(R.relatedTarget))||(y.value=!1,f("blur",R),c==null||c())},L=()=>{var R;(R=o.value)==null||R.focus()};return Ht(v,R=>{R&&R.setAttribute("tabindex","-1")}),ki(v,"click",L),{wrapperRef:v,isFocused:y,handleFocus:C,handleBlur:T}}const iS=["",void 0,null],aS=void 0,cS=Ns({emptyValues:Array,valueOnClear:{type:[String,Number,Boolean,Function],default:void 0,validator:o=>Ze(o)?!o():!o}}),YO=(o,i)=>{let u=Dc();u.value||(u=pt({}));const c=Oe(()=>o.emptyValues||u.value.emptyValues||iS),p=Oe(()=>Ze(o.valueOnClear)?o.valueOnClear():o.valueOnClear!==void 0?o.valueOnClear:Ze(u.value.valueOnClear)?u.value.valueOnClear():u.value.valueOnClear!==void 0?u.value.valueOnClear:i!==void 0?i:aS),f=v=>c.value.includes(v);return c.value.includes(p.value),{emptyValues:c,valueOnClear:p,isEmptyValue:f}},fv=Symbol(),sc=pt();function Dc(o,i=void 0){const u=Nn()?bt(fv,sc):sc;return o?Oe(()=>{var c,p;return(p=(c=u.value)==null?void 0:c[o])!=null?p:i}):u}function hv(o,i){const u=Dc(),c=Lo(o,Oe(()=>{var y;return((y=u.value)==null?void 0:y.namespace)||Ba})),p=JD(Oe(()=>{var y;return(y=u.value)==null?void 0:y.locale})),f=nS(Oe(()=>{var y;return((y=u.value)==null?void 0:y.zIndex)||lv})),v=Oe(()=>{var y;return ge(i)||((y=u.value)==null?void 0:y.size)||""});return gv(Oe(()=>ge(u)||{})),{ns:c,locale:p,zIndex:f,size:v}}const gv=(o,i,u=!1)=>{var c;const p=!!Nn(),f=p?Dc():void 0,v=(c=void 0)!=null?c:p?Do:void 0;if(!v)return;const y=Oe(()=>{const C=ge(o);return f!=null&&f.value?uS(f.value,C):C});return v(fv,y),v(rv,Oe(()=>y.value.locale)),v(iv,Oe(()=>y.value.namespace)),v(dv,Oe(()=>y.value.zIndex)),v(pv,{size:Oe(()=>y.value.size||"")}),(u||!sc.value)&&(sc.value=y.value),y},uS=(o,i)=>{const u=[...new Set([...yg(o),...yg(i)])],c={};for(const p of u)c[p]=i[p]!==void 0?i[p]:o[p];return c},lS=Ns({a11y:{type:Boolean,default:!0},locale:{type:En(Object)},size:_p,button:{type:En(Object)},experimentalFeatures:{type:En(Object)},keyboardNavigation:{type:Boolean,default:!0},message:{type:En(Object)},zIndex:Number,namespace:{type:String,default:"el"},...cS}),dS={},pS=ut({name:"ElConfigProvider",props:lS,setup(o,{slots:i}){Ht(()=>o.message,c=>{Object.assign(dS,c??{})},{immediate:!0,deep:!0});const u=gv(o);return()=>Tn(i,"default",{config:u==null?void 0:u.value})}}),fS=Ec(pS);var Ps=(o,i)=>{const u=o.__vccOpts||o;for(const[c,p]of i)u[c]=p;return u};const hS=Ns({size:{type:En([Number,String])},color:{type:String}}),gS=ut({name:"ElIcon",inheritAttrs:!1}),_S=ut({...gS,props:hS,setup(o){const i=o,u=Lo("icon"),c=Oe(()=>{const{size:p,color:f}=i;return!p&&!f?{}:{fontSize:Ym(p)?void 0:Td(p),"--color":f}});return(p,f)=>(be(),it("i",cr({class:ge(u).b(),style:ge(c)},p.$attrs),[Tn(p.$slots,"default")],16))}});var mS=Ps(_S,[["__file","icon.vue"]]);const _o=Ec(mS),mp=Symbol("formContextKey"),_v=Symbol("formItemContextKey"),mv=(o,i={})=>{const u=pt(void 0),c=i.prop?u:cv("size"),p=i.global?u:sS(),f=i.form?{size:void 0}:bt(mp,void 0),v=i.formItem?{size:void 0}:bt(_v,void 0);return Oe(()=>c.value||ge(o)||(v==null?void 0:v.size)||(f==null?void 0:f.size)||p.value||"")},vp=o=>{const i=cv("disabled"),u=bt(mp,void 0);return Oe(()=>i.value||ge(o)||(u==null?void 0:u.disabled)||!1)},vv=()=>{const o=bt(mp,void 0),i=bt(_v,void 0);return{form:o,formItem:i}},vS=(o,{formItemContext:i,disableIdGeneration:u,disableIdManagement:c})=>{u||(u=pt(!1)),c||(c=pt(!1));const p=pt();let f;const v=Oe(()=>{var y;return!!(!o.label&&i&&i.inputIds&&((y=i.inputIds)==null?void 0:y.length)<=1)});return so(()=>{f=Ht([za(o,"id"),u],([y,C])=>{const T=y??(C?void 0:Dd().value);T!==p.value&&(i!=null&&i.removeInputId&&(p.value&&i.removeInputId(p.value),!(c!=null&&c.value)&&!C&&T&&i.addInputId(T)),p.value=T)},{immediate:!0})}),ap(()=>{f&&f(),i!=null&&i.removeInputId&&p.value&&i.removeInputId(p.value)}),{isLabeledByFormItem:v,inputId:p}};let Xn;const yS=`
  height:0 !important;
  visibility:hidden !important;
  ${PT()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,IS=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function MS(o){const i=window.getComputedStyle(o),u=i.getPropertyValue("box-sizing"),c=Number.parseFloat(i.getPropertyValue("padding-bottom"))+Number.parseFloat(i.getPropertyValue("padding-top")),p=Number.parseFloat(i.getPropertyValue("border-bottom-width"))+Number.parseFloat(i.getPropertyValue("border-top-width"));return{contextStyle:IS.map(v=>`${v}:${i.getPropertyValue(v)}`).join(";"),paddingSize:c,borderSize:p,boxSizing:u}}function Sg(o,i=1,u){var c;Xn||(Xn=document.createElement("textarea"),document.body.appendChild(Xn));const{paddingSize:p,borderSize:f,boxSizing:v,contextStyle:y}=MS(o);Xn.setAttribute("style",`${y};${yS}`),Xn.value=o.value||o.placeholder||"";let C=Xn.scrollHeight;const T={};v==="border-box"?C=C+f:v==="content-box"&&(C=C-p),Xn.value="";const L=Xn.scrollHeight-p;if(tc(i)){let R=L*i;v==="border-box"&&(R=R+p+f),C=Math.max(R,C),T.minHeight=`${R}px`}if(tc(u)){let R=L*u;v==="border-box"&&(R=R+p+f),C=Math.min(R,C)}return T.height=`${C}px`,(c=Xn.parentNode)==null||c.removeChild(Xn),Xn=void 0,T}const CS=Ns({id:{type:String,default:void 0},size:_p,disabled:Boolean,modelValue:{type:En([String,Number,Object]),default:""},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:En([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:Bi},prefixIcon:{type:Bi},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:En([Object,Array,String]),default:()=>qD({})},autofocus:{type:Boolean,default:!1}}),TS={[Ed]:o=>Ct(o),input:o=>Ct(o),change:o=>Ct(o),focus:o=>o instanceof FocusEvent,blur:o=>o instanceof FocusEvent,clear:()=>!0,mouseleave:o=>o instanceof MouseEvent,mouseenter:o=>o instanceof MouseEvent,keydown:o=>o instanceof Event,compositionstart:o=>o instanceof CompositionEvent,compositionupdate:o=>o instanceof CompositionEvent,compositionend:o=>o instanceof CompositionEvent},ES=["role"],DS=["id","minlength","maxlength","type","disabled","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus"],SS=["id","minlength","maxlength","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus"],LS=ut({name:"ElInput",inheritAttrs:!1}),RS=ut({...LS,props:CS,emits:TS,setup(o,{expose:i,emit:u}){const c=o,p=YC(),f=lm(),v=Oe(()=>{const ae={};return c.containerRole==="combobox"&&(ae["aria-haspopup"]=p["aria-haspopup"],ae["aria-owns"]=p["aria-owns"],ae["aria-expanded"]=p["aria-expanded"]),ae}),y=Oe(()=>[c.type==="textarea"?V.b():G.b(),G.m(x.value),G.is("disabled",N.value),G.is("exceed",Xe.value),{[G.b("group")]:f.prepend||f.append,[G.bm("group","append")]:f.append,[G.bm("group","prepend")]:f.prepend,[G.m("prefix")]:f.prefix||c.prefixIcon,[G.m("suffix")]:f.suffix||c.suffixIcon||c.clearable||c.showPassword,[G.bm("suffix","password-clear")]:P.value&&he.value,[G.b("hidden")]:c.type==="hidden"},p.class]),C=Oe(()=>[G.e("wrapper"),G.is("focus",$.value)]),T=HD({excludeKeys:Oe(()=>Object.keys(v.value))}),{form:L,formItem:R}=vv(),{inputId:k}=vS(c,{formItemContext:R}),x=mv(),N=vp(),G=Lo("input"),V=Lo("textarea"),z=Ci(),te=Ci(),q=pt(!1),Ne=pt(!1),Le=pt(!1),Se=pt(),Ue=Ci(c.inputStyle),ve=Oe(()=>z.value||te.value),{wrapperRef:ye,isFocused:$,handleFocus:I,handleBlur:W}=rS(ve,{afterBlur(){var ae;c.validateEvent&&((ae=R==null?void 0:R.validate)==null||ae.call(R,"blur").catch(Ge=>void 0))}}),Z=Oe(()=>{var ae;return(ae=L==null?void 0:L.statusIcon)!=null?ae:!1}),X=Oe(()=>(R==null?void 0:R.validateState)||""),Q=Oe(()=>X.value&&GD[X.value]),Y=Oe(()=>Le.value?kD:CD),ue=Oe(()=>[p.style]),re=Oe(()=>[c.inputStyle,Ue.value,{resize:c.resize}]),Ee=Oe(()=>Wm(c.modelValue)?"":String(c.modelValue)),P=Oe(()=>c.clearable&&!N.value&&!c.readonly&&!!Ee.value&&($.value||q.value)),he=Oe(()=>c.showPassword&&!N.value&&!c.readonly&&!!Ee.value&&(!!Ee.value||$.value)),Fe=Oe(()=>c.showWordLimit&&!!c.maxlength&&(c.type==="text"||c.type==="textarea")&&!N.value&&!c.readonly&&!c.showPassword),$e=Oe(()=>Ee.value.length),Xe=Oe(()=>!!Fe.value&&$e.value>Number(c.maxlength)),ht=Oe(()=>!!f.suffix||!!c.suffixIcon||P.value||c.showPassword||Fe.value||!!X.value&&Z.value),[at,ie]=oS(z);ET(te,ae=>{if(Re(),!Fe.value||c.resize!=="both")return;const Ge=ae[0],{width:et}=Ge.contentRect;Se.value={right:`calc(100% - ${et+15+6}px)`}});const Ce=()=>{const{type:ae,autosize:Ge}=c;if(!(!Pn||ae!=="textarea"||!te.value))if(Ge){const et=Tt(Ge)?Ge.minRows:void 0,Dt=Tt(Ge)?Ge.maxRows:void 0,Xt=Sg(te.value,et,Dt);Ue.value={overflowY:"hidden",...Xt},dn(()=>{te.value.offsetHeight,Ue.value=Xt})}else Ue.value={minHeight:Sg(te.value).minHeight}},Re=(ae=>{let Ge=!1;return()=>{var et;if(Ge||!c.autosize)return;((et=te.value)==null?void 0:et.offsetParent)===null||(ae(),Ge=!0)}})(Ce),Je=()=>{const ae=ve.value,Ge=c.formatter?c.formatter(Ee.value):Ee.value;!ae||ae.value===Ge||(ae.value=Ge)},b=async ae=>{at();let{value:Ge}=ae.target;if(c.formatter&&(Ge=c.parser?c.parser(Ge):Ge),!Ne.value){if(Ge===Ee.value){Je();return}u(Ed,Ge),u("input",Ge),await dn(),Je(),ie()}},w=ae=>{u("change",ae.target.value)},j=ae=>{u("compositionstart",ae),Ne.value=!0},ce=ae=>{var Ge;u("compositionupdate",ae);const et=(Ge=ae.target)==null?void 0:Ge.value,Dt=et[et.length-1]||"";Ne.value=!xD(Dt)},ee=ae=>{u("compositionend",ae),Ne.value&&(Ne.value=!1,b(ae))},pe=()=>{Le.value=!Le.value,Te()},Te=async()=>{var ae;await dn(),(ae=ve.value)==null||ae.focus()},le=()=>{var ae;return(ae=ve.value)==null?void 0:ae.blur()},Ie=ae=>{q.value=!1,u("mouseleave",ae)},Me=ae=>{q.value=!0,u("mouseenter",ae)},we=ae=>{u("keydown",ae)},Ye=()=>{var ae;(ae=ve.value)==null||ae.select()},qe=()=>{u(Ed,""),u("change",""),u("clear"),u("input","")};return Ht(()=>c.modelValue,()=>{var ae;dn(()=>Ce()),c.validateEvent&&((ae=R==null?void 0:R.validate)==null||ae.call(R,"change").catch(Ge=>void 0))}),Ht(Ee,()=>Je()),Ht(()=>c.type,async()=>{await dn(),Je(),Ce()}),so(()=>{!c.formatter&&c.parser,Je(),dn(Ce)}),i({input:z,textarea:te,ref:ve,textareaStyle:re,autosize:za(c,"autosize"),focus:Te,blur:le,select:Ye,clear:qe,resizeTextarea:Ce}),(ae,Ge)=>(be(),it("div",cr(ge(v),{class:ge(y),style:ge(ue),role:ae.containerRole,onMouseenter:Me,onMouseleave:Ie}),[Rt(" input "),ae.type!=="textarea"?(be(),it(an,{key:0},[Rt(" prepend slot "),ae.$slots.prepend?(be(),it("div",{key:0,class:nt(ge(G).be("group","prepend"))},[Tn(ae.$slots,"prepend")],2)):Rt("v-if",!0),ze("div",{ref_key:"wrapperRef",ref:ye,class:nt(ge(C))},[Rt(" prefix slot "),ae.$slots.prefix||ae.prefixIcon?(be(),it("span",{key:0,class:nt(ge(G).e("prefix"))},[ze("span",{class:nt(ge(G).e("prefix-inner"))},[Tn(ae.$slots,"prefix"),ae.prefixIcon?(be(),Mt(ge(_o),{key:0,class:nt(ge(G).e("icon"))},{default:qt(()=>[(be(),Mt(Rn(ae.prefixIcon)))]),_:1},8,["class"])):Rt("v-if",!0)],2)],2)):Rt("v-if",!0),ze("input",cr({id:ge(k),ref_key:"input",ref:z,class:ge(G).e("inner")},ge(T),{minlength:ae.minlength,maxlength:ae.maxlength,type:ae.showPassword?Le.value?"text":"password":ae.type,disabled:ge(N),readonly:ae.readonly,autocomplete:ae.autocomplete,tabindex:ae.tabindex,"aria-label":ae.label,placeholder:ae.placeholder,style:ae.inputStyle,form:ae.form,autofocus:ae.autofocus,onCompositionstart:j,onCompositionupdate:ce,onCompositionend:ee,onInput:b,onFocus:Ge[0]||(Ge[0]=(...et)=>ge(I)&&ge(I)(...et)),onBlur:Ge[1]||(Ge[1]=(...et)=>ge(W)&&ge(W)(...et)),onChange:w,onKeydown:we}),null,16,DS),Rt(" suffix slot "),ge(ht)?(be(),it("span",{key:1,class:nt(ge(G).e("suffix"))},[ze("span",{class:nt(ge(G).e("suffix-inner"))},[!ge(P)||!ge(he)||!ge(Fe)?(be(),it(an,{key:0},[Tn(ae.$slots,"suffix"),ae.suffixIcon?(be(),Mt(ge(_o),{key:0,class:nt(ge(G).e("icon"))},{default:qt(()=>[(be(),Mt(Rn(ae.suffixIcon)))]),_:1},8,["class"])):Rt("v-if",!0)],64)):Rt("v-if",!0),ge(P)?(be(),Mt(ge(_o),{key:1,class:nt([ge(G).e("icon"),ge(G).e("clear")]),onMousedown:or(ge(cn),["prevent"]),onClick:qe},{default:qt(()=>[kt(ge(Jm))]),_:1},8,["class","onMousedown"])):Rt("v-if",!0),ge(he)?(be(),Mt(ge(_o),{key:2,class:nt([ge(G).e("icon"),ge(G).e("password")]),onClick:pe},{default:qt(()=>[(be(),Mt(Rn(ge(Y))))]),_:1},8,["class"])):Rt("v-if",!0),ge(Fe)?(be(),it("span",{key:3,class:nt(ge(G).e("count"))},[ze("span",{class:nt(ge(G).e("count-inner"))},Qn(ge($e))+" / "+Qn(ae.maxlength),3)],2)):Rt("v-if",!0),ge(X)&&ge(Q)&&ge(Z)?(be(),Mt(ge(_o),{key:4,class:nt([ge(G).e("icon"),ge(G).e("validateIcon"),ge(G).is("loading",ge(X)==="validating")])},{default:qt(()=>[(be(),Mt(Rn(ge(Q))))]),_:1},8,["class"])):Rt("v-if",!0)],2)],2)):Rt("v-if",!0)],2),Rt(" append slot "),ae.$slots.append?(be(),it("div",{key:1,class:nt(ge(G).be("group","append"))},[Tn(ae.$slots,"append")],2)):Rt("v-if",!0)],64)):(be(),it(an,{key:1},[Rt(" textarea "),ze("textarea",cr({id:ge(k),ref_key:"textarea",ref:te,class:ge(V).e("inner")},ge(T),{minlength:ae.minlength,maxlength:ae.maxlength,tabindex:ae.tabindex,disabled:ge(N),readonly:ae.readonly,autocomplete:ae.autocomplete,style:ge(re),"aria-label":ae.label,placeholder:ae.placeholder,form:ae.form,autofocus:ae.autofocus,onCompositionstart:j,onCompositionupdate:ce,onCompositionend:ee,onInput:b,onFocus:Ge[2]||(Ge[2]=(...et)=>ge(I)&&ge(I)(...et)),onBlur:Ge[3]||(Ge[3]=(...et)=>ge(W)&&ge(W)(...et)),onChange:w,onKeydown:we}),null,16,SS),ge(Fe)?(be(),it("span",{key:0,style:So(Se.value),class:nt(ge(G).e("count"))},Qn(ge($e))+" / "+Qn(ae.maxlength),7)):Rt("v-if",!0)],64))],16,ES))}});var kS=Ps(RS,[["__file","input.vue"]]);const AS=Ec(kS),Xl="focus-trap.focus-after-trapped",Zl="focus-trap.focus-after-released",OS="focus-trap.focusout-prevented",Lg={cancelable:!0,bubbles:!1},NS={cancelable:!0,bubbles:!1},Rg="focusAfterTrapped",kg="focusAfterReleased",PS=Symbol("elFocusTrap"),yp=pt(),Sc=pt(0),Ip=pt(0);let Oa=0;const yv=o=>{const i=[],u=document.createTreeWalker(o,NodeFilter.SHOW_ELEMENT,{acceptNode:c=>{const p=c.tagName==="INPUT"&&c.type==="hidden";return c.disabled||c.hidden||p?NodeFilter.FILTER_SKIP:c.tabIndex>=0||c===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;u.nextNode();)i.push(u.currentNode);return i},Ag=(o,i)=>{for(const u of o)if(!bS(u,i))return u},bS=(o,i)=>{if(getComputedStyle(o).visibility==="hidden")return!0;for(;o;){if(i&&o===i)return!1;if(getComputedStyle(o).display==="none")return!0;o=o.parentElement}return!1},GS=o=>{const i=yv(o),u=Ag(i,o),c=Ag(i.reverse(),o);return[u,c]},wS=o=>o instanceof HTMLInputElement&&"select"in o,Bo=(o,i)=>{if(o&&o.focus){const u=document.activeElement;o.focus({preventScroll:!0}),Ip.value=window.performance.now(),o!==u&&wS(o)&&i&&o.select()}};function Og(o,i){const u=[...o],c=o.indexOf(i);return c!==-1&&u.splice(c,1),u}const US=()=>{let o=[];return{push:c=>{const p=o[0];p&&c!==p&&p.pause(),o=Og(o,c),o.unshift(c)},remove:c=>{var p,f;o=Og(o,c),(f=(p=o[0])==null?void 0:p.resume)==null||f.call(p)}}},FS=(o,i=!1)=>{const u=document.activeElement;for(const c of o)if(Bo(c,i),document.activeElement!==u)return},Ng=US(),xS=()=>Sc.value>Ip.value,Na=()=>{yp.value="pointer",Sc.value=window.performance.now()},Pg=()=>{yp.value="keyboard",Sc.value=window.performance.now()},qS=()=>(so(()=>{Oa===0&&(document.addEventListener("mousedown",Na),document.addEventListener("touchstart",Na),document.addEventListener("keydown",Pg)),Oa++}),As(()=>{Oa--,Oa<=0&&(document.removeEventListener("mousedown",Na),document.removeEventListener("touchstart",Na),document.removeEventListener("keydown",Pg))}),{focusReason:yp,lastUserFocusTimestamp:Sc,lastAutomatedFocusTimestamp:Ip}),Pa=o=>new CustomEvent(OS,{...NS,detail:o}),VS=ut({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[Rg,kg,"focusin","focusout","focusout-prevented","release-requested"],setup(o,{emit:i}){const u=pt();let c,p;const{focusReason:f}=qS();tS(N=>{o.trapped&&!v.paused&&i("release-requested",N)});const v={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},y=N=>{if(!o.loop&&!o.trapped||v.paused)return;const{key:G,altKey:V,ctrlKey:z,metaKey:te,currentTarget:q,shiftKey:Ne}=N,{loop:Le}=o,Se=G===ur.tab&&!V&&!z&&!te,Ue=document.activeElement;if(Se&&Ue){const ve=q,[ye,$]=GS(ve);if(ye&&$){if(!Ne&&Ue===$){const W=Pa({focusReason:f.value});i("focusout-prevented",W),W.defaultPrevented||(N.preventDefault(),Le&&Bo(ye,!0))}else if(Ne&&[ye,ve].includes(Ue)){const W=Pa({focusReason:f.value});i("focusout-prevented",W),W.defaultPrevented||(N.preventDefault(),Le&&Bo($,!0))}}else if(Ue===ve){const W=Pa({focusReason:f.value});i("focusout-prevented",W),W.defaultPrevented||N.preventDefault()}}};Do(PS,{focusTrapRef:u,onKeydown:y}),Ht(()=>o.focusTrapEl,N=>{N&&(u.value=N)},{immediate:!0}),Ht([u],([N],[G])=>{N&&(N.addEventListener("keydown",y),N.addEventListener("focusin",L),N.addEventListener("focusout",R)),G&&(G.removeEventListener("keydown",y),G.removeEventListener("focusin",L),G.removeEventListener("focusout",R))});const C=N=>{i(Rg,N)},T=N=>i(kg,N),L=N=>{const G=ge(u);if(!G)return;const V=N.target,z=N.relatedTarget,te=V&&G.contains(V);o.trapped||z&&G.contains(z)||(c=z),te&&i("focusin",N),!v.paused&&o.trapped&&(te?p=V:Bo(p,!0))},R=N=>{const G=ge(u);if(!(v.paused||!G))if(o.trapped){const V=N.relatedTarget;!Wm(V)&&!G.contains(V)&&setTimeout(()=>{if(!v.paused&&o.trapped){const z=Pa({focusReason:f.value});i("focusout-prevented",z),z.defaultPrevented||Bo(p,!0)}},0)}else{const V=N.target;V&&G.contains(V)||i("focusout",N)}};async function k(){await dn();const N=ge(u);if(N){Ng.push(v);const G=N.contains(document.activeElement)?c:document.activeElement;if(c=G,!N.contains(G)){const z=new Event(Xl,Lg);N.addEventListener(Xl,C),N.dispatchEvent(z),z.defaultPrevented||dn(()=>{let te=o.focusStartEl;Ct(te)||(Bo(te),document.activeElement!==te&&(te="first")),te==="first"&&FS(yv(N),!0),(document.activeElement===G||te==="container")&&Bo(N)})}}}function x(){const N=ge(u);if(N){N.removeEventListener(Xl,C);const G=new CustomEvent(Zl,{...Lg,detail:{focusReason:f.value}});N.addEventListener(Zl,T),N.dispatchEvent(G),!G.defaultPrevented&&(f.value=="keyboard"||!xS()||N.contains(document.activeElement))&&Bo(c??document.body),N.removeEventListener(Zl,T),Ng.remove(v)}}return so(()=>{o.trapped&&k(),Ht(()=>o.trapped,N=>{N?k():x()})}),As(()=>{o.trapped&&x()}),{onKeydown:y}}});function BS(o,i,u,c,p,f){return Tn(o.$slots,"default",{handleKeydown:o.onKeydown})}var HS=Ps(VS,[["render",BS],["__file","focus-trap.vue"]]);const Iv=Symbol("buttonGroupContextKey"),KS=(o,i)=>{KD({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},Oe(()=>o.type==="text"));const u=bt(Iv,void 0),c=Dc("button"),{form:p}=vv(),f=mv(Oe(()=>u==null?void 0:u.size)),v=vp(),y=pt(),C=lm(),T=Oe(()=>o.type||(u==null?void 0:u.type)||""),L=Oe(()=>{var N,G,V;return(V=(G=o.autoInsertSpace)!=null?G:(N=c.value)==null?void 0:N.autoInsertSpace)!=null?V:!1}),R=Oe(()=>o.tag==="button"?{ariaDisabled:v.value||o.loading,disabled:v.value||o.loading,autofocus:o.autofocus,type:o.nativeType}:{}),k=Oe(()=>{var N;const G=(N=C.default)==null?void 0:N.call(C);if(L.value&&(G==null?void 0:G.length)===1){const V=G[0];if((V==null?void 0:V.type)===Xi){const z=V.children;return new RegExp("^\\p{Unified_Ideograph}{2}$","u").test(z.trim())}}return!1});return{_disabled:v,_size:f,_type:T,_ref:y,_props:R,shouldAddSpace:k,handleClick:N=>{o.nativeType==="reset"&&(p==null||p.resetFields()),i("click",N)}}},jS=["default","primary","success","warning","info","danger","text",""],WS=["button","submit","reset"],Sd=Ns({size:_p,disabled:Boolean,type:{type:String,values:jS,default:""},icon:{type:Bi},nativeType:{type:String,values:WS,default:"button"},loading:Boolean,loadingIcon:{type:Bi,default:()=>Qm},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:En([String,Object]),default:"button"}}),YS={click:o=>o instanceof MouseEvent};function pn(o,i){zS(o)&&(o="100%");var u=$S(o);return o=i===360?o:Math.min(i,Math.max(0,parseFloat(o))),u&&(o=parseInt(String(o*i),10)/100),Math.abs(o-i)<1e-6?1:(i===360?o=(o<0?o%i+i:o%i)/parseFloat(String(i)):o=o%i/parseFloat(String(i)),o)}function ba(o){return Math.min(1,Math.max(0,o))}function zS(o){return typeof o=="string"&&o.indexOf(".")!==-1&&parseFloat(o)===1}function $S(o){return typeof o=="string"&&o.indexOf("%")!==-1}function Mv(o){return o=parseFloat(o),(isNaN(o)||o<0||o>1)&&(o=1),o}function Ga(o){return o<=1?"".concat(Number(o)*100,"%"):o}function vs(o){return o.length===1?"0"+o:String(o)}function JS(o,i,u){return{r:pn(o,255)*255,g:pn(i,255)*255,b:pn(u,255)*255}}function bg(o,i,u){o=pn(o,255),i=pn(i,255),u=pn(u,255);var c=Math.max(o,i,u),p=Math.min(o,i,u),f=0,v=0,y=(c+p)/2;if(c===p)v=0,f=0;else{var C=c-p;switch(v=y>.5?C/(2-c-p):C/(c+p),c){case o:f=(i-u)/C+(i<u?6:0);break;case i:f=(u-o)/C+2;break;case u:f=(o-i)/C+4;break}f/=6}return{h:f,s:v,l:y}}function Ql(o,i,u){return u<0&&(u+=1),u>1&&(u-=1),u<1/6?o+(i-o)*(6*u):u<1/2?i:u<2/3?o+(i-o)*(2/3-u)*6:o}function XS(o,i,u){var c,p,f;if(o=pn(o,360),i=pn(i,100),u=pn(u,100),i===0)p=u,f=u,c=u;else{var v=u<.5?u*(1+i):u+i-u*i,y=2*u-v;c=Ql(y,v,o+1/3),p=Ql(y,v,o),f=Ql(y,v,o-1/3)}return{r:c*255,g:p*255,b:f*255}}function Gg(o,i,u){o=pn(o,255),i=pn(i,255),u=pn(u,255);var c=Math.max(o,i,u),p=Math.min(o,i,u),f=0,v=c,y=c-p,C=c===0?0:y/c;if(c===p)f=0;else{switch(c){case o:f=(i-u)/y+(i<u?6:0);break;case i:f=(u-o)/y+2;break;case u:f=(o-i)/y+4;break}f/=6}return{h:f,s:C,v}}function ZS(o,i,u){o=pn(o,360)*6,i=pn(i,100),u=pn(u,100);var c=Math.floor(o),p=o-c,f=u*(1-i),v=u*(1-p*i),y=u*(1-(1-p)*i),C=c%6,T=[u,v,f,f,y,u][C],L=[y,u,u,v,f,f][C],R=[f,f,y,u,u,v][C];return{r:T*255,g:L*255,b:R*255}}function wg(o,i,u,c){var p=[vs(Math.round(o).toString(16)),vs(Math.round(i).toString(16)),vs(Math.round(u).toString(16))];return c&&p[0].startsWith(p[0].charAt(1))&&p[1].startsWith(p[1].charAt(1))&&p[2].startsWith(p[2].charAt(1))?p[0].charAt(0)+p[1].charAt(0)+p[2].charAt(0):p.join("")}function QS(o,i,u,c,p){var f=[vs(Math.round(o).toString(16)),vs(Math.round(i).toString(16)),vs(Math.round(u).toString(16)),vs(eL(c))];return p&&f[0].startsWith(f[0].charAt(1))&&f[1].startsWith(f[1].charAt(1))&&f[2].startsWith(f[2].charAt(1))&&f[3].startsWith(f[3].charAt(1))?f[0].charAt(0)+f[1].charAt(0)+f[2].charAt(0)+f[3].charAt(0):f.join("")}function eL(o){return Math.round(parseFloat(o)*255).toString(16)}function Ug(o){return xn(o)/255}function xn(o){return parseInt(o,16)}function tL(o){return{r:o>>16,g:(o&65280)>>8,b:o&255}}var Ld={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function nL(o){var i={r:0,g:0,b:0},u=1,c=null,p=null,f=null,v=!1,y=!1;return typeof o=="string"&&(o=rL(o)),typeof o=="object"&&(Mo(o.r)&&Mo(o.g)&&Mo(o.b)?(i=JS(o.r,o.g,o.b),v=!0,y=String(o.r).substr(-1)==="%"?"prgb":"rgb"):Mo(o.h)&&Mo(o.s)&&Mo(o.v)?(c=Ga(o.s),p=Ga(o.v),i=ZS(o.h,c,p),v=!0,y="hsv"):Mo(o.h)&&Mo(o.s)&&Mo(o.l)&&(c=Ga(o.s),f=Ga(o.l),i=XS(o.h,c,f),v=!0,y="hsl"),Object.prototype.hasOwnProperty.call(o,"a")&&(u=o.a)),u=Mv(u),{ok:v,format:o.format||y,r:Math.min(255,Math.max(i.r,0)),g:Math.min(255,Math.max(i.g,0)),b:Math.min(255,Math.max(i.b,0)),a:u}}var oL="[-\\+]?\\d+%?",sL="[-\\+]?\\d*\\.\\d+%?",Jo="(?:".concat(sL,")|(?:").concat(oL,")"),ed="[\\s|\\(]+(".concat(Jo,")[,|\\s]+(").concat(Jo,")[,|\\s]+(").concat(Jo,")\\s*\\)?"),td="[\\s|\\(]+(".concat(Jo,")[,|\\s]+(").concat(Jo,")[,|\\s]+(").concat(Jo,")[,|\\s]+(").concat(Jo,")\\s*\\)?"),Zn={CSS_UNIT:new RegExp(Jo),rgb:new RegExp("rgb"+ed),rgba:new RegExp("rgba"+td),hsl:new RegExp("hsl"+ed),hsla:new RegExp("hsla"+td),hsv:new RegExp("hsv"+ed),hsva:new RegExp("hsva"+td),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function rL(o){if(o=o.trim().toLowerCase(),o.length===0)return!1;var i=!1;if(Ld[o])o=Ld[o],i=!0;else if(o==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var u=Zn.rgb.exec(o);return u?{r:u[1],g:u[2],b:u[3]}:(u=Zn.rgba.exec(o),u?{r:u[1],g:u[2],b:u[3],a:u[4]}:(u=Zn.hsl.exec(o),u?{h:u[1],s:u[2],l:u[3]}:(u=Zn.hsla.exec(o),u?{h:u[1],s:u[2],l:u[3],a:u[4]}:(u=Zn.hsv.exec(o),u?{h:u[1],s:u[2],v:u[3]}:(u=Zn.hsva.exec(o),u?{h:u[1],s:u[2],v:u[3],a:u[4]}:(u=Zn.hex8.exec(o),u?{r:xn(u[1]),g:xn(u[2]),b:xn(u[3]),a:Ug(u[4]),format:i?"name":"hex8"}:(u=Zn.hex6.exec(o),u?{r:xn(u[1]),g:xn(u[2]),b:xn(u[3]),format:i?"name":"hex"}:(u=Zn.hex4.exec(o),u?{r:xn(u[1]+u[1]),g:xn(u[2]+u[2]),b:xn(u[3]+u[3]),a:Ug(u[4]+u[4]),format:i?"name":"hex8"}:(u=Zn.hex3.exec(o),u?{r:xn(u[1]+u[1]),g:xn(u[2]+u[2]),b:xn(u[3]+u[3]),format:i?"name":"hex"}:!1)))))))))}function Mo(o){return!!Zn.CSS_UNIT.exec(String(o))}var iL=function(){function o(i,u){i===void 0&&(i=""),u===void 0&&(u={});var c;if(i instanceof o)return i;typeof i=="number"&&(i=tL(i)),this.originalInput=i;var p=nL(i);this.originalInput=i,this.r=p.r,this.g=p.g,this.b=p.b,this.a=p.a,this.roundA=Math.round(100*this.a)/100,this.format=(c=u.format)!==null&&c!==void 0?c:p.format,this.gradientType=u.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=p.ok}return o.prototype.isDark=function(){return this.getBrightness()<128},o.prototype.isLight=function(){return!this.isDark()},o.prototype.getBrightness=function(){var i=this.toRgb();return(i.r*299+i.g*587+i.b*114)/1e3},o.prototype.getLuminance=function(){var i=this.toRgb(),u,c,p,f=i.r/255,v=i.g/255,y=i.b/255;return f<=.03928?u=f/12.92:u=Math.pow((f+.055)/1.055,2.4),v<=.03928?c=v/12.92:c=Math.pow((v+.055)/1.055,2.4),y<=.03928?p=y/12.92:p=Math.pow((y+.055)/1.055,2.4),.2126*u+.7152*c+.0722*p},o.prototype.getAlpha=function(){return this.a},o.prototype.setAlpha=function(i){return this.a=Mv(i),this.roundA=Math.round(100*this.a)/100,this},o.prototype.isMonochrome=function(){var i=this.toHsl().s;return i===0},o.prototype.toHsv=function(){var i=Gg(this.r,this.g,this.b);return{h:i.h*360,s:i.s,v:i.v,a:this.a}},o.prototype.toHsvString=function(){var i=Gg(this.r,this.g,this.b),u=Math.round(i.h*360),c=Math.round(i.s*100),p=Math.round(i.v*100);return this.a===1?"hsv(".concat(u,", ").concat(c,"%, ").concat(p,"%)"):"hsva(".concat(u,", ").concat(c,"%, ").concat(p,"%, ").concat(this.roundA,")")},o.prototype.toHsl=function(){var i=bg(this.r,this.g,this.b);return{h:i.h*360,s:i.s,l:i.l,a:this.a}},o.prototype.toHslString=function(){var i=bg(this.r,this.g,this.b),u=Math.round(i.h*360),c=Math.round(i.s*100),p=Math.round(i.l*100);return this.a===1?"hsl(".concat(u,", ").concat(c,"%, ").concat(p,"%)"):"hsla(".concat(u,", ").concat(c,"%, ").concat(p,"%, ").concat(this.roundA,")")},o.prototype.toHex=function(i){return i===void 0&&(i=!1),wg(this.r,this.g,this.b,i)},o.prototype.toHexString=function(i){return i===void 0&&(i=!1),"#"+this.toHex(i)},o.prototype.toHex8=function(i){return i===void 0&&(i=!1),QS(this.r,this.g,this.b,this.a,i)},o.prototype.toHex8String=function(i){return i===void 0&&(i=!1),"#"+this.toHex8(i)},o.prototype.toHexShortString=function(i){return i===void 0&&(i=!1),this.a===1?this.toHexString(i):this.toHex8String(i)},o.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},o.prototype.toRgbString=function(){var i=Math.round(this.r),u=Math.round(this.g),c=Math.round(this.b);return this.a===1?"rgb(".concat(i,", ").concat(u,", ").concat(c,")"):"rgba(".concat(i,", ").concat(u,", ").concat(c,", ").concat(this.roundA,")")},o.prototype.toPercentageRgb=function(){var i=function(u){return"".concat(Math.round(pn(u,255)*100),"%")};return{r:i(this.r),g:i(this.g),b:i(this.b),a:this.a}},o.prototype.toPercentageRgbString=function(){var i=function(u){return Math.round(pn(u,255)*100)};return this.a===1?"rgb(".concat(i(this.r),"%, ").concat(i(this.g),"%, ").concat(i(this.b),"%)"):"rgba(".concat(i(this.r),"%, ").concat(i(this.g),"%, ").concat(i(this.b),"%, ").concat(this.roundA,")")},o.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var i="#"+wg(this.r,this.g,this.b,!1),u=0,c=Object.entries(Ld);u<c.length;u++){var p=c[u],f=p[0],v=p[1];if(i===v)return f}return!1},o.prototype.toString=function(i){var u=!!i;i=i??this.format;var c=!1,p=this.a<1&&this.a>=0,f=!u&&p&&(i.startsWith("hex")||i==="name");return f?i==="name"&&this.a===0?this.toName():this.toRgbString():(i==="rgb"&&(c=this.toRgbString()),i==="prgb"&&(c=this.toPercentageRgbString()),(i==="hex"||i==="hex6")&&(c=this.toHexString()),i==="hex3"&&(c=this.toHexString(!0)),i==="hex4"&&(c=this.toHex8String(!0)),i==="hex8"&&(c=this.toHex8String()),i==="name"&&(c=this.toName()),i==="hsl"&&(c=this.toHslString()),i==="hsv"&&(c=this.toHsvString()),c||this.toHexString())},o.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},o.prototype.clone=function(){return new o(this.toString())},o.prototype.lighten=function(i){i===void 0&&(i=10);var u=this.toHsl();return u.l+=i/100,u.l=ba(u.l),new o(u)},o.prototype.brighten=function(i){i===void 0&&(i=10);var u=this.toRgb();return u.r=Math.max(0,Math.min(255,u.r-Math.round(255*-(i/100)))),u.g=Math.max(0,Math.min(255,u.g-Math.round(255*-(i/100)))),u.b=Math.max(0,Math.min(255,u.b-Math.round(255*-(i/100)))),new o(u)},o.prototype.darken=function(i){i===void 0&&(i=10);var u=this.toHsl();return u.l-=i/100,u.l=ba(u.l),new o(u)},o.prototype.tint=function(i){return i===void 0&&(i=10),this.mix("white",i)},o.prototype.shade=function(i){return i===void 0&&(i=10),this.mix("black",i)},o.prototype.desaturate=function(i){i===void 0&&(i=10);var u=this.toHsl();return u.s-=i/100,u.s=ba(u.s),new o(u)},o.prototype.saturate=function(i){i===void 0&&(i=10);var u=this.toHsl();return u.s+=i/100,u.s=ba(u.s),new o(u)},o.prototype.greyscale=function(){return this.desaturate(100)},o.prototype.spin=function(i){var u=this.toHsl(),c=(u.h+i)%360;return u.h=c<0?360+c:c,new o(u)},o.prototype.mix=function(i,u){u===void 0&&(u=50);var c=this.toRgb(),p=new o(i).toRgb(),f=u/100,v={r:(p.r-c.r)*f+c.r,g:(p.g-c.g)*f+c.g,b:(p.b-c.b)*f+c.b,a:(p.a-c.a)*f+c.a};return new o(v)},o.prototype.analogous=function(i,u){i===void 0&&(i=6),u===void 0&&(u=30);var c=this.toHsl(),p=360/u,f=[this];for(c.h=(c.h-(p*i>>1)+720)%360;--i;)c.h=(c.h+p)%360,f.push(new o(c));return f},o.prototype.complement=function(){var i=this.toHsl();return i.h=(i.h+180)%360,new o(i)},o.prototype.monochromatic=function(i){i===void 0&&(i=6);for(var u=this.toHsv(),c=u.h,p=u.s,f=u.v,v=[],y=1/i;i--;)v.push(new o({h:c,s:p,v:f})),f=(f+y)%1;return v},o.prototype.splitcomplement=function(){var i=this.toHsl(),u=i.h;return[this,new o({h:(u+72)%360,s:i.s,l:i.l}),new o({h:(u+216)%360,s:i.s,l:i.l})]},o.prototype.onBackground=function(i){var u=this.toRgb(),c=new o(i).toRgb(),p=u.a+c.a*(1-u.a);return new o({r:(u.r*u.a+c.r*c.a*(1-u.a))/p,g:(u.g*u.a+c.g*c.a*(1-u.a))/p,b:(u.b*u.a+c.b*c.a*(1-u.a))/p,a:p})},o.prototype.triad=function(){return this.polyad(3)},o.prototype.tetrad=function(){return this.polyad(4)},o.prototype.polyad=function(i){for(var u=this.toHsl(),c=u.h,p=[this],f=360/i,v=1;v<i;v++)p.push(new o({h:(c+v*f)%360,s:u.s,l:u.l}));return p},o.prototype.equals=function(i){return this.toRgbString()===new o(i).toRgbString()},o}();function Fo(o,i=20){return o.mix("#141414",i).toString()}function aL(o){const i=vp(),u=Lo("button");return Oe(()=>{let c={};const p=o.color;if(p){const f=new iL(p),v=o.dark?f.tint(20).toString():Fo(f,20);if(o.plain)c=u.cssVarBlock({"bg-color":o.dark?Fo(f,90):f.tint(90).toString(),"text-color":p,"border-color":o.dark?Fo(f,50):f.tint(50).toString(),"hover-text-color":`var(${u.cssVarName("color-white")})`,"hover-bg-color":p,"hover-border-color":p,"active-bg-color":v,"active-text-color":`var(${u.cssVarName("color-white")})`,"active-border-color":v}),i.value&&(c[u.cssVarBlockName("disabled-bg-color")]=o.dark?Fo(f,90):f.tint(90).toString(),c[u.cssVarBlockName("disabled-text-color")]=o.dark?Fo(f,50):f.tint(50).toString(),c[u.cssVarBlockName("disabled-border-color")]=o.dark?Fo(f,80):f.tint(80).toString());else{const y=o.dark?Fo(f,30):f.tint(30).toString(),C=f.isDark()?`var(${u.cssVarName("color-white")})`:`var(${u.cssVarName("color-black")})`;if(c=u.cssVarBlock({"bg-color":p,"text-color":C,"border-color":p,"hover-bg-color":y,"hover-text-color":C,"hover-border-color":y,"active-bg-color":v,"active-border-color":v}),i.value){const T=o.dark?Fo(f,50):f.tint(50).toString();c[u.cssVarBlockName("disabled-bg-color")]=T,c[u.cssVarBlockName("disabled-text-color")]=o.dark?"rgba(255, 255, 255, 0.5)":`var(${u.cssVarName("color-white")})`,c[u.cssVarBlockName("disabled-border-color")]=T}}}return c})}const cL=ut({name:"ElButton"}),uL=ut({...cL,props:Sd,emits:YS,setup(o,{expose:i,emit:u}){const c=o,p=aL(c),f=Lo("button"),{_ref:v,_size:y,_type:C,_disabled:T,_props:L,shouldAddSpace:R,handleClick:k}=KS(c,u),x=Oe(()=>[f.b(),f.m(C.value),f.m(y.value),f.is("disabled",T.value),f.is("loading",c.loading),f.is("plain",c.plain),f.is("round",c.round),f.is("circle",c.circle),f.is("text",c.text),f.is("link",c.link),f.is("has-bg",c.bg)]);return i({ref:v,size:y,type:C,disabled:T,shouldAddSpace:R}),(N,G)=>(be(),Mt(Rn(N.tag),cr({ref_key:"_ref",ref:v},ge(L),{class:ge(x),style:ge(p),onClick:ge(k)}),{default:qt(()=>[N.loading?(be(),it(an,{key:0},[N.$slots.loading?Tn(N.$slots,"loading",{key:0}):(be(),Mt(ge(_o),{key:1,class:nt(ge(f).is("loading"))},{default:qt(()=>[(be(),Mt(Rn(N.loadingIcon)))]),_:1},8,["class"]))],64)):N.icon||N.$slots.icon?(be(),Mt(ge(_o),{key:1},{default:qt(()=>[N.icon?(be(),Mt(Rn(N.icon),{key:0})):Tn(N.$slots,"icon",{key:1})]),_:3})):Rt("v-if",!0),N.$slots.default?(be(),it("span",{key:2,class:nt({[ge(f).em("text","expand")]:ge(R)})},[Tn(N.$slots,"default")],2)):Rt("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var lL=Ps(uL,[["__file","button.vue"]]);const dL={size:Sd.size,type:Sd.type},pL=ut({name:"ElButtonGroup"}),fL=ut({...pL,props:dL,setup(o){const i=o;Do(Iv,ks({size:za(i,"size"),type:za(i,"type")}));const u=Lo("button");return(c,p)=>(be(),it("div",{class:nt(`${ge(u).b("group")}`)},[Tn(c.$slots,"default")],2))}});var Cv=Ps(fL,[["__file","button-group.vue"]]);const hL=Ec(lL,{ButtonGroup:Cv});UD(Cv);var Vn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mp(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Tv={exports:{}};(function(o,i){(function(u,c){o.exports=c()})(Vn,function(){var u=1e3,c=6e4,p=36e5,f="millisecond",v="second",y="minute",C="hour",T="day",L="week",R="month",k="quarter",x="year",N="date",G="Invalid Date",V=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,z=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,te={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(X){var Q=["th","st","nd","rd"],Y=X%100;return"["+X+(Q[(Y-20)%10]||Q[Y]||Q[0])+"]"}},q=function(X,Q,Y){var ue=String(X);return!ue||ue.length>=Q?X:""+Array(Q+1-ue.length).join(Y)+X},Ne={s:q,z:function(X){var Q=-X.utcOffset(),Y=Math.abs(Q),ue=Math.floor(Y/60),re=Y%60;return(Q<=0?"+":"-")+q(ue,2,"0")+":"+q(re,2,"0")},m:function X(Q,Y){if(Q.date()<Y.date())return-X(Y,Q);var ue=12*(Y.year()-Q.year())+(Y.month()-Q.month()),re=Q.clone().add(ue,R),Ee=Y-re<0,P=Q.clone().add(ue+(Ee?-1:1),R);return+(-(ue+(Y-re)/(Ee?re-P:P-re))||0)},a:function(X){return X<0?Math.ceil(X)||0:Math.floor(X)},p:function(X){return{M:R,y:x,w:L,d:T,D:N,h:C,m:y,s:v,ms:f,Q:k}[X]||String(X||"").toLowerCase().replace(/s$/,"")},u:function(X){return X===void 0}},Le="en",Se={};Se[Le]=te;var Ue="$isDayjsObject",ve=function(X){return X instanceof W||!(!X||!X[Ue])},ye=function X(Q,Y,ue){var re;if(!Q)return Le;if(typeof Q=="string"){var Ee=Q.toLowerCase();Se[Ee]&&(re=Ee),Y&&(Se[Ee]=Y,re=Ee);var P=Q.split("-");if(!re&&P.length>1)return X(P[0])}else{var he=Q.name;Se[he]=Q,re=he}return!ue&&re&&(Le=re),re||!ue&&Le},$=function(X,Q){if(ve(X))return X.clone();var Y=typeof Q=="object"?Q:{};return Y.date=X,Y.args=arguments,new W(Y)},I=Ne;I.l=ye,I.i=ve,I.w=function(X,Q){return $(X,{locale:Q.$L,utc:Q.$u,x:Q.$x,$offset:Q.$offset})};var W=function(){function X(Y){this.$L=ye(Y.locale,null,!0),this.parse(Y),this.$x=this.$x||Y.x||{},this[Ue]=!0}var Q=X.prototype;return Q.parse=function(Y){this.$d=function(ue){var re=ue.date,Ee=ue.utc;if(re===null)return new Date(NaN);if(I.u(re))return new Date;if(re instanceof Date)return new Date(re);if(typeof re=="string"&&!/Z$/i.test(re)){var P=re.match(V);if(P){var he=P[2]-1||0,Fe=(P[7]||"0").substring(0,3);return Ee?new Date(Date.UTC(P[1],he,P[3]||1,P[4]||0,P[5]||0,P[6]||0,Fe)):new Date(P[1],he,P[3]||1,P[4]||0,P[5]||0,P[6]||0,Fe)}}return new Date(re)}(Y),this.init()},Q.init=function(){var Y=this.$d;this.$y=Y.getFullYear(),this.$M=Y.getMonth(),this.$D=Y.getDate(),this.$W=Y.getDay(),this.$H=Y.getHours(),this.$m=Y.getMinutes(),this.$s=Y.getSeconds(),this.$ms=Y.getMilliseconds()},Q.$utils=function(){return I},Q.isValid=function(){return this.$d.toString()!==G},Q.isSame=function(Y,ue){var re=$(Y);return this.startOf(ue)<=re&&re<=this.endOf(ue)},Q.isAfter=function(Y,ue){return $(Y)<this.startOf(ue)},Q.isBefore=function(Y,ue){return this.endOf(ue)<$(Y)},Q.$g=function(Y,ue,re){return I.u(Y)?this[ue]:this.set(re,Y)},Q.unix=function(){return Math.floor(this.valueOf()/1e3)},Q.valueOf=function(){return this.$d.getTime()},Q.startOf=function(Y,ue){var re=this,Ee=!!I.u(ue)||ue,P=I.p(Y),he=function(De,Re){var Je=I.w(re.$u?Date.UTC(re.$y,Re,De):new Date(re.$y,Re,De),re);return Ee?Je:Je.endOf(T)},Fe=function(De,Re){return I.w(re.toDate()[De].apply(re.toDate("s"),(Ee?[0,0,0,0]:[23,59,59,999]).slice(Re)),re)},$e=this.$W,Xe=this.$M,ht=this.$D,at="set"+(this.$u?"UTC":"");switch(P){case x:return Ee?he(1,0):he(31,11);case R:return Ee?he(1,Xe):he(0,Xe+1);case L:var ie=this.$locale().weekStart||0,Ce=($e<ie?$e+7:$e)-ie;return he(Ee?ht-Ce:ht+(6-Ce),Xe);case T:case N:return Fe(at+"Hours",0);case C:return Fe(at+"Minutes",1);case y:return Fe(at+"Seconds",2);case v:return Fe(at+"Milliseconds",3);default:return this.clone()}},Q.endOf=function(Y){return this.startOf(Y,!1)},Q.$set=function(Y,ue){var re,Ee=I.p(Y),P="set"+(this.$u?"UTC":""),he=(re={},re[T]=P+"Date",re[N]=P+"Date",re[R]=P+"Month",re[x]=P+"FullYear",re[C]=P+"Hours",re[y]=P+"Minutes",re[v]=P+"Seconds",re[f]=P+"Milliseconds",re)[Ee],Fe=Ee===T?this.$D+(ue-this.$W):ue;if(Ee===R||Ee===x){var $e=this.clone().set(N,1);$e.$d[he](Fe),$e.init(),this.$d=$e.set(N,Math.min(this.$D,$e.daysInMonth())).$d}else he&&this.$d[he](Fe);return this.init(),this},Q.set=function(Y,ue){return this.clone().$set(Y,ue)},Q.get=function(Y){return this[I.p(Y)]()},Q.add=function(Y,ue){var re,Ee=this;Y=Number(Y);var P=I.p(ue),he=function(Xe){var ht=$(Ee);return I.w(ht.date(ht.date()+Math.round(Xe*Y)),Ee)};if(P===R)return this.set(R,this.$M+Y);if(P===x)return this.set(x,this.$y+Y);if(P===T)return he(1);if(P===L)return he(7);var Fe=(re={},re[y]=c,re[C]=p,re[v]=u,re)[P]||1,$e=this.$d.getTime()+Y*Fe;return I.w($e,this)},Q.subtract=function(Y,ue){return this.add(-1*Y,ue)},Q.format=function(Y){var ue=this,re=this.$locale();if(!this.isValid())return re.invalidDate||G;var Ee=Y||"YYYY-MM-DDTHH:mm:ssZ",P=I.z(this),he=this.$H,Fe=this.$m,$e=this.$M,Xe=re.weekdays,ht=re.months,at=re.meridiem,ie=function(Re,Je,b,w){return Re&&(Re[Je]||Re(ue,Ee))||b[Je].slice(0,w)},Ce=function(Re){return I.s(he%12||12,Re,"0")},De=at||function(Re,Je,b){var w=Re<12?"AM":"PM";return b?w.toLowerCase():w};return Ee.replace(z,function(Re,Je){return Je||function(b){switch(b){case"YY":return String(ue.$y).slice(-2);case"YYYY":return I.s(ue.$y,4,"0");case"M":return $e+1;case"MM":return I.s($e+1,2,"0");case"MMM":return ie(re.monthsShort,$e,ht,3);case"MMMM":return ie(ht,$e);case"D":return ue.$D;case"DD":return I.s(ue.$D,2,"0");case"d":return String(ue.$W);case"dd":return ie(re.weekdaysMin,ue.$W,Xe,2);case"ddd":return ie(re.weekdaysShort,ue.$W,Xe,3);case"dddd":return Xe[ue.$W];case"H":return String(he);case"HH":return I.s(he,2,"0");case"h":return Ce(1);case"hh":return Ce(2);case"a":return De(he,Fe,!0);case"A":return De(he,Fe,!1);case"m":return String(Fe);case"mm":return I.s(Fe,2,"0");case"s":return String(ue.$s);case"ss":return I.s(ue.$s,2,"0");case"SSS":return I.s(ue.$ms,3,"0");case"Z":return P}return null}(Re)||P.replace(":","")})},Q.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Q.diff=function(Y,ue,re){var Ee,P=this,he=I.p(ue),Fe=$(Y),$e=(Fe.utcOffset()-this.utcOffset())*c,Xe=this-Fe,ht=function(){return I.m(P,Fe)};switch(he){case x:Ee=ht()/12;break;case R:Ee=ht();break;case k:Ee=ht()/3;break;case L:Ee=(Xe-$e)/6048e5;break;case T:Ee=(Xe-$e)/864e5;break;case C:Ee=Xe/p;break;case y:Ee=Xe/c;break;case v:Ee=Xe/u;break;default:Ee=Xe}return re?Ee:I.a(Ee)},Q.daysInMonth=function(){return this.endOf(R).$D},Q.$locale=function(){return Se[this.$L]},Q.locale=function(Y,ue){if(!Y)return this.$L;var re=this.clone(),Ee=ye(Y,ue,!0);return Ee&&(re.$L=Ee),re},Q.clone=function(){return I.w(this.$d,this)},Q.toDate=function(){return new Date(this.valueOf())},Q.toJSON=function(){return this.isValid()?this.toISOString():null},Q.toISOString=function(){return this.$d.toISOString()},Q.toString=function(){return this.$d.toUTCString()},X}(),Z=W.prototype;return $.prototype=Z,[["$ms",f],["$s",v],["$m",y],["$H",C],["$W",T],["$M",R],["$y",x],["$D",N]].forEach(function(X){Z[X[1]]=function(Q){return this.$g(Q,X[0],X[1])}}),$.extend=function(X,Q){return X.$i||(X(Q,W,$),X.$i=!0),$},$.locale=ye,$.isDayjs=ve,$.unix=function(X){return $(1e3*X)},$.en=Se[Le],$.Ls=Se,$.p={},$})})(Tv);var gL=Tv.exports;const zO=Mp(gL),Rd="_trap-focus-children",ys=[],Fg=o=>{if(ys.length===0)return;const i=ys[ys.length-1][Rd];if(i.length>0&&o.code===ur.tab){if(i.length===1){o.preventDefault(),document.activeElement!==i[0]&&i[0].focus();return}const u=o.shiftKey,c=o.target===i[0],p=o.target===i[i.length-1];c&&u&&(o.preventDefault(),i[i.length-1].focus()),p&&!u&&(o.preventDefault(),i[0].focus())}},_L={beforeMount(o){o[Rd]=rg(o),ys.push(o),ys.length<=1&&document.addEventListener("keydown",Fg)},updated(o){dn(()=>{o[Rd]=rg(o)})},unmounted(){ys.shift(),ys.length===0&&document.removeEventListener("keydown",Fg)}},mL=Ns({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:En([String,Array,Object])},zIndex:{type:En([String,Number])}}),vL={click:o=>o instanceof MouseEvent},yL="overlay";var IL=ut({name:"ElOverlay",props:mL,emits:vL,setup(o,{slots:i,emit:u}){const c=Lo(yL),p=C=>{u("click",C)},{onClick:f,onMousedown:v,onMouseup:y}=uv(o.customMaskEvent?void 0:p);return()=>o.mask?kt("div",{class:[c.b(),o.overlayClass],style:{zIndex:o.zIndex},onClick:f,onMousedown:v,onMouseup:y},[Tn(i,"default")],Va.STYLE|Va.CLASS|Va.PROPS,["onClick","onMouseup","onMousedown"]):vc("div",{class:o.overlayClass,style:{zIndex:o.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[Tn(i,"default")])}});const ML=IL,CL=ut({name:"ElMessageBox",directives:{TrapFocus:_L},components:{ElButton:hL,ElFocusTrap:HS,ElInput:AS,ElOverlay:ML,ElIcon:_o,...bD},inheritAttrs:!1,props:{buttonSize:{type:String,validator:FD},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(o,{emit:i}){const{locale:u,zIndex:c,ns:p,size:f}=hv("message-box",Oe(()=>o.buttonSize)),{t:v}=u,{nextZIndex:y}=c,C=pt(!1),T=ks({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:y()}),L=Oe(()=>{const Y=T.type;return{[p.bm("icon",Y)]:Y&&oc[Y]}}),R=Dd(),k=Dd(),x=Oe(()=>T.icon||oc[T.type]||""),N=Oe(()=>!!T.message),G=pt(),V=pt(),z=pt(),te=pt(),q=pt(),Ne=Oe(()=>T.confirmButtonClass);Ht(()=>T.inputValue,async Y=>{await dn(),o.boxType==="prompt"&&Y!==null&&W()},{immediate:!0}),Ht(()=>C.value,Y=>{var ue,re;Y&&(o.boxType!=="prompt"&&(T.autofocus?z.value=(re=(ue=q.value)==null?void 0:ue.$el)!=null?re:G.value:z.value=G.value),T.zIndex=y()),o.boxType==="prompt"&&(Y?dn().then(()=>{var Ee;te.value&&te.value.$el&&(T.autofocus?z.value=(Ee=Z())!=null?Ee:G.value:z.value=G.value)}):(T.editorErrorMessage="",T.validateError=!1))});const Le=Oe(()=>o.draggable),Se=Oe(()=>o.overflow);jD(G,V,Le,Se),so(async()=>{await dn(),o.closeOnHashChange&&window.addEventListener("hashchange",Ue)}),As(()=>{o.closeOnHashChange&&window.removeEventListener("hashchange",Ue)});function Ue(){C.value&&(C.value=!1,dn(()=>{T.action&&i("action",T.action)}))}const ve=()=>{o.closeOnClickModal&&I(T.distinguishCancelAndClose?"close":"cancel")},ye=uv(ve),$=Y=>{if(T.inputType!=="textarea")return Y.preventDefault(),I("confirm")},I=Y=>{var ue;o.boxType==="prompt"&&Y==="confirm"&&!W()||(T.action=Y,T.beforeClose?(ue=T.beforeClose)==null||ue.call(T,Y,T,Ue):Ue())},W=()=>{if(o.boxType==="prompt"){const Y=T.inputPattern;if(Y&&!Y.test(T.inputValue||""))return T.editorErrorMessage=T.inputErrorMessage||v("el.messagebox.error"),T.validateError=!0,!1;const ue=T.inputValidator;if(typeof ue=="function"){const re=ue(T.inputValue);if(re===!1)return T.editorErrorMessage=T.inputErrorMessage||v("el.messagebox.error"),T.validateError=!0,!1;if(typeof re=="string")return T.editorErrorMessage=re,T.validateError=!0,!1}}return T.editorErrorMessage="",T.validateError=!1,!0},Z=()=>{const Y=te.value.$refs;return Y.input||Y.textarea},X=()=>{I("close")},Q=()=>{o.closeOnPressEscape&&X()};return o.lockScroll&&ZD(C),{...$_(T),ns:p,overlayEvent:ye,visible:C,hasMessage:N,typeClass:L,contentId:R,inputId:k,btnSize:f,iconComponent:x,confirmButtonClasses:Ne,rootRef:G,focusStartRef:z,headerRef:V,inputRef:te,confirmRef:q,doClose:Ue,handleClose:X,onCloseRequested:Q,handleWrapperClick:ve,handleInputEnter:$,handleAction:I,t:v}}}),TL=["aria-label","aria-describedby"],EL=["aria-label"],DL=["id"];function SL(o,i,u,c,p,f){const v=fs("el-icon"),y=fs("close"),C=fs("el-input"),T=fs("el-button"),L=fs("el-focus-trap"),R=fs("el-overlay");return be(),Mt(yc,{name:"fade-in-linear",onAfterLeave:i[11]||(i[11]=k=>o.$emit("vanish")),persisted:""},{default:qt(()=>[Ti(kt(R,{"z-index":o.zIndex,"overlay-class":[o.ns.is("message-box"),o.modalClass],mask:o.modal},{default:qt(()=>[ze("div",{role:"dialog","aria-label":o.title,"aria-modal":"true","aria-describedby":o.showInput?void 0:o.contentId,class:nt(`${o.ns.namespace.value}-overlay-message-box`),onClick:i[8]||(i[8]=(...k)=>o.overlayEvent.onClick&&o.overlayEvent.onClick(...k)),onMousedown:i[9]||(i[9]=(...k)=>o.overlayEvent.onMousedown&&o.overlayEvent.onMousedown(...k)),onMouseup:i[10]||(i[10]=(...k)=>o.overlayEvent.onMouseup&&o.overlayEvent.onMouseup(...k))},[kt(L,{loop:"",trapped:o.visible,"focus-trap-el":o.rootRef,"focus-start-el":o.focusStartRef,onReleaseRequested:o.onCloseRequested},{default:qt(()=>[ze("div",{ref:"rootRef",class:nt([o.ns.b(),o.customClass,o.ns.is("draggable",o.draggable),{[o.ns.m("center")]:o.center}]),style:So(o.customStyle),tabindex:"-1",onClick:i[7]||(i[7]=or(()=>{},["stop"]))},[o.title!==null&&o.title!==void 0?(be(),it("div",{key:0,ref:"headerRef",class:nt([o.ns.e("header"),{"show-close":o.showClose}])},[ze("div",{class:nt(o.ns.e("title"))},[o.iconComponent&&o.center?(be(),Mt(v,{key:0,class:nt([o.ns.e("status"),o.typeClass])},{default:qt(()=>[(be(),Mt(Rn(o.iconComponent)))]),_:1},8,["class"])):Rt("v-if",!0),ze("span",null,Qn(o.title),1)],2),o.showClose?(be(),it("button",{key:0,type:"button",class:nt(o.ns.e("headerbtn")),"aria-label":o.t("el.messagebox.close"),onClick:i[0]||(i[0]=k=>o.handleAction(o.distinguishCancelAndClose?"close":"cancel")),onKeydown:i[1]||(i[1]=ka(or(k=>o.handleAction(o.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"]))},[kt(v,{class:nt(o.ns.e("close"))},{default:qt(()=>[kt(y)]),_:1},8,["class"])],42,EL)):Rt("v-if",!0)],2)):Rt("v-if",!0),ze("div",{id:o.contentId,class:nt(o.ns.e("content"))},[ze("div",{class:nt(o.ns.e("container"))},[o.iconComponent&&!o.center&&o.hasMessage?(be(),Mt(v,{key:0,class:nt([o.ns.e("status"),o.typeClass])},{default:qt(()=>[(be(),Mt(Rn(o.iconComponent)))]),_:1},8,["class"])):Rt("v-if",!0),o.hasMessage?(be(),it("div",{key:1,class:nt(o.ns.e("message"))},[Tn(o.$slots,"default",{},()=>[o.dangerouslyUseHTMLString?(be(),Mt(Rn(o.showInput?"label":"p"),{key:1,for:o.showInput?o.inputId:void 0,innerHTML:o.message},null,8,["for","innerHTML"])):(be(),Mt(Rn(o.showInput?"label":"p"),{key:0,for:o.showInput?o.inputId:void 0},{default:qt(()=>[xa(Qn(o.dangerouslyUseHTMLString?"":o.message),1)]),_:1},8,["for"]))])],2)):Rt("v-if",!0)],2),Ti(ze("div",{class:nt(o.ns.e("input"))},[kt(C,{id:o.inputId,ref:"inputRef",modelValue:o.inputValue,"onUpdate:modelValue":i[2]||(i[2]=k=>o.inputValue=k),type:o.inputType,placeholder:o.inputPlaceholder,"aria-invalid":o.validateError,class:nt({invalid:o.validateError}),onKeydown:ka(o.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),ze("div",{class:nt(o.ns.e("errormsg")),style:So({visibility:o.editorErrorMessage?"visible":"hidden"})},Qn(o.editorErrorMessage),7)],2),[[Ri,o.showInput]])],10,DL),ze("div",{class:nt(o.ns.e("btns"))},[o.showCancelButton?(be(),Mt(T,{key:0,loading:o.cancelButtonLoading,class:nt([o.cancelButtonClass]),round:o.roundButton,size:o.btnSize,onClick:i[3]||(i[3]=k=>o.handleAction("cancel")),onKeydown:i[4]||(i[4]=ka(or(k=>o.handleAction("cancel"),["prevent"]),["enter"]))},{default:qt(()=>[xa(Qn(o.cancelButtonText||o.t("el.messagebox.cancel")),1)]),_:1},8,["loading","class","round","size"])):Rt("v-if",!0),Ti(kt(T,{ref:"confirmRef",type:"primary",loading:o.confirmButtonLoading,class:nt([o.confirmButtonClasses]),round:o.roundButton,disabled:o.confirmButtonDisabled,size:o.btnSize,onClick:i[5]||(i[5]=k=>o.handleAction("confirm")),onKeydown:i[6]||(i[6]=ka(or(k=>o.handleAction("confirm"),["prevent"]),["enter"]))},{default:qt(()=>[xa(Qn(o.confirmButtonText||o.t("el.messagebox.confirm")),1)]),_:1},8,["loading","class","round","disabled","size"]),[[Ri,o.showConfirmButton]])],2)],6)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,TL)]),_:3},8,["z-index","overlay-class","mask"]),[[Ri,o.visible]])]),_:3})}var LL=Ps(CL,[["render",SL],["__file","index.vue"]]);const Hi=new Map,RL=o=>{let i=document.body;return o.appendTo&&(Ct(o.appendTo)&&(i=document.querySelector(o.appendTo)),nc(o.appendTo)&&(i=o.appendTo),nc(i)||(i=document.body)),i},kL=(o,i,u=null)=>{const c=kt(LL,o,Ze(o.message)||no(o.message)?{default:Ze(o.message)?o.message:()=>o.message}:null);return c.appContext=u,ec(c,i),RL(o).appendChild(i.firstElementChild),c.component},AL=()=>document.createElement("div"),OL=(o,i)=>{const u=AL();o.onVanish=()=>{ec(null,u),Hi.delete(p)},o.onAction=f=>{const v=Hi.get(p);let y;o.showInput?y={value:p.inputValue,action:f}:y=f,o.callback?o.callback(y,c.proxy):f==="cancel"||f==="close"?o.distinguishCancelAndClose&&f!=="cancel"?v.reject("close"):v.reject("cancel"):v.resolve(y)};const c=kL(o,u,i),p=c.proxy;for(const f in o)ft(o,f)&&!ft(p.$props,f)&&(p[f]=o[f]);return p.visible=!0,p};function _r(o,i=null){if(!Pn)return Promise.reject();let u;return Ct(o)||no(o)?o={message:o}:u=o.callback,new Promise((c,p)=>{const f=OL(o,i??_r._context);Hi.set(f,{options:o,callback:u,resolve:c,reject:p})})}const NL=["alert","confirm","prompt"],PL={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};NL.forEach(o=>{_r[o]=bL(o)});function bL(o){return(i,u,c,p)=>{let f="";return Tt(u)?(c=u,f=""):Ym(u)?f="":f=u,_r(Object.assign({title:f,message:i,type:"",...PL[o]},c,{boxType:o}),p)}}_r.close=()=>{Hi.forEach((o,i)=>{i.doClose()}),Hi.clear()};_r._context=null;const Ho=_r;Ho.install=o=>{Ho._context=o._context,o.config.globalProperties.$msgbox=Ho,o.config.globalProperties.$messageBox=Ho,o.config.globalProperties.$alert=Ho.alert,o.config.globalProperties.$confirm=Ho.confirm,o.config.globalProperties.$prompt=Ho.prompt};const xg=Ho,Ev=["success","info","warning","error"],GL=Ns({customClass:{type:String,default:""},dangerouslyUseHTMLString:{type:Boolean,default:!1},duration:{type:Number,default:4500},icon:{type:Bi},id:{type:String,default:""},message:{type:En([String,Object]),default:""},offset:{type:Number,default:0},onClick:{type:En(Function),default:()=>{}},onClose:{type:En(Function),required:!0},position:{type:String,values:["top-right","top-left","bottom-right","bottom-left"],default:"top-right"},showClose:{type:Boolean,default:!0},title:{type:String,default:""},type:{type:String,values:[...Ev,""],default:""},zIndex:Number}),wL={destroy:()=>!0},UL=["id"],FL=["textContent"],xL={key:0},qL=["innerHTML"],VL=ut({name:"ElNotification"}),BL=ut({...VL,props:GL,emits:wL,setup(o,{expose:i}){const u=o,{ns:c,zIndex:p}=hv("notification"),{nextZIndex:f,currentZIndex:v}=p,{Close:y}=PD,C=pt(!1);let T;const L=Oe(()=>{const q=u.type;return q&&oc[u.type]?c.m(q):""}),R=Oe(()=>u.type&&oc[u.type]||u.icon),k=Oe(()=>u.position.endsWith("right")?"right":"left"),x=Oe(()=>u.position.startsWith("top")?"top":"bottom"),N=Oe(()=>{var q;return{[x.value]:`${u.offset}px`,zIndex:(q=u.zIndex)!=null?q:v.value}});function G(){u.duration>0&&({stop:T}=yT(()=>{C.value&&z()},u.duration))}function V(){T==null||T()}function z(){C.value=!1}function te({code:q}){q===ur.delete||q===ur.backspace?V():q===ur.esc?C.value&&z():G()}return so(()=>{G(),f(),C.value=!0}),ki(document,"keydown",te),i({visible:C,close:z}),(q,Ne)=>(be(),Mt(yc,{name:ge(c).b("fade"),onBeforeLeave:q.onClose,onAfterLeave:Ne[1]||(Ne[1]=Le=>q.$emit("destroy")),persisted:""},{default:qt(()=>[Ti(ze("div",{id:q.id,class:nt([ge(c).b(),q.customClass,ge(k)]),style:So(ge(N)),role:"alert",onMouseenter:V,onMouseleave:G,onClick:Ne[0]||(Ne[0]=(...Le)=>q.onClick&&q.onClick(...Le))},[ge(R)?(be(),Mt(ge(_o),{key:0,class:nt([ge(c).e("icon"),ge(L)])},{default:qt(()=>[(be(),Mt(Rn(ge(R))))]),_:1},8,["class"])):Rt("v-if",!0),ze("div",{class:nt(ge(c).e("group"))},[ze("h2",{class:nt(ge(c).e("title")),textContent:Qn(q.title)},null,10,FL),Ti(ze("div",{class:nt(ge(c).e("content")),style:So(q.title?void 0:{margin:0})},[Tn(q.$slots,"default",{},()=>[q.dangerouslyUseHTMLString?(be(),it(an,{key:1},[Rt(" Caution here, message could've been compromised, never use user's input as message "),ze("p",{innerHTML:q.message},null,8,qL)],2112)):(be(),it("p",xL,Qn(q.message),1))])],6),[[Ri,q.message]]),q.showClose?(be(),Mt(ge(_o),{key:0,class:nt(ge(c).e("closeBtn")),onClick:or(z,["stop"])},{default:qt(()=>[kt(ge(y))]),_:1},8,["class","onClick"])):Rt("v-if",!0)],2)],46,UL),[[Ri,C.value]])]),_:3},8,["name","onBeforeLeave"]))}});var HL=Ps(BL,[["__file","notification.vue"]]);const rc={"top-left":[],"top-right":[],"bottom-left":[],"bottom-right":[]},kd=16;let KL=1;const pr=function(o={},i=null){if(!Pn)return{close:()=>{}};(typeof o=="string"||no(o))&&(o={message:o});const u=o.position||"top-right";let c=o.offset||0;rc[u].forEach(({vm:L})=>{var R;c+=(((R=L.el)==null?void 0:R.offsetHeight)||0)+kd}),c+=kd;const p=`notification_${KL++}`,f=o.onClose,v={...o,offset:c,id:p,onClose:()=>{jL(p,u,f)}};let y=document.body;nc(o.appendTo)?y=o.appendTo:Ct(o.appendTo)&&(y=document.querySelector(o.appendTo)),nc(y)||(y=document.body);const C=document.createElement("div"),T=kt(HL,v,no(v.message)?{default:()=>v.message}:null);return T.appContext=i??pr._context,T.props.onDestroy=()=>{ec(null,C)},ec(T,C),rc[u].push({vm:T}),y.appendChild(C.firstElementChild),{close:()=>{T.component.exposed.visible.value=!1}}};Ev.forEach(o=>{pr[o]=(i={})=>((typeof i=="string"||no(i))&&(i={message:i}),pr({...i,type:o}))});function jL(o,i,u){const c=rc[i],p=c.findIndex(({vm:T})=>{var L;return((L=T.component)==null?void 0:L.props.id)===o});if(p===-1)return;const{vm:f}=c[p];if(!f)return;u==null||u(f);const v=f.el.offsetHeight,y=i.split("-")[0];c.splice(p,1);const C=c.length;if(!(C<1))for(let T=p;T<C;T++){const{el:L,component:R}=c[T].vm,k=Number.parseInt(L.style[y],10)-v-kd;R.props.offset=k}}function WL(){for(const o of Object.values(rc))o.forEach(({vm:i})=>{i.component.exposed.visible.value=!1})}pr.closeAll=WL;pr._context=null;const Ai=wD(pr,"$notify"),YL=(o,i,u)=>{const c=o[i];return c?typeof c=="function"?c():Promise.resolve(c):new Promise((p,f)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(f.bind(null,new Error("Unknown variable dynamic import: "+i+(i.split("/").length!==u?". Note that variables only represent file names one level deep.":""))))})};/*!
  * vue-router v4.3.2
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const nr=typeof document<"u";function zL(o){return o.__esModule||o[Symbol.toStringTag]==="Module"}const At=Object.assign;function nd(o,i){const u={};for(const c in i){const p=i[c];u[c]=oo(p)?p.map(o):o(p)}return u}const Oi=()=>{},oo=Array.isArray,Dv=/#/g,$L=/&/g,JL=/\//g,XL=/=/g,ZL=/\?/g,Sv=/\+/g,QL=/%5B/g,eR=/%5D/g,Lv=/%5E/g,tR=/%60/g,Rv=/%7B/g,nR=/%7C/g,kv=/%7D/g,oR=/%20/g;function Cp(o){return encodeURI(""+o).replace(nR,"|").replace(QL,"[").replace(eR,"]")}function sR(o){return Cp(o).replace(Rv,"{").replace(kv,"}").replace(Lv,"^")}function Ad(o){return Cp(o).replace(Sv,"%2B").replace(oR,"+").replace(Dv,"%23").replace($L,"%26").replace(tR,"`").replace(Rv,"{").replace(kv,"}").replace(Lv,"^")}function rR(o){return Ad(o).replace(XL,"%3D")}function iR(o){return Cp(o).replace(Dv,"%23").replace(ZL,"%3F")}function aR(o){return o==null?"":iR(o).replace(JL,"%2F")}function Ki(o){try{return decodeURIComponent(""+o)}catch{}return""+o}const cR=/\/$/,uR=o=>o.replace(cR,"");function od(o,i,u="/"){let c,p={},f="",v="";const y=i.indexOf("#");let C=i.indexOf("?");return y<C&&y>=0&&(C=-1),C>-1&&(c=i.slice(0,C),f=i.slice(C+1,y>-1?y:i.length),p=o(f)),y>-1&&(c=c||i.slice(0,y),v=i.slice(y,i.length)),c=fR(c??i,u),{fullPath:c+(f&&"?")+f+v,path:c,query:p,hash:Ki(v)}}function lR(o,i){const u=i.query?o(i.query):"";return i.path+(u&&"?")+u+(i.hash||"")}function qg(o,i){return!i||!o.toLowerCase().startsWith(i.toLowerCase())?o:o.slice(i.length)||"/"}function dR(o,i,u){const c=i.matched.length-1,p=u.matched.length-1;return c>-1&&c===p&&fr(i.matched[c],u.matched[p])&&Av(i.params,u.params)&&o(i.query)===o(u.query)&&i.hash===u.hash}function fr(o,i){return(o.aliasOf||o)===(i.aliasOf||i)}function Av(o,i){if(Object.keys(o).length!==Object.keys(i).length)return!1;for(const u in o)if(!pR(o[u],i[u]))return!1;return!0}function pR(o,i){return oo(o)?Vg(o,i):oo(i)?Vg(i,o):o===i}function Vg(o,i){return oo(i)?o.length===i.length&&o.every((u,c)=>u===i[c]):o.length===1&&o[0]===i}function fR(o,i){if(o.startsWith("/"))return o;if(!o)return i;const u=i.split("/"),c=o.split("/"),p=c[c.length-1];(p===".."||p===".")&&c.push("");let f=u.length-1,v,y;for(v=0;v<c.length;v++)if(y=c[v],y!==".")if(y==="..")f>1&&f--;else break;return u.slice(0,f).join("/")+"/"+c.slice(v).join("/")}var ji;(function(o){o.pop="pop",o.push="push"})(ji||(ji={}));var Ni;(function(o){o.back="back",o.forward="forward",o.unknown=""})(Ni||(Ni={}));function hR(o){if(!o)if(nr){const i=document.querySelector("base");o=i&&i.getAttribute("href")||"/",o=o.replace(/^\w+:\/\/[^\/]+/,"")}else o="/";return o[0]!=="/"&&o[0]!=="#"&&(o="/"+o),uR(o)}const gR=/^[^#]+#/;function _R(o,i){return o.replace(gR,"#")+i}function mR(o,i){const u=document.documentElement.getBoundingClientRect(),c=o.getBoundingClientRect();return{behavior:i.behavior,left:c.left-u.left-(i.left||0),top:c.top-u.top-(i.top||0)}}const Lc=()=>({left:window.scrollX,top:window.scrollY});function vR(o){let i;if("el"in o){const u=o.el,c=typeof u=="string"&&u.startsWith("#"),p=typeof u=="string"?c?document.getElementById(u.slice(1)):document.querySelector(u):u;if(!p)return;i=mR(p,o)}else i=o;"scrollBehavior"in document.documentElement.style?window.scrollTo(i):window.scrollTo(i.left!=null?i.left:window.scrollX,i.top!=null?i.top:window.scrollY)}function Bg(o,i){return(history.state?history.state.position-i:-1)+o}const Od=new Map;function yR(o,i){Od.set(o,i)}function IR(o){const i=Od.get(o);return Od.delete(o),i}let MR=()=>location.protocol+"//"+location.host;function Ov(o,i){const{pathname:u,search:c,hash:p}=i,f=o.indexOf("#");if(f>-1){let y=p.includes(o.slice(f))?o.slice(f).length:1,C=p.slice(y);return C[0]!=="/"&&(C="/"+C),qg(C,"")}return qg(u,o)+c+p}function CR(o,i,u,c){let p=[],f=[],v=null;const y=({state:k})=>{const x=Ov(o,location),N=u.value,G=i.value;let V=0;if(k){if(u.value=x,i.value=k,v&&v===N){v=null;return}V=G?k.position-G.position:0}else c(x);p.forEach(z=>{z(u.value,N,{delta:V,type:ji.pop,direction:V?V>0?Ni.forward:Ni.back:Ni.unknown})})};function C(){v=u.value}function T(k){p.push(k);const x=()=>{const N=p.indexOf(k);N>-1&&p.splice(N,1)};return f.push(x),x}function L(){const{history:k}=window;k.state&&k.replaceState(At({},k.state,{scroll:Lc()}),"")}function R(){for(const k of f)k();f=[],window.removeEventListener("popstate",y),window.removeEventListener("beforeunload",L)}return window.addEventListener("popstate",y),window.addEventListener("beforeunload",L,{passive:!0}),{pauseListeners:C,listen:T,destroy:R}}function Hg(o,i,u,c=!1,p=!1){return{back:o,current:i,forward:u,replaced:c,position:window.history.length,scroll:p?Lc():null}}function TR(o){const{history:i,location:u}=window,c={value:Ov(o,u)},p={value:i.state};p.value||f(c.value,{back:null,current:c.value,forward:null,position:i.length-1,replaced:!0,scroll:null},!0);function f(C,T,L){const R=o.indexOf("#"),k=R>-1?(u.host&&document.querySelector("base")?o:o.slice(R))+C:MR()+o+C;try{i[L?"replaceState":"pushState"](T,"",k),p.value=T}catch(x){console.error(x),u[L?"replace":"assign"](k)}}function v(C,T){const L=At({},i.state,Hg(p.value.back,C,p.value.forward,!0),T,{position:p.value.position});f(C,L,!0),c.value=C}function y(C,T){const L=At({},p.value,i.state,{forward:C,scroll:Lc()});f(L.current,L,!0);const R=At({},Hg(c.value,C,null),{position:L.position+1},T);f(C,R,!1),c.value=C}return{location:c,state:p,push:y,replace:v}}function ER(o){o=hR(o);const i=TR(o),u=CR(o,i.state,i.location,i.replace);function c(f,v=!0){v||u.pauseListeners(),history.go(f)}const p=At({location:"",base:o,go:c,createHref:_R.bind(null,o)},i,u);return Object.defineProperty(p,"location",{enumerable:!0,get:()=>i.location.value}),Object.defineProperty(p,"state",{enumerable:!0,get:()=>i.state.value}),p}function DR(o){return typeof o=="string"||o&&typeof o=="object"}function Nv(o){return typeof o=="string"||typeof o=="symbol"}const xo={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Pv=Symbol("");var Kg;(function(o){o[o.aborted=4]="aborted",o[o.cancelled=8]="cancelled",o[o.duplicated=16]="duplicated"})(Kg||(Kg={}));function hr(o,i){return At(new Error,{type:o,[Pv]:!0},i)}function Co(o,i){return o instanceof Error&&Pv in o&&(i==null||!!(o.type&i))}const jg="[^/]+?",SR={sensitive:!1,strict:!1,start:!0,end:!0},LR=/[.+*?^${}()[\]/\\]/g;function RR(o,i){const u=At({},SR,i),c=[];let p=u.start?"^":"";const f=[];for(const T of o){const L=T.length?[]:[90];u.strict&&!T.length&&(p+="/");for(let R=0;R<T.length;R++){const k=T[R];let x=40+(u.sensitive?.25:0);if(k.type===0)R||(p+="/"),p+=k.value.replace(LR,"\\$&"),x+=40;else if(k.type===1){const{value:N,repeatable:G,optional:V,regexp:z}=k;f.push({name:N,repeatable:G,optional:V});const te=z||jg;if(te!==jg){x+=10;try{new RegExp(`(${te})`)}catch(Ne){throw new Error(`Invalid custom RegExp for param "${N}" (${te}): `+Ne.message)}}let q=G?`((?:${te})(?:/(?:${te}))*)`:`(${te})`;R||(q=V&&T.length<2?`(?:/${q})`:"/"+q),V&&(q+="?"),p+=q,x+=20,V&&(x+=-8),G&&(x+=-20),te===".*"&&(x+=-50)}L.push(x)}c.push(L)}if(u.strict&&u.end){const T=c.length-1;c[T][c[T].length-1]+=.7000000000000001}u.strict||(p+="/?"),u.end?p+="$":u.strict&&(p+="(?:/|$)");const v=new RegExp(p,u.sensitive?"":"i");function y(T){const L=T.match(v),R={};if(!L)return null;for(let k=1;k<L.length;k++){const x=L[k]||"",N=f[k-1];R[N.name]=x&&N.repeatable?x.split("/"):x}return R}function C(T){let L="",R=!1;for(const k of o){(!R||!L.endsWith("/"))&&(L+="/"),R=!1;for(const x of k)if(x.type===0)L+=x.value;else if(x.type===1){const{value:N,repeatable:G,optional:V}=x,z=N in T?T[N]:"";if(oo(z)&&!G)throw new Error(`Provided param "${N}" is an array but it is not repeatable (* or + modifiers)`);const te=oo(z)?z.join("/"):z;if(!te)if(V)k.length<2&&(L.endsWith("/")?L=L.slice(0,-1):R=!0);else throw new Error(`Missing required param "${N}"`);L+=te}}return L||"/"}return{re:v,score:c,keys:f,parse:y,stringify:C}}function kR(o,i){let u=0;for(;u<o.length&&u<i.length;){const c=i[u]-o[u];if(c)return c;u++}return o.length<i.length?o.length===1&&o[0]===80?-1:1:o.length>i.length?i.length===1&&i[0]===80?1:-1:0}function AR(o,i){let u=0;const c=o.score,p=i.score;for(;u<c.length&&u<p.length;){const f=kR(c[u],p[u]);if(f)return f;u++}if(Math.abs(p.length-c.length)===1){if(Wg(c))return 1;if(Wg(p))return-1}return p.length-c.length}function Wg(o){const i=o[o.length-1];return o.length>0&&i[i.length-1]<0}const OR={type:0,value:""},NR=/[a-zA-Z0-9_]/;function PR(o){if(!o)return[[]];if(o==="/")return[[OR]];if(!o.startsWith("/"))throw new Error(`Invalid path "${o}"`);function i(x){throw new Error(`ERR (${u})/"${T}": ${x}`)}let u=0,c=u;const p=[];let f;function v(){f&&p.push(f),f=[]}let y=0,C,T="",L="";function R(){T&&(u===0?f.push({type:0,value:T}):u===1||u===2||u===3?(f.length>1&&(C==="*"||C==="+")&&i(`A repeatable param (${T}) must be alone in its segment. eg: '/:ids+.`),f.push({type:1,value:T,regexp:L,repeatable:C==="*"||C==="+",optional:C==="*"||C==="?"})):i("Invalid state to consume buffer"),T="")}function k(){T+=C}for(;y<o.length;){if(C=o[y++],C==="\\"&&u!==2){c=u,u=4;continue}switch(u){case 0:C==="/"?(T&&R(),v()):C===":"?(R(),u=1):k();break;case 4:k(),u=c;break;case 1:C==="("?u=2:NR.test(C)?k():(R(),u=0,C!=="*"&&C!=="?"&&C!=="+"&&y--);break;case 2:C===")"?L[L.length-1]=="\\"?L=L.slice(0,-1)+C:u=3:L+=C;break;case 3:R(),u=0,C!=="*"&&C!=="?"&&C!=="+"&&y--,L="";break;default:i("Unknown state");break}}return u===2&&i(`Unfinished custom RegExp for param "${T}"`),R(),v(),p}function bR(o,i,u){const c=RR(PR(o.path),u),p=At(c,{record:o,parent:i,children:[],alias:[]});return i&&!p.record.aliasOf==!i.record.aliasOf&&i.children.push(p),p}function GR(o,i){const u=[],c=new Map;i=$g({strict:!1,end:!0,sensitive:!1},i);function p(L){return c.get(L)}function f(L,R,k){const x=!k,N=wR(L);N.aliasOf=k&&k.record;const G=$g(i,L),V=[N];if("alias"in L){const q=typeof L.alias=="string"?[L.alias]:L.alias;for(const Ne of q)V.push(At({},N,{components:k?k.record.components:N.components,path:Ne,aliasOf:k?k.record:N}))}let z,te;for(const q of V){const{path:Ne}=q;if(R&&Ne[0]!=="/"){const Le=R.record.path,Se=Le[Le.length-1]==="/"?"":"/";q.path=R.record.path+(Ne&&Se+Ne)}if(z=bR(q,R,G),k?k.alias.push(z):(te=te||z,te!==z&&te.alias.push(z),x&&L.name&&!zg(z)&&v(L.name)),N.children){const Le=N.children;for(let Se=0;Se<Le.length;Se++)f(Le[Se],z,k&&k.children[Se])}k=k||z,(z.record.components&&Object.keys(z.record.components).length||z.record.name||z.record.redirect)&&C(z)}return te?()=>{v(te)}:Oi}function v(L){if(Nv(L)){const R=c.get(L);R&&(c.delete(L),u.splice(u.indexOf(R),1),R.children.forEach(v),R.alias.forEach(v))}else{const R=u.indexOf(L);R>-1&&(u.splice(R,1),L.record.name&&c.delete(L.record.name),L.children.forEach(v),L.alias.forEach(v))}}function y(){return u}function C(L){let R=0;for(;R<u.length&&AR(L,u[R])>=0&&(L.record.path!==u[R].record.path||!bv(L,u[R]));)R++;u.splice(R,0,L),L.record.name&&!zg(L)&&c.set(L.record.name,L)}function T(L,R){let k,x={},N,G;if("name"in L&&L.name){if(k=c.get(L.name),!k)throw hr(1,{location:L});G=k.record.name,x=At(Yg(R.params,k.keys.filter(te=>!te.optional).concat(k.parent?k.parent.keys.filter(te=>te.optional):[]).map(te=>te.name)),L.params&&Yg(L.params,k.keys.map(te=>te.name))),N=k.stringify(x)}else if(L.path!=null)N=L.path,k=u.find(te=>te.re.test(N)),k&&(x=k.parse(N),G=k.record.name);else{if(k=R.name?c.get(R.name):u.find(te=>te.re.test(R.path)),!k)throw hr(1,{location:L,currentLocation:R});G=k.record.name,x=At({},R.params,L.params),N=k.stringify(x)}const V=[];let z=k;for(;z;)V.unshift(z.record),z=z.parent;return{name:G,path:N,params:x,matched:V,meta:FR(V)}}return o.forEach(L=>f(L)),{addRoute:f,resolve:T,removeRoute:v,getRoutes:y,getRecordMatcher:p}}function Yg(o,i){const u={};for(const c of i)c in o&&(u[c]=o[c]);return u}function wR(o){return{path:o.path,redirect:o.redirect,name:o.name,meta:o.meta||{},aliasOf:void 0,beforeEnter:o.beforeEnter,props:UR(o),children:o.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in o?o.components||null:o.component&&{default:o.component}}}function UR(o){const i={},u=o.props||!1;if("component"in o)i.default=u;else for(const c in o.components)i[c]=typeof u=="object"?u[c]:u;return i}function zg(o){for(;o;){if(o.record.aliasOf)return!0;o=o.parent}return!1}function FR(o){return o.reduce((i,u)=>At(i,u.meta),{})}function $g(o,i){const u={};for(const c in o)u[c]=c in i?i[c]:o[c];return u}function bv(o,i){return i.children.some(u=>u===o||bv(o,u))}function xR(o){const i={};if(o===""||o==="?")return i;const c=(o[0]==="?"?o.slice(1):o).split("&");for(let p=0;p<c.length;++p){const f=c[p].replace(Sv," "),v=f.indexOf("="),y=Ki(v<0?f:f.slice(0,v)),C=v<0?null:Ki(f.slice(v+1));if(y in i){let T=i[y];oo(T)||(T=i[y]=[T]),T.push(C)}else i[y]=C}return i}function Jg(o){let i="";for(let u in o){const c=o[u];if(u=rR(u),c==null){c!==void 0&&(i+=(i.length?"&":"")+u);continue}(oo(c)?c.map(f=>f&&Ad(f)):[c&&Ad(c)]).forEach(f=>{f!==void 0&&(i+=(i.length?"&":"")+u,f!=null&&(i+="="+f))})}return i}function qR(o){const i={};for(const u in o){const c=o[u];c!==void 0&&(i[u]=oo(c)?c.map(p=>p==null?null:""+p):c==null?c:""+c)}return i}const VR=Symbol(""),Xg=Symbol(""),Rc=Symbol(""),Tp=Symbol(""),Nd=Symbol("");function vi(){let o=[];function i(c){return o.push(c),()=>{const p=o.indexOf(c);p>-1&&o.splice(p,1)}}function u(){o=[]}return{add:i,list:()=>o.slice(),reset:u}}function $o(o,i,u,c,p,f=v=>v()){const v=c&&(c.enterCallbacks[p]=c.enterCallbacks[p]||[]);return()=>new Promise((y,C)=>{const T=k=>{k===!1?C(hr(4,{from:u,to:i})):k instanceof Error?C(k):DR(k)?C(hr(2,{from:i,to:k})):(v&&c.enterCallbacks[p]===v&&typeof k=="function"&&v.push(k),y())},L=f(()=>o.call(c&&c.instances[p],i,u,T));let R=Promise.resolve(L);o.length<3&&(R=R.then(T)),R.catch(k=>C(k))})}function sd(o,i,u,c,p=f=>f()){const f=[];for(const v of o)for(const y in v.components){let C=v.components[y];if(!(i!=="beforeRouteEnter"&&!v.instances[y]))if(BR(C)){const L=(C.__vccOpts||C)[i];L&&f.push($o(L,u,c,v,y,p))}else{let T=C();f.push(()=>T.then(L=>{if(!L)return Promise.reject(new Error(`Couldn't resolve component "${y}" at "${v.path}"`));const R=zL(L)?L.default:L;v.components[y]=R;const x=(R.__vccOpts||R)[i];return x&&$o(x,u,c,v,y,p)()}))}}return f}function BR(o){return typeof o=="object"||"displayName"in o||"props"in o||"__vccOpts"in o}function Zg(o){const i=bt(Rc),u=bt(Tp),c=Oe(()=>{const C=ge(o.to);return i.resolve(C)}),p=Oe(()=>{const{matched:C}=c.value,{length:T}=C,L=C[T-1],R=u.matched;if(!L||!R.length)return-1;const k=R.findIndex(fr.bind(null,L));if(k>-1)return k;const x=Qg(C[T-2]);return T>1&&Qg(L)===x&&R[R.length-1].path!==x?R.findIndex(fr.bind(null,C[T-2])):k}),f=Oe(()=>p.value>-1&&WR(u.params,c.value.params)),v=Oe(()=>p.value>-1&&p.value===u.matched.length-1&&Av(u.params,c.value.params));function y(C={}){return jR(C)?i[ge(o.replace)?"replace":"push"](ge(o.to)).catch(Oi):Promise.resolve()}return{route:c,href:Oe(()=>c.value.href),isActive:f,isExactActive:v,navigate:y}}const HR=ut({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Zg,setup(o,{slots:i}){const u=ks(Zg(o)),{options:c}=bt(Rc),p=Oe(()=>({[e_(o.activeClass,c.linkActiveClass,"router-link-active")]:u.isActive,[e_(o.exactActiveClass,c.linkExactActiveClass,"router-link-exact-active")]:u.isExactActive}));return()=>{const f=i.default&&i.default(u);return o.custom?f:vc("a",{"aria-current":u.isExactActive?o.ariaCurrentValue:null,href:u.href,onClick:u.navigate,class:p.value},f)}}}),KR=HR;function jR(o){if(!(o.metaKey||o.altKey||o.ctrlKey||o.shiftKey)&&!o.defaultPrevented&&!(o.button!==void 0&&o.button!==0)){if(o.currentTarget&&o.currentTarget.getAttribute){const i=o.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(i))return}return o.preventDefault&&o.preventDefault(),!0}}function WR(o,i){for(const u in i){const c=i[u],p=o[u];if(typeof c=="string"){if(c!==p)return!1}else if(!oo(p)||p.length!==c.length||c.some((f,v)=>f!==p[v]))return!1}return!0}function Qg(o){return o?o.aliasOf?o.aliasOf.path:o.path:""}const e_=(o,i,u)=>o??i??u,YR=ut({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(o,{attrs:i,slots:u}){const c=bt(Nd),p=Oe(()=>o.route||c.value),f=bt(Xg,0),v=Oe(()=>{let T=ge(f);const{matched:L}=p.value;let R;for(;(R=L[T])&&!R.components;)T++;return T}),y=Oe(()=>p.value.matched[v.value]);Do(Xg,Oe(()=>v.value+1)),Do(VR,y),Do(Nd,p);const C=pt();return Ht(()=>[C.value,y.value,o.name],([T,L,R],[k,x,N])=>{L&&(L.instances[R]=T,x&&x!==L&&T&&T===k&&(L.leaveGuards.size||(L.leaveGuards=x.leaveGuards),L.updateGuards.size||(L.updateGuards=x.updateGuards))),T&&L&&(!x||!fr(L,x)||!k)&&(L.enterCallbacks[R]||[]).forEach(G=>G(T))},{flush:"post"}),()=>{const T=p.value,L=o.name,R=y.value,k=R&&R.components[L];if(!k)return t_(u.default,{Component:k,route:T});const x=R.props[L],N=x?x===!0?T.params:typeof x=="function"?x(T):x:null,V=vc(k,At({},N,i,{onVnodeUnmounted:z=>{z.component.isUnmounted&&(R.instances[L]=null)},ref:C}));return t_(u.default,{Component:V,route:T})||V}}});function t_(o,i){if(!o)return null;const u=o(i);return u.length===1?u[0]:u}const zR=YR;function $R(o){const i=GR(o.routes,o),u=o.parseQuery||xR,c=o.stringifyQuery||Jg,p=o.history,f=vi(),v=vi(),y=vi(),C=Ci(xo);let T=xo;nr&&o.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const L=nd.bind(null,ie=>""+ie),R=nd.bind(null,aR),k=nd.bind(null,Ki);function x(ie,Ce){let De,Re;return Nv(ie)?(De=i.getRecordMatcher(ie),Re=Ce):Re=ie,i.addRoute(Re,De)}function N(ie){const Ce=i.getRecordMatcher(ie);Ce&&i.removeRoute(Ce)}function G(){return i.getRoutes().map(ie=>ie.record)}function V(ie){return!!i.getRecordMatcher(ie)}function z(ie,Ce){if(Ce=At({},Ce||C.value),typeof ie=="string"){const j=od(u,ie,Ce.path),ce=i.resolve({path:j.path},Ce),ee=p.createHref(j.fullPath);return At(j,ce,{params:k(ce.params),hash:Ki(j.hash),redirectedFrom:void 0,href:ee})}let De;if(ie.path!=null)De=At({},ie,{path:od(u,ie.path,Ce.path).path});else{const j=At({},ie.params);for(const ce in j)j[ce]==null&&delete j[ce];De=At({},ie,{params:R(j)}),Ce.params=R(Ce.params)}const Re=i.resolve(De,Ce),Je=ie.hash||"";Re.params=L(k(Re.params));const b=lR(c,At({},ie,{hash:sR(Je),path:Re.path})),w=p.createHref(b);return At({fullPath:b,hash:Je,query:c===Jg?qR(ie.query):ie.query||{}},Re,{redirectedFrom:void 0,href:w})}function te(ie){return typeof ie=="string"?od(u,ie,C.value.path):At({},ie)}function q(ie,Ce){if(T!==ie)return hr(8,{from:Ce,to:ie})}function Ne(ie){return Ue(ie)}function Le(ie){return Ne(At(te(ie),{replace:!0}))}function Se(ie){const Ce=ie.matched[ie.matched.length-1];if(Ce&&Ce.redirect){const{redirect:De}=Ce;let Re=typeof De=="function"?De(ie):De;return typeof Re=="string"&&(Re=Re.includes("?")||Re.includes("#")?Re=te(Re):{path:Re},Re.params={}),At({query:ie.query,hash:ie.hash,params:Re.path!=null?{}:ie.params},Re)}}function Ue(ie,Ce){const De=T=z(ie),Re=C.value,Je=ie.state,b=ie.force,w=ie.replace===!0,j=Se(De);if(j)return Ue(At(te(j),{state:typeof j=="object"?At({},Je,j.state):Je,force:b,replace:w}),Ce||De);const ce=De;ce.redirectedFrom=Ce;let ee;return!b&&dR(c,Re,De)&&(ee=hr(16,{to:ce,from:Re}),he(Re,Re,!0,!1)),(ee?Promise.resolve(ee):$(ce,Re)).catch(pe=>Co(pe)?Co(pe,2)?pe:P(pe):re(pe,ce,Re)).then(pe=>{if(pe){if(Co(pe,2))return Ue(At({replace:w},te(pe.to),{state:typeof pe.to=="object"?At({},Je,pe.to.state):Je,force:b}),Ce||ce)}else pe=W(ce,Re,!0,w,Je);return I(ce,Re,pe),pe})}function ve(ie,Ce){const De=q(ie,Ce);return De?Promise.reject(De):Promise.resolve()}function ye(ie){const Ce=Xe.values().next().value;return Ce&&typeof Ce.runWithContext=="function"?Ce.runWithContext(ie):ie()}function $(ie,Ce){let De;const[Re,Je,b]=JR(ie,Ce);De=sd(Re.reverse(),"beforeRouteLeave",ie,Ce);for(const j of Re)j.leaveGuards.forEach(ce=>{De.push($o(ce,ie,Ce))});const w=ve.bind(null,ie,Ce);return De.push(w),at(De).then(()=>{De=[];for(const j of f.list())De.push($o(j,ie,Ce));return De.push(w),at(De)}).then(()=>{De=sd(Je,"beforeRouteUpdate",ie,Ce);for(const j of Je)j.updateGuards.forEach(ce=>{De.push($o(ce,ie,Ce))});return De.push(w),at(De)}).then(()=>{De=[];for(const j of b)if(j.beforeEnter)if(oo(j.beforeEnter))for(const ce of j.beforeEnter)De.push($o(ce,ie,Ce));else De.push($o(j.beforeEnter,ie,Ce));return De.push(w),at(De)}).then(()=>(ie.matched.forEach(j=>j.enterCallbacks={}),De=sd(b,"beforeRouteEnter",ie,Ce,ye),De.push(w),at(De))).then(()=>{De=[];for(const j of v.list())De.push($o(j,ie,Ce));return De.push(w),at(De)}).catch(j=>Co(j,8)?j:Promise.reject(j))}function I(ie,Ce,De){y.list().forEach(Re=>ye(()=>Re(ie,Ce,De)))}function W(ie,Ce,De,Re,Je){const b=q(ie,Ce);if(b)return b;const w=Ce===xo,j=nr?history.state:{};De&&(Re||w?p.replace(ie.fullPath,At({scroll:w&&j&&j.scroll},Je)):p.push(ie.fullPath,Je)),C.value=ie,he(ie,Ce,De,w),P()}let Z;function X(){Z||(Z=p.listen((ie,Ce,De)=>{if(!ht.listening)return;const Re=z(ie),Je=Se(Re);if(Je){Ue(At(Je,{replace:!0}),Re).catch(Oi);return}T=Re;const b=C.value;nr&&yR(Bg(b.fullPath,De.delta),Lc()),$(Re,b).catch(w=>Co(w,12)?w:Co(w,2)?(Ue(w.to,Re).then(j=>{Co(j,20)&&!De.delta&&De.type===ji.pop&&p.go(-1,!1)}).catch(Oi),Promise.reject()):(De.delta&&p.go(-De.delta,!1),re(w,Re,b))).then(w=>{w=w||W(Re,b,!1),w&&(De.delta&&!Co(w,8)?p.go(-De.delta,!1):De.type===ji.pop&&Co(w,20)&&p.go(-1,!1)),I(Re,b,w)}).catch(Oi)}))}let Q=vi(),Y=vi(),ue;function re(ie,Ce,De){P(ie);const Re=Y.list();return Re.length?Re.forEach(Je=>Je(ie,Ce,De)):console.error(ie),Promise.reject(ie)}function Ee(){return ue&&C.value!==xo?Promise.resolve():new Promise((ie,Ce)=>{Q.add([ie,Ce])})}function P(ie){return ue||(ue=!ie,X(),Q.list().forEach(([Ce,De])=>ie?De(ie):Ce()),Q.reset()),ie}function he(ie,Ce,De,Re){const{scrollBehavior:Je}=o;if(!nr||!Je)return Promise.resolve();const b=!De&&IR(Bg(ie.fullPath,0))||(Re||!De)&&history.state&&history.state.scroll||null;return dn().then(()=>Je(ie,Ce,b)).then(w=>w&&vR(w)).catch(w=>re(w,ie,Ce))}const Fe=ie=>p.go(ie);let $e;const Xe=new Set,ht={currentRoute:C,listening:!0,addRoute:x,removeRoute:N,hasRoute:V,getRoutes:G,resolve:z,options:o,push:Ne,replace:Le,go:Fe,back:()=>Fe(-1),forward:()=>Fe(1),beforeEach:f.add,beforeResolve:v.add,afterEach:y.add,onError:Y.add,isReady:Ee,install(ie){const Ce=this;ie.component("RouterLink",KR),ie.component("RouterView",zR),ie.config.globalProperties.$router=Ce,Object.defineProperty(ie.config.globalProperties,"$route",{enumerable:!0,get:()=>ge(C)}),nr&&!$e&&C.value===xo&&($e=!0,Ne(p.location).catch(Je=>{}));const De={};for(const Je in xo)Object.defineProperty(De,Je,{get:()=>C.value[Je],enumerable:!0});ie.provide(Rc,Ce),ie.provide(Tp,B_(De)),ie.provide(Nd,C);const Re=ie.unmount;Xe.add(ie),ie.unmount=function(){Xe.delete(ie),Xe.size<1&&(T=xo,Z&&Z(),Z=null,C.value=xo,$e=!1,ue=!1),Re()}}};function at(ie){return ie.reduce((Ce,De)=>Ce.then(()=>ye(De)),Promise.resolve())}return ht}function JR(o,i){const u=[],c=[],p=[],f=Math.max(i.matched.length,o.matched.length);for(let v=0;v<f;v++){const y=i.matched[v];y&&(o.matched.find(T=>fr(T,y))?c.push(y):u.push(y));const C=o.matched[v];C&&(i.matched.find(T=>fr(T,C))||p.push(C))}return[u,c,p]}function XR(){return bt(Rc)}function Gv(){return bt(Tp)}/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let wv;const kc=o=>wv=o,Uv=Symbol();function Pd(o){return o&&typeof o=="object"&&Object.prototype.toString.call(o)==="[object Object]"&&typeof o.toJSON!="function"}var Pi;(function(o){o.direct="direct",o.patchObject="patch object",o.patchFunction="patch function"})(Pi||(Pi={}));function ZR(){const o=A_(!0),i=o.run(()=>pt({}));let u=[],c=[];const p=pc({install(f){kc(p),p._a=f,f.provide(Uv,p),f.config.globalProperties.$pinia=p,c.forEach(v=>u.push(v)),c=[]},use(f){return this._a?u.push(f):c.push(f),this},_p:u,_a:null,_e:o,_s:new Map,state:i});return p}const Fv=()=>{};function n_(o,i,u,c=Fv){o.push(i);const p=()=>{const f=o.indexOf(i);f>-1&&(o.splice(f,1),c())};return!u&&Wd()&&Yd(p),p}function Qs(o,...i){o.slice().forEach(u=>{u(...i)})}const QR=o=>o();function bd(o,i){o instanceof Map&&i instanceof Map&&i.forEach((u,c)=>o.set(c,u)),o instanceof Set&&i instanceof Set&&i.forEach(o.add,o);for(const u in i){if(!i.hasOwnProperty(u))continue;const c=i[u],p=o[u];Pd(p)&&Pd(c)&&o.hasOwnProperty(u)&&!Wt(c)&&!Ts(c)?o[u]=bd(p,c):o[u]=c}return o}const ek=Symbol();function tk(o){return!Pd(o)||!o.hasOwnProperty(ek)}const{assign:Ko}=Object;function nk(o){return!!(Wt(o)&&o.effect)}function ok(o,i,u,c){const{state:p,actions:f,getters:v}=i,y=u.state.value[o];let C;function T(){y||(u.state.value[o]=p?p():{});const L=$_(u.state.value[o]);return Ko(L,f,Object.keys(v||{}).reduce((R,k)=>(R[k]=pc(Oe(()=>{kc(u);const x=u._s.get(o);return v[k].call(x,x)})),R),{}))}return C=xv(o,T,i,u,c,!0),C}function xv(o,i,u={},c,p,f){let v;const y=Ko({actions:{}},u),C={deep:!0};let T,L,R=[],k=[],x;const N=c.state.value[o];!f&&!N&&(c.state.value[o]={}),pt({});let G;function V(ve){let ye;T=L=!1,typeof ve=="function"?(ve(c.state.value[o]),ye={type:Pi.patchFunction,storeId:o,events:x}):(bd(c.state.value[o],ve),ye={type:Pi.patchObject,payload:ve,storeId:o,events:x});const $=G=Symbol();dn().then(()=>{G===$&&(T=!0)}),L=!0,Qs(R,ye,c.state.value[o])}const z=f?function(){const{state:ye}=u,$=ye?ye():{};this.$patch(I=>{Ko(I,$)})}:Fv;function te(){v.stop(),R=[],k=[],c._s.delete(o)}function q(ve,ye){return function(){kc(c);const $=Array.from(arguments),I=[],W=[];function Z(Y){I.push(Y)}function X(Y){W.push(Y)}Qs(k,{args:$,name:ve,store:Le,after:Z,onError:X});let Q;try{Q=ye.apply(this&&this.$id===o?this:Le,$)}catch(Y){throw Qs(W,Y),Y}return Q instanceof Promise?Q.then(Y=>(Qs(I,Y),Y)).catch(Y=>(Qs(W,Y),Promise.reject(Y))):(Qs(I,Q),Q)}}const Ne={_p:c,$id:o,$onAction:n_.bind(null,k),$patch:V,$reset:z,$subscribe(ve,ye={}){const $=n_(R,ve,ye.detached,()=>I()),I=v.run(()=>Ht(()=>c.state.value[o],W=>{(ye.flush==="sync"?L:T)&&ve({storeId:o,type:Pi.direct,events:x},W)},Ko({},C,ye)));return $},$dispose:te},Le=ks(Ne);c._s.set(o,Le);const Ue=(c._a&&c._a.runWithContext||QR)(()=>c._e.run(()=>(v=A_()).run(i)));for(const ve in Ue){const ye=Ue[ve];if(Wt(ye)&&!nk(ye)||Ts(ye))f||(N&&tk(ye)&&(Wt(ye)?ye.value=N[ve]:bd(ye,N[ve])),c.state.value[o][ve]=ye);else if(typeof ye=="function"){const $=q(ve,ye);Ue[ve]=$,y.actions[ve]=ye}}return Ko(Le,Ue),Ko(_t(Le),Ue),Object.defineProperty(Le,"$state",{get:()=>c.state.value[o],set:ve=>{V(ye=>{Ko(ye,ve)})}}),c._p.forEach(ve=>{Ko(Le,v.run(()=>ve({store:Le,app:c._a,pinia:c,options:y})))}),N&&f&&u.hydrate&&u.hydrate(Le.$state,N),T=!0,L=!0,Le}function Ep(o,i,u){let c,p;const f=typeof i=="function";typeof o=="string"?(c=o,p=f?u:i):(p=o,c=o.id);function v(y,C){const T=t0();return y=y||(T?bt(Uv,null):null),y&&kc(y),y=wv,y._s.has(c)||(f?xv(c,i,p,y):ok(c,p,y)),y._s.get(c)}return v.$id=c,v}function sk(o){return typeof o=="object"&&o!==null}function o_(o,i){return o=sk(o)?o:Object.create(null),new Proxy(o,{get(u,c,p){return c==="key"?Reflect.get(u,c,p):Reflect.get(u,c,p)||Reflect.get(i,c,p)}})}function rk(o,i){return i.reduce((u,c)=>u==null?void 0:u[c],o)}function ik(o,i,u){return i.slice(0,-1).reduce((c,p)=>/^(__proto__)$/.test(p)?{}:c[p]=c[p]||{},o)[i[i.length-1]]=u,o}function ak(o,i){return i.reduce((u,c)=>{const p=c.split(".");return ik(u,p,rk(o,p))},{})}function ck(o,i){return u=>{var c;try{const{storage:p=localStorage,beforeRestore:f=void 0,afterRestore:v=void 0,serializer:y={serialize:JSON.stringify,deserialize:JSON.parse},key:C=i.$id,paths:T=null,debug:L=!1}=u;return{storage:p,beforeRestore:f,afterRestore:v,serializer:y,key:((c=o.key)!=null?c:R=>R)(typeof C=="string"?C:C(i.$id)),paths:T,debug:L}}catch(p){return u.debug&&console.error("[pinia-plugin-persistedstate]",p),null}}}function s_(o,{storage:i,serializer:u,key:c,debug:p}){try{const f=i==null?void 0:i.getItem(c);f&&o.$patch(u==null?void 0:u.deserialize(f))}catch(f){p&&console.error("[pinia-plugin-persistedstate]",f)}}function r_(o,{storage:i,serializer:u,key:c,paths:p,debug:f}){try{const v=Array.isArray(p)?ak(o,p):o;i.setItem(c,u.serialize(v))}catch(v){f&&console.error("[pinia-plugin-persistedstate]",v)}}function uk(o={}){return i=>{const{auto:u=!1}=o,{options:{persist:c=u},store:p,pinia:f}=i;if(!c)return;if(!(p.$id in f.state.value)){const y=f._s.get(p.$id.replace("__hot:",""));y&&Promise.resolve().then(()=>y.$persist());return}const v=(Array.isArray(c)?c.map(y=>o_(y,o)):[o_(c,o)]).map(ck(o,p)).filter(Boolean);p.$persist=()=>{v.forEach(y=>{r_(p.$state,y)})},p.$hydrate=({runHooks:y=!0}={})=>{v.forEach(C=>{const{beforeRestore:T,afterRestore:L}=C;y&&(T==null||T(i)),s_(p,C),y&&(L==null||L(i))})},v.forEach(y=>{const{beforeRestore:C,afterRestore:T}=y;C==null||C(i),s_(p,y),T==null||T(i),p.$subscribe((L,R)=>{r_(R,y)},{detached:!0})})}}var lk=uk();const dk=Ep("app",{state:()=>({layout:"empty"}),actions:{setLayout(o){this.layout=o},resetApp(){this.$reset()}},getters:{},persist:{paths:[],storage:sessionStorage}}),pk=Ep("router",()=>{const o=XR(),i=Gv();function u(c){c.forEach(p=>{o.hasRoute(p.name)&&o.removeRoute(p.name)})}return{router:o,route:i,resetRouter:u}}),Wi=Ep("auth",{state:()=>({token:void 0}),actions:{setToken(o){this.token=o},reset(){this.$reset()},logout(){try{this.token=void 0,pk().router.push("/login")}catch(o){console.log("",o)}}},persist:{key:"short-video_auth",paths:["token"]}});function fk(o){const i=ZR();i.use(lk),o.use(i)}var hk={name:"zh-cn",el:{breadcrumb:{label:""},colorpicker:{confirm:"",clear:""},datepicker:{now:"",today:"",cancel:"",clear:"",confirm:"",selectDate:"",selectTime:"",startDate:"",startTime:"",endDate:"",endTime:"",prevYear:"",nextYear:"",prevMonth:"",nextMonth:"",year:"",month1:"1 ",month2:"2 ",month3:"3 ",month4:"4 ",month5:"5 ",month6:"6 ",month7:"7 ",month8:"8 ",month9:"9 ",month10:"10 ",month11:"11 ",month12:"12 ",weeks:{sun:"",mon:"",tue:"",wed:"",thu:"",fri:"",sat:""},months:{jan:"",feb:"",mar:"",apr:"",may:"",jun:"",jul:"",aug:"",sep:"",oct:"",nov:"",dec:""}},select:{loading:"",noMatch:"",noData:"",placeholder:""},cascader:{noMatch:"",loading:"",placeholder:"",noData:""},pagination:{goto:"",pagesize:"/",total:" {total} ",pageClassifier:"",page:"",prev:"",next:"",currentPage:" {pager} ",prevPages:" {pager} ",nextPages:" {pager} ",deprecationWarning:" el-pagination "},messagebox:{title:"",confirm:"",cancel:"",error:"!"},upload:{deleteTip:" delete ",delete:"",preview:"",continue:""},table:{emptyText:"",confirmFilter:"",resetFilter:"",clearFilter:"",sumText:""},tour:{next:"",previous:"",finish:""},tree:{emptyText:""},transfer:{noMatch:"",noData:"",titles:[" 1"," 2"],filterPlaceholder:"",noCheckedFormat:" {total} ",hasCheckedFormat:" {checked}/{total} "},image:{error:""},pageHeader:{title:""},popconfirm:{confirmButtonText:"",cancelButtonText:""},carousel:{leftArrow:"",rightArrow:"",indicator:" {index}"}}},qv={exports:{}};(function(o,i){(function(u,c){o.exports=c()})(Vn,function(){function u(e,t){var n,s=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),s.push.apply(s,n)),s}function c(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?u(Object(n),!0).forEach(function(s){C(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function p(e){return(p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function y(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function R(e,t){return(R=Object.setPrototypeOf||function(n,s){return n.__proto__=s,n})(e,t)}function k(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function x(e,t,n){return(x=k()?Reflect.construct:function(s,d,a){var l=[null],d=(l.push.apply(l,d),new(Function.bind.apply(s,l)));return a&&R(d,a.prototype),d}).apply(null,arguments)}function N(e){var t=typeof Map=="function"?new Map:void 0;return function(n){if(n===null||Function.toString.call(n).indexOf("[native code]")===-1)return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(t!==void 0){if(t.has(n))return t.get(n);t.set(n,s)}function s(){return x(n,arguments,L(this).constructor)}return s.prototype=Object.create(n.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),R(s,n)}(e)}function G(e,t){if(e==null)return{};var n,s=function(l,d){if(l==null)return{};for(var h,g={},_=Object.keys(l),M=0;M<_.length;M++)h=_[M],0<=d.indexOf(h)||(g[h]=l[h]);return g}(e,t);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(e),a=0;a<r.length;a++)n=r[a],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n]);return s}function V(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z(e){var t=k();return function(){var n,s=L(e),s=(n=t?(n=L(this).constructor,Reflect.construct(s,arguments,n)):s.apply(this,arguments),this);if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V(s)}}function te(e,t){return Ne(e)||function(n,s){var r=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r!=null){var a,l,d=[],h=!0,g=!1;try{for(r=r.call(n);!(h=(a=r.next()).done)&&(d.push(a.value),!s||d.length!==s);h=!0);}catch(_){g=!0,l=_}finally{try{h||r.return==null||r.return()}finally{if(g)throw l}}return d}}(e,t)||Se(e,t)||ve()}function q(e){return function(t){if(Array.isArray(t))return Ue(t)}(e)||Le(e)||Se(e)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ne(e){if(Array.isArray(e))return e}function Le(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Se(e,t){if(e){if(typeof e=="string")return Ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return(n=n==="Object"&&e.constructor?e.constructor.name:n)==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ue(e,t):void 0}}function Ue(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function ve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ye(e,t){var n,s=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!s){if(Array.isArray(e)||(s=Se(e))||t&&e&&typeof e.length=="number")return s&&(e=s),n=0,{s:t=function(){},n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t};throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var r,a=!0,l=!1;return{s:function(){s=s.call(e)},n:function(){var d=s.next();return a=d.done,d},e:function(d){l=!0,r=d},f:function(){try{a||s.return==null||s.return()}finally{if(l)throw r}}}}var $={SDK_READY:"sdkStateReady",SDK_NOT_READY:"sdkStateNotReady",SDK_DESTROY:"sdkDestroy",MESSAGE_RECEIVED:"onMessageReceived",ROOM_CUSTOM_DATA_RECEIVED:"onRoomCustomDataReceived",MESSAGE_MODIFIED:"onMessageModified",MESSAGE_REVOKED:"onMessageRevoked",MESSAGE_READ_BY_PEER:"onMessageReadByPeer",MESSAGE_READ_RECEIPT_RECEIVED:"onMessageReadReceiptReceived",MESSAGE_EXTENSIONS_UPDATED:"onMessageExtensionsUpdated",MESSAGE_EXTENSIONS_DELETED:"onMessageExtensionsDeleted",MESSAGE_REACTIONS_UPDATED:"onMessageReactionsUpdated",CONVERSATION_LIST_UPDATED:"onConversationListUpdated",TOTAL_UNREAD_MESSAGE_COUNT_UPDATED:"onTotalUnreadMessageCountUpdated",CONVERSATION_GROUP_LIST_UPDATED:"onConversationGroupListUpdated",CONVERSATION_IN_GROUP_UPDATED:"onConversationInGroupUpdated",GROUP_LIST_UPDATED:"onGroupListUpdated",GROUP_ATTRIBUTES_UPDATED:"groupAttributesUpdated",GROUP_COUNTER_UPDATED:"onGroupCounterUpdated",TOPIC_CREATED:"onTopicCreated",TOPIC_DELETED:"onTopicDeleted",TOPIC_UPDATED:"onTopicUpdated",PROFILE_UPDATED:"onProfileUpdated",USER_STATUS_UPDATED:"onUserStatusUpdated",BLACKLIST_UPDATED:"blacklistUpdated",FRIEND_LIST_UPDATED:"onFriendListUpdated",FRIEND_GROUP_LIST_UPDATED:"onFriendGroupListUpdated",FRIEND_APPLICATION_LIST_UPDATED:"onFriendApplicationListUpdated",MY_FOLLOWERS_LIST_UPDATED:"onMyFollowersListUpdated",MY_FOLLOWING_LIST_UPDATED:"onMyFollowingListUpdated",MUTUAL_FOLLOWERS_LIST_UPDATED:"onMutualFollowersListUpdated",KICKED_OUT:"kickedOut",ERROR:"error",NET_STATE_CHANGE:"netStateChange",ALL_RECEIVE_MESSAGE_OPT_UPDATED:"onAllReceiveMessageOptUpdated"},I={MSG_TEXT:"TIMTextElem",MSG_IMAGE:"TIMImageElem",MSG_SOUND:"TIMSoundElem",MSG_AUDIO:"TIMSoundElem",MSG_FILE:"TIMFileElem",MSG_FACE:"TIMFaceElem",MSG_VIDEO:"TIMVideoFileElem",MSG_GEO:"TIMLocationElem",MSG_LOCATION:"TIMLocationElem",MSG_GRP_TIP:"TIMGroupTipElem",MSG_GRP_SYS_NOTICE:"TIMGroupSystemNoticeElem",MSG_CUSTOM:"TIMCustomElem",MSG_MERGER:"TIMRelayElem",MSG_PRIORITY_HIGH:"High",MSG_PRIORITY_NORMAL:"Normal",MSG_PRIORITY_LOW:"Low",MSG_PRIORITY_LOWEST:"Lowest",CONV_C2C:"C2C",CONV_GROUP:"GROUP",CONV_TOPIC:"TOPIC",CONV_SYSTEM:"@TIM#SYSTEM",CONV_AT_ME:1,CONV_AT_ALL:2,CONV_AT_ALL_AT_ME:3,CONV_MARK_TYPE_STAR:1,CONV_MARK_TYPE_UNREAD:2,CONV_MARK_TYPE_FOLD:4,CONV_MARK_TYPE_HIDE:8,GRP_PRIVATE:"Private",GRP_WORK:"Private",GRP_PUBLIC:"Public",GRP_CHATROOM:"ChatRoom",GRP_MEETING:"ChatRoom",GRP_AVCHATROOM:"AVChatRoom",GRP_COMMUNITY:"Community",GRP_ROOM:"Room",GRP_LIVE:"Live",GRP_MBR_ROLE_OWNER:"Owner",GRP_MBR_ROLE_ADMIN:"Admin",GRP_MBR_ROLE_MEMBER:"Member",GRP_MBR_ROLE_CUSTOM:"Custom",GRP_TIP_MBR_JOIN:1,GRP_TIP_MBR_QUIT:2,GRP_TIP_MBR_KICKED_OUT:3,GRP_TIP_MBR_SET_ADMIN:4,GRP_TIP_MBR_CANCELED_ADMIN:5,GRP_TIP_GRP_PROFILE_UPDATED:6,GRP_TIP_MBR_PROFILE_UPDATED:7,GRP_TIP_BAN_AVCHATROOM_MEMBER:10,GRP_TIP_UNBAN_AVCHATROOM_MEMBER:11,MSG_REMIND_ACPT_AND_NOTE:"AcceptAndNotify",MSG_REMIND_ACPT_NOT_NOTE:"AcceptNotNotify",MSG_REMIND_DISCARD:"Discard",RECEIVE_WITH_OFFLINE_PUSH_EXCEPT_AT:"AcceptNotNotifyExceptAt",NOT_RECEIVE_OFFLINE_PUSH_EXCEPT_AT:"AcceptNotNotifyExceptAt",NOT_RECEIVE_MSG_EXCEPT_AT:"NotReceiveMsgExceptAt",GENDER_UNKNOWN:"Gender_Type_Unknown",GENDER_FEMALE:"Gender_Type_Female",GENDER_MALE:"Gender_Type_Male",KICKED_OUT_MULT_ACCOUNT:"multipleAccount",KICKED_OUT_MULT_DEVICE:"multipleDevice",KICKED_OUT_USERSIG_EXPIRED:"userSigExpired",KICKED_OUT_REST_API:"REST_API_Kick",ALLOW_TYPE_ALLOW_ANY:"AllowType_Type_AllowAny",ALLOW_TYPE_NEED_CONFIRM:"AllowType_Type_NeedConfirm",ALLOW_TYPE_DENY_ANY:"AllowType_Type_DenyAny",FORBID_TYPE_NONE:"AdminForbid_Type_None",FORBID_TYPE_SEND_OUT:"AdminForbid_Type_SendOut",JOIN_OPTIONS_FREE_ACCESS:"FreeAccess",JOIN_OPTIONS_NEED_PERMISSION:"NeedPermission",JOIN_OPTIONS_DISABLE_APPLY:"DisableApply",JOIN_STATUS_SUCCESS:"JoinedSuccess",JOIN_STATUS_ALREADY_IN_GROUP:"AlreadyInGroup",JOIN_STATUS_WAIT_APPROVAL:"WaitAdminApproval",INVITE_OPTIONS_DISABLE_INVITE:"DisableInvite",INVITE_OPTIONS_NEED_PERMISSION:"NeedPermission",INVITE_OPTIONS_FREE_ACCESS:"FreeAccess",GRP_PROFILE_OWNER_ID:"ownerID",GRP_PROFILE_CREATE_TIME:"createTime",GRP_PROFILE_LAST_INFO_TIME:"lastInfoTime",GRP_PROFILE_MEMBER_NUM:"memberNum",GRP_PROFILE_MAX_MEMBER_NUM:"maxMemberNum",GRP_PROFILE_JOIN_OPTION:"joinOption",GRP_PROFILE_INVITE_OPTION:"inviteOption",GRP_PROFILE_INTRODUCTION:"introduction",GRP_PROFILE_NOTIFICATION:"notification",GRP_PROFILE_MUTE_ALL_MBRS:"muteAllMembers",SNS_ADD_TYPE_SINGLE:"Add_Type_Single",SNS_ADD_TYPE_BOTH:"Add_Type_Both",SNS_DELETE_TYPE_SINGLE:"Delete_Type_Single",SNS_DELETE_TYPE_BOTH:"Delete_Type_Both",SNS_APPLICATION_TYPE_BOTH:"Pendency_Type_Both",SNS_APPLICATION_SENT_TO_ME:"Pendency_Type_ComeIn",SNS_APPLICATION_SENT_BY_ME:"Pendency_Type_SendOut",SNS_APPLICATION_AGREE:"Response_Action_Agree",SNS_APPLICATION_AGREE_AND_ADD:"Response_Action_AgreeAndAdd",SNS_CHECK_TYPE_BOTH:"CheckResult_Type_Both",SNS_CHECK_TYPE_SINGLE:"CheckResult_Type_Single",SNS_TYPE_NO_RELATION:"CheckResult_Type_NoRelation",SNS_TYPE_A_WITH_B:"CheckResult_Type_AWithB",SNS_TYPE_B_WITH_A:"CheckResult_Type_BWithA",SNS_TYPE_BOTH_WAY:"CheckResult_Type_BothWay",NET_STATE_CONNECTED:"connected",NET_STATE_CONNECTING:"connecting",NET_STATE_DISCONNECTED:"disconnected",MSG_AT_ALL:"__kImSDK_MesssageAtALL__",READ_ALL_C2C_MSG:"readAllC2CMessage",READ_ALL_GROUP_MSG:"readAllGroupMessage",READ_ALL_MSG:"readAllMessage",USER_STATUS_UNKNOWN:0,USER_STATUS_ONLINE:1,USER_STATUS_OFFLINE:2,USER_STATUS_UNLOGINED:3,IOS_OFFLINE_PUSH_NO_SOUND:"push.no_sound",IOS_OFFLINE_PUSH_DEFAULT_SOUND:"default"},W={NEW_INVITATION_RECEIVED:"newInvitationReceived",INVITEE_ACCEPTED:"ts_invitee_accepted",INVITEE_REJECTED:"ts_invitee_rejected",INVITATION_CANCELLED:"ts_invitation_cancelled",INVITATION_TIMEOUT:"ts_invitation_timeout",INVITATION_MODIFIED:"ts_invitation_modified",ACTION_TYPE_UNKNOWN:0,ACTION_TYPE_INVITE:1,ACTION_TYPE_CANCEL_INVITE:2,ACTION_TYPE_ACCEPT_INVITE:3,ACTION_TYPE_REJECT_INVITE:4,ACTION_TYPE_INVITE_TIMEOUT:5},Z=(y(at,[{key:"use",value:function(e){if(typeof e!="function")throw"middleware must be a function";return this.cache.push(e),this}},{key:"next",value:function(e){if(this.middlewares&&0<this.middlewares.length)return this.middlewares.shift().call(this,this.options,this.next.bind(this))}},{key:"run",value:function(e){return this.middlewares=this.cache.map(function(t){return t}),this.options=e,this.next()}}]),at),X=(y(ht,[{key:"equal",value:function(e){return e!==null&&this.low===e.low&&this.high===e.high}},{key:"toString",value:function(){var e=Number(this.high).toString(16),t=Number(this.low).toString(16);if(t.length<8)for(var n=8-t.length;n;)t="0"+t,n--;return e+t}}]),ht),Q={TEST:{CHINA:{DEFAULT:"wss://wss-dev.tim.qq.com"},OVERSEA:{DEFAULT:"wss://wss-dev.tim.qq.com"},SINGAPORE:{DEFAULT:"wss://wsssgp-dev.im.qcloud.com"},KOREA:{DEFAULT:"wss://wsskr-dev.im.qcloud.com"},GERMANY:{DEFAULT:"wss://wssger-dev.im.qcloud.com"},IND:{DEFAULT:"wss://wssind-dev.im.qcloud.com"},JPN:{DEFAULT:"wss://wssjpn-dev.im.qcloud.com"},USA:{DEFAULT:"wss://wssusa-dev.im.qcloud.com"},INDONESIA:{DEFAULT:"wss://wssidn-dev.im.qcloud.com"}},PRODUCTION:{CHINA:{DEFAULT0:"wss://*w4c.my-imcloud.com",DEFAULT:"wss://wss.im.qcloud.com",IPV6:"wss://wssv6.im.qcloud.com",BACKUP:"wss://wss.tim.qq.com",STAT:"https://events.im.qcloud.com",ANYCAST:"wss://162.14.13.203"},OVERSEA:{DEFAULT0:"wss://*w4c.my-imcloud.com",DEFAULT:"wss://wss.im.qcloud.com",BACKUP:"wss://wss.my-imcloud.com",STAT:"https://api.my-imcloud.com"},SINGAPORE:{DEFAULT0:"wss://*w4s.my-imcloud.com",DEFAULT:"wss://wsssgp.im.qcloud.com",IPV6:"wss://wsssgpv6.im.qcloud.com",BACKUP:"wss://wsssgp.my-imcloud.com",STAT:"https://apisgp.my-imcloud.com",ANYCAST:"wss://162.14.19.159"},KOREA:{DEFAULT0:"wss://*w4k.my-imcloud.com",DEFAULT:"wss://wsskr.im.qcloud.com",IPV6:"wss://wsskrv6.im.qcloud.com",BACKUP:"wss://wsskr.my-imcloud.com",STAT:"https://apikr.my-imcloud.com",ANYCAST:"wss://162.14.13.104"},GERMANY:{DEFAULT0:"wss://*w4g.my-imcloud.com",DEFAULT:"wss://wssger.im.qcloud.com",IPV6:"wss://wssgerv6.im.qcloud.com",BACKUP:"wss://wssger.my-imcloud.com",STAT:"https://apiger.my-imcloud.com",ANYCAST:"wss://162.14.3.17"},IND:{DEFAULT0:"wss://*w4i.my-imcloud.com",DEFAULT:"wss://wssind.my-imcloud.com",IPV6:"wss://wssindv6.im.qcloud.com",BACKUP:"wss://wssind.im.qcloud.com",STAT:"https://apiind.my-imcloud.com",ANYCAST:"wss://162.14.19.46"},JPN:{DEFAULT0:"wss://*w4j.my-imcloud.com",DEFAULT:"wss://wssjpn.im.qcloud.com",IPV6:"wss://wssjpnv6.im.qcloud.com",BACKUP:"wss://wssjpn.my-imcloud.com",STAT:"https://apijpn.my-imcloud.com"},USA:{DEFAULT0:"wss://*w4u.my-imcloud.com",DEFAULT:"wss://wssusa.im.qcloud.com",IPV6:"wss://wssusav6.im.qcloud.com",BACKUP:"wss://wssusa.my-imcloud.com",STAT:"https://apiusa.my-imcloud.com",ANYCAST:"wss://162.14.10.42"},INDONESIA:{DEFAULT0:"wss://*w4y.my-imcloud.com",DEFAULT:"wss://wssidn.im.qcloud.com",IPV6:"wss://wssidnv6.im.qcloud.com",BACKUP:"wss://wssidn.my-imcloud.com",STAT:"https://apiidn.my-imcloud.com",ANYCAST:"wss://43.129.34.169"}}},Y={ANDROID:2,IOS:3,MAC:4,WEB:7,WX_MP:8,QQ_MP:9,TT_MP:10,BAIDU_MP:11,ALI_MP:12,IPAD:13,UNI_NATIVE_APP:15,DONUT_NATIVE_APP:19,NS_NATIVE_APP:20,RN_NATIVE_APP:21},ue="1.7.3",re=537048168,Ee="CHINA",P={HOST:{CURRENT:{DEFAULT:"wss://wss.im.qcloud.com",STAT:"https://events.im.qcloud.com"},setCurrent:function(){this.CURRENT=Q.PRODUCTION[0<arguments.length&&arguments[0]!==void 0?arguments[0]:Ee]}},NAME:{OPEN_IM:"openim",OPEN_IM_MSG_EXT:"openim_msg_ext_http_svc",GRP:"group_open_http_svc",GRP_AV:"group_open_avchatroom_http_svc",GRP_COMMUNITY:"million_group_open_http_svc",GRP_ATTR:"group_open_attr_http_svc",FD:"sns",PROFILE:"profile",RECENT_CONTACT:"recentcontact",BIG_GRP_NO_AUTH:"group_open_http_noauth_svc",BIG_GRP_POLLING:"group_open_long_polling_http_svc",BIG_GRP_POLLING_NO_AUTH:"group_open_long_polling_http_noauth_svc",IM_OPEN_STAT:"imopenstat",IM_COS_SIGN:"im_cos_sign_svr",CUSTOM_UPLOAD:"im_cos_msg",HEARTBEAT:"heartbeat",IM_OPEN_PUSH:"im_open_push",IM_OPEN_STATUS:"im_open_status",IM_LONG_MSG:"im_long_msg",IM_CONFIG_MANAGER:"im_sdk_config_mgr",STAT_SERVICE:"StatSvc",OVERLOAD_PUSH:"OverLoadPush",IM_MSG_AUDIT_MGR:"im_msg_audit_mgr",TUIROOM_SVR:"tui_room_svr",IM_OPEN_TRANSLATE:"im_open_translate",IM_OPEN_SPEECH:"im_open_speech",MSG_SEARCH:"message_search",GRP_SEARCH:"group_search",GRP_MEMBER_SEARCH:"group_member_search",USER_SEARCH:"user_search",FOLLOW:"follow",OFFLINE_PUSH_REPORT:"offline_push_report",IM_MSG_LOGIC:"im_msg_db_logic"}},he={SEARCH_GRP_SNS:new X(0,Math.pow(2,1)).toString(),AV_HISTORY_MSG:new X(0,Math.pow(2,2)).toString(),GRP_COMMUNITY:new X(0,Math.pow(2,3)).toString(),MSG_TO_SPECIFIED_GRP_MBR:new X(0,Math.pow(2,4)).toString(),AV_MBR_LIST:new X(0,Math.pow(2,6)).toString(),USER_STATUS:new X(0,Math.pow(2,7)).toString(),CONV_MARK:new X(0,Math.pow(2,9)).toString(),CONV_GROUP:new X(0,Math.pow(2,10)).toString(),AV_BAN_MBR:new X(0,Math.pow(2,11)).toString(),MSG_EXT:new X(0,Math.pow(2,13)).toString(),GRP_COUNTER:new X(0,Math.pow(2,15)).toString(),PLUGIN_TRANSLATE:new X(Math.pow(2,6)).toString(),PLUGIN_VOICE_TO_TEXT:new X(Math.pow(2,7)).toString(),PLUGIN_CS:new X(Math.pow(2,8)).toString(),PLUGIN_PUSH:new X(Math.pow(2,9)).toString(),PLUGIN_BOT:new X(Math.pow(2,10)).toString(),MSG_REACTION:new X(Math.pow(2,16)).toString(),FOLLOW:new X(Math.pow(2,20)).toString()},Fe="group_profile",$e=["Type","Name","Introduction","Notification","FaceUrl","Owner_Account","CreateTime","InfoSeq","LastInfoTime","LastMsgTime","MemberNum","MaxMemberNum","ApplyJoinOption","NextMsgSeq","ShutUpAllMember","InviteJoinOption"],Xe=["Role","JoinTime","MsgSeq","MsgFlag"];function ht(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;f(this,ht),this.high=e,this.low=t}function at(){f(this,at),this.cache=[],this.options=null}P.HOST.setCurrent(Ee);for(var ie,Ce=typeof wx<"u"&&typeof wx.getSystemInfoSync=="function"&&!!wx.getSystemInfoSync().fontSizeSetting,De=Ce&&typeof wx.createGamePortal=="function",Re=typeof qq<"u"&&typeof qq.getSystemInfoSync=="function"&&!!qq.getSystemInfoSync().fontSizeSetting,Je=typeof tt<"u"&&typeof tt.getSystemInfoSync=="function"&&!!tt.getSystemInfoSync().fontSizeSetting,b=typeof swan<"u"&&typeof swan.getSystemInfoSync=="function"&&!!swan.getSystemInfoSync().fontSizeSetting,w=typeof my<"u"&&typeof my.getSystemInfoSync=="function"&&!!my.getSystemInfoSync().fontSizeSetting,je=typeof jd<"u"&&typeof jd.getSystemInfoSync=="function",j=typeof uni<"u"&&typeof window>"u"&&typeof uni.requireNativePlugin=="function",fe=Ce&&p(wx.miniapp)==="object",ce=typeof uni<"u",ee=Ce||Re||Je||b||w||j||je,Ke=typeof window>"u"&&!ee&&typeof Vn<"u"&&Vn.NativeScriptGlobals!==void 0,pe=typeof Vn<"u"&&(Vn.nativeModuleProxy!==void 0||Vn.ReactNative!==void 0),Te=typeof uni<"u"?!ee:typeof window<"u"&&!ee&&!pe,le=Re?qq:Je?tt:b?swan:w?my:Ce?wx:j?uni:je?jd:{},Ie=Te&&window&&window.navigator&&window.navigator.userAgent||"",Me=(je="WEB",/(micromessenger|webbrowser)/i.test(Ie)?je="WEB":Re?je="QQ_MP":Je?je="TT_MP":b?je="BAIDU_MP":w?je="ALI_MP":Ce?je=fe?"DONUT_NATIVE_APP":"WX_MP":j?je="UNI_NATIVE_APP":Ke?je="NS_NATIVE_APP":pe&&(je="RN_NATIVE_APP"),Y[je]),fe=/iPad/i.test(Ie),Ke=/iPhone/i.test(Ie)&&!fe,je=/iPod/i.test(Ie),we=Ke||fe||je,Ye=(Ke=Ie.match(/OS (\d+)_/i))&&Ke[1]?Ke[1]:null,qe=/Android/i.test(Ie),ae=function(){var s=Ie.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!s)return null;var r=s[1]&&parseFloat(s[1]),a=s[2]&&parseFloat(s[2]);return r&&a?parseFloat(s[1]+"."+s[2]):r||null}(),fe=/Edge/i.test(Ie),je=!fe&&/Chrome/i.test(Ie),Ge=/MSIE/.test(Ie)||-1<Ie.indexOf("Trident")&&-1<Ie.indexOf("rv:11.0"),et=Ke=!(Ke=(Ke=/MSIE\s(\d+)\.\d/.exec(Ie))&&parseFloat(Ke[1]))&&/Trident\/7.0/i.test(Ie)&&/rv:11.0/.test(Ie)?11:Ke,Dt=/Safari/i.test(Ie)&&!je&&!qe&&!fe,Xt=/Windows/i.test(Ie),bn=/MAC OS X/i.test(Ie),Gn=Te&&typeof Worker<"u"&&!Ge,bs=qe||we,ko=Te&&window.tencent_cloud_im_csig_flutter_for_web_25F_cy!==void 0,yr=function(){if(typeof window>"u"||window.navigator===void 0)return!1;var s=window.navigator.standalone;return!(!we||s||Dt)}(),fn=typeof console<"u"?console:typeof Vn<"u"&&Vn.console?Vn.console:typeof window<"u"&&window.console?window.console:{},Bn=function(){},Ir=["assert","clear","count","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],Rp=Ir.length;Rp--;)ie=Ir[Rp],console[ie]||(fn[ie]=Bn);function kp(){var e=new Date;return e.setTime(Wn()),e}function Ap(){Cr=0}function Mr(){return Math.floor(Wn()/1e3)}var Op=fn,Cr=0,Wn=function(){return new Date().getTime()+Cr},mo=0;function Np(){return jc()?"%c Chat %c":"Chat"}function Pp(){var e=kp();return e.toLocaleTimeString("en-US",{hour12:!1})+"."+function(t){var n;switch(t.toString().length){case 1:n="00"+t;break;case 2:n="0"+t;break;default:n=t}return n}(e.getMilliseconds())}var m={arguments2String:function(e){var t="";if(e.length===1)t=e[0];else for(var n=0,s=e.length;n<s;n++){if(Er(e[n]))try{t+=yy(e[n])?JSON.stringify(e[n],["message","code"]):JSON.stringify(e[n])}catch(r){t+=r?r.message:"";break}else t+=e[n];t+=" "}return t},_exec:function(e,t){jc()?Op[e](Np(),"background:#0abf5b; padding:1px; border-radius:3px; color: #fff","background:transparent",Pp(),t):Op[e]("".concat(Np()," ").concat(Pp()," ").concat(t))},d:function(){var e;mo<=-1&&(e=this.arguments2String(arguments),this._exec("debug",e))},l:function(){var e;mo<=0&&(e=this.arguments2String(arguments),this._exec("log",e))},log:function(){var e;mo<=0&&(e=this.arguments2String(arguments),this._exec("log",e))},i:function(){var e;mo<=1&&(e=this.arguments2String(arguments),this._exec("info",e))},w:function(){var e;mo<=2&&(e=this.arguments2String(arguments),this._exec("warn",e))},e:function(){var e;mo<=3&&(e=this.arguments2String(arguments),this._exec("error",e))},setLevel:function(e){e<4&&this._exec("log","set level from "+mo+" to "+e),mo=e},getLevel:function(){return mo}},na={JPG:1,JPEG:1,GIF:2,PNG:3,BMP:4,UNKNOWN:255},Ke="Tag_Profile_IM_",Ve={NICK:"".concat(Ke,"Nick"),GENDER:"".concat(Ke,"Gender"),BIRTHDAY:"".concat(Ke,"BirthDay"),LOCATION:"".concat(Ke,"Location"),SELFSIGNATURE:"".concat(Ke,"SelfSignature"),ALLOWTYPE:"".concat(Ke,"AllowType"),LANGUAGE:"".concat(Ke,"Language"),AVATAR:"".concat(Ke,"Image"),MESSAGESETTINGS:"".concat(Ke,"MsgSettings"),ADMINFORBIDTYPE:"".concat(Ke,"AdminForbidType"),LEVEL:"".concat(Ke,"Level"),ROLE:"".concat(Ke,"Role")},Yn={GROUP:"".concat("Tag_SNS_IM_","Group"),REMARK:"".concat("Tag_SNS_IM_","Remark"),ADDSOURCE:"".concat("Tag_SNS_IM_","AddSource"),ADDWORDING:"".concat("Tag_SNS_IM_","Wording"),ADDTIME:"".concat("Tag_SNS_IM_","AddTime")},je="Gender_Type_",bp={UNKNOWN:"".concat(je,"Unknown"),FEMALE:"".concat(je,"Female"),MALE:"".concat(je,"Male")},Gp={NONE:"".concat("AdminForbid_Type_","None"),SEND_OUT:"".concat("AdminForbid_Type_","SendOut")},wp={NEED_CONFIRM:"".concat("AllowType_Type_","NeedConfirm"),ALLOW_ANY:"".concat("AllowType_Type_","AllowAny"),DENY_ANY:"".concat("AllowType_Type_","DenyAny")},Gs="JoinedSuccess",Up="WaitAdminApproval",oa="@TOPIC#_",gy=Object.prototype.hasOwnProperty;function se(e){if(e==null)return!0;if(typeof e=="boolean")return!1;if(typeof e=="number")return e===0;if(typeof e=="string"||typeof e=="function"||Array.isArray(e))return e.length===0;if(e instanceof Error)return e.message==="";if(dt(e)){for(var t in e)if(gy.call(e,t))return!1;return!0}return!!(Fp(e)||_y(e)||io(e))&&e.size===0}function Fp(e){return Us(e)==="map"}function _y(e){return Us(e)==="set"}function io(e){return Us(e)==="file"}function Qe(e){return e!==null&&(typeof e=="number"&&!isNaN(+e)||p(e)==="object"&&e.constructor===Number)}function ao(e){return e!==null&&p(e)==="object"}function dt(e){if(p(e)==="object"&&e!==null){if((e=Object.getPrototypeOf(e))===null)return 1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return e===t}}function _e(e){return typeof Array.isArray=="function"?Array.isArray(e):Us(e)==="array"}function Fc(e){return _e(e)&&0<e.length}function Yt(e){return typeof e=="function"}function xp(e){return Us(e)==="filelist"}function qp(e){return typeof e=="string"&&(e=e[0],!/[^a-zA-Z0-9]/.test(e))}function zn(e,t,n,s){if(!Er(e)||!Er(t))return 0;for(var r,a=0,l=Object.keys(t),d=0,h=l.length;d<h;d++)if(r=l[d],!(H(t[r])||n&&n.includes(r)))if(Er(e[r])&&Er(t[r]))a+=zn(e[r],t[r],n,s);else{if(s&&s.includes(t[r]))continue;e[r]!==t[r]&&(e[r]=t[r],a+=1)}return a}function xc(e,t){var n,s=new Map,r=ye(e.entries());try{for(r.s();!(n=r.n()).done;){var a=te(n.value,2),l=a[0],d=a[1];d&&s.set(l,t?JSON.stringify(d):JSON.parse(JSON.stringify(d)))}}catch(h){r.e(h)}finally{r.f()}return s}function sa(e){if(e.length===0)return 0;for(var t=0,n=0,s=typeof document<"u"&&document.characterSet!==void 0?document.characterSet:"UTF-8";e[t]!==void 0;)n+=e[t++].charCodeAt[t]<=255?1:s===!1?3:2;return n}function wn(e){return e=e||99999999,Math.round(Math.random()*e)}function Vp(){for(var e="",t=32;0<t;--t)e+=Bp[Math.floor(Math.random()*Iy)];return e}function ws(e,t){for(var n in e)if(e[n]===t)return 1}function Tr(e){return e.indexOf("http://")===-1||e.indexOf("https://")===-1?"https://"+e:e.replace(/https|http/,"https")}function qc(e){if(Object.getOwnPropertyNames(e).length===0)return Object.create(null);var t,n,s=Array.isArray(e)?[]:Object.create(null);for(n in e)e[n]!==null?e[n]!==void 0?(t=p(e[n]),0<=["string","number","function","boolean"].indexOf(t)?s[n]=e[n]:s[n]=qc(e[n])):s[n]=void 0:s[n]=null;return s}var vy=["url"],xe=function(e){return typeof e=="string"},H=function(e){return e===void 0},Er=function(e){return _e(e)||ao(e)},yy=function(e){return e instanceof Error},Us=function(e){return Object.prototype.toString.call(e).match(/^\[object (.*)\]$/)[1].toLowerCase()},Bp=(Date.now||(Date.now=function(){return new Date().getTime()}),"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),Iy=Bp.length,ra={};function Dr(e,t){if(!_e(e)||!_e(t))return!1;var n=!1;return t.forEach(function(a){var r=a.key,a=a.value,l=e.find(function(d){return d.key===r});l?l.value!==a&&(l.value=a,n=!0):(e.push({key:r,value:a}),n=!0)}),n}function Vc(e){return se(e)?[]:e.filter(function(t){return t.isModified===!0})}function Hp(e){if(dt(e)&&dt(e.webhookInfo)){var t=[];if(e.webhookInfo.disableCloudMessagePreHook&&t.push("ForbidBeforeSendMsgCallback"),e.webhookInfo.disableCloudMessagePostHook&&t.push("ForbidAfterSendMsgCallback"),t.length!==0)return t}}function Bc(e){return se(e)?[]:e.filter(function(t){return t.isModified===!1})}function nn(e){return e===I.GRP_AVCHATROOM}function rn(n){var t=n.type,n=n.groupID;return t===I.GRP_COMMUNITY||"".concat(n).startsWith("@TGS#_")&&!"".concat(n).includes(oa)}function Vt(e){return"".concat(e).startsWith("@TGS#_")&&"".concat(e).includes(oa)}function Zt(e){return xe(e)&&e.slice(0,3)===I.CONV_C2C}function ln(e){return xe(e)&&e.slice(0,5)===I.CONV_GROUP}function Sr(e){return xe(e)&&e===I.CONV_SYSTEM}function Kp(e,t){var n={};return Object.keys(e).forEach(function(s){n[s]=t(e[s],s)}),n}function Fs(e){return pe?Promise.resolve({width:0,height:0}):ee?new Promise(function(t,n){le.getImageInfo({src:e,success:function(s){t({width:s.width,height:s.height})},fail:function(){t({width:0,height:0})}})}):Ge&&et===9?Promise.resolve({width:0,height:0}):new Promise(function(t,n){var s=new Image;s.onload=function(){t({width:this.width,height:this.height}),s=null},s.onerror=function(){t({width:0,height:0}),s=null},s.src=e})}function jp(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return"".concat(e()+e()).concat(e()).concat(e()).concat(e()).concat(e()).concat(e()).concat(e())}function Wp(){var e=qe?"android":we?"ios":Xt?"windows":bn?"mac":"unknown";if(ee)try{var t=le.getSystemInfoSync().platform;t!==void 0&&(e=t)}catch{}return e}function Yp(e,t){e=e.split("."),t=t.split(".");for(var n=Math.max(e.length,t.length);e.length<n;)e.push("0");for(;t.length<n;)t.push("0");for(var s=0;s<n;s++){var r=parseInt(e[s]),a=parseInt(t[s]);if(a<r)return 1;if(r<a)return-1}return 0}function Hc(n){var t=n.originUrl,t=t===void 0?void 0:t,s=n.originWidth,r=n.originHeight,n=n.min,n=n===void 0?198:n,s=parseInt(s),r=parseInt(r),a={url:void 0,width:0,height:0};return(s<=r?s:r)<=n?(a.url=t,a.width=s,a.height=r):(r<=s?(a.width=Math.ceil(s*n/r),a.height=n):(a.width=n,a.height=Math.ceil(r*n/s)),r=t&&-1<t.indexOf("?")?"".concat(t,"&"):"".concat(t,"?"),a.url="".concat(r,n===198?"imageView2/3/w/198/h/198":"imageView2/3/w/720/h/720")),H(t)?(a.url,G(a,vy)):a}function zp(e){var t=e[2];e[2]=e[1],e[1]=t;for(var n=0;n<e.length;n++)e[n].setType(n)}function Kc(e){return e=e.servcmd,e.slice(e.indexOf(".")+1)}function $n(e,t){return Math.round(Number(e)*Math.pow(10,t))/Math.pow(10,t)}function $p(e,t){return e.includes(t)}function Jp(e,t){return e.includes(t)}function wt(e){return e.split(oa)[0]}var Lr=function(e,t,n){if(H(t))return"";switch(e){case I.MSG_TEXT:return t.text;case I.MSG_IMAGE:return n?"[Image]":"[]";case I.MSG_LOCATION:return n?"[Location]":"[]";case I.MSG_AUDIO:return n?"[Voice]":"[]";case I.MSG_VIDEO:return n?"[Video]":"[]";case I.MSG_FILE:return n?"[File]":"[]";case I.MSG_CUSTOM:return n?"[Custom Messages]":"[]";case I.MSG_GRP_TIP:return n?"[Group Notification]":"[]";case I.MSG_GRP_SYS_NOTICE:return n?"[Group System Message]":"[]";case I.MSG_FACE:return n?"[Animated Sticker]":"[]";case I.MSG_MERGER:return n?"[Chat Record]":"[]";default:return""}};function Xp(e){return e===I.MSG_TEXT||e===I.MSG_CUSTOM||e===I.MSG_LOCATION||e===I.MSG_FACE}function ia(e){var t=[];if(!xe(e))return t;var n=e.length;if(n===0)return t;for(var s=n-1;0<=s;s--)e[s]==="1"&&t.push(Math.pow(2,n-s-1));return t}function jc(){return!Ge&&!ee}function os(e){return"the length of userIDList cannot exceed ".concat(e)}function Zp(e){var t;if(_e(e)&&e.length!==0)return t=0,e.forEach(function(n){t+=n}),t.toFixed(0)}function Qp(e){var t;if(_e(e)&&e.length!==0)return t=0,e.forEach(function(n){t+=n}),(t/e.length).toFixed(0)}function Kt(e,s,r){var s=!(1<arguments.length&&s!==void 0)||s,r=!(2<arguments.length&&r!==void 0)||r,a=Date.now();return s?r?"".concat(a-e," ms"):"".concat(Math.round((a-e)/1e3)," s"):r?a-e:Math.round((a-e)/1e3)}function ef(e){return!!(e&&1<e)}function tf(e,t,n,s){if(t===void 0)return 1;var r,a,l=!0;return t.required&&se(e)&&(m.e("[".concat(n,'] Missing required params: "').concat(s,'".')),l=!1),se(e)||(r=Us(e))!==(a=t.type.toLowerCase())&&(r==="asyncfunction"&&a==="function"||(m.e("[".concat(n,'] Invalid params: type check failed for "').concat(s,'". Expected ').concat(t.type,".")),l=!1)),t.validator&&!t.validator(e,n,s)&&(m.e("[".concat(n,'] Invalid params: custom validator check failed for "').concat(s,'".')),l=!1),l}function Ao(e){return!!e&&(!!(Zt(e)||ln(e)||Sr(e))||((e=lt("InvalidConversationID",e))&&m.w(e),!1))}function ne(e){e.desc!==""&&lt("API_REFER")!==""&&m.w("[".concat(e.api,"] | ").concat(e.paramName," | ").concat(e.desc,", ").concat(lt("API_REFER")).concat(e.api))}function Un(){return lt("StringRequiredLog")}function xs(e){return lt("NonEmptyStringRequiredLog",e)}function qs(){return lt("NumberRequiredLog")}function Rr(){return lt("UndefinedNotAllowedLog")}function Wc(){return lt("FileRequiredLog")}function vo(){return lt("FunctionRequiredLog")}function vn(){return lt("ArrayRequiredLog")}function Oo(){return lt("NonEmptyArrayLog")}function aa(){return lt("CallbackMissingLog")}function nf(){return lt("PositiveIntegerRequiredLog")}function ss(e,t){return lt("StringNotLongerThanLog",e,t)}function of(e,t){return lt("NumberGreaterThanLog",e,t)}function sf(e,t){return lt("NumberGreaterOrEqualLog",e,t)}function ca(e){return lt("KeyValueStringRequiredLog",e)}function Jn(){return lt("PlainObjectRequiredLog")}function rf(){return lt("NonEmptyContentRequiredLog")}function Vs(){return lt("FileNotSelectedLog")}function ua(){return lt("MessageInstanceRequiredLog")}function kr(){return lt("NonAnonymousFunctionLog")}function Yc(){return lt("MessageExtensionNotAvailableLog")}function zc(){return lt("MessageReactionRequiredLog")}function af(e,t){return lt("ContainsUnsupportedTypeLog",e,t)}function Bs(e,t,n,l){var r=l.allowUndefined,a=l.allowEmpty,l=l.maxLength;return H(e)?!!r||(ne({api:t,paramName:n,desc:Rr()}),!1):_e(e)?!(e.length===0&&(ne({api:t,paramName:n,desc:Oo()}),!a)||l&&e.length>l&&(ne({api:t,paramName:n,desc:lt("MaximumArrayLengthLog",n,l)}),1)):(ne({api:t,paramName:n,desc:vn()}),!1)}function Ar(e,t,n,l){var r=l.allowUndefined,a=l.min,l=l.max;return H(e)?!!r||(ne({api:t,paramName:n,desc:Rr()}),!1):Qe(e)?Qe(a)&&e<a?(ne({api:t,paramName:n,desc:a===0?sf(n,a):of(n,a-1)}),!1):!(Qe(l)&&l<e&&(ne({api:t,paramName:n,desc:lt("MaximumNumberLog",n,l)}),1)):(ne({api:t,paramName:n,desc:qs()}),!1)}function me(e){return{code:0,data:e||{}}}function Pe(e){return Promise.resolve(me(e))}function A(e){var t=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(e instanceof yt)return t&&rs!==null&&rs.emit($.ERROR,e),Promise.reject(e);if(e instanceof Error)return n=new yt({code:F.UNCAUGHT_ERROR}),t&&rs!==null&&rs.emit($.ERROR,n),Promise.reject(n);if(H(e)||H(e.code))return Promise.reject(new yt({code:F.UNCAUGHT_ERROR}));var n=new yt(e);return t&&rs!==null&&rs.emit($.ERROR,n),Promise.reject(n)}var cf,la="unSend",Fn="success",$c="fail",yo="notStart",uf="pending",Or="resolved",Hs="rejected",fe={type:"String",required:!0},Ke={type:"Array",required:!0},je={type:"Object",required:!0},Dn={type:"Boolean",required:!0},St={type:"number",required:!0},zt={keywordListForMsg:{type:"Array",required:!1,validator:function(e,t,n){return Bs(e,t,n,{allowUndefined:!0,allowEmpty:!0,maxLength:5})}},keywordListExceptMsg:{type:"Array",required:!0,validator:function(e,t,n){return Bs(e,t,n,{allowUndefined:!1,allowEmpty:!1,maxLength:5})}},keywordListMatchType:{type:"String",required:!1,validator:function(e,t,n){return!e||e==="or"||e==="and"||ne({api:t,paramName:n,desc:"".concat(e," is invalid match type")})}},cursor:{type:"String",required:!1},count:{type:"Number",required:!1,validator:function(e,t,n){return Ar(e,t,n,{allowUndefined:!0,min:1,max:100})}},groupTypeList:{type:"Array",required:!1,validator:function(e,t,n){if(!e)return!0;if(!Bs(e,t,n,{allowUndefined:!0,allowEmpty:!0}))return!1;var s=[I.GRP_PUBLIC,I.GRP_COMMUNITY,I.GRP_WORK,I.GRP_MEETING];return!(0<e.filter(function(r){return s.indexOf(r)===-1}).length&&(ne({api:t,paramName:n,desc:af(n,"group")}),1))}}},lt=null,lf={hookGetAPITips:function(e){lt=e},login:{userID:fe,userSig:fe},addToBlacklist:{userIDList:Ke},removeFromBlacklist:{userIDList:Ke},on:[{name:"eventName",type:"String",validator:function(e,t,n){return typeof e=="string"&&e.length!==0||(ne({api:t,paramName:n,desc:xs(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return typeof e!="function"?(ne({api:t,paramName:n,desc:vo()}),!1):(e.name===""&&ne({api:t,paramName:n,desc:kr()}),!0)}}],once:[{name:"eventName",type:"String",validator:function(e,t,n){return typeof e=="string"&&e.length!==0||(ne({api:t,paramName:n,desc:xs(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return typeof e!="function"?(ne({api:t,paramName:n,desc:vo()}),!1):(e.name===""&&ne({api:t,paramName:n,desc:kr()}),!0)}}],off:[{name:"eventName",type:"String",validator:function(e,t,n){return typeof e=="string"&&e.length!==0||(ne({api:t,paramName:n,desc:xs(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return typeof e!="function"?(ne({api:t,paramName:n,desc:vo()}),!1):(e.name===""&&ne({api:t,paramName:n,desc:kr()}),!0)}}],sendMessage:[c({name:"message"},je)],setMessageExtensions:[c(c({name:"message"},je),{},{validator:function(e,t,n){return e.status===Fn&&e.isSupportExtension===!0||(ne({api:t,paramName:n,desc:Yc()}),!1)}}),c({name:"extensions"},Ke)],getMessageExtensions:[c(c({name:"message"},je),{},{validator:function(e,t,n){return e.status===Fn&&e.isSupportExtension===!0||(ne({api:t,paramName:n,desc:Yc()}),!1)}})],deleteMessageExtensions:[c(c({name:"message"},je),{},{validator:function(e,t,n){return e.status===Fn&&e.isSupportExtension===!0||(ne({api:t,paramName:n,desc:Yc()}),!1)}})],addMessageReaction:[c(c({name:"message"},je),{},{validator:function(e,t,n){return e.status===Fn||(ne({api:t,paramName:n,desc:zc()}),!1)}}),c({name:"reactionID"},fe)],removeMessageReaction:[c(c({name:"message"},je),{},{validator:function(e,t,n){return e.status===Fn||(ne({api:t,paramName:n,desc:zc()}),!1)}}),c({name:"reactionID"},fe)],getMessageReactions:{messageList:c({},Ke)},getAllUserListOfMessageReaction:{message:c(c({},je),{},{validator:function(e,t,n){return e.status===Fn||(ne({api:t,paramName:n,desc:zc()}),!1)}}),reactionID:c({},fe),nextSeq:{type:"Number"},count:{type:"Number"}},getMessageList:{conversationID:c(c({},fe),{},{validator:Ao}),nextReqMessageID:{type:"String"},count:{type:"Number",validator:function(e,t,n){return!(!H(e)&&!/^[1-9][0-9]*$/.test(e)&&(ne({api:t,paramName:n,desc:nf()}),1))}}},getMessageListHopping:{conversationID:c(c({},fe),{},{validator:Ao}),sequence:{type:"Number"},time:{type:"Number"},direction:{type:"Number",validator:function(e,t,n){return!(!H(e)&&e!==0&&e!==1&&(ne({api:t,paramName:n,desc:lt("0Or1RequiredLog")}),1))}},count:{type:"Number",validator:function(e,t,n){return!(!H(e)&&!/^[1-9][0-9]*$/.test(e)&&(ne({api:t,paramName:n,desc:nf}),1))}}},setMessageRead:{conversationID:c(c({},fe),{},{validator:Ao})},setAllMessageRead:{scope:{type:"String",required:!1,validator:function(e,t,n){return!e||[I.READ_ALL_C2C_MSG,I.READ_ALL_GROUP_MSG,I.READ_ALL_MSG].indexOf(e)!==-1||(ne({api:t,paramName:n,desc:lt("ValidScopeRequired")}),!1)}}},getConversationProfile:[c(c({name:"conversationID"},fe),{},{validator:Ao})],clearHistoryMessage:[c(c({name:"conversationID"},fe),{},{validator:Ao})],pinConversation:{conversationID:c(c({},fe),{},{validator:Ao}),isPinned:c({},Dn)},setConversationDraft:{conversationID:c(c({},fe),{},{validator:Ao}),draftText:{type:"String",validator:function(e,t,n){return!!xe(e)||(ne({api:t,paramName:n,desc:Un()}),!1)}}},setConversationCustomData:{conversationIDList:c({},Ke),customData:{type:"String",validator:function(e,t,n){return xe(e)?!(256<e.length&&(ne({api:t,paramName:n,desc:ss(n,256)}),1)):(ne({api:t,paramName:n,desc:Un()}),!1)}}},markConversation:{conversationIDList:c({},Ke),markType:{type:"number",validator:function(e,t,n){return Qe(e)?e<=0?(ne({api:t,paramName:n,desc:of(n,0)}),!1):!(e>=Math.pow(2,64)&&(ne({api:t,paramName:n,desc:lt("NumberLessThanLog",n,"Math.pow(2,64)")}),1)):(ne({api:t,paramName:n,desc:qs()}),!1)}},enableMark:c({},Dn)},createConversationGroup:{conversationIDList:c({},Ke),groupName:c(c({},fe),{},{validator:function(e,t,n){return!(!e||32<e.length&&(ne({api:t,paramName:n,desc:ss(n,32)}),1))}})},deleteConversationGroup:[c({name:"groupName"},fe)],renameConversationGroup:{oldName:c({},fe),newName:c(c({},fe),{},{validator:function(e,t,n){return!(!e||32<e.length&&(ne({api:t,paramName:n,desc:ss(n,32)}),1))}})},addConversationsToGroup:{conversationIDList:c({},Ke),groupName:c({},fe)},deleteConversationsFromGroup:{conversationIDList:c({},Ke),groupName:c({},fe)},getGroupList:{groupProfileFilter:{type:"Array"}},getGroupProfile:{groupID:fe,groupCustomFieldFilter:{type:"Array"},memberCustomFieldFilter:{type:"Array"}},getGroupProfileAdvance:{groupIDList:Ke},createGroup:{name:fe},joinGroup:{groupID:fe,type:{type:"String"},applyMessage:{type:"String"}},quitGroup:[c({name:"groupID"},fe)],handleApplication:{message:je,handleAction:fe,handleMessage:{type:"String"}},changeGroupOwner:{groupID:fe,newOwnerID:fe},updateGroupProfile:{groupID:fe,muteAllMembers:{type:"Boolean"}},dismissGroup:[c({name:"groupID"},fe)],searchGroupByID:[c({name:"groupID"},fe)],getGroupOnlineMemberCount:[c({name:"groupID"},fe)],initGroupAttributes:{groupID:fe,groupAttributes:c(c({},je),{},{validator:function(e,t,n){var s=!0;return Object.keys(e).forEach(function(r){if(!xe(e[r]))return ne({api:t,paramName:n,desc:ca("value")}),s=!1}),s}})},setGroupAttributes:{groupID:fe,groupAttributes:c(c({},je),{},{validator:function(e,t,n){var s=!0;return Object.keys(e).forEach(function(r){if(!xe(e[r]))return ne({api:t,paramName:n,desc:ca("value")}),s=!1}),s}})},deleteGroupAttributes:{groupID:fe,keyList:{type:"Array",validator:function(e,t,n){return H(e)||!_e(e)?(ne({api:t,paramName:n,desc:vn()}),!1):!!se(e)||(s=!0,e.forEach(function(r){if(!xe(r))return ne({api:t,paramName:n,desc:lt("StringArrayRequiredLog")}),s=!1}),s);var s}}},getGroupAttributes:{groupID:fe,keyList:{type:"Array",validator:function(e,t,n){return H(e)||!_e(e)?(ne({api:t,paramName:n,desc:vn()}),!1):!!se(e)||(s=!0,e.forEach(function(r){if(!xe(r))return ne({api:t,paramName:n,desc:ca("key")}),s=!1}),s);var s}}},setGroupCounters:{groupID:fe,counters:je},increaseGroupCounter:{groupID:fe,key:fe,value:St},decreaseGroupCounter:{groupID:fe,key:fe,value:St},getGroupCounters:{groupID:fe},getGroupMemberList:{groupID:fe,count:{type:"Number"}},getGroupMemberProfile:{groupID:fe,userIDList:Ke,memberCustomFieldFilter:{type:"Array"}},addGroupMember:{groupID:fe,userIDList:Ke},setGroupMemberRole:{groupID:fe,userID:fe,role:fe},setGroupMemberMuteTime:{groupID:fe,userID:fe,muteTime:{type:"Number",validator:function(e){return 0<=e}}},setGroupMemberNameCard:{groupID:fe,userID:{type:"String"},nameCard:{type:"String",validator:function(e,t,n){return xe(e)?(e.length,!0):(ne({api:t,paramName:n,desc:Un()}),!1)}}},setGroupMemberCustomField:{groupID:fe,userID:{type:"String"},memberCustomField:Ke},deleteGroupMember:{groupID:fe},markGroupMemberList:{groupID:fe,markType:{type:"number",validator:function(e,t,n){return Qe(e)?!(e<1e3&&(ne({api:t,paramName:n,desc:sf(n,1e3)}),1)):(ne({api:t,paramName:n,desc:qs()}),!1)}},userIDList:c({},Ke),enableMark:c({},Dn)},createTextMessage:{to:fe,conversationType:fe,payload:c(c({},je),{},{validator:function(e,t,n){return dt(e)?xe(e.text)?e.text.length!==0||(ne({api:t,paramName:"payload.text",desc:rf()}),!1):(ne({api:t,paramName:"payload.text",desc:Un()}),!1):(ne({api:t,paramName:n,desc:Jn()}),!1)}})},createTextAtMessage:{to:fe,conversationType:fe,payload:c(c({},je),{},{validator:function(e,t,n){return dt(e)?xe(e.text)?e.text.length===0?(ne({api:t,paramName:"payload.text",desc:rf()}),!1):!(e.atUserList&&!_e(e.atUserList)&&(ne({api:t,paramName:"payload.atUserList",desc:vn()}),1)):(ne({api:t,paramName:"payload.text",desc:Un()}),!1):(ne({api:t,paramName:n,desc:Jn()}),!1)}})},createCustomMessage:{to:fe,conversationType:fe,payload:c(c({},je),{},{validator:function(e,t,n){return dt(e)?e.data&&!xe(e.data)?(ne({api:t,paramName:"payload.data",desc:Un()}),!1):e.description&&!xe(e.description)?(ne({api:t,paramName:"payload.description",desc:Un()}),!1):!(e.extension&&!xe(e.extension)&&(ne({api:t,paramName:"payload.extension",desc:Un()}),1)):(ne({api:t,paramName:"payload",desc:Jn()}),!1)}})},createImageMessage:{to:fe,conversationType:fe,payload:c(c({},je),{},{validator:function(e,t,n){if(!dt(e))return ne({api:t,paramName:n,desc:Jn()}),!1;if(H(e.file))return ne({api:t,paramName:"payload.file",desc:Rr()}),!1;if(Te){if(!(e.file instanceof HTMLInputElement||io(e.file)))return dt(e.file)&&typeof uni<"u"?e.file.tempFilePaths.length!==0&&e.file.tempFiles.length!==0||(ne({api:t,paramName:"payload.file",desc:Vs()}),!1):(ne({api:t,paramName:"payload.file",desc:Wc()}),!1);if(e.file instanceof HTMLInputElement&&e.file.files.length===0)return ne({api:t,paramName:"payload.file",desc:Vs()}),!1}return!0},onProgress:{type:"Function",required:!1,validator:function(e,t,n){return H(e)&&ne({api:t,paramName:n,desc:aa()}),!0}}})},createAudioMessage:{to:fe,conversationType:fe,payload:c(c({},je),{},{validator:function(e,t,n){return!!dt(e)||(ne({api:t,paramName:n,desc:Jn()}),!1)}}),onProgress:{type:"Function",required:!1,validator:function(e,t,n){return H(e)&&ne({api:t,paramName:n,desc:aa()}),!0}}},createVideoMessage:{to:fe,conversationType:fe,payload:c(c({},je),{},{validator:function(e,t,n){if(!dt(e))return ne({api:t,paramName:n,desc:Jn()}),!1;if(H(e.file))return ne({api:t,paramName:"payload.file",desc:Rr()}),!1;if(Te){if(!(e.file instanceof HTMLInputElement||io(e.file)))return dt(e.file)&&typeof uni<"u"?!!io(e.file.tempFile)||(ne({api:t,paramName:"payload.file",desc:Vs()}),!1):(ne({api:t,paramName:"payload.file",desc:Wc()}),!1);if(e.file instanceof HTMLInputElement&&e.file.files.length===0)return ne({api:t,paramName:"payload.file",desc:Vs()}),!1}return!0}}),onProgress:{type:"Function",required:!1,validator:function(e,t,n){return H(e)&&ne({api:t,paramName:n,desc:aa()}),!0}}},createFaceMessage:{to:fe,conversationType:fe,payload:c(c({},je),{},{validator:function(e,t,n){return dt(e)?Qe(e.index)?!!xe(e.data)||(ne({api:t,paramName:"payload.data",desc:Un()}),!1):(ne({api:t,paramName:"payload.index",desc:qs()}),!1):(ne({api:t,paramName:n,desc:Jn()}),!1)}})},createFileMessage:{to:fe,conversationType:fe,payload:c(c({},je),{},{validator:function(e,t,n){if(!dt(e))return ne({api:t,paramName:n,desc:Jn()}),!1;if(H(e.file))return ne({api:t,paramName:"payload.file",desc:Rr()}),!1;if(Te){if(!(e.file instanceof HTMLInputElement||io(e.file)))return dt(e.file)&&typeof uni<"u"?e.file.tempFilePaths.length!==0&&e.file.tempFiles.length!==0||(ne({api:t,paramName:"payload.file",desc:Vs()}),!1):(ne({api:t,paramName:"payload.file",desc:Wc()}),!1);if(e.file instanceof HTMLInputElement&&e.file.files.length===0)return ne({api:t,paramName:"payload.file",desc:Vs()}),!1}return!0}}),onProgress:{type:"Function",required:!1,validator:function(e,t,n){return H(e)&&ne({api:t,paramName:n,desc:aa()}),!0}}},createLocationMessage:{to:fe,conversationType:fe,payload:c(c({},je),{},{validator:function(e,t,n){return dt(e)?xe(e.description)?Qe(e.longitude)?!!Qe(e.latitude)||(ne({api:t,paramName:"payload.latitude",desc:qs()}),!1):(ne({api:t,paramName:"payload.longitude",desc:qs()}),!1):(ne({api:t,paramName:"payload.description",desc:Un()}),!1):(ne({api:t,paramName:n,desc:Jn()}),!1)}})},createMergerMessage:{to:fe,conversationType:fe,payload:c(c({},je),{},{validator:function(e,t,n){if(se(e.messageList))return ne({api:t,paramName:"payload.messageList",desc:Oo()}),!1;if(se(e.compatibleText))return ne({api:t,paramName:"payload.compatibleText",desc:xs("compatibleText")}),!1;var s=!1;return e.messageList.forEach(function(r){r.status===$c&&(s=!0)}),!s||(ne({api:t,paramName:"payload.messageList",desc:lt("MergeFailedMessageLog")}),!1)}})},revokeMessage:[c(c({name:"message"},je),{},{validator:function(e,t,n){return se(e)?(ne({api:t,paramName:n,desc:ua()}),!1):e.conversationType===I.CONV_SYSTEM?(ne({api:t,paramName:n,desc:lt("MessageCanBeRevokedDesc")}),!1):e.isRevoked!==!0||(ne({api:t,paramName:n,desc:lt("MessageRevokedLog")}),!1)}})],deleteMessage:[c(c({name:"messageList"},Ke),{},{validator:function(e,t,n){return!se(e)||(ne({api:t,paramName:n,desc:Oo()}),!1)}})],translateText:{sourceTextList:Ke,sourceLanguage:fe,targetLanguage:fe},convertVoiceToText:{message:c(c({},je),{},{validator:function(e,t,n){return se(e)?(ne({api:t,paramName:n,desc:ua()}),!1):e.type===I.MSG_AUDIO&&e.status===Fn||(ne({api:t,paramName:n,desc:lt("AudioMessageRequiredLog")}),!1)}})},modifyMessage:[c(c({name:"message"},je),{},{validator:function(e,t,n){return se(e)?(ne({api:t,paramName:n,desc:ua()}),!1):e.conversationType===I.CONV_SYSTEM?(ne({api:t,paramName:n,desc:lt("MessageCanBeModifiedLog")}),!1):e._onlineOnlyFlag!==!0||(ne({api:t,paramName:n,desc:lt("OnlineMessageNotSupportLog")}),!1)}})],searchCloudMessages:{keywordList:zt.keywordListForMsg,keywordListMatchType:zt.keywordListMatchType,cursor:zt.cursor,senderUserIDList:{type:"Array",required:!1,validator:function(e,t,n){return Bs(e,t,n,{allowUndefined:!0,allowEmpty:!0,maxLength:5})}},messageTypeList:{type:"Array",required:!1,validator:function(e,t,n){if(!e)return!0;if(!Bs(e,t,n,{allowUndefined:!0,allowEmpty:!0}))return!1;var s=[I.MSG_TEXT,I.MSG_IMAGE,I.MSG_AUDIO,I.MSG_FILE,I.MSG_VIDEO,I.MSG_LOCATION,I.MSG_CUSTOM,I.MSG_MERGER];return!(0<e.filter(function(r){return s.indexOf(r)===-1}).length&&(ne({api:t,paramName:n,desc:af(n,"message")}),1))}},conversationID:{type:"String",required:!1,validator:function(e){return!e||Ao(e)}},timePosition:{type:"number",required:!1,validator:function(e,t,n){return Ar(e,t,n,{allowUndefined:!0,min:0})}},timePeriod:{type:"number",required:!1,validator:function(e,t,n){return Ar(e,t,n,{allowUndefined:!0,min:0})}}},searchCloudUsers:{keywordList:zt.keywordListExceptMsg,keywordListMatchType:zt.keywordListMatchType,cursor:zt.cursor,count:zt.count,miniBirthday:{type:"Number",required:!1,validator:function(e,t,n){return Ar(e,t,n,{allowUndefined:!0,min:0})}},maxBirthday:{type:"Number",required:!1,validator:function(e,t,n){return Ar(e,t,n,{allowUndefined:!0,min:0})}},gender:{type:"String",required:!1,validator:function(e,t,n){return!e||e===I.GENDER_FEMALE||e===I.GENDER_MALE||ne({api:t,paramName:n,desc:"".concat(e," is invalid match type")})}}},searchCloudGroups:{keywordList:zt.keywordListExceptMsg,keywordListMatchType:zt.keywordListMatchType,cursor:zt.cursor,count:zt.count,groupTypeList:zt.groupTypeList},searchCloudGroupMembers:{keywordList:zt.keywordListExceptMsg,keywordListMatchType:zt.keywordListMatchType,cursor:zt.cursor,count:zt.count,groupTypeList:zt.groupTypeList,groupIDList:{type:"Array",required:!1,validator:function(e,t,n){return Bs(e,t,n,{allowUndefined:!0,allowEmpty:!0})}}},getUserProfile:{userIDList:{type:"Array",validator:function(e,t,n){return _e(e)?(e.length===0&&ne({api:t,paramName:n,desc:Oo()}),!0):(ne({api:t,paramName:n,desc:vn()}),!1)}}},updateMyProfile:{profileCustomField:{type:"Array",validator:function(e,t,n){return!!H(e)||!!_e(e)||(ne({api:t,paramName:n,desc:vn()}),!1)}}},setSelfStatus:{customStatus:{type:"String",validator:function(e,t,n){return!!xe(e)||(ne({api:t,paramName:n,desc:Un()}),!1)}}},getUserStatus:{userIDList:{type:"Array",validator:function(e,t,n){return _e(e)?e.length!==0||(ne({api:t,paramName:n,desc:Oo()}),!1):(ne({api:t,paramName:n,desc:vn()}),!1)}}},subscribeUserStatus:{userIDList:{type:"Array",validator:function(e,t,n){return _e(e)?e.length!==0||(ne({api:t,paramName:n,desc:Oo()}),!1):(ne({api:t,paramName:n,desc:vn()}),!1)}}},unsubscribeUserStatus:{userIDList:{type:"Array",validator:function(e,t,n){return!e||!!_e(e)||(ne({api:t,paramName:n,desc:vn()}),!1)}}},addFriend:{to:fe,source:{type:"String",required:!0,validator:function(e,t,n){return!(!e||(e.startsWith("AddSource_Type_")?8<e.replace("AddSource_Type_","").length&&(ne({api:t,paramName:n,desc:ss("keyword",8)}),1):(ne({api:t,paramName:n,desc:lt("SourcePrefixLog")}),1)))}},remark:{type:"String",required:!1,validator:function(e,t,n){return!(xe(e)&&96<e.length&&(ne({api:t,paramName:n,desc:ss(n,96)}),1))}}},deleteFriend:{userIDList:Ke},checkFriend:{userIDList:Ke},getFriendProfile:{userIDList:Ke},updateFriend:{userID:fe,remark:{type:"String",required:!1,validator:function(e,t,n){return!(xe(e)&&96<e.length&&(ne({api:t,paramName:n,desc:ss(n,96)}),1))}},friendCustomField:{type:"Array",required:!1,validator:function(e,t,n){if(e){if(!_e(e))return ne({api:t,paramName:n,desc:vn()}),!1;var s=!0;return e.forEach(function(r){return xe(r.key)&&r.key.indexOf("Tag_SNS_Custom")!==-1?xe(r.value)?8<r.key.replace("Tag_SNS_Custom_","").length?(ne({api:t,paramName:n,desc:ss("keyword",8)}),s=!1):void 0:(ne({api:t,paramName:n,desc:ca("value")}),s=!1):(ne({api:t,paramName:n,desc:lt("FriendCustomFieldPrefixLog")}),s=!1)}),s}return!0}}},acceptFriendApplication:{userID:fe},refuseFriendApplication:{userID:fe},deleteFriendApplication:{userID:fe},createFriendGroup:{name:fe},deleteFriendGroup:{name:fe},addToFriendGroup:{name:fe,userIDList:Ke},removeFromFriendGroup:{name:fe,userIDList:Ke},renameFriendGroup:{oldName:fe,newName:fe},sendMessageReadReceipt:[{name:"messageList",type:"Array",validator:function(e,t,n){return _e(e)?e.length!==0||(ne({api:t,paramName:n,desc:Oo()}),!1):(ne({api:t,paramName:n,desc:vn()}),!1)}}],getMessageReadReceiptList:[{name:"messageList",type:"Array",validator:function(e,t,n){return _e(e)?e.length!==0||(ne({api:t,paramName:n,desc:Oo()}),!1):(ne({api:t,paramName:n,desc:vn()}),!1)}}],createTopicInCommunity:{groupID:fe,topicName:fe},deleteTopicFromCommunity:{groupID:fe,topicIDList:{type:"Array",validator:function(e,t,n){return!e||!!_e(e)||(ne({api:t,paramName:n,desc:vn()}),!1)}}},updateTopicProfile:{groupID:fe,topicID:fe},getTopicList:{groupID:fe,topicIDList:{type:"Array",validator:function(e,t,n){return!e||!!_e(e)||(ne({api:t,paramName:n,desc:vn()}),!1)}}},followUser:[c({name:"userIDList"},Ke)],unfollowUser:[c({name:"userIDList"},Ke)],getMyFollowingList:[c(c({name:"startIndex"},fe),{},{required:!1})],getMyFollowersList:[c(c({name:"startIndex"},fe),{},{required:!1})],getMutualFollowersList:[c(c({name:"startIndex"},fe),{},{required:!1})],getUserFollowInfo:[c(c({name:"userIDList"},Ke),{},{required:!1})],checkFollowType:[c({name:"userIDList"},Ke)],addSignalingListener:[{name:"eventName",type:"String",validator:function(e,t,n){return typeof e=="string"&&e.length!==0||(ne({api:t,paramName:n,desc:xs(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return typeof e!="function"?(ne({api:t,paramName:n,desc:vo()}),!1):(e.name===""&&ne({api:t,paramName:n,desc:kr()}),!0)}}],removeSignalingListener:[{name:"eventName",type:"String",validator:function(e,t,n){return typeof e=="string"&&e.length!==0||(ne({api:t,paramName:n,desc:xs(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return typeof e!="function"?(ne({api:t,paramName:n,desc:vo()}),!1):(e.name===""&&ne({api:t,paramName:n,desc:kr()}),!0)}}],invite:{userID:fe},inviteSync:[c(c({},je),{},{validator:function(e,t,n){return dt(e)?!!xe(e.userID)||(ne({api:t,paramName:"options.userID",desc:Un()}),!1):(ne({api:t,paramName:"options",desc:Jn()}),!1)}}),{name:"successCb",type:"Function",required:!1,validator:function(e,t,n){return H(e)&&ne({api:t,paramName:n,desc:vo()}),!0}},{name:"errorCb",type:"Function",required:!1,validator:function(e,t,n){return H(e)&&ne({api:t,paramName:n,desc:vo()}),!0}}],inviteInGroup:{groupID:fe,inviteeList:Ke},inviteInGroupSync:[c(c({},je),{},{validator:function(e,t,n){return dt(e)?xe(e.groupID)?!!_e(e.inviteeList)||(ne({api:t,paramName:"options.inviteeList",desc:vn()}),!1):(ne({api:t,paramName:"options.groupID",desc:Un()}),!1):(ne({api:t,paramName:"options",desc:Jn()}),!1)}}),{name:"successCb",type:"Function",required:!1,validator:function(e,t,n){return H(e)&&ne({api:t,paramName:n,desc:vo()}),!0}},{name:"errorCb",type:"Function",required:!1,validator:function(e,t,n){return H(e)&&ne({api:t,paramName:n,desc:vo()}),!0}}],accept:{inviteID:fe},reject:{inviteID:fe},getSignalingInfo:[c(c({name:"message"},je),{},{validator:function(e,t,n){return!se(e)||(ne({api:t,paramName:n,desc:ua()}),!1)}})],modifyInvitation:{inviteID:fe,data:fe}},My={login:1,logout:1,getLoginUser:1,getServerTime:1,on:1,once:1,off:1,setLogLevel:1,registerPlugin:1,destroy:1,isReady:1,createTextMessage:1,createTextAtMessage:1,createImageMessage:1,createAudioMessage:1,createVideoMessage:1,createCustomMessage:1,createFaceMessage:1,createFileMessage:1,createLocationMessage:1,createMergerMessage:1,downloadMergerMessage:1,createForwardMessage:1,sendMessage:1,resendMessage:1,revokeMessage:1,deleteMessage:1,translateText:1,convertVoiceToText:1,modifyMessage:1,sendMessageReadReceipt:1,getGroupMessageReadMemberList:1,getMessageReadReceiptList:1,setMessageExtensions:1,getMessageExtensions:1,deleteMessageExtensions:1,addMessageReaction:1,removeMessageReaction:1,getMessageReactions:1,getAllUserListOfMessageReaction:1,getMessageList:1,findMessage:1,getMessageListHopping:1,setMessageRead:1,setAllMessageRead:1,getConversationList:1,getConversationProfile:1,deleteConversation:1,setConversationDraft:1,pinConversation:1,getTotalUnreadMessageCount:1,setConversationCustomData:1,markConversation:1,createConversationGroup:1,getConversationGroupList:1,deleteConversationGroup:1,renameConversationGroup:1,addConversationsToGroup:1,deleteConversationsFromGroup:1,clearHistoryMessage:1,setMessageRemindType:1,setAllReceiveMessageOpt:1,getAllReceiveMessageOpt:1,getGroupList:1,getGroupProfile:1,createGroup:1,joinGroup:1,updateGroupProfile:1,quitGroup:1,dismissGroup:1,changeGroupOwner:1,searchGroupByID:1,getGroupApplicationList:1,handleGroupApplication:1,initGroupAttributes:1,setGroupAttributes:1,deleteGroupAttributes:1,getGroupAttributes:1,setGroupCounters:1,increaseGroupCounter:1,decreaseGroupCounter:1,getGroupCounters:1,getJoinedCommunityList:1,createTopicInCommunity:1,deleteTopicFromCommunity:1,updateTopicProfile:1,getTopicList:1,getGroupMemberProfile:1,getGroupMemberList:1,addGroupMember:1,deleteGroupMember:1,setGroupMemberNameCard:1,setGroupMemberMuteTime:1,setGroupMemberRole:1,setGroupMemberCustomField:1,getGroupOnlineMemberCount:1,markGroupMemberList:1,getMyProfile:1,getUserProfile:1,updateMyProfile:1,setSelfStatus:1,getUserStatus:1,subscribeUserStatus:1,unsubscribeUserStatus:1,getBlacklist:1,addToBlacklist:1,removeFromBlacklist:1,searchCloudMessages:1,searchCloudUsers:1,searchCloudGroups:1,searchCloudGroupMembers:1,getFriendList:1,addFriend:1,deleteFriend:1,checkFriend:1,updateFriend:1,getFriendProfile:1,getFriendApplicationList:1,refuseFriendApplication:1,deleteFriendApplication:1,acceptFriendApplication:1,setFriendApplicationRead:1,getFriendGroupList:1,createFriendGroup:1,renameFriendGroup:1,deleteFriendGroup:1,addToFriendGroup:1,removeFromFriendGroup:1,followUser:1,unfollowUser:1,getMyFollowingList:1,getMyFollowersList:1,getMutualFollowersList:1,getUserFollowInfo:1,checkFollowType:1,callExperimentalAPI:1,addSignalingListener:1,removeSignalingListener:1,invite:1,inviteSync:1,inviteInGroup:1,inviteInGroupSync:1,cancel:1,accept:1,reject:1,getSignalingInfo:1,modifyInvitation:1},yt=(T(da,N(Error)),cf=z(da),y(da)),F={NO_SDKAPPID:2e3,NO_ACCOUNT_TYPE:2001,NO_IDENTIFIER:2002,NO_USERSIG:2003,NO_TINYID:2022,NO_A2KEY:2023,USER_NOT_LOGGED_IN:2024,REPEAT_LOGIN:2025,COS_UNDETECTED:2040,COS_GET_SIG_FAIL:2041,MSG_SEND_FAIL:2100,MSG_SEND_FAIL_NOT_IN_AV:2101,MSG_INSTANCE_REQUIRED:2105,MSG_INVALID_CONV_TYPE:2106,MSG_F_IS_EMPTY:2108,MSG_ONPROGRESS_ERR:2109,MSG_REVOKE_FAIL:2110,MSG_DELETE_FAIL:2111,MSG_UNREAD_ALL_FAIL:2112,READ_RECEIPT_MSG_LIST_EMPTY:2114,MSG_SEND_GRP_WITH_TOPIC_FAIL:2115,CANNOT_DELETE_GRP_SYSTEM_NOTICE:2116,TRANSLATE_TEXT_FAIL:2117,VOICE_TO_TEXT_FAIL:2118,UNSUPPORTED_VOICE_FORMAT:2119,MSG_I_SELECT_F_FIRST:2251,MSG_I_TYPES_LIMIT:2252,MSG_I_SIZE_LIMIT:2253,MSG_A_UPLOAD_FAIL:2300,MSG_A_SIZE_LIMIT:2301,MSG_V_UPLOAD_FAIL:2350,MSG_V_SIZE_LIMIT:2351,MSG_V_TYPES_LIMIT:2352,MSG_F_UPLOAD_FAIL:2400,MSG_F_SELECT_F_FIRST:2401,MSG_F_SIZE_LIMIT:2402,MSG_F_URL_IS_EMPTY:2403,MSG_MERGER_TYPE_INVALID:2450,MSG_MERGER_KEY_INVALID:2451,MSG_MERGER_DOWNLOAD_FAIL:2452,MSG_FORWARD_TYPE_INVALID:2453,MSG_FORWARD_INVALID_ELEMENTS:2454,MSG_MODIFY_CONFLICT:2480,MSG_MODIFY_DISABLED_IN_AV:2481,CONV_NOT_FOUND:2500,USER_OR_GRP_NOT_FOUND:2501,CONV_UN_RECORDED_TYPE:2502,INVALID_CONV_ID:2503,ILLEGAL_GRP_TYPE:2600,ILLEGAL_GRP_ID:2602,CANNOT_FIND_GRP:2603,CANNOT_CHANGE_OWNER_IN_AV:2620,CANNOT_CHANGE_OWNER_TO_SELF:2621,MEMBER_NOT_IN_GRP:2623,JOIN_GRP_FAIL:2660,CANNOT_ADD_MEMBER_IN_AV:2661,CANNOT_JOIN_NON_AV_WITHOUT_LOGIN:2662,NOT_OWNER:2681,INVALID_MEMBER_ROLE:2683,CANNOT_SET_SELF_MEMBER_ROLE:2684,CANNOT_MUTE_SELF:2685,BAN_DURATION_INVALID:2686,OPERATION_NOT_SUPPORTED_IN_AV:2687,NOT_MY_FRIEND:2700,ALREADY_MY_FRIEND:2701,FRIEND_GRP_EXISTED:2710,FRIEND_GRP_NOT_EXIST:2711,FRIEND_APPLICATION_NOT_EXIST:2716,UPDATE_PROFILE_INVALID_PARAM:2721,UPDATE_PROFILE_NO_KEY:2722,CANNOT_ADD_SELF_TO_BLACKLIST:2742,NETWORK_ERROR:2800,NETWORK_TIMEOUT:2801,NO_NETWORK:2805,UNCAUGHT_ERROR:2903,INVALID_OPERATION:2905,INVALID_TRTC_CMD:2995,OVER_FREQUENCY_LIMIT:2996,NO_PROTOCOL:2997,NO_MODULE:2998,SDK_IS_NOT_READY:2999,LOGGING_IN:3e3,LOGIN_FAILED:3001,KICKED_OUT_MULT_DEVICE:3002,KICKED_OUT_MULT_ACCOUNT:3003,KICKED_OUT_USERSIG_EXPIRED:3004,LOGGED_OUT:3005,KICKED_OUT_REST_API:3006,ILLEGAL_TOPIC_ID:3021,NO_USE:3122,PROFANITY_FOUND:3123,OPTIONS_IS_EMPTY:3153,MSG_A2KEY_EXPIRED:20002,ACCOUNT_A2KEY_EXPIRED:70001,HELLO_ANSWER_KICKED_OUT:1002,OPEN_SERVICE_OVERLOAD_ERROR:60022,SIGNALING_INVALID_INVITE_ID:8010,SIGNALING_NO_PERMISSION:8011,SIGNALING_ALREADY_EXISTS:8012,INVALID_CANCEL_MESSAGE:8020},rs=null,St=(y(eu,[{key:"isLoggedIn",value:function(){return this._m.get(12).isLoggedIn()}},{key:"isOversea",value:function(){return this._m.get(12).isOversea()}},{key:"isPrivateNetWork",value:function(){var e=this._m.get(12);return e.isPrivateNetWork()&&!e.getFileDownloadProxy()}},{key:"getFileDownloadProxy",value:function(){return this._m.get(12).getFileDownloadProxy()}},{key:"getDowloadFileAuthKey",value:function(){return this._m.get(12).getDowloadFileAuthKey()}},{key:"getMyUserID",value:function(){return this._m.get(12).getUserID()}},{key:"getMyTinyID",value:function(){return this._m.get(12).getTinyID()}},{key:"getSDKAppID",value:function(){return this._m.get(12).getSDKAppID()}},{key:"isIntl",value:function(){return this._m.get(12).isIntl()}},{key:"isUsingChatCore",value:function(){return this._m.get(12).isUsingChatCore()}},{key:"isDevMode",value:function(){return this._m.get(12).isDevMode()}},{key:"get",value:function(e){return this._m.get(e)}},{key:"getPlatform",value:function(){return Me}},{key:"getCloudConfig",value:function(e){return this._m.get(23).getCloudConfig(e)}},{key:"emitOEvt",value:function(e,t){this._m.getOEmitInst().emit(e,t)}},{key:"emitIEvt",value:function(e,t){this._m.getIEmitInst().emit(e,t)}},{key:"getIEmitInst",value:function(){return this._m.getIEmitInst()}},{key:"req",value:function(e){return this._m.get(20).req(e)}},{key:"canIUse",value:function(e){return this._m.get(27).canIUse(e)}},{key:"getErrMsg",value:function(e,t,n){return this._m.getErrMsg(e,t,n)}},{key:"warn",value:function(e,t,n){e=this.getErrMsg(e,t,n),e&&m.w(e)}},{key:"noUse",value:function(e){var t=F.NO_USE;return A({code:t,message:this.getErrMsg(t,e)})}}]),eu),E={LOGIN:"wslogin",LOGOUT:"wslogout",HELLO:"wshello",KICK_OTHER:"KickOther",SYNC_UNREAD_MSG:"getmsg",SEND_C2C_MSG:"sendmsg",SEND_GRP_MSG:"send_group_msg",GET_USER_PROFILE:"portrait_get_all",UPDATE_MY_PROFILE:"portrait_set",GET_BL:"black_list_get",ADD_TO_BL:"black_list_add",RM_FROM_BL:"black_list_delete",GET_FD_LIST:"friend_get",GET_FD_PROFILE:"friend_get_specified",CHECK_FD:"friend_check",DEL_FD:"friend_delete",ADD_FD:"friend_add",UPDATE_FD:"friend_update",RESPOND_FD_APPLICATION:"friend_response",GET_FD_APPLICATION_LIST:"pendency_get",DEL_FD_APPLICATION:"pendency_delete",REFUSE_FD_APPLICATION:"pendency_refuse",REPORT_FD_APPLICATION:"pendency_report",GET_FD_GRP_LIST:"group_get",CREATE_FD_GRP:"group_add",DEL_FD_GRP:"group_delete",UPDATE_FD_GRP:"group_update",REVOKE_C2C_MSG:"msgwithdraw",SET_C2C_MSG_READ:"msgreaded",SET_C2C_PEER_MUTE_NOTIFICATIONS:"set_c2c_peer_mute_notifications",GET_C2C_PEER_MUTE_NOTIFICATIONS:"get_c2c_peer_mute_notifications",GET_C2C_ROAMING_MSG:"getroammsg",GET_C2C_PEER_READ_TIME:"get_peer_read_time",DEL_C2C_MSG:"delete_c2c_msg_ramble",MODIFY_C2C_MSG:"modify_c2c_msg",MODIFY_C2C_MSG_EXT:"set_key_values",GET_C2C_MSG_EXT:"get_key_values",ADD_C2C_MSG_REACTION:"reaction_add",RM_C2C_MSG_REACTION:"reaction_del",GET_C2C_MSG_REACTIONS:"reaction_multi_stat",GET_C2C_MSG_REACTION_USER_LIST:"reaction_iterate",PAGING_GET_CONV_LIST:"page_get",DEL_CONV:"batch_delete",CLEAR_HISTORY_MSG:"clear_msg",PIN_CONV:"top",DEL_GROUP_AT_TIPS:"deletemsg",SET_CONV_CUSTOM_DATA:"set_conv_custom_data",MARK_CONV:"mark_contact",CREATE_CONV_GRP:"create_contact_group",DEL_CONV_GRP:"del_contact_group",RENAME_CONV_GRP:"update_contact_group",ADD_CONV_TO_GRP:"add_conv_to_group",DEL_CONV_FROM_GRP:"del_conv_from_group",GET_CONV_GRP_LIST:"get_contact_group",SEARCH_CONV_GRP_MARK:"search_contact_group",GET_GRP_LIST:"get_joined_group_list",GET_GRP_PROFILE:"get_group_self_member_info",CREATE_GRP:"create_group",DISMISS_GRP:"destroy_group",UPDATE_GRP_PROFILE:"modify_group_base_info",APPLY_JOIN_GRP:"apply_join_group",APPLY_JOIN_GRP_NOAUTH:"apply_join_group_noauth",QUIT_GRP:"quit_group",SEARCH_GRP:"get_group_public_info",CHANGE_GRP_OWNER:"change_group_owner",HANDLE_GRP_APPLICATION:"handle_apply_join_group",HANDLE_INVITE_JOIN_GRP:"handle_invite_join_permission_group",HANDLE_GRP_INVITATION:"handle_invite_join_group",REVOKE_GRP_MSG:"group_msg_recall",SET_GRP_MSG_READ:"msg_read_report",SET_ALL_MSG_READ:"read_all_unread_msg",GET_GRP_ROAMING_MSG:"group_msg_get",GET_READ_RECEIPT:"get_group_msg_receipt",SEND_READ_RECEIPT:"group_msg_receipt",SEND_C2C_READ_RECEIPT:"c2c_msg_read_receipt",GET_READ_RECEIPT_DETAIL:"get_group_msg_receipt_detail",GET_GRP_PENDENCY:"get_pendency",DEL_GRP_SYSTEM_NOTICE:"deletemsg",AV_POLLING:"get_msg",AV_NOAUTH_POLLING:"get_msg_noauth",GET_ONLINE_MBR_NUM:"get_online_member_num",DEL_GRP_MSG:"delete_group_ramble_msg_by_seq",MODIFY_GRP_MSG:"modify_group_msg",SET_GRP_ATTR:"set_group_attr",MODIFY_GRP_ATTR:"modify_group_attr",DEL_GRP_ATTR:"delete_group_attr",CLEAR_GRP_ATTR:"clear_group_attr",GET_GRP_ATTR:"get_group_attr",MODIFY_GRP_MSG_EXT:"group_set_key_values",GET_GRP_MSG_EXT:"group_get_key_values",GET_GRP_NOTIFY:"batch_get_group_notify",UPDATE_GRP_COUNTER:"update_group_counter",GET_GRP_COUNTER:"get_group_counter",ADD_GRP_MSG_REACTION:"group_reaction_add",RM_GRP_MSG_REACTION:"group_reaction_del",GET_GRP_MSG_REACTIONS:"group_reaction_multi_stat",GET_GRP_MSG_REACTION_USER_LIST:"group_reaction_iterate",GET_GRP_MBR_LIST:"get_group_member_info",GET_AV_MBR_LIST:"get_members",GET_GRP_MBR_PROFILE:"get_specified_group_member_info",ADD_GRP_MBR:"add_group_member",DEL_GRP_MBR:"delete_group_member",BAN_AV_MBR:"ban_group_member",MODIFY_GRP_MBR_INFO:"modify_group_member_info",MARK_AV_MBR_INFO:"modify_user_info",COS_SIGN:"cos",COS_PRE_SIG:"pre_sig",SIMPLE_COS_PRE_SIG:"simple_sig",GET_IMAGE_INFO:"get_imageinfo",GET_IP:"get_final_ip",VIDEO_COVER:"video_cover",SSO_STAT:"tim_web_report_v2",PING:"alive",MSG_PUSH:"msg_push",CS:"query",GRP_CS:"query_grp",MBR_CS:"query_grp_member",USER_CS:"query_user",MULTI_MSG_PUSH:"multi_msg_push_ws",MSG_PUSH_ACK:"ws_msg_push_ack",STATUS_FORCE_OFFLINE:"stat_forceoffline",UPLOAD_MERGER_MSG:"save_relay_json_msg",DOWNLOAD_MERGER_MSG:"get_relay_json_msg",FETCH_CLOUD_CTRL_CONFIG:"fetch_config",PUSHED_CLOUD_CTRL_CONFIG:"push_configv2",FETCH_COMMERCIAL_CONFIG:"fetch_imsdk_purchase_bitsv2",PUSHED_COMMERCIAL_CONFIG:"push_imsdk_purchase_bitsv2",OVERLOAD_NOTIFY:"notify2",CREATE_TOPIC:"create_topic",DEL_TOPIC:"destroy_topic",UPDATE_TOPIC_PROFILE:"modify_topic",GET_TOPIC_LIST:"get_topic",SET_SELF_STATUS:"ws_set_custom_status",GET_USER_STATUS:"ws_get_user_status",SUB_USER_STATUS:"ws_status_subscribe",UNSUB_USER_STATUS:"ws_status_unsubscribe",STAT_BACKGROUND:"ws_stat_background",STAT_FOREGROUND:"ws_stat_foreground",SET_TOKEN:"ws_stat_settoken",PUSH_REPORT:"uniapp_sdk_report",GET_PROFANITY_LIST:"get_local_words",TRANSLATE_TEXT:"ws_batch_trans_text",VOICE_TO_TEXT:"ws_sentence_recognition",FOLLOW:"follow_add",UNFOLLOW:"follow_delete",GET_FOLLOW:"follow_get",GET_FOLLOW_INFO:"follow_get_info",CHECK_FOLLOW_TYPE:"follow_check",SET_ALL_RECEIVE_MSG_OPT:"ws_set_do_not_disturb",GET_ALL_RECEIVE_MSG_OPT:"ws_get_do_not_disturb"},Jc="networkRTT",Xc="messageE2EDelay",Ks="sendMessageC2C",js="sendMessageGroup",Ws="sendMessageGroupAV",is="sendMessageRichMedia",yn="cosUpload",Ys="messageReceivedGroup",Nr="messageReceivedGroupAVPush",Pr="messageReceivedGroupAVPull",Cy=(C(Dn={},Jc,2),C(Dn,Xc,3),C(Dn,Ks,4),C(Dn,js,5),C(Dn,Ws,6),C(Dn,is,7),C(Dn,Ys,8),C(Dn,Nr,9),C(Dn,Pr,10),C(Dn,yn,11),Dn),Ty={info:4,warning:5,error:6},df={wifi:1,"2g":2,"3g":3,"4g":4,"5g":5,unknown:6,none:7,online:8},Ey={login:4,plugin_search:16,plugin_translate:16,plugin_voice_to_text:16,plugin_cs:16,plugin_push:16,plugin_bot:16,plugin_emoji_reaction:16,tui_key_features:16},K=(y(br,[{key:"updateTimeStamp",value:function(){this.timestamp=Wn()}},{key:"start",value:function(e){return this._startts=e,this}},{key:"end",value:function(){var e,t=this,n=0<arguments.length&&arguments[0]!==void 0&&arguments[0];this._sentFlag||(this._netMonitorModule&&(e=this._netMonitorModule.getNetworkType(),this.setNetworkType(e)),e=Wn(),this.costTime===0&&(this.costTime=e-this._startts),this.setMoreMessage("startts:".concat(this._startts," endts:").concat(e)),n?(this._sentFlag=!0,this._eventStatModule&&this._eventStatModule.pushIn(this)):setTimeout(function(){t._sentFlag=!0,t._eventStatModule&&t._eventStatModule.pushIn(t)},0))}},{key:"setError",value:function(e){if(!(e instanceof Error))return m.w("".concat(this._n,".setError value not instanceof Error, please check!")),this;if(this._sentFlag)return this;var t=!0;return(t=this._netMonitorModule?this._netMonitorModule.isOnline():t)?(e.code&&this.setCode(e.code),e.message&&this.setMoreMessage(e.message)):this.setCode(F.NO_NETWORK),this.setLevel("error"),this}},{key:"setCode",value:function(e){return H(e)||this._sentFlag||(e==="ECONNABORTED"&&(this.code=103),Qe(e)?this.code=e:m.w("".concat(this._n,".setCode value not a number, please check!"),e,p(e))),this}},{key:"setMessage",value:function(e){return H(e)||this._sentFlag||(Qe(e)&&(this.message=e.toString()),xe(e)&&(this.message=e)),this}},{key:"setCostTime",value:function(e){return this.costTime=e,this}},{key:"setLevel",value:function(e){return H(e)||this._sentFlag||(this.level=Ty[e]),this}},{key:"setMoreMessage",value:function(e){return se(this.moreMessage)?this.moreMessage="".concat(e):this.moreMessage+=" ".concat(e),this}},{key:"setNetworkType",value:function(e){return H(e)?m.w("".concat(this._n,".setNetworkType value is undefined, please check!")):(e=df[e.toLowerCase()],H(e)||(this.networkType=e)),this}},{key:"getStartTs",value:function(){return this._startts}},{key:"setUIPlatform",value:function(e){return this.uiPlatform=e,this}},{key:"setExtension",value:function(e){return this.extension=e,this}},{key:"setEventType",value:function(e){return this.eventType=e,this}}],[{key:"bindEventStatModule",value:function(e){br.prototype._eventStatModule=e}},{key:"bindNetMonitorModule",value:function(e){br.prototype._netMonitorModule=e}}]),br),Zc=(y(Qc,[{key:"setText",value:function(e){this.content.text=e}},{key:"sendable",value:function(){return this.content.text.length!==0}}]),Qc);function Qc(e){f(this,Qc),this.type=I.MSG_TEXT,this.content={text:e.text||""}}function br(e){f(this,br),this._n="SSOLogData",this.eventType=Ey[e]||0,this.timestamp=0,this.networkType=8,this.code=0,this.message="",this.moreMessage="",this.extension=e,this.costTime=0,this.duplicate=!1,this.level=4,this.uiPlatform=void 0,this._sentFlag=!1,this._startts=Wn()}function eu(e){f(this,eu),this._m=e,this._n=""}function da(r){f(this,da),t=cf.call(this);var t,n=r.code,s=r.message,r=r.data;return t.code=n,s?t.message=s:t._getErrMsg&&(t.message=t._getErrMsg(t.code)),t.data=r||{},t}function hn(e,t,n,a){var r,a=3<arguments.length&&a!==void 0?a:[];if(e)return r=e,t&&(e.startsWith("http://")?r=e.replace(/^http:\/\/[^/]+/,t):e.startsWith("https://")&&(r=e.replace(/^https:\/\/[^/]+/,t))),n&&r.indexOf("authKey=")===-1&&tu(r,a)?(-1<r.indexOf("?")?"".concat(r,"&authKey="):"".concat(r,"?authKey=")).concat(n):r}function pa(e,t,s){var s=2<arguments.length&&s!==void 0?s:[];return e===I.MSG_VIDEO?tu((t[0].content||t[0].payload).snapshotUrl,s)&&(t[0].content?(t[0].content.snapshotUrl=zs(t[0].content.snapshotUrl),t[0].content.thumbUrl=zs(t[0].content.thumbUrl)):(t[0].payload.snapshotUrl=zs(t[0].payload.snapshotUrl),t[0].payload.thumbUrl=zs(t[0].payload.thumbUrl))):e===I.MSG_FILE?tu((t[0].content||t[0].payload).fileUrl,s)&&(t[0].content?t[0].content.fileUrl=zs(t[0].content.fileUrl):t[0].payload.fileUrl=zs(t[0].payload.fileUrl)):e===I.MSG_MERGER&&(e=(s=t[0].content||t[0].payload).downloadKey,s=(s=s.messageList)===void 0?[]:s,se(e===void 0?"":e)&&s.forEach(function(r){pa(r.messageBody[0].type,r.messageBody)})),t}function zs(e){if(!e||e.indexOf("authKey=")===-1)return e;for(var e=e.split("?"),t=e[1].split("&"),n=0,s=0;s<t.length;s++)if(-1<t[s].indexOf("authKey=")){n=s;break}return t.splice(n,1),0<t.length?"".concat(e[0],"?").concat(t.join("&")):e[0]}function tu(e,t){var n=!1;if(e){var e=e.match(/:\/\/([0-9]?\.)?(.[^/:]+)/),s=e&&e[2]||"";if(s.includes("rich-dev"))return 1;for(var r=0;r<t.length;r++)if(s.endsWith(t[r])){n=!0;break}}return n}y(Mu,[{key:"_initImageInfoModel",value:function(){var e=this;this._ImageInfoModel=function(t){this.instanceID=wn(9999999),this.sizeType=t.type||0,this.type=0,this.size=t.size||0,this.width=t.width||0,this.height=t.height||0,this.imageUrl=t.imageUrl||t.url||"",this.url=hn(t.url||e._imageMemoryURL,e._fileDownloadProxy,e._authKey,e._fileDNList)},this._ImageInfoModel.prototype={setSizeType:function(t){this.sizeType=t},setType:function(t){this.type=t},setImageUrl:function(t){t&&(this.imageUrl=t)},getImageUrl:function(){return this.imageUrl}}}},{key:"initImageInfoArray",value:function(e){for(var t,n=0,s=null;n<=2;)t=H(e)||H(e[n])?{type:0,size:0,width:0,height:0,url:""}:e[n],(s=new this._ImageInfoModel(t)).setSizeType(n+1),s.setType(n),this.addImageInfo(s),n++;this.updateAccessSideImageInfoArray()}},{key:"updateImageInfoArray",value:function(e){for(var t,n=this.content.imageInfoArray.length,s=0;s<n;s++)t=this.content.imageInfoArray[s],e[s].size&&(t.size=e[s].size),e[s].url&&t.setImageUrl(e[s].url),e[s].width&&(t.width=e[s].width),e[s].height&&(t.height=e[s].height)}},{key:"_autoFixUrl",value:function(){for(var e=this.content.imageInfoArray.length,t="",n="",s=["http","https"],r=null,a=0;a<e;a++)this.content.imageInfoArray[a].url&&(r=this.content.imageInfoArray[a]).imageUrl!==""&&(n=r.imageUrl.slice(0,r.imageUrl.indexOf("://")+1),t=r.imageUrl.slice(r.imageUrl.indexOf("://")+1),s.indexOf(n)<0&&(n="https:"),this.content.imageInfoArray[a].setImageUrl([n,t].join("")))}},{key:"updatePercent",value:function(e){this._percent=e,1<this._percent&&(this._percent=1)}},{key:"updateImageFormat",value:function(e){this.content.imageFormat=na[e.toUpperCase()]||na.UNKNOWN}},{key:"createImageDataASURLInWeb",value:function(e){e!==void 0&&0<e.files.length&&(this._imageMemoryURL=window.URL.createObjectURL(e.files[0]))}},{key:"createImageDataASURL",value:function(e){e&&e.url&&(this._imageMemoryURL=e.url)}},{key:"replaceImageInfo",value:function(e,t){this.content.imageInfoArray[t]instanceof this._ImageInfoModel||(this.content.imageInfoArray[t]=e)}},{key:"addImageInfo",value:function(e){3<=this.content.imageInfoArray.length||this.content.imageInfoArray.push(e)}},{key:"updateAccessSideImageInfoArray",value:function(){var e=this.content.imageInfoArray,n=e[0],t=n.width,t=t===void 0?0:t,n=n.height,n=n===void 0?0:n;t!==0&&n!==0&&(zp(e),Object.assign(e[2],Hc({originWidth:t,originHeight:n,min:720})))}},{key:"sendable",value:function(){return this.content.imageInfoArray.length!==0&&this.content.imageInfoArray[0].imageUrl!==""&&this.content.imageInfoArray[0].size!==0}}]);var nu=Mu,ou=(y(Iu,[{key:"sendable",value:function(){return this.content!==null}}]),Iu),su=(y(yu,[{key:"updatePercent",value:function(e){this._percent=e,1<this._percent&&(this._percent=1)}},{key:"updateAudioUrl",value:function(e){this.content.remoteAudioUrl=e}},{key:"sendable",value:function(){return this.content.remoteAudioUrl!==""}}]),yu),Dy={from:!0,groupID:!0,groupName:!0,to:!0},pf=(y(vu,[{key:"_initContent",value:function(e){var t=this;Object.keys(e).forEach(function(n){switch(n){case"remarkInfo":break;case"groupProfile":t.content.groupProfile={},t._initGroupProfile(e[n]);break;case"operatorInfo":t.content.operatorInfo={},t._initOperatorInfo(e[n]);break;case"memberInfoList":case"msgMemberInfo":t._updateMemberList(e[n]);break;case"memberExtraInfo":case"onlineMemberInfo":break;case"memberNum":t.content[n]=e[n],t.content.memberCount=e[n];break;case"newGroupProfile":t.content.newGroupProfile={},t._initNewGroupProfile(e[n]);break;default:t.content[n]=e[n]}}),this.content.userIDList||(this.content.userIDList=[this.content.operatorID])}},{key:"_initGroupProfile",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var s=t[n];Dy[s]&&(this.content.groupProfile[s]=e[s])}}},{key:"_initOperatorInfo",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var s=t[n];this.content.operatorInfo[s]=e[s]}}},{key:"_updateMemberList",value:function(e){se(this.content.memberList)?this.content.memberList=e:this.content.memberList.forEach(function(t){e.forEach(function(n){t.userID===n.userID&&Object.assign(t,n)})})}},{key:"_initNewGroupProfile",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var s=t[n];this.content.newGroupProfile[s]=s!=="muteAllMembers"?e[s]:e[s]===1}}}]),vu),Sy={from:!0,groupID:!0,groupName:!0,to:!0,groupType:!0},ff=(y(mu,[{key:"_initContent",value:function(e){var t=this;Object.keys(e).forEach(function(n){switch(n){case"memberInfoList":break;case"remarkInfo":t.content.handleMessage=e[n];break;case"groupProfile":t.content.groupProfile={},t._initGroupProfile(e[n]);break;default:t.content[n]=e[n]}})}},{key:"_initGroupProfile",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var s=t[n];Sy[s]&&(s==="groupName"?this.content.groupProfile.name=e[s]:this.content.groupProfile[s]=e[s])}}}]),mu),ru=(y(_u,[{key:"_getFileInfo",value:function(n){if(!H(n.fileName)&&!H(n.fileSize))return{size:n.fileSize,name:n.fileName};var t,n=n.file.files[0];return j&&(n.path&&n.path.indexOf(".")!==-1&&(t=n.path.slice(n.path.lastIndexOf(".")+1).toLowerCase(),n.type=t,n.name||(n.name="".concat(wn(999999),".").concat(t))),n.name||(n.type="",n.name=n.path.slice(n.path.lastIndexOf("/")+1).toLowerCase()),n.suffix&&(n.type=n.suffix),n.url||(n.url=n.path)),{size:n.size,name:n.name}}},{key:"updatePercent",value:function(e){this._percent=e,1<this._percent&&(this._percent=1)}},{key:"updateFileUrl",value:function(e){this.content.fileUrl=e}},{key:"sendable",value:function(){return this.content.fileUrl!==""&&this.content.fileName!==""&&this.content.fileSize!==0}}]),_u),iu=(y(gu,[{key:"setData",value:function(e){return this.content.data=e,this}},{key:"setDescription",value:function(e){return this.content.description=e,this}},{key:"setExtension",value:function(e){return this.content.extension=e,this}},{key:"sendable",value:function(){return this.content.data.length!==0||this.content.description.length!==0||this.content.extension.length!==0}}]),gu),au=(y(hu,[{key:"updatePercent",value:function(e){this._percent=e,1<this._percent&&(this._percent=1)}},{key:"updateVideoUrl",value:function(e){e&&(this.content.remoteVideoUrl=e)}},{key:"updateSnapshotInfo",value:function(s){var t=s.snapshotUrl,n=s.snapshotWidth,s=s.snapshotHeight;se(t)||(this.content.thumbUrl=this.content.snapshotUrl=t),se(n)||(this.content.thumbWidth=this.content.snapshotWidth=Number(n)),se(s)||(this.content.thumbHeight=this.content.snapshotHeight=Number(s))}},{key:"sendable",value:function(){return this.content.remoteVideoUrl!==""}}]),hu),cu=(y(fu,[{key:"sendable",value:function(){return!0}}]),fu),hf=(y(pu,[{key:"_patchRichMediaPayload",value:function(e,t){e===I.MSG_IMAGE?t.imageInfoArray.forEach(function(n){!n.imageUrl&&n.url&&(n.imageUrl=n.url,n.sizeType=n.type,n.type===1?n.type=0:n.type===3&&(n.type=1))}):e===I.MSG_VIDEO?!t.remoteVideoUrl&&t.videoUrl&&(t.remoteVideoUrl=t.videoUrl):e===I.MSG_AUDIO?!t.remoteAudioUrl&&t.url&&(t.remoteAudioUrl=t.url):e===I.MSG_FILE&&!t.fileUrl&&t.url&&(t.fileUrl=t.url,t.url=void 0)}},{key:"_updateRichMediaDownloadUrl",value:function(e,t,n,s,r){(n||s)&&(e===I.MSG_IMAGE?t.imageInfoArray.forEach(function(a){a.url=hn(a.url,n,s,r)}):e===I.MSG_VIDEO?(t.videoUrl=hn(t.videoUrl,n,s,r),t.snapshotUrl=hn(t.thumbUrl,n,s,r),t.snapshotHeight=t.thumbHeight,t.snapshotWidth=t.thumbWidth):e===I.MSG_AUDIO?t.url=hn(t.url,n,s,r):e===I.MSG_FILE&&(t.fileUrl=hn(t.fileUrl,n,s,r)))}}]),pu),fa=(y(du,[{key:"sendable",value:function(){return!se(this.content.messageList)||!se(this.content.downloadKey)}}]),du),uu={1:I.MSG_PRIORITY_HIGH,2:I.MSG_PRIORITY_NORMAL,3:I.MSG_PRIORITY_LOW,4:I.MSG_PRIORITY_LOWEST},Bt=(y(lu,[{key:"elements",get:function(){return this._elements}},{key:"getElements",value:function(){return this._elements}},{key:"extractGroupInfo",value:function(e){e!==null&&(xe(e.nick)&&(this.nick=e.nick),xe(e.avatar)&&(this.avatar=e.avatar),e=e.messageFromAccountExtraInformation,dt(e)&&xe(e.nameCard)&&(this.nameCard=e.nameCard))}},{key:"handleGroupAtInfo",value:function(e){var t=this;e.payload&&e.payload.atUserList&&e.payload.atUserList.forEach(function(n){n!==I.MSG_AT_ALL?(t._groupAtInfoList.push({groupAtAllFlag:0,groupAtUserID:n}),t.atUserList.push(n)):(t._groupAtInfoList.push({groupAtAllFlag:1}),t.atUserList.push(I.MSG_AT_ALL))}),_e(e.groupAtInfo)&&e.groupAtInfo.forEach(function(n){n.groupAtAllFlag===0?t.atUserList.push(n.groupAtUserID):n.groupAtAllFlag===1&&t.atUserList.push(I.MSG_AT_ALL)})}},{key:"getGroupAtInfoList",value:function(){return this._groupAtInfoList}},{key:"_initProxy",value:function(){this._elements[0]&&(this.payload=this._elements[0].content,this.type=this._elements[0].type)}},{key:"reInitialize",value:function(e){e&&(this.status=this.from?Fn:la,this.from||(this.from=e)),this._initFlow(e),this._initSequence(e),this._concatConversationID(e),this.generateMessageID()}},{key:"isSendable",value:function(){return this._elements.length!==0&&(this._relayFlag===!0||typeof this._elements[0].sendable=="function"&&this._elements[0].sendable())}},{key:"_initTo",value:function(e){this.conversationType===I.CONV_GROUP&&(this.to=e.groupID)}},{key:"_initSequence",value:function(e){var t,n,s;this.clientSequence===0&&e&&(this.clientSequence=!!(e=e)&&(ra[e]===void 0&&(s=new Date,t="3".concat(s.getHours()).slice(-2),n="0".concat(s.getMinutes()).slice(-2),s="0".concat(s.getSeconds()).slice(-2),ra[e]=parseInt([t,n,s,"0001"].join("")),s=n=t=null,m.l("autoIncrementIndex start index:".concat(ra[e]))),ra[e]++)),this.sequence===0&&this.conversationType===I.CONV_C2C&&(this.sequence=this.clientSequence)}},{key:"generateMessageID",value:function(){this.from===I.CONV_SYSTEM&&(this.senderTinyID="144115198244471703"),this.ID="".concat(this.senderTinyID,"-").concat(this.clientTime,"-").concat(this.random)}},{key:"_initFlow",value:function(e){e!==""&&(e===this.from?(this.flow="out",this.isRead=!0):this.flow="in")}},{key:"_concatConversationID",value:function(e){var t=this.to,n=this.conversationType;n!==I.CONV_SYSTEM?(e=n===I.CONV_C2C?e===this.from?t:this.from:this.to,this.conversationID=e?"".concat(n).concat(e):null):this.conversationID=I.CONV_SYSTEM}},{key:"isElement",value:function(e){return e instanceof Zc||e instanceof nu||e instanceof ou||e instanceof su||e instanceof ru||e instanceof au||e instanceof pf||e instanceof ff||e instanceof iu||e instanceof cu||e instanceof fa}},{key:"setElement",value:function(e,t,n,s){var r=this;if(this.isElement(e))return this._elements=[e],void this._initProxy();function a(d){if(d.type&&d.content)switch(d.type){case I.MSG_TEXT:r.setTextElement(d.content);break;case I.MSG_IMAGE:r.setImageElement(d.content,t,n,s);break;case I.MSG_AUDIO:r.setAudioElement(d.content,t,n,s);break;case I.MSG_FILE:r.setFileElement(d.content,t,n,s);break;case I.MSG_VIDEO:r.setVideoElement(d.content,t,n,s);break;case I.MSG_CUSTOM:r.setCustomElement(d.content);break;case I.MSG_LOCATION:r.setLocationElement(d.content);break;case I.MSG_GRP_TIP:r.setGroupTipElement(d.content);break;case I.MSG_GRP_SYS_NOTICE:r.setGroupSystemNoticeElement(d.content);break;case I.MSG_FACE:r.setFaceElement(d.content);break;case I.MSG_MERGER:r.setMergerElement(d.content,t,n,s)}}if(_e(e))for(var l=0;l<e.length;l++)a(e[l]);else a(e);this._initProxy()}},{key:"clearElement",value:function(){this._elements.length=0}},{key:"setTextElement",value:function(e){e=typeof e=="string"?e:e.text,e=new Zc({text:e}),this._elements.push(e)}},{key:"setImageElement",value:function(e,t,n,s){e=new nu(e,t,n,s),this._elements.push(e)}},{key:"setAudioElement",value:function(e,t,n,s){e=new su(e,t,n,s),this._elements.push(e)}},{key:"setFileElement",value:function(e,t,n,s){e=new ru(e,t,n,s),this._elements.push(e)}},{key:"setVideoElement",value:function(e,t,n,s){e=new au(e,t,n,s),this._elements.push(e)}},{key:"setLocationElement",value:function(e){e=new cu(e),this._elements.push(e)}},{key:"setCustomElement",value:function(e){e=new iu(e),this._elements.push(e)}},{key:"setGroupTipElement",value:function(e){var t,n={},s=e.operationType;se(e.memberInfoList)?e.operatorInfo&&(n=e.operatorInfo):s!==I.GRP_TIP_MBR_JOIN&&s!==I.GRP_TIP_MBR_KICKED_OUT&&s!==I.GRP_TIP_MBR_SET_ADMIN&&s!==I.GRP_TIP_MBR_CANCELED_ADMIN||(n=e.memberInfoList[0]),se(e.memberExtraInfo)||(t=e.memberExtraInfo.reason,e.msgMemberInfo.forEach(function(r){r.reason=t})),s=n.nick,n=n.avatar,xe(s)&&(this.nick=s),xe(n)&&(this.avatar=n),s=new pf(e),this._elements.push(s)}},{key:"setGroupSystemNoticeElement",value:function(e){e=new ff(e),this._elements.push(e)}},{key:"setFaceElement",value:function(e){e=new ou(e),this._elements.push(e)}},{key:"setMergerElement",value:function(e,t,n,s){e=new fa(e,t,n,s),this._elements.push(e)}},{key:"setIsRead",value:function(e){this.isRead=e}},{key:"setRelayFlag",value:function(e){this._relayFlag=e}},{key:"_computePriority",value:function(e){return H(e)?I.MSG_PRIORITY_NORMAL:xe(e)&&Object.values(uu).indexOf(e)!==-1?e:Qe(e)&&(e=""+e,Object.keys(uu).indexOf(e)!==-1)?uu[e]:I.MSG_PRIORITY_NORMAL}},{key:"setNickAndAvatar",value:function(n){var t=n.nick,n=n.avatar;xe(t)&&(this.nick=t),xe(n)&&(this.avatar=n)}},{key:"setNameCard",value:function(e){xe(e)&&(this.nameCard=e)}},{key:"initC2CReadReceiptInfo",value:function(n){var t=n.readReceiptSentByPeer,n=n.timestamp,n=n===void 0?0:n;this.conversationType===I.CONV_C2C&&this.needReadReceipt===!0&&(this.readReceiptInfo.isPeerRead=(t===void 0?void 0:t)===1,this.readReceiptInfo.timestamp=n)}}]),lu),Ly=["sound","FCMChannelID"];function lu(e){f(this,lu),this.ID="",this.conversationID=e.conversationID||null,this.conversationType=e.conversationType||I.CONV_C2C,this.conversationSubType=e.conversationSubType,this.time=e.time||Math.ceil(Date.now()/1e3),this.sequence=e.sequence||0,this.clientSequence=e.clientSequence||e.sequence||0,this.random=e.random||e.random===0?e.random:wn(),this.priority=this._computePriority(e.priority),this.nick=e.nick||"",this.avatar=e.avatar||"",this.isPeerRead=!1,this.nameCard="",this.hasRiskContent=ef(e.checkResult),this._elements=[],this.isPlaceMessage=e.isPlaceMessage||0,this.isRevoked=e.isPlaceMessage===2||e.msgFlagBits===8,this.from=e.from||null,this.to=e.to||null,this.flow="",this.isSystemMessage=e.isSystemMessage||!1,this.protocol=e.protocol||"JSON",this.isResend=!1,this.isRead=!1,this.status=e.status||Fn,this._onlineOnlyFlag=!1,this._groupAtInfoList=[],this._relayFlag=!1,this.atUserList=[],this.cloudCustomData=e.cloudCustomData||"",this.isDeleted=!1,this.isModified=!!e.messageVersion,this._isExcludedFromUnreadCount=!(!e.messageControlInfo||e.messageControlInfo.excludedFromUnreadCount!==1),this._isExcludedFromLastMessage=!(!e.messageControlInfo||e.messageControlInfo.excludedFromLastMessage!==1),this.clientTime=e.clientTime||Mr()||0,this.senderTinyID=e.senderTinyID||e.tinyID||"",this.readReceiptInfo=e.readReceiptInfo||{readCount:void 0,unreadCount:void 0,isPeerRead:void 0,timestamp:0},this.needReadReceipt=e.needReadReceipt===!0||e.needReadReceipt===1,this.version=e.messageVersion||0,this.isBroadcastMessage=e.isBroadcastMessage||!1,this._receiverList=e.receiverList||void 0,this.isSupportExtension=e.isSupportExtension===!0||e.isSupportExtension===1,this._cmConfigID=e.customModerationConfigurationID,this.revoker=e.revokerInfo&&e.revokerInfo.revoker||"",this.revokerInfo=e.revokerInfo||{userID:"",nick:"",avatar:""},this.revokeReason=e.revokeReason||"",this.reInitialize(e.currentUser),this.extractGroupInfo(e.groupProfile||null),this.handleGroupAtInfo(e),this.initC2CReadReceiptInfo(e)}function du(e,t,n,s){var r,a,l,d,h,g,_;f(this,du),this.type=I.MSG_MERGER,this.content={downloadKey:"",pbDownloadKey:"",messageList:[],title:"",abstractList:[],compatibleText:"",version:0,layersOverLimit:!1},e.downloadKey?(a=e.downloadKey,l=e.pbDownloadKey,d=e.title,h=e.abstractList,g=e.compatibleText,r=e.version,this.content.downloadKey=a,this.content.pbDownloadKey=l,this.content.title=d,this.content.abstractList=h,this.content.compatibleText=g,this.content.version=r||0):se(e.messageList)?e.layersOverLimit===1&&(this.content.layersOverLimit=!0):(a=e.messageList,l=e.title,d=e.abstractList,h=e.compatibleText,g=e.version,_=[],a.forEach(function(M){se(M)||(M=new hf(M,t,n,s),_.push(M))}),this.content.messageList=_,this.content.title=l,this.content.abstractList=d,this.content.compatibleText=h,this.content.version=g||0)}function pu(e,t,n,s){var r,a;f(this,pu),this.from=e.from,this.messageSender=e.from,this.time=e.time,this.messageSequence=e.sequence,this.clientSequence=e.clientSequence||e.sequence,this.messageRandom=e.random,this.cloudCustomData=e.cloudCustomData||"",this.clientTime=e.clientTime||void 0,e.ID?(this.ID=e.ID||"",this.nick=e.nick||"",this.avatar=e.avatar||"",e.messageBody?this.messageBody=JSON.parse(JSON.stringify(e.messageBody)):this.messageBody=[{type:e.type,payload:e.payload}],e.conversationType?e.conversationType.startsWith(I.CONV_C2C)?this.receiverUserID=e.to:e.conversationType.startsWith(I.CONV_GROUP)&&(this.receiverGroupID=e.to):e.receiverGroupID?this.receiverGroupID=e.receiverGroupID:e.receiverUserID&&(this.receiverUserID=e.receiverUserID),this.messageReceiver=e.to||e.messageReceiver):(this.nick=e.nick||"",this.avatar=e.avatar||"",this.messageBody=[],r=e.elements[0].type,a=e.elements[0].content,this._patchRichMediaPayload(r,a),this._updateRichMediaDownloadUrl(r,a,t,n,s),r===I.MSG_MERGER?this.messageBody.push({type:r,payload:new fa(a,t,n,s).content}):this.messageBody.push({type:r,payload:a}),e.groupID&&(this.receiverGroupID=e.groupID,this.messageReceiver=e.groupID),e.to&&(this.receiverUserID=e.to,this.messageReceiver=e.to),this.ID="".concat(e.tinyID,"-").concat(e.clientTime,"-").concat(e.random))}function fu(s){f(this,fu),this.type=I.MSG_LOCATION;var t=s.description,n=s.longitude,s=s.latitude;this.content={description:t,longitude:n,latitude:s}}function hu(e,t,n,s){f(this,hu),this.type=I.MSG_VIDEO,this._percent=0,this.content={remoteVideoUrl:e.remoteVideoUrl||e.videoUrl||"",videoFormat:e.videoFormat,videoSecond:parseInt(e.videoSecond,10),videoSize:e.videoSize,videoUrl:hn(e.videoUrl,t,n,s),videoDownloadFlag:2,videoUUID:e.videoUUID,thumbUUID:e.thumbUUID,thumbFormat:e.thumbFormat,thumbWidth:e.thumbWidth,snapshotWidth:e.thumbWidth,thumbHeight:e.thumbHeight,snapshotHeight:e.thumbHeight,thumbSize:e.thumbSize,snapshotSize:e.thumbSize,thumbDownloadFlag:2,thumbUrl:hn(e.thumbUrl,t,n,s),snapshotUrl:hn(e.thumbUrl,t,n,s)}}function gu(e){f(this,gu),this.type=I.MSG_CUSTOM,this.content={data:e.data||"",description:e.description||"",extension:e.extension||""}}function _u(e,t,n,s){f(this,_u),this.type=I.MSG_FILE,this._percent=0;var r=this._getFileInfo(e);this.content={downloadFlag:2,fileUrl:hn(e.url||e.fileUrl,t,n,s)||"",uuid:e.uuid,fileName:r.name||"",fileSize:r.size||0}}function mu(e){f(this,mu),this.type=I.MSG_GRP_SYS_NOTICE,this.content={},this._initContent(e)}function vu(e){f(this,vu),this.type=I.MSG_GRP_TIP,this.content={},this._initContent(e)}function yu(e,t,n,s){f(this,yu),this.type=I.MSG_AUDIO,this._percent=0,this.content={downloadFlag:2,second:e.second,size:e.size,url:hn(e.url,t,n,s),remoteAudioUrl:e.url||"",uuid:e.uuid}}function Iu(e){f(this,Iu),this.type=I.MSG_FACE,this.content=e||null}function Mu(e,t,n,s){f(this,Mu),this._imageMemoryURL="",this._fileDownloadProxy=t,this._authKey=n,this._fileDNList=s,ee||pe?this.createImageDataASURL(e.file):this.createImageDataASURLInWeb(e.file),this._initImageInfoModel(),this.type=I.MSG_IMAGE,this._percent=0,this.content={imageFormat:e.imageFormat||na.UNKNOWN,uuid:e.uuid,imageInfoArray:[]},this.initImageInfoArray(e.imageInfoArray),this._autoFixUrl()}function ha(e){if(dt(e))return{pushFlag:e.disablePush===!0?1:0,title:e.title||"",desc:e.description||"",ext:e.extension||"",apnsInfo:(n=(n=(t=e).apnsInfo)===void 0?{}:n,s=t.ignoreIOSBadge,t=t.disableVoipPush,s=n.ignoreIOSBadge===!0||(s!==void 0&&s)===!0?1:0,r=void 0,H(t)||(r=t===!1?1:0),H(n.disableVoipPush)||(r=n.disableVoipPush===!1?1:0),c(c({},n),{},{badgeMode:s,isVoipPush:r})),androidInfo:(n=(n=(t=e).androidInfo)===void 0?{}:n,t=t.androidOPPOChannelID,t=n.OPPOChannelID||(t===void 0?"":t),s=(s=n.sound)===void 0?"":s,r=(r=n.FCMChannelID)===void 0?"":r,c(c({},G(n,Ly)),{},{Sound:(s=(n=s).lastIndexOf("."))===-1?n:n.slice(0,s),OPPOChannelID:t,GoogleChannelID:r}))};var t,n,s,r}T(Gr,St),gf=z(Gr),y(Gr,[{key:"onNewMessage",value:function(n){var a=n.dataList,t=n.isInstantMessage,s=n.C2CRemainingUnreadList,r=n.C2CPairUnreadList,n=n.isSyncingEnded,a=(t||m.l("".concat(this._n,".onNewMessage C2CPairUnreadList:"),r,"C2CRemainingUnreadList:",s),this._assembly({dataList:a,C2CRemainingUnreadList:s,C2CPairUnreadList:r,isInstantMessage:t})),s=a.conversationOptionsList,r=a.messageList,a=a.isUnreadC2CMessage,l=Vc(r),l=(0<l.length&&this.emitOEvt($.MESSAGE_MODIFIED,l),this.get(11).onNewMessage({conversationOptionsList:s,isInstantMessage:t,isUnreadC2CMessage:a,isSyncingEnded:n}),Bc(r));t&&0<l.length&&this.emitOEvt($.MESSAGE_RECEIVED,l),r.length=0}},{key:"_assembly",value:function(e){for(var t=e.dataList,n=e.C2CRemainingUnreadList,s=e.C2CPairUnreadList,r=e.isInstantMessage,a=null,l=[],d=[],h={},g=this.get(26),_=!1,M=this.get(11),S=this.get(4),e=this.get(17),D=this.getFileDownloadProxy(),O=this.getDowloadFileAuthKey(),B=e.getFileDNList(),U=0,de=t.length;U<de;U++)if(this._isC2CNotice(t[U]))this._noticeFromUnreadDBList.push(t[U].eventArray[0].c2CNotifyMsgArray[0]);else{var J=t[U],ke=(J.currentUser=this.getMyUserID(),J.conversationType=I.CONV_C2C,J.isSystemMessage=!!J.isSystemMessage,(H(J.nick)||H(J.avatar))&&(_=!0),(a=new Bt(J)).setElement(J.elements,D,O,B),a.setNickAndAvatar({nick:J.nick,avatar:J.avatar}),a.conversationID);if(r){if(this._msgFromUnreadDBMap.get(a.ID))continue;var Ae,Be,We=!1,ot=(a.from!==this.getMyUserID()?(Be=M.getLatestMessageSentByPeer(ke))&&(Ae=Be.nick,Be=Be.avatar,_?a.setNickAndAvatar({nick:Ae,avatar:Be}):Ae===a.nick&&Be===a.avatar||(We=!0)):(Ae=M.getLatestMessageSentByMe(ke))&&(Be=Ae.nick,ot=Ae.avatar,Be===a.nick&&ot===a.avatar||(M.modifyMessageSentByMe({conversationID:ke,latestNick:a.nick,latestAvatar:a.avatar}),S.mockOnNickAvatarModified(a.nick,a.avatar))),t[U].isModified===1);if(M.isMessageSentByCurrentInstance(a)?a.isModified=ot:ot=!1,J.msgLifeTime===0)a._onlineOnlyFlag=!0,M.isMessageSentByCurrentInstance(a)||d.push(a);else{if(!M.pushIntoMessageList(d,a,ot))continue;We&&(M.modifyMessageSentByPeer({conversationID:ke,latestNick:a.nick,latestAvatar:a.avatar}),M.updateUserProfileSpecifiedKey({conversationID:ke,nick:a.nick,avatar:a.avatar}))}r&&0<a.clientTime&&g.addMessageDelay(a.clientTime)}else this._msgFromUnreadDBMap.set(a.ID,a);if(J.msgLifeTime!==0){if(a._onlineOnlyFlag===!1){if(We=M.getLastMessageTime(ke),Qe(We)&&a.time<We)continue;r&&(H(h[ke])?(J=0,a.flow==="in"&&(a._isExcludedFromUnreadCount||(J=1)),h[ke]=l.push({conversationID:ke,unreadCount:J,type:a.conversationType,subType:a.conversationSubType,lastMessage:a._isExcludedFromLastMessage?"":a})-1):(J=h[ke],l[J].type=a.conversationType,l[J].subType=a.conversationSubType,l[J].lastMessage=a._isExcludedFromLastMessage?"":a,a.flow==="in"&&(a._isExcludedFromUnreadCount||l[J].unreadCount++)))}}else a._onlineOnlyFlag=!0}this._handleNoticeFromUnreadDB();var Lt=!1;if(_e(s)&&0<s.length)for(var vt=0,gt=s.length;vt<gt;vt++)(function(It){if(s[It].from!==I.CONV_SYSTEM){Lt=!0;var Ut=l.find(function($t){return $t.conversationID==="".concat(I.CONV_C2C).concat(s[It].from)});Ut?Ut.unreadCount=s[It].unreadCount:l.push({conversationID:"".concat(I.CONV_C2C).concat(s[It].from),unreadCount:s[It].unreadCount,type:I.CONV_C2C})}})(vt);if(_e(n))for(var Ot=0,cs=n.length;Ot<cs;Ot++)(function(It){l.find(function(Ut){return Ut.conversationID==="".concat(I.CONV_C2C).concat(n[It].from)})||l.push({conversationID:"".concat(I.CONV_C2C).concat(n[It].from),type:I.CONV_C2C,lastMsgTime:n[It].lastMsgTime})})(Ot);return{conversationOptionsList:l,messageList:d,isUnreadC2CMessage:Lt}}},{key:"getMessageListFromUnreadDB",value:function(){return q(this._msgFromUnreadDBMap.values())}},{key:"_isC2CNotice",value:function(e){return e=e.eventArray,!(!_e(e)||e[0].event!==10)}},{key:"_handleNoticeFromUnreadDB",value:function(){var e,t=this._noticeFromUnreadDBList.length;t!==0&&(m.l("".concat(this._n,"._handleNoticeFromUnreadDB count:").concat(t)),e=[],this._noticeFromUnreadDBList.forEach(function(n){n.hasOwnProperty("c2cMessageRevokedNotify")&&e.push(n)}),this.onMsgRevoked({dataList:e}),this._noticeFromUnreadDBList.length=0,e.length=0)}},{key:"onMsgRevoked",value:function(e,t){var n,s=this,r=this.get(11),a=[];e.dataList.forEach(function(l){l.c2cMessageRevokedNotify&&(l=l.c2cMessageRevokedNotify.revokedInfos,H(l)||l.forEach(function(d){var h=s.getMyUserID()===d.from?"".concat(I.CONV_C2C).concat(d.to):"".concat(I.CONV_C2C).concat(d.from);n=r.revoke(h,d.sequence,d.random);var g,_=d.revokerInfo&&d.revokerInfo.revoker,M=d.revokerInfo&&d.revokerInfo.reason||"";n?g=n:(g={conversationID:h,sequence:d.sequence},d.tinyID&&d.clientTime&&d.random&&(g.ID="".concat(d.tinyID,"-").concat(d.clientTime,"-").concat(d.random)),d.time&&(g.time=d.time)),g&&(g.revoker=_,g.revokeReason=M,g.revokerInfo={userID:_,nick:"",avatar:""},a.push(g))}))}),a.length!==0&&(m.l("".concat(this._n,".onMsgRevoked count:").concat(a.length," updateUnreadCount:").concat(t)),r.onMessageRevoked(a,t),r.updateRevokerInfo(a).then(function(l){s.emitOEvt($.MESSAGE_REVOKED,l)}))}},{key:"onMsgReadReceipt",value:function(e){var t=this;e.dataList.forEach(function(n){var s;se(n.c2cMessageReadReceipt)||(s=n.c2cMessageReadReceipt.to,n.c2cMessageReadReceipt.uinPairReadArray.forEach(function(a){var a=a.peerReadTime,l=(m.l("".concat(t._n,".onMsgReadReceipt to:").concat(s," peerReadTime:").concat(a)),"".concat(I.CONV_C2C).concat(s)),d=t.get(11);d.recordPeerReadTime(l,a),d.updateMsgIsPeerReadProp(l,a)}))})}},{key:"onMsgReadNotice",value:function(e){var t=this;e.dataList.forEach(function(n){var s;se(n.c2cMessageReadNotice)||(s=t.get(11),n.c2cMessageReadNotice.uinPairReadArray.forEach(function(a){var l=a.from,a=a.peerReadTime,l=(m.l("".concat(t._n,".onMsgReadNotice from:").concat(l," lastReadTime:").concat(a)),"".concat(I.CONV_C2C).concat(l));s.updateIsReadAfterReadReport({conversationID:l,lastMessageTime:a}),s.updateUnreadCount(l)}))})}},{key:"onMsgModified",value:function(e){m.l("".concat(this._n,".onMsgModified options:"),e);var t=this.get(11);e.dataList.forEach(function(n){t.onMessageModified(c(c({},n),{},{conversationType:I.CONV_C2C}))})}},{key:"onReadReceiptList",value:function(e){m.l("".concat(this._n,".onReadReceiptList options:"),e),this.get(11).updateReadReceiptInfo(e.dataList)}},{key:"sendMessage",value:function(e,t){return e=this._createC2CMessagePack(e,t),this.req(e)}},{key:"_createC2CMessagePack",value:function(e,t){var n=null,s=(t&&(t.offlinePushInfo&&(n=t.offlinePushInfo),t.onlineUserOnly===!0&&(n?n.disablePush=!0:n={disablePush:!0})),""),r=(xe(e.cloudCustomData)&&0<e.cloudCustomData.length&&(s=e.cloudCustomData),[]),a=(dt(t)&&dt(t.messageControlInfo)&&(a=(d=t.messageControlInfo).excludedFromUnreadCount,l=d.excludedFromLastMessage,d=d.excludedFromContentModeration,a===!0&&r.push("NoUnread"),l===!0&&r.push("NoLastMsg"),d===!0&&r.push("NoMsgCheck")),this.isOnlineMessage(e,t)?0:void 0),l=JSON.parse(JSON.stringify(e.getElements())),d=this.get(17).getFileDNList();return{P:E.SEND_C2C_MSG,data:{fromAccount:this.getMyUserID(),toAccount:e.to,msgBody:pa(e.type,l,d),cloudCustomData:s,msgSeq:e.sequence,msgRandom:e.random,msgLifeTime:a,nick:e.nick,avatar:e.avatar,offlinePushInfo:ha(n),messageControlInfo:a!==0?r:void 0,clientTime:e.clientTime,needReadReceipt:e.needReadReceipt===!0?1:0,isSupportExtension:e.isSupportExtension===!0?1:0,isRelayMessage:e._relayFlag===!0?1:0,cmConfigID:e._cmConfigID,forbidCallbackControl:Hp(t)}}}},{key:"isOnlineMessage",value:function(e,t){return!(!t||t.onlineUserOnly!==!0)}},{key:"revokeMessage",value:function(e){return this.req({P:E.REVOKE_C2C_MSG,data:{msgInfo:{fromAccount:e.from,toAccount:e.to,msgSeq:e.sequence,msgRandom:e.random,msgTimeStamp:e.time}}})}},{key:"deleteMessage",value:function(n){var t=n.to,n=n.keyList;return m.l("".concat(this._n,".deleteMessage toAccount:").concat(t," count:").concat(n.length)),this.req({P:E.DEL_C2C_MSG,data:{fromAccount:this.getMyUserID(),to:t,keyList:n}})}},{key:"modifyRemoteMessage",value:function(_){var t=_.from,n=_.to,s=_.version,s=s===void 0?0:s,r=_.sequence,a=_.random,l=_.time,d=_.payload,h=_.type,g=_.cloudCustomData,_=_._elements,M=void 0;return Xp(h)&&(1<_.length&&_.splice(0,1,{type:h,content:d}),M=_),this.req({P:E.MODIFY_C2C_MSG,data:{from:t,to:n,version:s,sequence:r,random:a,time:l,elements:M,cloudCustomData:g}})}},{key:"setMessageRead",value:function(a){var t=this,n=a.conversationID,s=a.lastMessageTime,r="".concat(this._n,".").concat("setMessageRead"),a="convID:".concat(n," lastMessageTime:").concat(s),l=(m.l("".concat(r," ").concat(a)),Qe(s)||this.warn("DoNotModifyLastTime"),new K("setMessageRead"));return l.setMessage(a),this.req({P:E.SET_C2C_MSG_READ,data:{C2CMsgReaded:{cookie:"",C2CMsgReadedItem:[{toAccount:n.replace("C2C",""),lastMessageTime:s,receipt:1}]}}}).then(function(){l.end(),m.l("".concat(r," ok"));var d=t.get(11);return d.updateIsReadAfterReadReport({conversationID:n,lastMessageTime:s}),d.updateUnreadCount(n),me()}).catch(function(d){return l.setError(d).end(),m.l("".concat(r," failed. error:"),d),A(d)})}},{key:"getRoamingMessage",value:function(d){var t=this,n="".concat(this._n,".").concat("getRoamingMessage"),s=d.peerAccount,r=d.conversationID,a=d.count,l=d.lastMessageTime,d=d.messageKey,h="peerAccount:".concat(s," count:").concat(a||15," lastMessageTime:").concat(l||0," messageKey:").concat(d),g=(m.l("".concat(n," ").concat(h)),new K("getRoamingMessage"));return this.req({P:E.GET_C2C_ROAMING_MSG,data:{peerAccount:s,count:a||15,lastMessageTime:l||0,messageKey:d}}).then(function(M){var M=M.data,D=M.complete,B=M.messageList,U=M.messageKey,M=M.lastMessageTime,S=(H(B)?m.l("".concat(n," ok. complete:").concat(D," but messageList is undefined!")):m.l("".concat(n," ok. complete:").concat(D," count:").concat(B.length)),g.setMessage("".concat(h," complete:").concat(D," length:").concat(B.length)).end(),t.get(11)),D=D===1,O=(D&&S.setCompleted(r),[]),B=S.onRoamingMessage(B,r,!0,O),U=(S.modifyMessageList(r),S.updateIsRead(r),S.updateRoamingMsgKeyAndTime(r,U,M),S.getPeerReadTime(r)),U=(m.l("".concat(n," update isPeerRead property. convID:").concat(r," peerReadTime:").concat(U)),U?S.updateMsgIsPeerReadProp(r,U):(M=r.replace(I.CONV_C2C,""),t.getRemotePeerReadTime([M]).then(function(){S.updateMsgIsPeerReadProp(r,S.getPeerReadTime(r))})),"");return 0<B.length?U=B[0].ID:(M=S.getLocalOldestMessage(r))&&(U=M.ID),m.l("".concat(n," nextReqID:").concat(U," storedMsgCount:").concat(B.length)),{nextReqID:U,storedMessageList:B,assembledMessageList:O,isPullingCompleted:D}}).catch(function(_){return g.setMessage(h).setError(_).end(),m.w("".concat(n," failed. error:"),_),A(_)})}},{key:"getRoamingMessagesHopping",value:function(e){var t=this,n="".concat(this._n,".").concat("getRoamingMessagesHopping"),s=e.peerAccount,r=e.time,r=r===void 0?0:r,a=e.count,l=e.direction,d="".concat(I.CONV_C2C).concat(s),h="peerAccount:".concat(s," count:").concat(a," time:").concat(r," direction:").concat(l),g=(m.l("".concat(n," ").concat(h)),new K("getRoamingMessagesHopping"));return this.req({P:E.GET_C2C_ROAMING_MSG,data:{peerAccount:s,count:a+1,lastMessageTime:r,direction:l}}).then(function(M){var M=M.data,B=M.complete,O=M.messageList,O=O===void 0?[]:O,M=M.lastMessageTime,D="complete:".concat(B," count:").concat(O.length),S=(m.l("".concat(n," ok. ").concat(D)),g.setMessage("".concat(h," ").concat(D)).end(),B!==1&&(l===1?O.pop():O.shift()),t.get(11)),D=S.onRoamingMessage(O,d,!1),O=(t._modifyMessageList(d,D),t._computeResult({complete:B,lastMessageTime:M,resultList:D})),B=(S.storeHoppingMessageList(O.messageList),S.getPeerReadTime(d));return m.l("".concat(n," update isPeerRead property. convID:").concat(d," peerReadTime:").concat(B)),B?S.updateMsgIsPeerReadProp(d,B):(M=d.replace(I.CONV_C2C,""),t.getRemotePeerReadTime([M]).then(function(){S.updateMsgIsPeerReadProp(d,S.getPeerReadTime(d))})),me(O)}).catch(function(_){return g.setMessage(h).setError(_).end(),m.w("".concat(n," failed. error:"),_),A(_)})}},{key:"_computeResult",value:function(s){var t=s.complete,t=t===void 0?0:t,n=s.lastMessageTime,s=s.resultList,s={messageList:q(s===void 0?[]:s),isCompleted:!1,nextMessageTime:""};return t===1?s.isCompleted=!0:s.nextMessageTime=n,s}},{key:"_modifyMessageList",value:function(e,t){if(e=this.get(11).getLocalConversation(e),e)for(var n=e.userProfile.nick,s=e.userProfile.avatar,e=this.get(4).getNickAndAvatarByUserID(this.getMyUserID()),r=e.nick,a=e.avatar,l=t.length-1;0<=l;l--){var d=t[l];d.flow==="in"&&(d.nick!==n&&d.setNickAndAvatar({nick:n}),d.avatar!==s&&d.setNickAndAvatar({avatar:s})),d.flow==="out"&&(d.nick!==r&&d.setNickAndAvatar({nick:r}),d.avatar!==a&&d.setNickAndAvatar({avatar:a}))}}},{key:"getRemotePeerReadTime",value:function(e){var t=this,n="".concat(this._n,".").concat("getRemotePeerReadTime");if(se(e))return Promise.resolve();var s=new K("getRemotePeerReadTime");return m.l("".concat(n," userIDList:").concat(e)),this.req({P:E.GET_C2C_PEER_READ_TIME,data:{userIDList:e}}).then(function(r){var a=r.data.peerReadTimeList;m.l("".concat(n," ok. peerReadTimeList:").concat(a));for(var l="",d=t.get(11),h=0;h<e.length;h++)l+="".concat(e[h],"-").concat(a[h]," "),0<a[h]&&d.recordPeerReadTime("".concat(I.CONV_C2C).concat(e[h]),a[h]);s.setMessage(l).end()}).catch(function(r){s.setError(r).end(),m.w("".concat(n," failed. error:"),r)})}},{key:"sendReadReceipt",value:function(r){var t=r[0].conversationID.replace(I.CONV_C2C,""),n=new K("sendReadReceipt"),s=(n.setMessage("peerAccount:".concat(t)),this.getMyUserID()),r=r.filter(function(l){return l.from!==s&&l.needReadReceipt===!0}).map(function(l){return{fromAccount:l.from,toAccount:l.to,sequence:l.sequence,random:l.random,time:l.time,clientTime:l.clientTime}});if(r.length===0)return A({code:F.READ_RECEIPT_MSG_LIST_EMPTY});var a="".concat(this._n,".").concat("sendReadReceipt");return m.l("".concat(a,". peerAccount:").concat(t," length:").concat(r.length)),this.req({P:E.SEND_C2C_READ_RECEIPT,data:{peerAccount:t,messageInfoList:r}}).then(function(l){return n.end(),m.l("".concat(a," ok")),me()}).catch(function(l){return n.setError(l).end(),m.w("".concat(a," failed. error:"),l),A(l)})}},{key:"getReadReceiptList",value:function(e){var t=e[0].conversationID.replace(I.CONV_C2C,"");return m.l("".concat(this._n,".getReadReceiptList peerAccount:").concat(t," msgCount:").concat(e.length)),Pe({messageList:e})}},{key:"getMessageExtensions",value:function(e,t){return m.l("".concat(this._n,".getMessageExtensions startSequence:").concat(t)),this.req({P:E.GET_C2C_MSG_EXT,data:{from:e.from,to:e.to,messageKey:this.getMessageKey(e),startSequence:t}})}},{key:"modifyMsgExts",value:function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1;return m.l("".concat(this._n,".modifyMsgExts operateType:").concat(n)),this.req({P:E.MODIFY_C2C_MSG_EXT,data:{from:e.from,to:e.to,messageKey:this.getMessageKey(e),extensionList:t,operateType:n}})}},{key:"getMessageKey",value:function(s){var t=s.clientSequence,n=s.random,s=s.time;return"".concat(t,"_").concat(n,"_").concat(s)}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._msgFromUnreadDBMap.clear(),this._noticeFromUnreadDBList.length=0}}]);var gf,Ry=Gr,mt={A2KEY_AND_TINYID_UPDATED:"_inner".concat(1),CLOUD_CONFIG:"_inner".concat(2),PROFILE_UPDATED:"_inner".concat(3),CONV_SYNC_COMPLETED:"_inner".concat(4),C2C_UNREAD_HANDLE_COMPLETED:"_inner".concat(5)},ky=(y(Cu,[{key:"_onCloudConfig",value:function(){var e=this._convM.getCloudConfig("topic_msg_limit");H(e)||(this.TOPIC_MSG_LIMIT=Number(e)),m.l("".concat(this._n,"._onCloudConfig topicMsgLimit:").concat(this.TOPIC_MSG_LIMIT))}},{key:"onCheckTimer",value:function(e){if(e%20==0&&0<this._map.size){var t,n=ye(this._map);try{for(n.s();!(t=n.n()).done;){var s=te(t.value,2),r=s[0],a=s[1];r.includes(oa)&&a.size>=this.TOPIC_MSG_LIMIT&&this._convM.clearMemMsg(r,!0)}}catch(l){n.e(l)}finally{n.f()}}}},{key:"pushIn",value:function(e){var t=1<arguments.length&&arguments[1]!==void 0&&arguments[1],n=e.conversationID,s=!0,r=(this._map.has(n)||this._map.set(n,new Map),this._getUniqueIDOfMsg(e));if(this._map.get(n).has(r)){var a=this._map.get(n).get(r);if(!t||a.isModified===!0)return!1}return this._map.get(n).set(r,e),this._setLatestMsgSentByPeer(n,e),this._setLatestMsgSentByMe(n,e),s}},{key:"unshift",value:function(e,t){var n;if(_e(e)?0<e.length&&(n=e[0].conversationID,this._unshiftMultipleMsgs(e,t)):(n=e.conversationID,this._unshiftSingleMsg(e,t)),n){var s=Array.from(this._map.get(n).values()),e=s.length;if(e!==0){for(var r=e-1;0<=r;r--)if(s[r].flow==="out"){this._setLatestMsgSentByMe(n,s[r]);break}if(n.startsWith(I.CONV_C2C)){for(var a=e-1;0<=a;a--)if(s[a].flow==="in"){this._setLatestMsgSentByPeer(n,s[a]);break}}}}}},{key:"_unshiftSingleMsg",value:function(e,t){var n=e.conversationID,s=this._getUniqueIDOfMsg(e);if(!this._map.has(n))return this._map.set(n,new Map),this._map.get(n).set(s,e),void t.push(e);var r=this._map.get(n),a=Array.from(r);r.has(s)||(a.unshift([s,e]),this._map.set(n,new Map(a)),t.push(e))}},{key:"_unshiftMultipleMsgs",value:function(e,t){for(var n=e.length,s=[],r=e[0].conversationID,a=this._map.get(r),l=this._map.has(r)?Array.from(a):[],d=0;d<n;d++){var h=this._getUniqueIDOfMsg(e[d]);a&&a.has(h)||(s.push([h,e[d]]),t.push(e[d]))}this._map.set(r,new Map(s.concat(l)))}},{key:"remove",value:function(n){var t=n.conversationID,n=this._getUniqueIDOfMsg(n);this._map.has(t)&&this._map.get(t).delete(n)}},{key:"revoke",value:function(e,t,n){var s;return this._map.has(e)?(s=this._map.get(e),this._updateMsgIsRevoked(s,t,n)):this._hoppingMsgMap.has(e)?(s=this._hoppingMsgMap.get(e),this._updateMsgIsRevoked(s,t,n)):null}},{key:"_updateMsgIsRevoked",value:function(e,t,n){var s,r=ye(e);try{for(r.s();!(s=r.n()).done;){var a=te(s.value,2)[1];if(a.sequence===t&&(H(n)||a.random===n))return a.isRevoked||(a.isRevoked=!0),a}}catch(l){r.e(l)}finally{r.f()}}},{key:"removeByConvID",value:function(e){var t=this._map.has(e);m.l("".concat(this._n,".removeByConvID convID:").concat(e," has:").concat(t)),t&&(this._map.delete(e),this._latestMsgSentByPeerMap.delete(e),this._latestMsgSentByMeMap.delete(e))}},{key:"findMessage",value:function(e){var t=null;return t=(t=this._findMsg(e,this._map))?t:this._findMsg(e,this._hoppingMsgMap)}},{key:"_findMsg",value:function(e,t){var n,s=null,r=ye(t);try{for(r.s();!(n=r.n()).done;)for(var a=q(te(n.value,2)[1].values()),l=a.length,d=0;d<l;d++)if(a[d].ID===e){s=a[d];break}}catch(h){r.e(h)}finally{r.f()}return s}},{key:"updateMsgIsPeerReadProp",value:function(e,t){var n,s=[];return this._map.has(e)?(n=this._map.get(e),s=this._updateMsgIsPeerReadProp(n,t)):this._hoppingMsgMap.has(e)&&(n=this._hoppingMsgMap.get(e),s=this._updateMsgIsPeerReadProp(n,t)),m.l("".concat(this._n,".updateMsgIsPeerReadProp convID:").concat(e," peerReadTime:").concat(t," count:").concat(s.length)),s}},{key:"_updateMsgIsPeerReadProp",value:function(e,t){var n,s=[],r=ye(e);try{for(r.s();!(n=r.n()).done;){var a=te(n.value,2)[1];a.time<=t&&!a.isPeerRead&&a.flow==="out"&&(a.isPeerRead=!0,s.push(a))}}catch(l){r.e(l)}finally{r.f()}return s}},{key:"updateMsgIsModifiedProp",value:function(e){var t=e.conversationID;this._map.has(t)&&(e=this._getUniqueIDOfMsg(e),(t=this._map.get(t).get(e))&&(t.isModified=!0))}},{key:"hasLocalMsgList",value:function(e){return this._map.has(e)}},{key:"getLocalMsgList",value:function(e){return this.hasLocalMsgList(e)?q(this._map.get(e).values()):[]}},{key:"getLocalMaxSeq",value:function(e){return this.hasLocalMsgList(e)?(e=q(this._map.get(e).values()).map(function(t){return t.sequence}),Math.max.apply(Math,q(e))):0}},{key:"getLocalMaxTime",value:function(e){return this.hasLocalMsgList(e)?(e=q(this._map.get(e).values()).map(function(t){return t.time}),Math.max.apply(Math,q(e))):0}},{key:"hasLocalMsg",value:function(e,t){for(var n=!1,s=this.getLocalMsgList(e),r=s.length,a=0;a<r;a++)s[a].ID===t&&(n=!0);return n}},{key:"getLocalMsg",value:function(e,t){for(var n=null,s=this.getLocalMsgList(e),r=s.length,a=0;a<r;a++)if(s[a].ID===t){n=s[a];break}return n}},{key:"getLocalLastMsg",value:function(e){return e=this.getLocalMsgList(e),e[e.length-1]}},{key:"getLocalSecondLastMsg",value:function(e){return e=this.getLocalMsgList(e),e[e.length-2]}},{key:"getLocalOldestMsg",value:function(e){return this.getLocalMsgList(e)[0]}},{key:"_setLatestMsgSentByPeer",value:function(e,t){e.startsWith(I.CONV_C2C)&&t.flow==="in"&&this._latestMsgSentByPeerMap.set(e,t)}},{key:"_setLatestMsgSentByMe",value:function(e,t){t.flow==="out"&&this._latestMsgSentByMeMap.set(e,t)}},{key:"getLatestMsgSentByPeer",value:function(e){return this._latestMsgSentByPeerMap.get(e)}},{key:"getLatestMsgSentByMe",value:function(e){return this._latestMsgSentByMeMap.get(e)}},{key:"modifyMsgSentByPeer",value:function(r){var t=r.conversationID,n=r.latestNick,s=r.latestAvatar,r=this._map.get(t);if(!se(r)){var a=Array.from(r.values()),r=a.length;if(r!==0){for(var l=null,d=0,h=!1,g=r-1;0<=g;g--)a[g].flow==="in"&&((l=a[g]).nick!==n&&(l.setNickAndAvatar({nick:n}),h=!0),l.avatar!==s&&(l.setNickAndAvatar({avatar:s}),h=!0),h&&(d+=1));m.l("".concat(this._n,".modifyMsgSentByPeer convID:").concat(t," count:").concat(d))}}}},{key:"modifyMsgSentByMe",value:function(r){var t=r.conversationID,n=r.latestNick,s=r.latestAvatar,r=this._map.get(t);if(!se(r)){var a=Array.from(r.values()),r=a.length;if(r!==0){for(var l=null,d=0,h=!1,g=r-1;0<=g;g--)a[g].flow==="out"&&((l=a[g]).nick!==n&&(l.setNickAndAvatar({nick:n}),h=!0),l.avatar!==s&&(l.setNickAndAvatar({avatar:s}),h=!0),h&&(d+=1));m.l("".concat(this._n,".modifyMsgSentByMe convID:").concat(t," count:").concat(d))}}}},{key:"getTopicConvIDList",value:function(e){return q(this._map.keys()).filter(function(t){return t.startsWith("".concat(I.CONV_GROUP).concat(e))})}},{key:"onMsgModified",value:function(e,t){if(!this._map.has(e)&&!this._hoppingMsgMap.has(e))return{isUpdated:!1,message:null};var n="".concat(this._n,".onMsgModified"),s=this._getUniqueIDOfMsg(t),r=this._getTargetMsg(e,s),a=!!r;return m.l("".concat(n," convID:").concat(e," uniqueID:").concat(s," has:").concat(a)),a?(e=t.messageVersion,s=t.elements,a=t.cloudCustomData,t=t.checkResult,m.l("".concat(n," localVersion:").concat(r.version," remoteVersion:").concat(e)),r.version<e?(r.version=e,r._elements=JSON.parse(JSON.stringify(s)),r.payload=r._elements[0].content,r.type=r._elements[0].type,r.cloudCustomData=a,r.isModified=!0,r.hasRiskContent=ef(t),{isUpdated:!0,message:r}):{isUpdated:!1,message:r}):{isUpdated:!1,message:null}}},{key:"_getUniqueIDOfMsg",value:function(a){var t=a.from,n=a.to,s=a.random,r=a.sequence,a=a.time;return"".concat(t,"-").concat(n,"-").concat(s,"-").concat(r,"-").concat(a)}},{key:"_getTargetMsg",value:function(e,t){if(this._map.has(e))return this._map.get(e).get(t);var n=void 0;if(this._hoppingMsgMap.has(e)){for(var s=q(this._hoppingMsgMap.get(e).values()),r=0;r<s.length;r++)if(this._getUniqueIDOfMsg(s[r])===t){n=s[r];break}}return n}},{key:"storeHoppingMsgList",value:function(e){if(e.length!==0){var t=e[0].conversationID,n=e.length;this._hoppingMsgMap.has(t)||this._hoppingMsgMap.set(t,new Map);for(var s=this._hoppingMsgMap.get(t),r=0;r<n;r++){var a=e[r];s.has(a.ID)||s.set(a.ID,a)}}}},{key:"getHoppingMsg",value:function(e,t){if(this._hoppingMsgMap.has(e))return this._hoppingMsgMap.get(e).get(t)}},{key:"reset",value:function(){this._map.clear(),this._latestMsgSentByPeerMap.clear(),this._latestMsgSentByMeMap.clear(),this._hoppingMsgMap.clear()}}]),Cu);function Cu(e){f(this,Cu),this._convM=e,this._map=new Map,this._n="MsgListHandler",this._latestMsgSentByPeerMap=new Map,this._latestMsgSentByMeMap=new Map,this._hoppingMsgMap=new Map,this.TOPIC_MSG_LIMIT=1e3,this._convM.getIEmitInst().on(mt.CLOUD_CONFIG,this._onCloudConfig,this)}function Gr(e){return f(this,Gr),(e=gf.call(this,e))._n="C2CModule",e._msgFromUnreadDBMap=new Map,e._noticeFromUnreadDBList=[],e}function Tu(e){this.mixin(e)}Tu.mixin=function(e){e=e.prototype||e,e._isReady=!1,e.ready=function(t){if(t)return this._isReady?void(1<arguments.length&&arguments[1]!==void 0&&arguments[1]?t.call(this):setTimeout(t,1)):(this._readyQueue=this._readyQueue||[],void this._readyQueue.push(t))},e.triggerReady=function(){var t=this;this._isReady=!0,setTimeout(function(){var n=t._readyQueue;t._readyQueue=[],n&&0<n.length&&n.forEach(function(s){s.call(this)},t)},1)},e.resetReady=function(){this._isReady=!1,this._readyQueue=[]},e.isReady=function(){return this._isReady}};function _f(e,t,n){return H(e)?{lastTime:0,lastSequence:0,fromAccount:"",messageForShow:"",payload:null,type:"",isRevoked:!1,cloudCustomData:"",onlineOnlyFlag:!1,nick:"",nameCard:"",version:0,isPeerRead:!1,revoker:null}:n&&e.ID||e instanceof Bt?{lastTime:e.time||0,lastSequence:e.sequence||0,fromAccount:e.from||"",messageForShow:Lr(e.type,e.payload,t),payload:e.payload||null,type:e.type||null,isRevoked:e.isRevoked||!1,cloudCustomData:e.cloudCustomData||"",onlineOnlyFlag:e._onlineOnlyFlag||!1,nick:e.nick||"",nameCard:e.nameCard||"",version:e.version||0,isPeerRead:e.isPeerRead||!1,revoker:e.revoker||null}:c(c({},e),{},{messageForShow:Lr(e.type,e.payload,t)})}function mf(e,t){return se(e)?{lastTime:0,lastSequence:0,fromAccount:"",payload:null,type:"",messageForShow:"",nick:"",avatar:"",version:0,cloudCustomData:"",isRevoked:!1,revoker:null}:{lastTime:e.time||0,lastSequence:e.sequence||0,fromAccount:e.from||"",payload:e.payload||null,type:e.type||"",messageForShow:Lr(e.type,e.payload,t),nick:e.nick||"",avatar:e.avatar||"",version:e.version||0,cloudCustomData:e.cloudCustomData||"",isRevoked:e.isRevoked||!1,revoker:e.revoker||null}}function ga(e){var t=String(e).replace(/[=]+$/,""),n="";if(t.length%4==1)return"";for(var s,r,a=0,l=0;r=t.charAt(l++);~r&&(s=a%4?64*s+r:r,a++%4)&&(n+=String.fromCharCode(255&s>>(-2*a&6))))r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);try{return decodeURIComponent(escape(n))}catch{return""}}var vf,yf,If,Mf,Cf,Ay=["jpg","jpeg","gif","png","bmp","image","webp"],Oy=["mp4","quicktime","mov"],wr=(y(Ku,[{key:"validate",value:function(e){var t,n=!0,s="";if(se(e))return{valid:!1,tips:"empty options"};if(e.profileCustomField)for(var r=e.profileCustomField.length,a=null,l=0;l<r;l++){if(a=e.profileCustomField[l],!xe(a.key)||a.key.indexOf("Tag_Profile_Custom")===-1)return{valid:!1,tips:"The prefix of keys of the custom profile key-value pairs (which is profileCustomField) must be Tag_Profile_Custom"};if(!xe(a.value))return{valid:!1,tips:"The type of values of the custom profile key-value pairs (which is profileCustomField) must be String"}}for(t in e)if(Object.prototype.hasOwnProperty.call(e,t)){if(t==="profileCustomField")continue;if(se(e[t])&&!xe(e[t])&&!Qe(e[t])){s="key:"+t+", invalid value:"+e[t],n=!1;continue}switch(t){case"nick":xe(e[t])||(n=!(s="nick must be a string")),500<sa(e[t])&&(s="nick name limited: must less than or equal to ".concat(500," bytes, current size: ").concat(sa(e[t])," bytes"),n=!1);break;case"gender":ws(bp,e.gender)||(s="key:gender, invalid value:"+e.gender,n=!1);break;case"birthday":Qe(e.birthday)||(n=!(s="birthday must be a number"));break;case"location":xe(e.location)||(n=!(s="location must be a string"));break;case"selfSignature":xe(e.selfSignature)||(n=!(s="selfSignature must be a string"));break;case"allowType":ws(wp,e.allowType)||(s="key:allowType, invalid value:"+e.allowType,n=!1);break;case"language":Qe(e.language)||(n=!(s="language must be a number"));break;case"avatar":xe(e.avatar)||(n=!(s="avatar must be a string"));break;case"messageSettings":e.messageSettings!==0&&e.messageSettings!==1&&(n=!(s="messageSettings must be 0 or 1"));break;case"adminForbidType":ws(Gp,e.adminForbidType)||(s="key:adminForbidType, invalid value:"+e.adminForbidType,n=!1);break;case"level":Qe(e.level)||(n=!(s="level must be a number"));break;case"role":Qe(e.role)||(n=!(s="role must be a number"));break;default:s="unknown key:"+t+"  "+e[t],n=!1}}return{valid:n,tips:s}}}]),Ku),Eu=(y(Hu,[{key:"set",value:function(e){var t;this.map.size>=this.MAX_LENGTH&&(t=this.map.entries().next().value[0],this.map.delete(t)),this.map.set(e,1)}},{key:"has",value:function(e){return this.map.has(e)}},{key:"delete",value:function(e){this.has(e)&&this.map.delete(e)}},{key:"reset",value:function(){this.map.clear()}}]),Hu),Ny=["groupID","name","avatar","type","introduction","notification","ownerID","selfInfo","createTime","infoSequence","lastInfoTime","lastMessage","nextMessageSeq","memberNum","maxMemberNum","memberList","joinOption","groupCustomField","muteAllMembers","isSupportTopic","inviteOption","_lastRevokedTime"],co=(y(Bu,[{key:"memberNum",get:function(){return this.memberCount},set:function(e){}},{key:"maxMemberNum",get:function(){return this.maxMemberCount},set:function(e){}},{key:"_initGroup",value:function(e){for(var t in e)Ny.indexOf(t)<0||(t!=="selfInfo"?(t==="memberNum"&&(this.memberCount=e[t]),t==="maxMemberNum"&&(this.maxMemberCount=e[t]),t!=="isSupportTopic"?this[t]=e[t]:this.isSupportTopic=e[t]===1):this.updateSelfInfo(e[t]))}},{key:"updateGroup",value:function(n){var t=this,n=(n.appid=void 0,n.grossTopicNextMsgSeq=void 0,n.selfInfo&&(n.selfInfo.grossTopicReadSeq=void 0),JSON.parse(JSON.stringify(n)));n.lastMsgTime&&(this.lastMessage.lastTime=n.lastMsgTime),H(n.muteAllMembers)||(n.muteAllMembers==="On"?n.muteAllMembers=!0:n.muteAllMembers=!1),n.groupCustomField&&Dr(this.groupCustomField,n.groupCustomField),H(n.memberNum)||(this.memberCount=n.memberNum),H(n.maxMemberNum)||(this.maxMemberCount=n.maxMemberNum),H(n.isSupportTopic)||(this.isSupportTopic=Qe(n.isSupportTopic)?n.isSupportTopic===1:n.isSupportTopic),zn(this,n,["members","errorCode","lastMsgTime","groupCustomField","memberNum","maxMemberNum","isSupportTopic"]),_e(n.members)&&0<n.members.length&&n.members.forEach(function(s){s.userID===t.selfInfo.userID&&zn(t.selfInfo,s,["sequence"])})}},{key:"updateSelfInfo",value:function(e){e={nameCard:e.nameCard,joinTime:e.joinTime,role:e.role,messageRemindType:e.messageRemindType,readedSequence:e.readedSequence,excludedUnreadSequenceList:e.excludedUnreadSequenceList},zn(this.selfInfo,c({},e),[],["",null,void 0,0,NaN])}},{key:"setSelfNameCard",value:function(e){this.selfInfo.nameCard=e}}]),Bu),Ur=(y(Vu,[{key:"toAccount",get:function(){return this.conversationID.startsWith(I.CONV_C2C)?this.conversationID.replace(I.CONV_C2C,""):this.conversationID.startsWith(I.CONV_GROUP)?this.conversationID.replace(I.CONV_GROUP,""):""}},{key:"_initProfile",value:function(e){var t=this;Object.keys(e).forEach(function(n){switch(n){case"userProfile":t.userProfile=e.userProfile;break;case"groupProfile":t.groupProfile=e.groupProfile}}),H(this.userProfile)&&this.type===I.CONV_C2C?this.userProfile=new wr({userID:e.conversationID.replace("C2C","")}):H(this.groupProfile)&&this.type===I.CONV_GROUP&&(this.groupProfile=new co({groupID:e.conversationID.replace("GROUP","")}))}},{key:"updateUnreadCount",value:function(s){var t=s.nextUnreadCount,n=s.isFromGetConversations,s=s.isUnreadC2CMessage;H(t)||(nn(this.subType)?this.unreadCount=0:n&&this.type===I.CONV_GROUP||n&&this.type===I.CONV_TOPIC||s&&this.type===I.CONV_C2C?this.unreadCount=t:this.unreadCount=this.unreadCount+t)}},{key:"updateLastMessage",value:function(e){this.lastMessage=_f(e)}},{key:"updateGroupAtInfoList",value:function(e){var t;this._isNeedMergeGroupAtInfo(e)||((t=(Ne(t=e.groupAtType)||Le(t)||Se(t)||ve()).slice(0)).indexOf(I.CONV_AT_ME)!==-1&&t.indexOf(I.CONV_AT_ALL)!==-1&&(t=[I.CONV_AT_ALL_AT_ME]),t={from:e.from,groupID:e.groupID,topicID:e.topicID,messageSequence:e.sequence,atTypeArray:t,__random:e.__random,__sequence:e.__sequence},this.groupAtInfoList.push(t))}},{key:"_isNeedMergeGroupAtInfo",value:function(e){var t=e.groupID,n=e.sequence;if(!rn({groupID:t}))return!1;var s=!1;return this.groupAtInfoList.forEach(function(r){r.messageSequence===n&&(-1<r.atTypeArray.indexOf(I.CONV_AT_ME)&&-1<e.groupAtType.indexOf(I.CONV_AT_ALL)&&(r.atTypeArray=[I.CONV_AT_ALL_AT_ME]),-1<r.atTypeArray.indexOf(I.CONV_AT_ALL)&&-1<e.groupAtType.indexOf(I.CONV_AT_ME)&&(r.atTypeArray=[I.CONV_AT_ALL_AT_ME],r.__random=e.__random,r.__sequence=e.__sequence),s=!0)}),s}},{key:"clearGroupAtInfoList",value:function(){this.groupAtInfoList.length=0}},{key:"reduceUnreadCount",value:function(){return 1<=this.unreadCount&&(--this.unreadCount,!0)}},{key:"isLastMessageRevoked",value:function(n){var t=n.sequence,n=n.time;return this.type===I.CONV_C2C&&t===this.lastMessage.lastSequence&&n===this.lastMessage.lastTime||this.type===I.CONV_GROUP&&t===this.lastMessage.lastSequence}},{key:"setLastMessageRevoked",value:function(e){this.lastMessage.isRevoked=e}},{key:"setLastMessageRevoker",value:function(e){this.lastMessage.revoker=e}},{key:"setDraftText",value:function(e){this.draftText=e}}]),Vu),Tf=(C(zt={},I.MSG_REMIND_ACPT_AND_NOTE,0),C(zt,I.MSG_REMIND_DISCARD,1),C(zt,I.MSG_REMIND_ACPT_NOT_NOTE,2),zt),Py=(y(qu,[{key:"onAllRcvMsgOptNotify",value:function(e){e=this._handleResult(e),this._convM.emitOEvt($.ALL_RECEIVE_MESSAGE_OPT_UPDATED,e)}},{key:"getC2CMsgRemindType",value:function(e){var t=this,n="".concat(this._n,".getC2CMsgRemindType");return this._convM.req({P:E.GET_C2C_PEER_MUTE_NOTIFICATIONS,data:{toAccount:this._convM.getMyUserID(),userIDList:e}}).then(function(s){m.l("".concat(n," ok. userIDList:").concat(e)),s=s.data.muteFlagList,t._convM.onC2CMsgRemindTypeFetched(s)}).catch(function(s){m.e("".concat(n," failed. error:"),s)})}},{key:"set",value:function(e){return e.groupID?this._setGroupMsgRemindType(e):_e(e.userIDList)?this._setC2CMsgRemindType(e):void 0}},{key:"_setGroupMsgRemindType",value:function(e){var t=this,n="".concat(this._n,".").concat("_setGroupMsgRemindType"),s=e.groupID,r=e.messageRemindType,a="groupID:".concat(s," messageRemindType:").concat(r),l=new K("_setGroupMsgRemindType"),d=(l.setMessage(a),this._get(7));return d?d.modifyGroupMemberInfo({groupID:s,messageRemindType:r,userID:this._convM.getMyUserID()}).then(function(){l.end(),m.l("".concat(n," ok. ").concat(a));var h=t.onGroupMsgRemindTypeUpdated(e);return t._convM.onTotalUnreadCountUpdate(),me(h)}).catch(function(h){return l.setError(h).end(),m.e("".concat(n," failed. error:"),h),A(h)}):A({code:F.NO_MODULE})}},{key:"onGroupMsgRemindTypeUpdated",value:function(r){var t,n,s=r.groupID,r=r.messageRemindType,a=(m.l("".concat(this._n,".onGroupMsgRemindTypeUpdated groupID:").concat(s," messageRemindType:").concat(r)),this._get(7).getLocalGroupProfile(s));return a&&(a.selfInfo.messageRemindType=r),Vt(s)?(t=wt(n=s),(n=this._get(10).getLocalTopic(t,n))&&n.updateSelfInfo({messageRemindType:r})&&this._convM.emitOEvt($.TOPIC_UPDATED,{groupID:t,topic:n}),{topic:n}):(this._convM.patchMsgRemindType({ID:s,isC2CConversation:!1,messageRemindType:r})&&this._emitConvUpdate(),{group:a})}},{key:"_setC2CMsgRemindType",value:function(l){var t=this,n="".concat(this._n,".").concat("_setC2CMsgRemindType"),s=l.userIDList,r=l.messageRemindType,a=s.slice(0,30),l=Tf[r]||0,d="userIDList:".concat(a," messageRemindType:").concat(r),h=new K("_setC2CMsgRemindType");return h.setMessage(d),this._convM.req({P:E.SET_C2C_PEER_MUTE_NOTIFICATIONS,data:{userIDList:a,muteFlag:l}}).then(function(S){h.end();var S=S.data.errorList,_=[],M=[],S=(_e(S)&&S.forEach(function(O){_.push(O.userID),M.push({userID:O.userID,code:O.errorCode})}),a.filter(function(O){return _.indexOf(O)===-1})),D=(m.l("".concat(n," ok. ").concat(d," successUserIDList:").concat(S," failureUserIDList:").concat(JSON.stringify(M))),0);return S.forEach(function(O){t._convM.patchMsgRemindType({ID:O,isC2CConversation:!0,messageRemindType:r})&&(D+=1)}),1<=D&&t._emitConvUpdate(),a.length=_.length=0,t._convM.onTotalUnreadCountUpdate(),Pe({successUserIDList:S.map(function(O){return{userID:O}}),failureUserIDList:M})}).catch(function(g){return h.setError(g).end(),m.e("".concat(n," failed. error:"),g),A(g)})}},{key:"_get",value:function(e){return this._convM.get(e)}},{key:"_emitConvUpdate",value:function(){this._convM.emitConvUpdate(!0,!1)}},{key:"setAllRcvMsgOpt",value:function(l){var t="".concat(this._n,".").concat("setAllRcvMsgOpt"),n=l.messageRemindType,n=n===void 0?I.MSG_REMIND_ACPT_NOT_NOTE:n,s=l.isRepeated,s=s===void 0||s,a=this._calcStartAndEndTime(l),r=a.startTime,r=r===void 0?0:r,a=a.endTime,a=a===void 0?0:a,l=JSON.stringify(l),d=new K("setAllRcvMsgOpt");return d.setMessage(l),m.l("".concat(t," options:").concat(l)),this._convM.req({P:E.SET_ALL_RECEIVE_MSG_OPT,data:{messageRemindType:Tf[n],startTime:r,endTime:a,isRepeated:s?1:0}}).then(function(h){return d.end(),m.l("".concat(t," ok.")),me(h)}).catch(function(h){return d.setError(h).end(),m.e("".concat(t," failed. error:"),h),A(h)})}},{key:"_calcStartAndEndTime",value:function(a){var t=a.startHour,t=t===void 0?0:t,n=a.startMinute,n=n===void 0?0:n,s=a.startSecond,s=s===void 0?0:s,r=a.duration,r=r===void 0?0:r,a=a.isRepeated,a=a===void 0||a,d=new Date,h=d.getFullYear(),l=d.getMonth(),d=d.getDate(),h=Math.round(new Date(h,l,d,t,n,s).getTime()/1e3);return{startTime:h,endTime:a&&86400<=r?h+86400:h+r}}},{key:"getAllRcvMsgOpt",value:function(){var e=this,t="".concat(this._n,".").concat("getAllRcvMsgOpt"),n=new K("getAllRcvMsgOpt");return this._convM.req({P:E.GET_ALL_RECEIVE_MSG_OPT,data:{toAccount:this._convM.getMyUserID()}}).then(function(s){return s=s.data,n.setMessage(JSON.stringify(s)).end(),m.l("".concat(t," ok. data:").concat(JSON.stringify(s))),s=e._handleResult(s),me(s)}).catch(function(s){return n.setError(s).end(),m.e("".concat(t," failed. error:"),s),A(s)})}},{key:"_handleResult",value:function(r){var t=r.messageRemindType,n=r.startTime,s=r.endTime,r=r.isRepeated,a=I.MSG_REMIND_ACPT_AND_NOTE;return t===1&&(a=I.MSG_REMIND_DISCARD),{messageRemindType:a=t===2?I.MSG_REMIND_ACPT_NOT_NOTE:a,startTime:n,endTime:s,isRepeated:r===1}}},{key:"reset",value:function(){m.l("".concat(this._n,".reset"))}}]),qu),by=(y(xu,[{key:"setConvCustomData",value:function(e){var t=this,n="".concat(this._n,".").concat("setConvCustomData"),s=e.conversationIDList,r=e.customData,a=(m.l("".concat(n," options:"),e),new K("setConvCustomData")),l=(a.setMessage(JSON.stringify(e)),{fromAccount:this._getMyUserID(),itemList:[]}),d=[],h=[];return s.forEach(function(g){if(!t._hasLocalConv(g))return t._onConvNotFound(h,g),!0;if(!Zt(g)&&!ln(g))return t._onConvIDInvalid(h,g),!0;var _={operationType:2,contactItem:void 0,customMark:r};Zt(g)?_.contactItem={type:1,toAccount:g.replace(I.CONV_C2C,"")}:ln(g)&&(_.contactItem={type:2,groupID:g.replace(I.CONV_GROUP,"")}),l.itemList.push(_)}),h.length===s.length?Pe({successConversationIDList:d,failureConversationIDList:h}):this._convM.req({P:E.SET_CONV_CUSTOM_DATA,data:l}).then(function(D){a.end(),m.l("".concat(n," ok"));var _,M,S,D=D.data.resultItem;return _e(D)&&(S=!1,D.forEach(function(O){_=t._concatConvID(O.contactItem),O.resultCode===0?(d.push(_),(M=t._getLocalConv(_))&&M.customData!==r&&(M.customData=r,S=!0)):h.push({conversationID:_,code:O.resultCode,message:O.resultInfo})}),S===!0&&t._emitConvUpdate()),me({successConversationIDList:d,failureConversationIDList:h})}).catch(function(g){return a.setError(g).end(),m.e("".concat(n," failed. error:"),g),A(g)})}},{key:"markConv",value:function(g){var t=this;if(!this._convM.canIUse(he.CONV_MARK))return this._convM.noUse("markConv");var n="".concat(this._n,".").concat("markConv"),s=g.conversationIDList,r=g.markType,a=g.enableMark,l=(m.l("".concat(n," options:"),g),new K("markConv")),d=(l.setMessage(JSON.stringify(g)),void 0),h=void 0,g=this._getFlagBit(r),_=(a===!0?h=[g]:d=[g],{fromAccount:this._getMyUserID(),itemList:[]}),M=[],S=[];return s.forEach(function(D){if(!t._hasLocalConv(D))return t._onConvNotFound(S,D),!0;if(!Zt(D)&&!ln(D))return t._onConvIDInvalid(S,D),!0;var O={operationType:1,contactItem:void 0,clearMark:d,setMark:h};Zt(D)?O.contactItem={type:1,toAccount:D.replace(I.CONV_C2C,"")}:ln(D)&&(O.contactItem={type:2,groupID:D.replace(I.CONV_GROUP,"")}),_.itemList.push(O)}),S.length===s.length?Pe({successConversationIDList:M,failureConversationIDList:S}):this._convM.req({P:E.MARK_CONV,data:_}).then(function(de){l.end(),m.l("".concat(n," ok"));var O,B,U,de=de.data.resultItem;return _e(de)&&(U=!1,de.forEach(function(J){var ke;O=t._concatConvID(J.contactItem),J.resultCode===0?(M.push(O),(B=t._getLocalConv(O))&&(ke=B.markList.indexOf(r),a===!0?ke===-1&&(B.markList.push(r),U=!0):ke!==-1&&(B.markList.splice(ke,1),U=!0))):S.push({conversationID:O,code:J.resultCode,message:J.resultInfo})}),U===!0&&t._emitConvUpdate()),me({successConversationIDList:M,failureConversationIDList:S})}).catch(function(D){return l.setError(D).end(),m.e("".concat(n," failed. error:"),D),A(D)})}},{key:"getLocalConvGroupList",value:function(){var e=this;return m.l("".concat(this._n,".getLocalConvGroupList pagingStatus:").concat(this._pagingStatus)),this._pagingStatus===Hs?this.getRemoteConvGroupList().then(function(){return me(q(e._convGroupMap.values()))}):Pe(q(this._convGroupMap.values()))}},{key:"searchConvGroupAndMark",value:function(e,t){var n=this,s="".concat(this._n,".searchConvGroupAndMark"),r=[];return e.forEach(function(a){t===1?r.push({type:1,toAccount:a}):t===2&&r.push({type:2,groupID:a})}),m.l("".concat(s," type:").concat(t," list:"),e),this._convM.req({P:E.SEARCH_CONV_GRP_MARK,data:{fromAccount:this._getMyUserID(),contactItem:r}}).then(function(d){var d=d.data,l=d.contactItem,d=d.groupItem;m.l("".concat(s," ok. contactItem:"),l,"groupItem:",d),n._fillConvGroupMap(d),n._handleContactItem(l),n._emitConvUpdate()}).catch(function(a){m.w("".concat(s," failed. error:"),a)})}},{key:"_fillConvGroupMap",value:function(e){var t=this;_e(e)&&e.forEach(function(r){var s=r.convGroupID,r=r.groupName;t._convGroupMap.set(s,r)})}},{key:"_handleContactItem",value:function(e){var t,n=this;_e(e)&&e.forEach(function(s){var r=[],a=s.standardMark,l=s.customData,d=s.convGroupIDList;_e(d)&&d.forEach(function(h){n._convGroupMap.has(h)&&r.push(n._convGroupMap.get(h))}),t=n._concatConvID(s),(t=n._getLocalConv(t))&&(t.markList=ia(a),t.customData=l||"",t.conversationGroupList=[].concat(r))})}},{key:"getRemoteConvGroupList",value:function(){var e=this,t="".concat(this._n,".getRemoteConvGroupList");return this._pagingStatus=uf,this._convM.req({P:E.GET_CONV_GRP_LIST,data:{fromAccount:this._getMyUserID(),startIndex:this._startIndex}}).then(function(l){var l=l.data,s=l.completeFlag,r=l.contactItem,a=l.nextStartIndex,a=a===void 0?0:a,l=l.groupItem;if(e._startIndex=a,m.l("".concat(t," completeFlag:").concat(s," nextStartIndex:").concat(a,", groupItem:"),l,"contactItem:",r),e._fillConvGroupMap(l),e._handleContactItem(r),s===0)return e.getRemoteConvGroupList();s===1&&(e._pagingStatus=Or,e._emitConvUpdate(),e._emitConvGroupListUpdate())}).catch(function(n){e._pagingStatus=Hs,m.w("".concat(t," failed. error:"),n)})}},{key:"createConvGroup",value:function(a){var t=this;if(!this._convM.canIUse(he.CONV_GROUP))return this._convM.noUse("createConvGroup");var n="".concat(this._n,".").concat("createConvGroup"),s=(m.l("".concat(n," options:"),a),new K("createConvGroup")),r=(s.setMessage(JSON.stringify(a)),a.groupName),a=a.conversationIDList,l={fromAccount:this._getMyUserID(),itemList:[{groupName:r,contactItem:[]}]},d=[],h=[];return a.forEach(function(g){return t._hasLocalConv(g)?Zt(g)||ln(g)?void(Zt(g)?l.itemList[0].contactItem.push({type:1,toAccount:g.replace(I.CONV_C2C,"")}):ln(g)&&l.itemList[0].contactItem.push({type:2,groupID:g.replace(I.CONV_GROUP,"")})):(t._onConvIDInvalid(h,g),!0):(t._onConvNotFound(h,g),!0)}),h.length===a.length?Pe({successConversationIDList:d,failureConversationIDList:h}):this._convM.req({P:E.CREATE_CONV_GRP,data:l}).then(function(O){s.end(),m.l("".concat(n," ok"));var _,M,S,O=O.data.groupResultItem[0],D=O.groupItem,O=O.resultItem;return dt(D)&&(t._convGroupMap.set(D.convGroupID,D.groupName),t._emitConvGroupListUpdate()),_e(O)&&(S=!1,O.forEach(function(B){_=t._concatConvID(B.contactItem),B.resultCode===0?(d.push(_),(M=t._getLocalConv(_))&&M.conversationGroupList.indexOf(r)===-1&&(M.conversationGroupList.push(r),S=!0)):h.push({conversationID:_,code:B.resultCode,message:B.resultInfo})}),S===!0&&(t._emitConvUpdate(),t._emitConvGroupListUpdate())),me({successConversationIDList:d,failureConversationIDList:h})}).catch(function(g){return s.setError(g).end(),m.e("".concat(n," failed. error:"),g),A(g)})}},{key:"deleteConvGroup",value:function(e){var t=this;if(!this._convM.canIUse(he.CONV_GROUP))return this._convM.noUse("deleteConvGroup");var n="".concat(this._n,".").concat("deleteConvGroup"),s=(m.l("".concat(n," groupName:").concat(e)),new K("deleteConvGroup"));return s.setMessage(e),this._convM.req({P:E.DEL_CONV_GRP,data:{fromAccount:this._getMyUserID(),groupName:[e]}}).then(function(l){s.end(),m.l("".concat(n," ok"));var a,l=l.data.groupItem;_e(l)&&(a=!1,l.forEach(function(d){t._convGroupMap.has(d.convGroupID)&&(t._convGroupMap.delete(d.convGroupID),a=!0)}),a===!0&&t._emitConvGroupListUpdate()),t._eraseFromConversationGroupList([e])}).catch(function(r){return s.setError(r).end(),m.e("".concat(n," failed. error:"),r),A(r)})}},{key:"renameConvGroup",value:function(e){var t=this;if(!this._convM.canIUse(he.CONV_GROUP))return this._convM.noUse("renameConvGroup");var n="".concat(this._n,".").concat("renameConvGroup"),s=(m.l("".concat(n," options:"),e),new K("renameConvGroup")),r=(s.setMessage(JSON.stringify(e)),e.oldName),a=e.newName;return this._convM.req({P:E.RENAME_CONV_GRP,data:{fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:1,oldName:r,newName:a}}}).then(function(g){s.end(),m.l("".concat(n," ok")),g=g.data.updateGroupResult.convGroupID,t._convGroupMap.set(g,a),t._emitConvGroupListUpdate();var d,h,g=t._convM.getLocalConvList(),_=!1;g.forEach(function(M){d=M.conversationGroupList,(h=d.indexOf(r))!==-1&&(d.splice(h,1,a),_=!0)}),_===!0&&t._emitConvUpdate()}).catch(function(l){return s.setError(l).end(),m.e("".concat(n," failed. error:"),l),A(l)})}},{key:"addConvsToGroup",value:function(e){var t=this;if(!this._convM.canIUse(he.CONV_GROUP))return this._convM.noUse("addConvsToGroup");var n="".concat(this._n,".").concat("addConvsToGroup"),s=(m.l("".concat(n," options:"),e),new K("addConvsToGroup")),r=(s.setMessage(JSON.stringify(e)),e.conversationIDList),a=e.groupName,l={fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:2,groupName:a,updateItem:[]}},d=[],h=[];return r.forEach(function(g){return t._hasLocalConv(g)?Zt(g)||ln(g)?void(Zt(g)?l.updateGroup.updateItem.push({operationType:1,contactItem:{type:1,toAccount:g.replace(I.CONV_C2C,"")}}):ln(g)&&l.updateGroup.updateItem.push({operationType:1,contactItem:{type:2,groupID:g.replace(I.CONV_GROUP,"")}})):(t._onConvIDInvalid(h,g),!0):(t._onConvNotFound(h,g),!0)}),h.length===r.length?Pe({successConversationIDList:d,failureConversationIDList:h}):this._convM.req({P:E.ADD_CONV_TO_GRP,data:l}).then(function(D){s.end(),m.l("".concat(n," ok"));var _,M,S,D=D.data.updateGroupResult.contactResultItem;return _e(D)&&(S=!1,D.forEach(function(O){_=t._concatConvID(O.contactItem),O.resultCode===0?(M=t._getLocalConv(_))&&M.conversationGroupList.indexOf(a)===-1&&(M.conversationGroupList.push(a),d.push(_),S=!0):h.push({conversationID:_,code:O.resultCode,message:O.resultInfo})}),S===!0&&(t._emitConvUpdate(),t._emitConvInGroupUpdate(a))),me({successConversationIDList:d,failureConversationIDList:h})}).catch(function(g){return s.setError(g).end(),m.e("".concat(n," failed. error:"),g),A(g)})}},{key:"deleteConvsFromGroup",value:function(e){var t=this,r="deleteConvsFromGroup";if(!this._convM.canIUse(he.CONV_GROUP))return this._convM.noUse(r);var n="".concat(this._n,".").concat(r),s=(m.l("".concat(n," options:"),e),new K(r)),r=(s.setMessage(JSON.stringify(e)),e.conversationIDList),a=e.groupName,l={fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:2,groupName:a,updateItem:[]}},d=[],h=[];return r.forEach(function(g){return t._hasLocalConv(g)?Zt(g)||ln(g)?void(Zt(g)?l.updateGroup.updateItem.push({operationType:2,contactItem:{type:1,toAccount:g.replace(I.CONV_C2C,"")}}):ln(g)&&l.updateGroup.updateItem.push({operationType:2,contactItem:{type:2,groupID:g.replace(I.CONV_GROUP,"")}})):(t._onConvIDInvalid(h,g),!0):(t._onConvNotFound(h,g),!0)}),h.length===r.length?Pe({successConversationIDList:d,failureConversationIDList:h}):this._convM.req({P:E.DEL_CONV_FROM_GRP,data:l}).then(function(D){s.end(),m.l("".concat(n," ok"));var _,M,S,D=D.data.updateGroupResult.contactResultItem;return _e(D)&&(S=!1,D.forEach(function(O){var B;_=t._concatConvID(O.contactItem),O.resultCode===0?!(M=t._getLocalConv(_))||(B=M.conversationGroupList.indexOf(a))!==-1&&(M.conversationGroupList.splice(B,1),d.push(_),S=!0):h.push({conversationID:_,code:O.resultCode,message:O.resultInfo})}),S===!0&&(t._emitConvUpdate(),t._emitConvInGroupUpdate(a))),me({successConversationIDList:d,failureConversationIDList:h})}).catch(function(g){return s.setError(g).end(),m.e("".concat(n," failed. error:"),g),A(g)})}},{key:"onConvMarkUpdated",value:function(e){var t,n,s=this;se(e)||(m.l("".concat(this._n,".onConvMarkUpdated markItemList:"),e),n=!1,e.forEach(function(h){var a=h.recentContactItem,l=h.optType,d=h.standardMark,h=h.customMark;t=s._concatConvID(a),(t=s._getLocalConv(t))&&(l===1?n=s._diffStandardMark(t,d):l===2?n=s._diffCustomMark(t,h):l===3&&(a=s._diffStandardMark(t,d),l=s._diffCustomMark(t,h),n=a||l))}),n===!0&&this._emitConvUpdate())}},{key:"_diffStandardMark",value:function(e,n){var n=ia(n),s=!1;return function(r,a){if(r===a)return!0;if(!r||!a||r.length!==a.length)return!1;for(var l=0,d=r.length;l<d;l++)if(r[l]!==a[l])return!1;return!0}(e.markList,n)!==!0&&(e.markList=n,s=!0),s}},{key:"_diffCustomMark",value:function(e,t){var n=!1;return e.customData!==t&&t!==void 0&&(e.customData=t,n=!0),n}},{key:"onConvGroupCreated",value:function(e){var t=this,n=(m.l("".concat(this._n,".onConvGroupCreated resultList:"),e),!1),s=!1;_e(e)&&(e.forEach(function(r){var h=r.msgGroupItem,a=h.groupID,l=h.groupName;t._convGroupMap.get(a)!==l&&(t._convGroupMap.set(a,l),s=!0);var d,h=r.msgRecentContactItem;_e(h)&&h.forEach(function(g){d=t._concatConvID(g),(d=t._getLocalConv(d))&&d.conversationGroupList.indexOf(l)===-1&&(d.conversationGroupList.push(l),n=!0)})}),n===!0&&this._emitConvUpdate(),s===!0&&this._emitConvGroupListUpdate())}},{key:"onConvGroupDeleted",value:function(e){var t,n=this,s=(m.l("".concat(this._n,".onConvGroupDeleted groupItemList:"),e),[]);_e(e)&&(t=!1,e.forEach(function(l){var a=l.groupID,l=l.groupName;n._convGroupMap.has(a)&&(n._convGroupMap.delete(a),t=!0,s.push(l))}),t===!0&&this._emitConvGroupListUpdate()),this._eraseFromConversationGroupList(s)}},{key:"_eraseFromConversationGroupList",value:function(e){se(e)||(this._convM.getLocalConvList().forEach(function(t){t.conversationGroupList=t.conversationGroupList.filter(function(n){return!e.includes(n)})}),this._emitConvUpdate())}},{key:"onConvGroupNameUpdated",value:function(e){m.l("".concat(this._n,".onConvGroupNameUpdated options:"),e);var t,n,s,r=e.groupID,a=e.groupName,l=e.oldGroupName;this._convGroupMap.get(r)!==a&&(this._convGroupMap.set(r,a),this._emitConvGroupListUpdate(),e=this._convM.getLocalConvList(),s=!1,e.forEach(function(d){t=d.conversationGroupList,(n=t.indexOf(l))!==-1&&(t.splice(n,1,a),s=!0)}),s===!0&&this._emitConvUpdate())}},{key:"onConvInGroupUpdated",value:function(l){var t,n,s,r=this,a=(m.l("".concat(this._n,".onConvInGroupUpdated options:"),l),l.oldGroupName),l=l.recentContactUpdateGroupItem;_e(l)&&(s=!1,l.forEach(function(g){var h=g.contactOptType,g=g.recentContactItem;t=r._concatConvID(g),(t=r._getLocalConv(t))&&(n=t.conversationGroupList.indexOf(a),h===1?n===-1&&(t.conversationGroupList.push(a),s=!0):h===2&&n!==-1&&(t.conversationGroupList.splice(n,1),s=!0))}),s===!0&&(this._emitConvUpdate(),this._emitConvInGroupUpdate(a)))}},{key:"onConvAddedToOrDeletedFromGroup",value:function(r){var t,n,s=this,a=(m.l("".concat(this._n,".onConvAddedToOrDeletedFromGroup options:"),r),r.msgRecentContactItem),r=r.msgRecentContactUpdateContactItem,a=this._concatConvID(a),l=this._getLocalConv(a);l&&_e(r)&&(n=!1,r.forEach(function(g){var h=g.groupOptType,g=g.recentContactGroupItem.groupName;t=l.conversationGroupList.indexOf(g),h===1?t===-1&&(l.conversationGroupList.push(g),n=!0):h===2&&t!==-1&&(l.conversationGroupList.splice(t,1),n=!0),n===!0&&s._emitConvInGroupUpdate(g)}),n===!0&&this._emitConvUpdate())}},{key:"onConvGroupListSynced",value:function(e){_e(e)&&e.length!==0&&(m.l("".concat(this._n,".onConvGroupListSynced groupItem:"),e),this._fillConvGroupMap(e))}},{key:"getConvGroupListByID",value:function(e){var t,n=this;if(!se(e))return t=[],e.forEach(function(s){n._convGroupMap.has(s)&&t.push(n._convGroupMap.get(s))}),t}},{key:"_onConvNotFound",value:function(e,t){e.push({conversationID:t,code:F.CONV_NOT_FOUND,message:this._convM.getErrMsg(F.CONV_NOT_FOUND)})}},{key:"_onConvIDInvalid",value:function(e,t){e.push({conversationID:t,code:F.INVALID_CONV_ID,message:this._convM.getErrMsg(F.INVALID_CONV_ID)})}},{key:"_getFlagBit",value:function(e){for(var t=e.toString(2),n=t.length,s=n-1;0<=s;s--)if(t[s]==="1")return n-s-1}},{key:"_concatConvID",value:function(a){var t,n=a.type,s=a.to,r=a.groupID,a=a.userID;return n===1?H(a)?H(s)||(t="".concat(I.CONV_C2C).concat(s)):t="".concat(I.CONV_C2C).concat(a):n===2&&(t="".concat(I.CONV_GROUP).concat(r)),t}},{key:"_getMyUserID",value:function(){return this._convM.getMyUserID()}},{key:"_getLocalConv",value:function(e){return this._convM.getLocalConversation(e)}},{key:"_hasLocalConv",value:function(e){return this._convM.hasLocalConversation(e)}},{key:"_emitConvUpdate",value:function(){this._convM.emitConvUpdate(!0,!1)}},{key:"_emitConvGroupListUpdate",value:function(){this._convM.emitOEvt($.CONVERSATION_GROUP_LIST_UPDATED,q(this._convGroupMap.values()))}},{key:"_emitConvInGroupUpdate",value:function(e){var t={groupName:e,conversationList:[]},n=this._convM.getLocalConvList();t.conversationList=n.filter(function(s){return s.conversationGroupList.includes(e)}),this._convM.emitOEvt($.CONVERSATION_IN_GROUP_UPDATED,t)}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._convGroupMap.clear(),this._startIndex=0,this._pagingStatus=yo}}]),xu),Gy=(T(Br,St),Cf=z(Br),y(Br,[{key:"_initListeners",value:function(){var e=this.getIEmitInst();e.on(mt.A2KEY_AND_TINYID_UPDATED,this._init,this),e.on(mt.PROFILE_UPDATED,this._onProfileUpdated,this),e.on(mt.CLOUD_CONFIG,this._onCloudConfig,this)}},{key:"_init",value:function(){var e=this,t=(m.l("".concat(this._n,"._init")),this.get(13).getItem("conversationMap")),n=this.isIntl(),s=this.isUsingChatCore();if(t){for(var r=t.length,a=0;a<r;a++){var l=t[a];l&&(this._isNonExistentAccount(l.conversationID)||l.groupProfile&&nn(l.groupProfile.type))||this._convMap.set(l.conversationID,new Ur(t[a],n,s))}this.emitConvUpdate(!0,!1)}this.ready(function(){0<e._tmpGroupList.length&&(e.updateConvGroupProfile(e._tmpGroupList),e._tmpGroupList.length=0)}),this.syncConvList()}},{key:"_isNonExistentAccount",value:function(e){var t;return(t=e.startsWith(I.CONV_C2C)?e.replace(I.CONV_C2C,""):t)==="@TLS#ERROR"||t==="@TLS#NOT_FOUND"}},{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&this._msgListHandler.onCheckTimer(e)}},{key:"onMessageSent",value:function(e){this._onSendOrRcvMsg({conversationOptionsList:e.conversationOptionsList,isInstantMessage:!0})}},{key:"onNewMessage",value:function(e){this._onSendOrRcvMsg(e)}},{key:"_onSendOrRcvMsg",value:function(e){var t=this,n=e.conversationOptionsList,s=e.isInstantMessage,s=s===void 0||s,r=e.isUnreadC2CMessage,r=r!==void 0&&r,a=e.updateUnreadCount,a=a===void 0||a,l=e.isSyncingEnded,l=l!==void 0&&l;this._isReady?n.length!==0?(s===!0&&this._checkNewConv(n),this._updateLocalConvList({conversationOptionsList:n,isInstantMessage:s,isUnreadC2CMessage:r,isFromGetConversations:!1,updateUnreadCount:a}),s||(this._convIDFromUnreadDBMap=new Map([].concat(q(this._convIDFromUnreadDBMap),q(n.map(function(d){return[d.conversationID,1]})))),this._diffAndDeleteConv(),l&&this.emitIEvt(mt.C2C_UNREAD_HANDLE_COMPLETED)),0<n.filter(function(d){return!t._isConvNeedShow(d.conversationID)}).length||this.emitConvUpdate()):l&&this.emitIEvt(mt.C2C_UNREAD_HANDLE_COMPLETED):this.ready(function(){t._onSendOrRcvMsg(e)})}},{key:"updateConvGroupProfile",value:function(e){var t,n=this;_e(e)&&e.length===0||(this._convMap.size!==0?(t=!1,e.forEach(function(s){var r="".concat(I.CONV_GROUP).concat(s.groupID);n._convMap.has(r)&&(t=!0,(r=n._convMap.get(r)).groupProfile=JSON.parse(JSON.stringify(s)),r.lastMessage.lastSequence<s.nextMessageSeq&&(r.lastMessage.lastSequence=s.nextMessageSeq-1),r.subType||(r.subType=s.type))}),t&&this.emitConvUpdate(!0,!1)):this._tmpGroupList=e)}},{key:"onMessageRevoked",value:function(e,t){var n,s,r,a=this;e.length!==0&&(n=null,s=!1,r=[],e.forEach(function(l){(n=a._convMap.get(l.conversationID))&&(t&&n.reduceUnreadCount()&&(s=n.type!==I.CONV_TOPIC),n.type===I.CONV_TOPIC?r.push(l):n.isLastMessageRevoked({sequence:l.sequence,time:l.time})&&(n.setLastMessageRevoked(!0),n.setLastMessageRevoker(l.revoker),s=!0))}),this.get(10).onMessageRevoked(r),s&&this.emitConvUpdate(!0,!1))}},{key:"updateRevokerInfo",value:function(e){for(var t=new Set,n=0;n<e.length;n++){var s=e[n].revoker;t.add(s)}var r=q(t),a=this.get(4);return new Promise(function(l){a.getUserProfile({userIDList:r}).then(function(d){if(d=d.data,!_e(d)||d.length===0)return l(e);var h,g={},_=ye(d);try{for(_.s();!(h=_.n()).done;){var M=h.value,S=M.userID,D=M.nick,O=M.avatar;g[S]={nick:D,avatar:O}}}catch(B){_.e(B)}finally{_.f()}e.forEach(function(B){var U=B.revoker;g[U]&&(B.revokerInfo.nick=g[U].nick||"",B.revokerInfo.avatar=g[U].avatar||"")}),l(e)}).catch(function(){l(e)})})}},{key:"isLastMessageRevoked",value:function(e){var t=!1,n=e.conversationID,s=e.sequence,r=e.time,a=this._convMap.get(n);return a&&(t=a.type===I.CONV_TOPIC?this.get(10).isLastMessageRevoked({topicID:n.replace(I.CONV_GROUP,""),sequence:s}):a.isLastMessageRevoked({sequence:s,time:r})),m.l("".concat(this._n,".isLastMessageRevoked options:"),e,"ret:".concat(t)),t}},{key:"onMessageDeleted",value:function(e){var t=this;if(e.length!==0){var n=null;e.forEach(function(h){(n=t._msgListHandler.getLocalMsg(h.conversationID,h.ID))&&(n.isDeleted=!0),h!==n&&(h.isDeleted=!0)});for(var e=e[0].conversationID,s=this._msgListHandler.getLocalMsgList(e),r={},a=s.length-1;0<=a;a--)if(!s[a].isDeleted){r=s[a];break}var l,d=this._convMap.get(e);d&&(l=!1,d.lastMessage.lastSequence===r.sequence&&d.lastMessage.lastTime===r.time||(se(r)&&(r=void 0),d.updateLastMessage(r),d.type!==I.CONV_TOPIC&&(l=!0),m.l("".concat(this._n,".onMessageDeleted. update convID:").concat(e," with lastMessage:"),d.lastMessage)),e.startsWith(I.CONV_C2C)&&this.updateUnreadCount(e),l&&this.emitConvUpdate(!0,!1))}}},{key:"onMessageModified",value:function(e){var t="".concat(this._n,".onMessageModified"),_=e.conversationType,n=e.from,s=e.to,r=e.time,a=e.sequence,l=e.elements,d=e.cloudCustomData,h=e.messageVersion,M=this.getMyUserID(),g="".concat(_).concat(s),M=(s===M&&_===I.CONV_C2C&&(g="".concat(_).concat(n)),this._msgListHandler.onMsgModified(g,e)),_=M.isUpdated,M=M.message,S=(_===!0&&this.emitOEvt($.MESSAGE_MODIFIED,[M]),this._isTopicConv(g));return M===null?m.l("".concat(t," message is null! options:"),e):m.l("".concat(t," isUpdated:").concat(_," isTopicMessage:").concat(S," from:").concat(n," to:").concat(s," sequence:").concat(M.sequence," time:").concat(M.time)),S?this.get(10).onMessageModified(e):!(_=this._convMap.get(g))||(n=_.lastMessage)&&n.lastTime===r&&n.lastSequence===a&&n.version!==h&&(m.l("".concat(t," convID:").concat(g," lastMessage updated")),n.type=l[0].type,n.payload=l[0].content,n.messageForShow=Lr(n.type,n.payload,this.isIntl()),n.cloudCustomData=d,n.version=h,this.emitConvUpdate(!0,!1)),M}},{key:"onNewGroupAtTips",value:function(n){var t=this,n=n.dataList,s=null;n.forEach(function(r){r.groupAtTips?s=r.groupAtTips:r.elements?s=c(c({},r.elements),{},{sync:!0}):r.groupAtType&&(s=c(c({},r),{},{sync:!0})),s.__random=r.random,s.__sequence=r.clientSequence,t._tmpGroupAtTipsList.push(s)}),m.l("".concat(this._n,".onNewGroupAtTips isReady:").concat(this._isReady),this._tmpGroupAtTipsList),this._isReady&&this._handleGroupAtTipsList()}},{key:"_handleGroupAtTipsList",value:function(){var e,t=this;this._tmpGroupAtTipsList.length!==0&&(e=!1,this._tmpGroupAtTipsList.forEach(function(n){var s=n.groupID,r=n.from,a=n.topicID,a=a===void 0?void 0:a,l=n.sync,l=l!==void 0&&l;r!==t.getMyUserID()&&(H(a)?(r=t._convMap.get("".concat(I.CONV_GROUP).concat(s)))&&(r.updateGroupAtInfoList(n),e=!0):((s=t._convMap.get("".concat(I.CONV_GROUP).concat(a)))&&(s.updateGroupAtInfoList(n),t.get(10).onAtInfoUpdated({topicID:a,groupAtInfoList:s.groupAtInfoList})),se(s)&&l&&(t.updateTopicConversation([{conversationID:"".concat(I.CONV_GROUP).concat(a),type:I.CONV_TOPIC}]),t._convMap.get("".concat(I.CONV_GROUP).concat(a)).updateGroupAtInfoList(n))))}),e&&this.emitConvUpdate(!0,!1),this._tmpGroupAtTipsList.length=0)}},{key:"_checkNewConv",value:function(e){var t=this,n=[],s=[];e.forEach(function(r){t._convMap.has(r.conversationID)||(r.type===I.CONV_C2C?n.push(r.conversationID.replace(I.CONV_C2C,"")):r.type===I.CONV_GROUP&&s.push(r.conversationID.replace(I.CONV_GROUP,"")))}),0<n.length&&(this._onNewC2CConv(n),n=null),0<s.length&&(this._onNewGroupConv(s),s=null)}},{key:"_onNewC2CConv",value:function(e){var t=this.get(6);return Promise.all([t.getRemotePeerReadTime(e),this._msgRemindHandler.getC2CMsgRemindType(e),this._convGroupHandler.searchConvGroupAndMark(e,1)])}},{key:"_onNewGroupConv",value:function(e){var t=this.get(7);return t?Promise.all([t.getMsgRemindType(e),this._convGroupHandler.searchConvGroupAndMark(e,2)]):Promise.resolve()}},{key:"_setStorageConvList",value:function(){var e=0<arguments.length&&arguments[0]!==void 0&&arguments[0],t=this.getLocalConvList().filter(function(n){return n.type===I.CONV_C2C||n.type===I.CONV_GROUP&&n.lastMessage.type!==I.MSG_GRP_TIP}).slice(0,20).map(function(n){return{conversationID:n.conversationID,type:n.type,subType:n.subType,lastMessage:n.lastMessage,groupProfile:n.groupProfile,userProfile:n.userProfile}});this.get(13).setItem("conversationMap",t,e)}},{key:"emitConvUpdate",value:function(){var e=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],t=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],n=this.getLocalConvList();!t||(t=this.get(7))&&t.updateGroupLastMessage(n),e&&(this.get(12).isPartialUpdatedConvs()?(this._diffConvMap(this._convMapForDiff,this._convMap),0<this._partialUpdatedConvMap.size&&(this.emitOEvt($.CONVERSATION_LIST_UPDATED),this.onTotalUnreadCountUpdate(),this._convMapForDiff.clear(),this._convMapForDiff=xc(this._convMap,!0)),this._convMapForDiff.size===0&&(this._convMapForDiff=xc(this._convMap,!0))):(this.emitOEvt($.CONVERSATION_LIST_UPDATED),this.onTotalUnreadCountUpdate()))}},{key:"_diffConvMap",value:function(e,t){var n,s=ye(t);try{for(s.s();!(n=s.n()).done;){var r=te(n.value,2),a=r[0],l=r[1];e.has(a)&&JSON.stringify(l)===e.get(a)||this._partialUpdatedConvMap.set(a,l)}}catch(d){s.e(d)}finally{s.f()}}},{key:"getPartialUpdatedConvs",value:function(){var e=q(xc(this._partialUpdatedConvMap,!1).values());return this._partialUpdatedConvMap.clear(),e}},{key:"getLocalConvList",value:function(){var e=this;return q(this._convMap.values()).filter(function(t){return e._isConvNeedShow(t.conversationID)})}},{key:"getLocalConversation",value:function(e){return this._convMap.get(e)}},{key:"hasLocalConversation",value:function(e){return this._convMap.has(e)}},{key:"getLocalOldestMessage",value:function(e){return this._msgListHandler.getLocalOldestMsg(e)}},{key:"syncConvList",value:function(){var e=this,t=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],n="syncConvList",s=new K(n);return this._pagingStatus===yo&&this._convMap.clear(),this._pagingGetConvList(t).then(function(r){var a=Qp(e._pagingGetCostList),l=Zp(e._pagingGetCostList),l=(e._pagingGetCostList.length=0,e._pagingStatus=Or,e._diffAndDeleteConv(),e.emitConvUpdate(!0,!1),e._setStorageConvList(),e._handleC2CPeerReadTime(),e.emitIEvt(mt.CONV_SYNC_COMPLETED),"count:".concat(e._convMap.size," sum:").concat(l," avg:").concat(a));return m.l("".concat(e._n,".").concat(n,". ").concat(l)),s.setMessage(l).end(),r}).catch(function(r){return e._pagingStatus=Hs,s.setMessage(e._pagingTs).setError(r).end(),A(r)})}},{key:"_diffAndDeleteConv",value:function(){var e,t=this;this._isSyncCompleted()&&(e=[],this._convMap.forEach(function(n,s){!t._pagingConvIDMap.has(s)&&t._convIDFromUnreadDBMap.has(s)&&(t._convMap.delete(s),e.push(s))}),m.l("".concat(this._n,"._diffAndDeleteConv list:").concat(e)),e=null)}},{key:"_pagingGetConvList",value:function(){var e=this,t=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],n="".concat(this._n,"._pagingGetConvList"),s=(m.l("".concat(n," incrementalPullFlag:").concat(t," ts:").concat(this._pagingTs," startIdx:").concat(this._pagingStartIdx)+" pinnedTs:".concat(this._pagingPinnedTs," pinnedStartIdx:").concat(this._pagingPinnedStartIdx)),Date.now());return this._pagingStatus=uf,this.req({P:E.PAGING_GET_CONV_LIST,data:{fromAccount:this.getMyUserID(),timeStamp:t?this._pagingTs:0,startIndex:t?this._pagingStartIdx:0,pinnedTimeStamp:t?this._pagingPinnedTs:0,pinnedStartIndex:t?this._pagingPinnedStartIdx:0,orderType:1}}).then(function(M){var M=M.data,a=M.completeFlag,l=M.conversations,l=l===void 0?[]:l,d=M.timeStamp,h=M.startIndex,g=M.pinnedTimeStamp,_=M.pinnedStartIndex,M=M.groupItem;if(e._pagingGetCostList.push(Kt(s,!1)),m.l("".concat(n," ok. completeFlag:").concat(a," count:").concat(l.length," cost:").concat(Kt(s))),e._convGroupHandler.onConvGroupListSynced(M),0<l.length&&(M=e._getConvOptions(l),e._pagingConvIDMap=new Map([].concat(q(e._pagingConvIDMap),q(M.map(function(S){return[S.conversationID,1]})))),e._updateLocalConvList({conversationOptionsList:M,isFromGetConversations:!0,updateUnreadCount:!0}),e.isLoggedIn()&&e.emitConvUpdate()),!e._isReady){if(!e.isLoggedIn())return Pe();e.triggerReady()}return e._pagingTs=d,e._pagingStartIdx=h,e._pagingPinnedTs=g,e._pagingPinnedStartIdx=_,a!==1?e._pagingGetConvList():(e._handleGroupAtTipsList(),e._convGroupHandler.getRemoteConvGroupList(),Pe())}).catch(function(r){throw e.isLoggedIn()&&(e._isReady||(m.w("".concat(n," failed. error:"),r),e.triggerReady())),r})}},{key:"_updateLocalConvList",value:function(s){var t=s.isFromGetConversations,n=Date.now(),s=this._getTmpConvListMapping(s).newConvList;this._convMap=new Map(this._sortConvList(q(this._convMap))),t||this._updateUserOrGroupProfile(s),m.l("".concat(this._n,"._updateLocalConvList cost:").concat(Kt(n)))}},{key:"_getTmpConvListMapping",value:function(e){for(var t=e.conversationOptionsList,n=e.isFromGetConversations,s=e.isInstantMessage,r=e.isUnreadC2CMessage,a=r!==void 0&&r,l=e.updateUnreadCount,d=[],h=[],g=this.get(7),_=this.get(8),M=this.isIntl(),S=this.isUsingChatCore(),D=0,O=t.length;D<O;D++){var B=new Ur(t[D],M,S),U=B.conversationID,de=B.type;if(!this._isNonExistentAccount(U)){if(this._convMap.has(U)){var J=this._convMap.get(U);if(n&&de!==I.CONV_TOPIC){this._convMap.set(U,B),de===I.CONV_C2C?B.unreadCount=J.unreadCount:de===I.CONV_GROUP&&(B.groupProfile=JSON.parse(JSON.stringify(J.groupProfile)));continue}var ke=["unreadCount","allowType","adminForbidType","payload"],Ae=(s===!1&&ke.push("lastMessage"),typeof s=="boolean"&&ke.push("isPinned"),t[D].lastMessage),Be=!H(Ae);Be||t[D].type===I.CONV_TOPIC||this._onLastMsgNotExist(t[D]),H(s)&&Be&&J.lastMessage.payload===null&&(J.lastMessage.payload=Ae.payload),se(J.lastMessage.revoker)||(J.lastMessage.revoker=null),zn(J,B,ke,[null,void 0,"",0,NaN]),l===!0&&J.updateUnreadCount({nextUnreadCount:B.unreadCount,isFromGetConversations:n,isUnreadC2CMessage:a}),s&&Be&&(Ae.payload&&(J.lastMessage.payload=Ae.payload),J.type===I.CONV_GROUP&&(J.lastMessage.nameCard=Ae.nameCard,J.lastMessage.nick=Ae.nick)),Be&&J.lastMessage.cloudCustomData!==Ae.cloudCustomData&&(J.lastMessage.cloudCustomData=Ae.cloudCustomData||"")}else de===I.CONV_GROUP&&g?(ke=B.groupProfile.groupID,(Be=g.getLocalGroupProfile(ke))&&(B.groupProfile=Be,l===!0&&B.updateUnreadCount({nextUnreadCount:0}))):de===I.CONV_C2C&&(J=U.replace(I.CONV_C2C,""),_&&_.isMyFriend(J)&&(B.remark=_.getFriendRemark(J))),d.push(B),this._convMap.set(U,B);this._convMap.get(U).type===I.CONV_TOPIC&&h.push(this._convMap.get(U))}}for(var We=this.get(10),ot=0,Lt=h.length;ot<Lt;ot++){var gt=h[ot],vt=gt.conversationID,gt=gt.groupAtInfoList;se(gt)||We.onAtInfoUpdated({topicID:vt.replace(I.CONV_GROUP,""),groupAtInfoList:gt})}return{newConvList:d}}},{key:"_onLastMsgNotExist",value:function(e){new K("lastMsgNotExist").setMessage(JSON.stringify(e)).end()}},{key:"_sortConvList",value:function(e){var t=[],n=[],s=[],r=[];return e.forEach(function(a){(a[1].isPinned===!0?se(a[1].lastMessage.lastTime)?n:t:se(a[1].lastMessage.lastTime)?r:s).push(a)}),t.sort(function(a,l){return l[1].lastMessage.lastTime-a[1].lastMessage.lastTime}).concat(n).concat(s.sort(function(a,l){return l[1].lastMessage.lastTime-a[1].lastMessage.lastTime})).concat(r)}},{key:"_sortConvListAndEmitEvent",value:function(){this._convMap=new Map(this._sortConvList(q(this._convMap))),this.emitConvUpdate(!0,!1)}},{key:"_updateUserOrGroupProfile",value:function(e){var t,n,s,r,a=this;e.length!==0&&(t=[],n=[],s=this.get(4),r=this.get(7),e.forEach(function(l){var d;l.type===I.CONV_C2C?t.push(l.toAccount):l.type===I.CONV_GROUP&&(d=l.toAccount,r.hasLocalGroup(d)?l.groupProfile=r.getLocalGroupProfile(d):n.push(d))}),m.l("".concat(this._n,"._updateUserOrGroupProfile userIDList:").concat(t," groupIDList:").concat(n)),0<t.length&&s.getUserProfile({userIDList:t}).then(function(l){l=l.data,_e(l)?l.forEach(function(d){a._doUpdateUserProfile("".concat(I.CONV_C2C).concat(d.userID),d)}):a._doUpdateUserProfile("".concat(I.CONV_C2C).concat(l.userID),l)}),0<n.length&&r.getGroupProfileAdvance({groupIDList:n,responseFilter:{groupBaseInfoFilter:["Type","Name","FaceUrl"]}}).then(function(d){var d=d.data.successGroupList,h=!1;d.forEach(function(g){var _="".concat(I.CONV_GROUP).concat(g.groupID);a._convMap.has(_)&&(_=a._convMap.get(_),zn(_.groupProfile,g,[],[null,void 0,"",0,NaN]),!_.subType&&g.type&&(_.subType=g.type),h=!0)}),h&&a.emitConvUpdate()}))}},{key:"_doUpdateUserProfile",value:function(e,t){this.hasLocalConversation(e)&&(this.getLocalConversation(e).userProfile=t,this.emitConvUpdate())}},{key:"_getConvOptions",value:function(r){var t=this,n=[],r=r.filter(function(d){var l=d.type,d=d.userID;return l===1&&!t._isNonExistentAccount(d)||l===2}),s=this.getMyUserID(),r=r.map(function(a){var l;return H(a.lastMsg)&&(a.lastMsg={elements:[]}),a.type===1?(l={userID:a.userID,nick:a.peerNick,avatar:a.peerAvatar},n.push(l),{conversationID:"".concat(I.CONV_C2C).concat(a.userID),type:I.CONV_C2C,lastMessage:{lastTime:a.time,lastSequence:a.sequence,fromAccount:a.lastC2CMsgFromAccount,type:a.lastMsg.elements[0]?a.lastMsg.elements[0].type:null,payload:a.lastMsg.elements[0]?t._amendLayersOverLimitProp(a.lastMsg.elements[0].content):null,cloudCustomData:a.lastMsg.cloudCustomData||"",isRevoked:a.lastMessageFlag===8,onlineOnlyFlag:!1,nick:"",nameCard:"",version:0,isPeerRead:a.lastC2CMsgFromAccount===s&&a.time<=a.c2cPeerReadTime,revoker:a.lastMsg.revokerInfo?a.lastMsg.revokerInfo.revoker:null},unreadCount:0,userProfile:new wr(l),peerReadTime:a.c2cPeerReadTime,isPinned:a.isPinned===1,customData:a.customMark||"",markList:ia(a.standardMark),conversationGroupList:t._convGroupHandler.getConvGroupListByID(a.contactGroupId),remark:a.friendRemark||"",messageRemindType:t._transMsgRemindType(a.messageRemindType)}):{conversationID:"".concat(I.CONV_GROUP).concat(a.groupID),type:I.CONV_GROUP,lastMessage:c(c({lastTime:a.time,lastSequence:a.sequence,fromAccount:a.msgGroupFromAccount},t._patchTypeAndPayload(a)),{},{cloudCustomData:a.lastMsg.cloudCustomData||"",isRevoked:a.lastMessageFlag===2,onlineOnlyFlag:!1,nick:a.senderNick||"",nameCard:a.senderNameCard||"",revoker:a.lastMsg.revokerInfo?a.lastMsg.revokerInfo.revoker:null}),groupProfile:new co({groupID:a.groupID,name:a.groupNick,avatar:a.groupImage,type:a.groupType,nextMessageSeq:a.nextMessageSeq}),unreadCount:t._computeGroupUnreadCount(a),peerReadTime:0,isPinned:a.isPinned===1,version:0,customData:a.customMark||"",markList:ia(a.standardMark),conversationGroupList:t._convGroupHandler.getConvGroupListByID(a.contactGroupId),messageRemindType:t._transMsgRemindType(a.messageRemindType)}});return 0<n.length&&this.get(4).onConvProfileUpdated(n),r}},{key:"_transMsgRemindType",value:function(e){var t="";return e===0?t=I.MSG_REMIND_ACPT_AND_NOTE:e===1?t=I.MSG_REMIND_DISCARD:e===2?t=I.MSG_REMIND_ACPT_NOT_NOTE:e===3&&(t=I.NOT_RECEIVE_OFFLINE_PUSH_EXCEPT_AT),t}},{key:"_computeGroupUnreadCount",value:function(t){var n=t.unreadCount,t=t.noUnreadCount,n=(n===void 0?0:n)-(t===void 0?0:t);return 0<n?n:0}},{key:"_patchTypeAndPayload",value:function(s){var s=s.lastMsg,t=s.event,n=s.elements,n=n===void 0?[]:n,s=s.groupTips,s=s===void 0?{}:s;return H(t===void 0?void 0:t)||se(s)?{type:n[0]?n[0].type:null,payload:n[0]?this._amendLayersOverLimitProp(n[0].content):null}:((t=new Bt(s)).setElement({type:I.MSG_GRP_TIP,content:c(c({},s.elements),{},{groupProfile:s.groupProfile})}),n=JSON.parse(JSON.stringify(t.payload)),t=null,{type:I.MSG_GRP_TIP,payload:n})}},{key:"_amendLayersOverLimitProp",value:function(e){var t=e.layersOverLimit;return t===0?e.layersOverLimit=!1:t===1&&(e.layersOverLimit=!0),e}},{key:"getLocalMessageList",value:function(e){return this._msgListHandler.getLocalMsgList(e)}},{key:"deleteLocalMessage",value:function(e){e instanceof Bt&&this._msgListHandler.remove(e)}},{key:"onConvDeleted",value:function(e){_e(e)&&(e=e.map(function(r){var n=r.type,s=r.userID,r=r.groupID;return n===1?"".concat(I.CONV_C2C).concat(s):n===2?"".concat(I.CONV_GROUP).concat(r):void 0}),m.l("".concat(this._n,".onConvDeleted convIDList:").concat(e)),this.deleteLocalConvList(e))}},{key:"onConvPinnedStatus",value:function(e,t){var n,s=this;_e(e)&&(n=!1,e.forEach(function(h){var a,l=h.type,d=h.userID,h=h.groupID;l===1?a=s.getLocalConversation("".concat(I.CONV_C2C).concat(d)):l===2&&(a=s.getLocalConversation("".concat(I.CONV_GROUP).concat(h))),a&&(m.l("".concat(s._n,".onConvPinnedStatus convID:").concat(a.conversationID," localPinned:").concat(a.isPinned," remotePinned:").concat(t)),t?a.isPinned||(a.isPinned=!0,n=!0):a.isPinned&&(a.isPinned=!1,n=!0))}),n&&this._sortConvListAndEmitEvent())}},{key:"getMessageList",value:function(r){var t=this,n=r.conversationID,s=r.nextReqMessageID,r=r.count,a="".concat(this._n,".getMessageList"),h=this.getLocalConversation(n),l="";if(h&&h.groupProfile&&(l=h.groupProfile.type),nn(l))return m.l("".concat(a," not available in ").concat(l,". convID:").concat(n)),Pe({messageList:[],nextReqMessageID:"",isCompleted:!0});(H(r)||15<r)&&(r=15),s||this._isMeInCommunity(n)||this.clearMemMsg(n);var d=this._computeRemainingCount({conversationID:n,nextReqMessageID:s}),h=this._completedMap.has(n);return m.l("".concat(a," convID:").concat(n," isEverCleared:").concat(this._isEverCleared(n)," nextReqMessageID:").concat(s)+" remainingCount:".concat(d," count:").concat(r," isCompleted:").concat(h)),this._needGetHistory({conversationID:n,remainingCount:d,count:r})?this.getHistoryMessages({conversationID:n,nextReqMessageID:s,count:20}).then(function(M){var _=M.nextReqID,B=M.storedMessageList,U=M.assembledMessageList,M=M.isPullingCompleted,S=t._completedMap.has(n),D=B,O=(0<d&&(D=t._msgListHandler.getLocalMsgList(n).slice(0,B.length+d)),{nextReqMessageID:void 0,messageList:void 0,isCompleted:void 0}),B=(t._isEverCleared(n)?(O.nextReqMessageID=_,O.messageList=U,O.isCompleted=M):(O.nextReqMessageID=S?"":_,O.messageList=D,O.isCompleted=S),O.messageList.filter(function(de){return de.isRevoked})||[]),U=O.messageList.map(function(de){return de.sequence});return m.l("".concat(a," ret.nextReqMessageID:").concat(O.nextReqMessageID," ret.isCompleted:").concat(O.isCompleted," sequenceList:"),U),_e(B)&&B.length!==0?t.updateRevokerInfo(B).then(function(de){return de.forEach(function(J){var ke=J.revokerInfo;O.messageList=O.messageList.map(function(Ae){return Ae.ID===J.ID&&ke&&(Ae.revokeReason=ke.reason||"",Ae.revokerInfo={userID:ke.revoker||Ae.revoker,nick:ke.nick,avatar:ke.avatar}),Ae})}),me(O)}):me(O)}):(this.modifyMessageList(n),l=this._getMsgListFromMem({conversationID:n,nextReqMessageID:s,count:r}),Pe(l))}},{key:"_isEverCleared",value:function(e){return this._everClearedMap.has(e)}},{key:"_getMsgListFromMem",value:function(g){var t=g.conversationID,n=g.nextReqMessageID,g=g.count,s="".concat(this._n,"._getMsgListFromMem"),r=this._msgListHandler.getLocalMsgList(t),a=r.length,l=Zt(t),d=0,h={isCompleted:!1,nextReqMessageID:"",messageList:[]},g=(n?(d=l?r.findIndex(function(_){return _.ID===n}):r.findIndex(function(_){return _.sequence+""===n}))>g?(h.messageList=r.slice(d-g,d),h.nextReqMessageID=l?r[d-g].ID:r[d-g].sequence+""):(h.messageList=r.slice(0,d),h.isCompleted=!0):g<a?(h.messageList=r.slice(d=a-g,a),h.nextReqMessageID=l?r[d].ID:r[d].sequence+""):(h.messageList=r.slice(0,a),h.isCompleted=!0),h.messageList.map(function(_){return _.sequence}));return m.l("".concat(s," convID:").concat(t)+" ret.nextReqMessageID:".concat(h.nextReqMessageID," ret.isCompleted:").concat(h.isCompleted," sequenceList:").concat(g)),h}},{key:"getMessageListHopping",value:function(d){var t,n,s=d.conversationID,r=d.sequence,a=d.time,l=d.count,d=d.direction,d=d===void 0?0:d;return(H(l)||15<l)&&(l=15),s.startsWith(I.CONV_C2C)?(t=this.get(6),n=s.replace(I.CONV_C2C,""),t.getRoamingMessagesHopping({peerAccount:n,time:a,count:l,direction:d})):s.startsWith(I.CONV_GROUP)?(t=this.get(7),n=s.replace(I.CONV_GROUP,""),t.getRoamingMessagesHopping({groupID:n,sequence:r,count:l,direction:d})):void 0}},{key:"_computeRemainingCount",value:function(s){var t=s.conversationID,n=s.nextReqMessageID,s=this._msgListHandler.getLocalMsgList(t),r=s.length;return m.l("".concat(this._n,"._computeRemainingCount convID:").concat(t," nextReqMessageID:").concat(n," length:").concat(r)),n?(r=0,Zt(t)?r=s.findIndex(function(a){return a.ID===n}):ln(t)&&(r=n.indexOf("-")!==-1?s.findIndex(function(a){return a.ID===n}):s.findIndex(function(a){return a.sequence+""===n})),r=r===-1?0:r):r}},{key:"_needGetHistory",value:function(s){var t=s.conversationID,n=s.remainingCount,s=s.count,r=this.getLocalConversation(t),a="";return r&&r.groupProfile&&(a=r.groupProfile.type),Sr(t)||nn(a)?!1:this._isEverCleared(t)?!0:(r=n<=s&&!this._completedMap.has(t),m.l("".concat(this._n,"._needGetHistory convID:").concat(t," ret:").concat(r)),r)}},{key:"_isTopicConv",value:function(e){return e=e.replace(I.CONV_GROUP,""),Vt(e)}},{key:"getHistoryMessages",value:function(n){var t=n.conversationID,l=n.count,n=n.nextReqMessageID;if(t===I.CONV_SYSTEM)return Pe();var s,r,a=15,l=(20<l&&(a=20),null);if(Zt(t))return g=0,s="",r=!1,h=this._roamingMsgKeyAndTimeMap.has(t),n&&(r=!0,h?(g=this._roamingMsgKeyAndTimeMap.get(t).lastMessageTime,s=this._roamingMsgKeyAndTimeMap.get(t).messageKey):(d=this._msgListHandler.findMessage(n))&&(g=d.time,m.l("".concat(this._n,".getHistoryMessages convID:").concat(t," isRelayInfoExisted:").concat(h," lastMessageTime:").concat(g)))),(l=this.get(6)).getRoamingMessage({conversationID:t,peerAccount:t.replace(I.CONV_C2C,""),count:a,lastMessageTime:r?g:0,messageKey:r?s:""});if(ln(t)){if(!(l=this.get(7)))return A({code:F.NO_MODULE});var d=t.replace(I.CONV_GROUP,""),h=null,g=(this._convMap.has(t)&&!Vt(d)&&(h=this._convMap.get(t).lastMessage),0);return n?g=Number(n):h&&(g=h.lastSequence),l.getRoamingMessage({conversationID:t,groupID:d,count:a,sequence:g})}return Pe()}},{key:"patchConvLastMessage",value:function(e){var t,n,s=1<arguments.length&&arguments[1]!==void 0&&arguments[1],r=this.getLocalConversation(e);r&&(t=(n=r.lastMessage).messageForShow,n=n.payload,!(se(t)||se(n)||s)||(t=this._msgListHandler.getLocalMsgList(e)).length!==0&&(n=t[t.length-1],m.l("".concat(this._n,".patchConvLastMessage bForceUpdate:").concat(s," convID:").concat(e," payload:"),n.payload),r.updateLastMessage(n)))}},{key:"onRoamingMessage",value:function(){for(var e,t,n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],h=1<arguments.length?arguments[1]:void 0,s=!(2<arguments.length&&arguments[2]!==void 0)||arguments[2],r=3<arguments.length?arguments[3]:void 0,a=h.startsWith(I.CONV_C2C)?I.CONV_C2C:I.CONV_GROUP,l=null,d=[],h=[],U=0,de=n.length,g=a===I.CONV_GROUP,_=this.getFileDownloadProxy(),M=this.getDowloadFileAuthKey(),S=_e(r),D=this.get(17).getFileDNList(),O=function(){g?--U:++U},B=function(){return g?de<=U:U<de},U=g?n.length-1:0,de=g?0:n.length;B();O())n[U].isPlaceMessage!==1&&((l=new Bt(n[U])).to=n[U].to,a!==I.CONV_GROUP||H(n[U].topicID)||(l.to=n[U].topicID),l.isSystemMessage=!!n[U].isSystemMessage,l.conversationType=a,e=n[U].event===4?{type:I.MSG_GRP_TIP,content:c(c({},n[U].elements),{},{groupProfile:n[U].groupProfile})}:n[U].elements,g||l.setNickAndAvatar({nick:n[U].nick,avatar:n[U].avatar}),se(e)?((t=new K("emptyMessageBody")).setMessage("from:".concat(l.from," to:").concat(l.to," sequence:").concat(l.sequence," event:").concat(n[U].event)),t.setLevel("warning").end()):(l.setElement(e,_,M,D),l.reInitialize(this.getMyUserID()),d.push(l),S&&r.push(l)));return O=B=null,s?(this._msgListHandler.unshift(d,h),d=null,h):(h=null,d)}},{key:"findMessage",value:function(e){return this._msgListHandler.findMessage(e)}},{key:"_isMeInCommunity",value:function(e){var t=!0;return this._isTopicConv(e)&&(e=wt(e.replace(I.CONV_GROUP,"")),this.get(7).hasLocalGroup(e)||(t=!1,m.l("".concat(this._n,"._isMeInCommunity groupID:").concat(e," ret:").concat(t)))),t}},{key:"deleteTopicRoamingInfo",value:function(e){var t=this;rn({groupID:e})&&this._msgListHandler.getTopicConvIDList(e).forEach(function(n){t.clearMemMsg(n)})}},{key:"deleteGroupRoamingInfo",value:function(e){e="".concat(I.CONV_GROUP).concat(e),0<this._msgListHandler.getLocalMsgList(e).length&&this.clearMemMsg(e)}},{key:"setMessageRead",value:function(s){var t=s.conversationID,n=this.getLocalConversation(t),s="".concat(this._n,".setMessageRead");if(m.l("".concat(s," convID:").concat(t," unreadCount:").concat(n?n.unreadCount:0)),!n||(n.type!==I.CONV_GROUP&&n.type!==I.CONV_TOPIC||se(n.groupAtInfoList)||this.deleteGroupAtTips(t),n.unreadCount===0))return Pe();var r=this._msgListHandler.getLocalLastMsg(t),a=n.lastMessage.lastTime,l=this._msgListHandler.getLocalMaxTime(t),l=(a<l&&(m.l("".concat(s," update lastMessageTime from ").concat(a," to ").concat(l)),a=l),this._msgListHandler.getLocalMaxSeq(t)),d=n.lastMessage.lastSequence,h=(d<l&&(m.l("".concat(s," update lastMessageSeq from ").concat(d," to ").concat(l)),d=l),n.type===I.CONV_TOPIC&&H(r)&&(s=this.get(10),r=wt(l=t.replace(I.CONV_GROUP,"")),(s=s.getLocalTopic(r,l))&&(d=s.nextMessageSeq-1)),null);switch(n.type){case I.CONV_C2C:return(h=this.get(6))?h.setMessageRead({conversationID:t,lastMessageTime:a}):A({code:F.NO_MODULE});case I.CONV_GROUP:case I.CONV_TOPIC:return(h=this.get(7))?h.setMessageRead({conversationID:t,lastMessageSeq:d}):A({code:F.NO_MODULE});case I.CONV_SYSTEM:return n.unreadCount=0,this.emitConvUpdate(!0,!1),Pe();default:return Pe()}}},{key:"setAllMessageRead",value:function(){var e=this,t=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},n="setAllMessageRead",s="".concat(this._n,".").concat(n),r=(t.scope||(t.scope=I.READ_ALL_MSG),m.l("".concat(s," options:"),t),this._createSetAllMessageReadPack(t));if(r.readAllC2CMessage===0&&r.groupMessageReadInfoList.length===0)return Pe();var a=new K(n);return this.req({P:E.SET_ALL_MSG_READ,data:r}).then(function(l){return l=l.data,l=e._handleAllMsgRead(l),a.setMessage("scope:".concat(t.scope," failureGroups:").concat(JSON.stringify(l))).end(),Pe()}).catch(function(l){return a.setError(l).end(),m.w("".concat(s," failed. error:"),l),A({code:l&&l.code?l.code:F.MSG_UNREAD_ALL_FAIL,message:l&&l.message?l.message:void 0})})}},{key:"setConvCustomData",value:function(e){return this._convGroupHandler.setConvCustomData(e)}},{key:"markConv",value:function(e){return this._convGroupHandler.markConv(e)}},{key:"getConvGroupList",value:function(){return this._convGroupHandler.getLocalConvGroupList()}},{key:"createConvGroup",value:function(e){return this._convGroupHandler.createConvGroup(e)}},{key:"deleteConvGroup",value:function(e){return this._convGroupHandler.deleteConvGroup(e)}},{key:"renameConvGroup",value:function(e){return this._convGroupHandler.renameConvGroup(e)}},{key:"addConvsToGroup",value:function(e){return this._convGroupHandler.addConvsToGroup(e)}},{key:"deleteConvsFromGroup",value:function(e){return this._convGroupHandler.deleteConvsFromGroup(e)}},{key:"onConvMarkUpdated",value:function(e){this._convGroupHandler.onConvMarkUpdated(e)}},{key:"onConvGroupCreated",value:function(e){this._convGroupHandler.onConvGroupCreated(e)}},{key:"onConvGroupDeleted",value:function(e){this._convGroupHandler.onConvGroupDeleted(e)}},{key:"onConvGroupNameUpdated",value:function(e){this._convGroupHandler.onConvGroupNameUpdated(e)}},{key:"onConvInGroupUpdated",value:function(e){this._convGroupHandler.onConvInGroupUpdated(e)}},{key:"onConvAddedToOrDeletedFromGroup",value:function(e){this._convGroupHandler.onConvAddedToOrDeletedFromGroup(e)}},{key:"_getConvLastMessageSeq",value:function(n){var t=this._msgListHandler.getLocalLastMsg(n.conversationID),n=n.lastMessage.lastSequence;return n=t&&n<t.sequence?t.sequence:n}},{key:"_getConvLastMessageTime",value:function(n){var t=this._msgListHandler.getLocalLastMsg(n.conversationID),n=n.lastMessage.lastTime;return n=t&&n<t.time?t.time:n}},{key:"_createSetAllMessageReadPack",value:function(e){var t,n={readAllC2CMessage:0,groupMessageReadInfoList:[]},s=e.scope,r=ye(this._convMap);try{for(r.s();!(t=r.n()).done;){var a,l=te(t.value,2)[1];if(0<l.unreadCount)if(l.type===I.CONV_C2C&&n.readAllC2CMessage===0){if(s===I.READ_ALL_MSG)n.readAllC2CMessage=1;else if(s===I.READ_ALL_C2C_MSG){n.readAllC2CMessage=1;break}}else l.type!==I.CONV_GROUP||s!==I.READ_ALL_GROUP_MSG&&s!==I.READ_ALL_MSG||(a=this._getConvLastMessageSeq(l),n.groupMessageReadInfoList.push({groupID:l.groupProfile.groupID,messageSequence:a}))}}catch(d){r.e(d)}finally{r.f()}return n}},{key:"onPushedAllMessageRead",value:function(e){this._handleAllMsgRead(e)}},{key:"_handleAllMsgRead",value:function(t){var n=t.groupMessageReadInfoList,t=t.readAllC2CMessage,n=this._parseGroupReadInfo(n);return 1<=this._updateAllConvUnreadCount({readAllC2CMessage:t})&&this.emitConvUpdate(!0,!1),n}},{key:"_parseGroupReadInfo",value:function(e){var t=[];if(e&&e.length)for(var n=0,s=e.length;n<s;n++){var d=e[n],r=d.groupID,a=d.sequence,l=d.retCode,d=d.lastMessageSeq;H(l)?this._remoteGroupReadSeqMap.set(r,d):(this._remoteGroupReadSeqMap.set(r,a),l!==0&&t.push("".concat(r,"-").concat(a,"-").concat(l)))}return t}},{key:"_updateAllConvUnreadCount",value:function(e){var t,n=e.readAllC2CMessage,s=0,r=ye(this._convMap);try{for(r.s();!(t=r.n()).done;){var a,l,d,h,g=te(t.value,2),_=g[0],M=g[1];1<=M.unreadCount&&(n===1&&M.type===I.CONV_C2C?(a=this._getConvLastMessageTime(M),this.updateIsReadAfterReadReport({conversationID:_,lastMessageTime:a})):M.type===I.CONV_GROUP&&(l=_.replace(I.CONV_GROUP,""),this._remoteGroupReadSeqMap.has(l)&&(d=this._remoteGroupReadSeqMap.get(l),h=this._getConvLastMessageSeq(M),this.updateIsReadAfterReadReport({conversationID:_,remoteReadSequence:d}),d<=h&&this._remoteGroupReadSeqMap.delete(l))),this.updateUnreadCount(_,!1)&&(s+=1))}}catch(S){r.e(S)}finally{r.f()}return s}},{key:"isRemoteRead",value:function(s){var t,n=s.conversationID,s=s.sequence,r=n.replace(I.CONV_GROUP,""),a=!1;return this._remoteGroupReadSeqMap.has(r)&&(s<=(t=this._remoteGroupReadSeqMap.get(r))&&(a=!0,m.l("".concat(this._n,".isRemoteRead convID:").concat(n," msgSeq:").concat(s," remoteReadSeq:").concat(t))),t+10<=s&&this._remoteGroupReadSeqMap.delete(r)),a}},{key:"updateIsReadAfterReadReport",value:function(e){var t=e.conversationID,n=e.lastMessageSeq,s=e.lastMessageTime,r=this._msgListHandler.getLocalMsgList(t);if(r.length!==0){for(var a,l=r.length-1;0<=l;l--)if(a=r[l],!(s&&a.time>s||n&&a.sequence>n)){if(a.flow==="in"&&a.isRead)break;a.setIsRead(!0)}}}},{key:"updateUnreadCount",value:function(e){var t,n=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],s=!1,r=this.getLocalConversation(e),a=this._msgListHandler.getLocalMsgList(e);if(r)return(t=r.unreadCount)!==(a=a.filter(function(l){return!l.isRead&&!l._onlineOnlyFlag&&!l.isDeleted}).length)&&(r.unreadCount=a,s=!0,m.l("".concat(this._n,".updateUnreadCount from ").concat(t," to ").concat(a,", convID:").concat(e)),n===!0&&this.emitConvUpdate(!0,!1)),s&&r.type===I.CONV_TOPIC&&(t=r.unreadCount,a=this.get(10),n=e.replace(I.CONV_GROUP,""),a.onUnreadCountUpdatedFromConv(n,t)),s}},{key:"clearGroupAtInfoList",value:function(e){var t,n=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],s=this.getLocalConversation(e);s&&0<s.groupAtInfoList.length&&(s.clearGroupAtInfoList(),m.l("".concat(this._n,".clearGroupAtInfoList convID:").concat(e)),s.type===I.CONV_TOPIC&&(s=s.groupAtInfoList,t=this.get(10),e=e.replace(I.CONV_GROUP,""),t.onAtInfoUpdated({topicID:e,groupAtInfoList:s})),n===!0&&this.emitConvUpdate(!0,!1))}},{key:"updateReadReceiptInfo",value:function(h){var t,n,s,r=this,d=h.userID,a=d===void 0?void 0:d,d=h.groupID,l=d===void 0?void 0:d,d=h.readReceiptList,h=h.timestamp,g=h===void 0?0:h;se(d)||(t=[],H(a)?H(l)||(n="".concat(I.CONV_GROUP).concat(l),d.forEach(function(S){var D=S.tinyID,O=S.clientTime,B=S.random,M=S.readCount,S=S.unreadCount,D="".concat(D,"-").concat(O,"-").concat(B),O=r._msgListHandler.getLocalMsg(n,D)||r._msgListHandler.getHoppingMsg(n,D),B={groupID:l,messageID:D,readCount:0,unreadCount:0};O&&(Qe(M)&&(O.readReceiptInfo.readCount=M,B.readCount=M),Qe(S)&&(O.readReceiptInfo.unreadCount=S,B.unreadCount=S),t.push(B))})):(s="".concat(I.CONV_C2C).concat(a),d.forEach(function(M){var S=M.tinyID,D=M.clientTime,M=M.random,S="".concat(S,"-").concat(D,"-").concat(M),D=r._msgListHandler.getLocalMsg(s,S)||r._msgListHandler.getHoppingMsg(s,S);D&&!D.readReceiptInfo.isPeerRead&&(D.readReceiptInfo.isPeerRead=!0,D.readReceiptInfo.timestamp=g,t.push({userID:a,messageID:S,isPeerRead:!0,timestamp:g}))})),0<t.length&&this.emitOEvt($.MESSAGE_READ_RECEIPT_RECEIVED,t))}},{key:"updateIsRead",value:function(e){var t=this.getLocalConversation(e),n=this.getLocalMessageList(e);if(t&&n.length!==0&&!Sr(t.type)){for(var s=[],r=0,a=n.length;r<a;r++)n[r].flow!=="in"?n[r].flow!=="out"||n[r].isRead||n[r].setIsRead(!0):s.push(n[r]);var l=0;l=t.type===I.CONV_C2C?(e=s.slice(-t.unreadCount).filter(function(h){return h.isRevoked}).length,s.length-t.unreadCount-e):s.length-t.unreadCount;for(var d=0;d<l&&!s[d].isRead;d++)s[d].setIsRead(!0)}}},{key:"deleteGroupAtTips",value:function(e){var t=this,n="".concat(this._n,".deleteGroupAtTips"),r=(m.l("".concat(n)),this._convMap.get(e));if(!r)return Promise.resolve();var s=r.groupAtInfoList;if(s.length===0)return Promise.resolve();var r=void 0,a=(e.startsWith(I.CONV_GROUP)&&(r=e.replace(I.CONV_GROUP,"")),q(s));if((rn({groupID:r})||Vt(r))&&(a=s.filter(function(d){return!d.atTypeArray.includes(I.CONV_AT_ALL)})).length===0)return this.clearGroupAtInfoList(e,!1),Promise.resolve();var l=this.getMyUserID();return this.req({P:E.DEL_GROUP_AT_TIPS,data:{messageListToDelete:a.map(function(d){return{from:d.from,to:l,messageSeq:d.__sequence,messageRandom:d.__random,groupID:H(d.topicID)?d.groupID:d.topicID}})}}).then(function(){return m.l("".concat(n," ok. count:").concat(s.length)),t.clearGroupAtInfoList(e,!1),Promise.resolve()}).catch(function(d){return m.e("".concat(n," failed. error:"),d),A(d)})}},{key:"appendToMessageList",value:function(e){return this._msgListHandler.pushIn(e)}},{key:"setMessageRandom",value:function(e){this._sll.set(e.random)}},{key:"deleteMessageRandom",value:function(e){this._sll.delete(e.random)}},{key:"pushIntoMessageList",value:function(e,t,n){return!(!this._msgListHandler.pushIn(t,n)||this._sll.has(t.random)&&!n||(e.push(t),0))}},{key:"revoke",value:function(e,t,n){return this._msgListHandler.revoke(e,t,n)}},{key:"getPeerReadTime",value:function(e){return this._peerReadTimeMap.get(e)}},{key:"recordPeerReadTime",value:function(e,t){(!this._peerReadTimeMap.has(e)||this._peerReadTimeMap.get(e)<t)&&this._peerReadTimeMap.set(e,t)}},{key:"updateMsgIsPeerReadProp",value:function(e,t){var n;e.startsWith(I.CONV_C2C)&&0<t&&(0<(n=this._msgListHandler.updateMsgIsPeerReadProp(e,t)).length&&this.emitOEvt($.MESSAGE_READ_BY_PEER,n),this._convMap.has(e)&&(se(n=this._convMap.get(e).lastMessage)||n.fromAccount===this.getMyUserID()&&n.lastTime<=t&&!n.isPeerRead&&(n.isPeerRead=!0,this.emitConvUpdate(!0,!1))))}},{key:"updateMsgIsModifiedProp",value:function(e){this._msgListHandler.updateMsgIsModifiedProp(e)}},{key:"setCompleted",value:function(e){m.l("".concat(this._n,".setCompleted convID:").concat(e)),this._completedMap.set(e,!0)}},{key:"updateRoamingMsgKeyAndTime",value:function(e,t,n){this._roamingMsgKeyAndTimeMap.set(e,{messageKey:t,lastMessageTime:n})}},{key:"getConvList",value:function(e){var t,n=this,s="".concat(this._n,".").concat("getConvList"),r="pagingStatus:".concat(this._pagingStatus,", local conversation count:").concat(this._convMap.size,", options:").concat(JSON.stringify(e));return m.l("".concat(s,". ").concat(r)),this._pagingStatus===Hs?((t=new K("getConvList")).setMessage(r),this.syncConvList().then(function(){t.end();var a=n._getConvList(e);return me({conversationList:a,isSyncCompleted:n._isSyncCompleted()})}).catch(function(a){return t.setError(a).end(),m.e("".concat(s," failed. error:"),a),A(a)})):(r=this._getConvList(e),m.l("".concat(s,". returned conversation count:").concat(r.length)),Pe({conversationList:r,isSyncCompleted:this._isSyncCompleted()}))}},{key:"_getConvList",value:function(e){var t,n,s,r,a,l=this;return H(e)?this.getLocalConvList():_e(e)?e.length===0?[]:this.getLocalConvList().filter(function(d){return e.includes(d.conversationID)}):dt(e)?(t=e.type,n=e.markType,s=e.groupName,r=e.hasUnreadCount,a=e.hasGroupAtInfo,this.getLocalConvList().filter(function(d){return l._filterType(d,t)&&l._filterMarkType(d,n)&&l._filterGroupName(d,s)&&l._filterUnreadCount(d,r)&&l._filterGroupAtInfo(d,a)})):[]}},{key:"_filterType",value:function(e,t){return t!==I.CONV_C2C&&t!==I.CONV_GROUP||e.type===t}},{key:"_filterGroupName",value:function(e,t){return!xe(t)||(t===""?e.conversationGroupList.length===0:e.conversationGroupList.includes(t))}},{key:"_filterMarkType",value:function(e,t){return!Qe(t)||(t===0?e.markList.length===0:e.markList.includes(t))}},{key:"_filterUnreadCount",value:function(e,t){var n=!0;return t===!0?n=1<=e.unreadCount:t===!1&&(n=e.unreadCount===0),n}},{key:"_filterGroupAtInfo",value:function(e,t){var n=!0;return t===!0?n=1<=e.groupAtInfoList.length:t===!1&&(n=e.groupAtInfoList.length===0),n}},{key:"_handleC2CPeerReadTime",value:function(){var e,t=ye(this._convMap);try{for(t.s();!(e=t.n()).done;){var n=te(e.value,2),s=n[0],r=n[1];r.type===I.CONV_C2C&&this.recordPeerReadTime(s,r.peerReadTime)}}catch(a){t.e(a)}finally{t.f()}}},{key:"_isPagingGetGroupListCompleted",value:function(){var e=this.get(7);return!e||e.isPagingGetCompleted()}},{key:"_getLocalGroupCount",value:function(){var e=this.get(7);return e?e.getLocalGroupList().length:0}},{key:"_hasLocalGroup",value:function(e){var t=this.get(7);return!!t&&t.hasLocalGroup(e.replace(I.CONV_GROUP,""))}},{key:"getConversationProfile",value:function(e){var t,n=this,s=!1;if(this._convMap.has(e)?t=this._convMap.get(e):(t=new Ur({conversationID:e,type:Zt(e)?I.CONV_C2C:I.CONV_GROUP},this.isIntl(),this.isUsingChatCore()),s=!0),t._isInfoCompleted||t.type===I.CONV_SYSTEM)return Pe({conversation:t});if(ln(e)){if(!this.get(7))return A({code:F.NO_MODULE});if(!this._hasLocalGroup(e))return Pe({conversation:t})}var r="".concat(this._n,".").concat("getConversationProfile"),a=new K("getConversationProfile");return m.l("".concat(r,". convID:").concat(e," remark:").concat(t.remark," lastMessage:"),t.lastMessage),this._getUserOrGroupProfile(t).then(function(l){a.setMessage("convID:".concat(e," unreadCount:").concat(l.data.conversation.unreadCount)).end();var d,h=n.get(8);if(h&&t.type===I.CONV_C2C&&(d=e.replace(I.CONV_C2C,""),h.isMyFriend(d)&&(h=h.getFriendRemark(d),t.remark!==h&&(t.remark=h,m.l("".concat(r,". convID:").concat(e," patch remark:").concat(t.remark))))),m.l("".concat(r," ok. isNewConv:").concat(s," convID:").concat(e)),s){if(t.type===I.CONV_C2C)return n._onNewC2CConv([e.replace(I.CONV_C2C,"")]).then(function(){return Pe({conversation:t})});if(t.type===I.CONV_GROUP)return n._onNewGroupConv([e.replace(I.CONV_GROUP,"")]).then(function(){return Pe({conversation:t})})}return l}).catch(function(l){return a.setError(l).setMessage("convID:".concat(e)).end(),m.e("".concat(r," failed. error:"),l),A(l)})}},{key:"_getUserOrGroupProfile",value:function(e){var t=this;return e.type===I.CONV_C2C?this.get(4).getUserProfile({userIDList:[e.toAccount]}).then(function(n){return n=n.data,n.length===0?A({code:F.USER_OR_GRP_NOT_FOUND}):(e.userProfile=n[0],e._isInfoCompleted=!0,t._insertConvAfterTopmost(e),Pe({conversation:e}))}):this.get(7).getGroupProfile({groupID:e.toAccount}).then(function(n){return e.groupProfile=n.data.group,e._isInfoCompleted=!0,t._insertConvAfterTopmost(e),Pe({conversation:e})})}},{key:"_insertConvAfterTopmost",value:function(e){var t,n;e instanceof Ur&&!this._convMap.has(e.conversationID)&&(n=(t=q(this._convMap)).findIndex(function(s){return s[1].isPinned===!1}),t.splice(n,0,[e.conversationID,e]),this._convMap=new Map(t),this._setStorageConvList(),this.emitConvUpdate(!0,!1))}},{key:"_onProfileUpdated",value:function(e){var t=this;e.data.forEach(function(n){var s=n.userID;s===t.getMyUserID()?t._onMyProfileModified({latestNick:n.nick,latestAvatar:n.avatar}):(s=t._convMap.get("".concat(I.CONV_C2C).concat(s)))&&(s.userProfile=n)})}},{key:"_onCloudConfig",value:function(e){this.getCloudConfig("pull_on_invite")==="0"&&(this._bPullOnInvite=!1),m.l("".concat(this._n,"._onCloudConfig bPullOnInvite:").concat(this._bPullOnInvite))}},{key:"disableMsgPullOnInvite",value:function(){this._bPullOnInvite=!1}},{key:"_isSyncCompleted",value:function(){return this._pagingStatus===Or}},{key:"_errorLog",value:function(e,t,n,s){var r=new Error("Params validate failed."),a="".concat(this.getErrMsg("API_REFER")).concat(e);throw m.w("[".concat(e,"] | ").concat(t," | ").concat(this.getErrMsg(n,s),", ").concat(a)),m.e("[".concat(e,"] Invalid ").concat(t,": type check failed for ").concat(t,".")),r}},{key:"_isValidConvID",value:function(e){return Zt(e)||ln(e)||Sr(e)}},{key:"deleteConversation",value:function(e){var t=this,n="deleteConversation";return xe(e)||ao(e)||this._errorLog(n,"options","StringOrObjectRequiredLog"),xe(e)?(this._isValidConvID(e)||this._errorLog(n,"options","InvalidConversationID",e),m.l("".concat(this._n,".").concat(n," convID:").concat(e)),this.deleteConvList({conversationIDList:[e],flag:1})):(_e(e.conversationIDList)||this._errorLog(n,"conversationIDList","ArrayRequiredLog"),e.conversationIDList.length===0&&this._errorLog(n,"conversationIDList","NonEmptyArrayLog"),e.conversationIDList.forEach(function(s){t._isValidConvID(s)||t._errorLog(n,"conversationIDList","InvalidConversationID",s)}),"clearHistoryMessage"in e&&typeof e.clearHistoryMessage!="boolean"&&this._errorLog(n,"clearHistoryMessage","BooleanRequiredLog"),100<e.conversationIDList.length&&(e.conversationIDList=e.conversationIDList.slice(0,100)),this.deleteConvList(e))}},{key:"deleteConvList",value:function(a){var t=a.conversationIDList,t=t===void 0?[]:t,n=a.clearHistoryMessage,n=n===void 0||n,a=a.flag,s=a===void 0?0:a,r="".concat(this._n,".").concat("deleteConvList"),a="convIDList:".concat(t," clearHistoryMessage:").concat(n),l=(m.l("".concat(r," ").concat(a)),new K("deleteConvList"));return l.setMessage(a),Promise.all([this.rmLocalOnlyConvList(t),this.rmLocalAndRemoteConvList(t,n)]).then(function(d){return l.end(),d=[].concat(q(d[0]),q(d[1])),d.length===0?A(new yt({code:F.CONV_NOT_FOUND})):(m.l("".concat(r," ok")),Pe(s===1?{conversationID:d[0]}:{conversationIDList:d}))}).catch(function(d){return l.setError(d).end(),m.e("".concat(r," failed. error:"),d),A(d)})}},{key:"rmLocalOnlyConvList",value:function(e){var t=this;return e.filter(function(n){if(!t._convMap.has(n))return!1;var s=t.getLocalConversation(n).type;return s!==I.CONV_GROUP||t._hasLocalGroup(n)?s===I.CONV_SYSTEM&&(t.get(7).deleteGroupSystemNotice({messageList:t._msgListHandler.getLocalMsgList(n)}),t.deleteLocalConv(n),!0):(t.deleteLocalConv(n),!0)})}},{key:"rmLocalAndRemoteConvList",value:function(e,t){var n=this,s={fromAccount:this.getMyUserID(),conversationList:[],clearHistoryMessage:t?1:0};return e.forEach(function(r){var a;n._convMap.has(r)&&((a=n.getLocalConversation(r).type)===I.CONV_C2C?s.conversationList.push({toAccount:r.replace(a,""),type:1}):a===I.CONV_GROUP&&n._hasLocalGroup(r)&&s.conversationList.push({toGroupID:r.replace(a,""),type:2}))}),s.conversationList.length===0?[]:this.req({P:E.DEL_CONV,data:s}).then(function(r){var a=[];return 0<r.data.resultList.length&&r.data.resultList.map(function(l){l.code===0&&(l=l.type===1?"".concat(I.CONV_C2C).concat(l.to):"".concat(I.CONV_GROUP).concat(l.groupID),a.push(l))}),n.deleteLocalConvList(a),a})}},{key:"setConvDraft",value:function(n){var t=n.conversationID,n=n.draftText,s="".concat(this._n,".").concat("setConvDraft");return m.l("".concat(s," convID:").concat(t," draftText:").concat(n)),this._convMap.has(t)?(s=this._convMap.get(t),s.setDraftText(n),this.emitConvUpdate(),Pe({code:0,conversation:s})):A({code:F.CONV_NOT_FOUND})}},{key:"clearHistoryMessage",value:function(e){var t=this,n={fromAccount:this.getMyUserID(),toAccount:void 0,type:void 0,toGroupID:void 0};if(!this._convMap.has(e))return A({code:F.CONV_NOT_FOUND});var s=this._convMap.get(e).type;if(s===I.CONV_C2C)n.type=1,n.toAccount=e.replace(I.CONV_C2C,"");else{if(s!==I.CONV_GROUP)return s===I.CONV_SYSTEM?(this.get(7).deleteGroupSystemNotice({messageList:this._msgListHandler.getLocalMsgList(e)}),Pe({conversationID:e})):A({code:F.CONV_UN_RECORDED_TYPE});n.type=2,n.toGroupID=e.replace(I.CONV_GROUP,"")}var r="".concat(this._n,".").concat("clearHistoryMessage"),a=new K("clearHistoryMessage");return a.setMessage("convID:".concat(e)),m.l("".concat(r,". convID:").concat(e)),this.setMessageRead({conversationID:e}).then(function(){return t.req({P:E.CLEAR_HISTORY_MSG,data:n})}).then(function(){a.end(),m.l("".concat(r," ok")),t.clearMemMsg(e);var l=t.getLocalConversation(e);return l&&(l.updateLastMessage(),t._sortConvListAndEmitEvent()),Pe({conversationID:e})}).catch(function(l){return a.setError(l).end(),m.e("".concat(r," failed. error:"),l),A(l)})}},{key:"pinConversation",value:function(e){var t=this,n=e.conversationID,s=e.isPinned,r=this.getLocalConversation(n);if(r&&r.isPinned===s)return Pe({conversationID:n});if(Sr(n))return r&&(r.isPinned=s),this._sortConvListAndEmitEvent(),Pe({conversationID:n});if(e=null,Zt(n)?e={type:1,toAccount:n.replace(I.CONV_C2C,"")}:ln(n)&&(e={type:2,groupID:n.replace(I.CONV_GROUP,"")}),e===null)return A({code:F.INVALID_CONV_ID});var a="".concat(this._n,".").concat("pinConversation"),l="convID:".concat(n," isPinned:").concat(s),d=new K("pinConversation");return d.setMessage(l),m.l("".concat(a,". ").concat(l)),this.req({P:E.PIN_CONV,data:{fromAccount:this.getMyUserID(),operationType:s===!0?1:2,itemList:[e]}}).then(function(){return d.end(),m.l("".concat(a," ok")),r?r.isPinned!==s&&(r.isPinned=s):t._convMap.set(n,new Ur({conversationID:n,type:Zt(n)?I.CONV_C2C:I.CONV_GROUP,isPinned:s},t.isIntl(),t.isUsingChatCore())),t._sortConvListAndEmitEvent(),me({conversationID:n})}).catch(function(h){return d.setError(h).end(),m.e("".concat(a," failed. error:"),h),A(h)})}},{key:"setMessageRemindType",value:function(e){return this._msgRemindHandler.set(e)}},{key:"patchMsgRemindType",value:function(e){var t=e.ID,r=e.isC2CConversation,n=e.messageRemindType,s=!1,r=this.getLocalConversation("".concat(r?I.CONV_C2C:I.CONV_GROUP).concat(t));return r&&r.messageRemindType!==n&&(r.messageRemindType=n,s=!0),m.l("".concat(this._n,".patchMsgRemindType options:"),e,"ret:".concat(s)),s}},{key:"onC2CMsgRemindTypeFetched",value:function(e){var t,n=this;_e(e)&&0<e.length&&(t=0,e.forEach(function(a){var r=a.userID,a=a.muteFlag,a=n._transMsgRemindType(a);n.patchMsgRemindType({ID:r,isC2CConversation:!0,messageRemindType:a})===!0&&(t+=1)}),m.l("".concat(this._n,".onC2CMsgRemindTypeFetched updateCount:").concat(t)),1<=t&&this.emitConvUpdate(!0,!1))}},{key:"onC2CMsgRemindTypeSynced",value:function(e){var t=this,n="".concat(this._n,".onC2CMsgRemindTypeSynced");e.dataList.forEach(function(s){var r;se(s.muteNotificationsSync)||(r=(s=s.muteNotificationsSync).to,s=s.muteFlag,s=t._transMsgRemindType(s),t.patchMsgRemindType({ID:r,isC2CConversation:!(r=0),messageRemindType:s})&&(r+=1),m.l("".concat(n," updateCount:").concat(r)),1<=r&&t.emitConvUpdate(!0,!1))})}},{key:"onGroupMsgRemindTypeUpdated",value:function(e){this._msgRemindHandler.onGroupMsgRemindTypeUpdated(e)}},{key:"deleteLocalConv",value:function(e){var t=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],n=this._convMap.has(e);m.l("".concat(this._n,".deleteLocalConv convID:").concat(e," has:").concat(n)),n&&(this._convMap.delete(e),this._convMapForDiff.delete(e),this.clearMemMsg(e),this._setStorageConvList(!0),t)&&(n=!this._isTopicConv(e),this.emitConvUpdate(n,!1))}},{key:"pullMsgOnInvite",value:function(e){var t,n,s,r,a,l=this.get(7);l&&(t="".concat(this._n,".pullMsgOnInvite"),m.l("".concat(t," flag:").concat(this._bPullOnInvite)),this._bPullOnInvite&&(a=this.getLocalLastMessage(e),n=this.getLocalSecondLastMessage(e),r=s=1,a&&(s=a.sequence),n&&(r=n.sequence),a=l.getGroupRemoteLastSeq(e.replace(I.CONV_GROUP,"")),m.l("".concat(t," convID:").concat(e," localLastSeq:").concat(s," localSecondLastSeq:").concat(r," remoteLastSeq:").concat(a)),this.clearMemMsg(e),1<s-r?this._recursiveGetMsgList([],e,!1,s,r):1<a-s&&this._recursiveGetMsgList([],e,!0,a,s)))}},{key:"_recursiveGetMsgList",value:function(e,t,n,s,r,a){var l=this;this.getMessageList({conversationID:t,nextReqMessageID:a}).then(function(_){var _=_.data,h=_.messageList,g=_.isCompleted,_=_.nextReqMessageID,M=h.filter(function(S){return n?S.sequence>r&&S.sequence<=s:S.sequence>r&&S.sequence<s});e.unshift.apply(e,q(M)),!g&&0<h.length&&h[0].sequence>r&&e.length<60?l._recursiveGetMsgList(e,t,n,s,r,_):l._emitMsgReceived(t,e)})}},{key:"_emitMsgReceived",value:function(e,t){var n,s,r=this;0<t.length&&(t=t.filter(function(a,l,d){return l===d.findIndex(function(h){return h.sequence===a.sequence})}),n=this.hasLocalConversation(e),s=t.map(function(a){return a.sequence}),m.l("".concat(this._n,"._emitMsgReceived convID:").concat(e," has:").concat(n," count:").concat(s.length," sequenceList:"),s),this.emitOEvt($.MESSAGE_RECEIVED,t),n?this.patchConvLastMessage(e,!0):this.getConversationProfile(e).then(function(){r.patchConvLastMessage(e,!0)}))}},{key:"deleteLocalConvList",value:function(e){var t=this,n=!1;e.forEach(function(s){t._convMap.has(s)&&(t.deleteLocalConv(s,!1),n=!0)}),m.l("".concat(this._n,".deleteLocalConvList convID:").concat(e," isConvIDExisted:").concat(n)),n&&this.emitConvUpdate(!0,!1)}},{key:"isMessageSentByCurrentInstance",value:function(e){return!(!this._msgListHandler.hasLocalMsg(e.conversationID,e.ID)&&!this._sll.has(e.random))}},{key:"modifyMessageList",value:function(e){var t,n;e.startsWith(I.CONV_C2C)&&this._convMap.has(e)&&(n=this._convMap.get(e),t=Date.now(),this._msgListHandler.modifyMsgSentByPeer({conversationID:e,latestNick:n.userProfile.nick,latestAvatar:n.userProfile.avatar}),n=this.get(4).getNickAndAvatarByUserID(this.getMyUserID()),this._msgListHandler.modifyMsgSentByMe({conversationID:e,latestNick:n.nick,latestAvatar:n.avatar}),m.l("".concat(this._n,".modifyMessageList convID:").concat(e," cost:").concat(Kt(t))))}},{key:"updateUserProfileSpecifiedKey",value:function(s){m.l("".concat(this._n,".updateUserProfileSpecifiedKey options:"),s);var t=s.conversationID,n=s.nick,s=s.avatar;this._convMap.has(t)&&(t=this._convMap.get(t).userProfile,xe(n)&&t.nick!==n&&(t.nick=n),xe(s)&&t.avatar!==s&&(t.avatar=s),this.emitConvUpdate(!0,!1))}},{key:"_onMyProfileModified",value:function(e){var t=this,n=this.getLocalConvList(),s=Date.now();n.forEach(function(r){t.modifyMessageSentByMe(c({conversationID:r.conversationID},e))}),m.l("".concat(this._n,"._onMyProfileModified. modify all messages sent by me, cost:").concat(Kt(s)))}},{key:"modifyMessageSentByMe",value:function(e){this._msgListHandler.modifyMsgSentByMe(e)}},{key:"getLatestMessageSentByMe",value:function(e){return this._msgListHandler.getLatestMsgSentByMe(e)}},{key:"modifyMessageSentByPeer",value:function(e){this._msgListHandler.modifyMsgSentByPeer(e)}},{key:"getLatestMessageSentByPeer",value:function(e){return this._msgListHandler.getLatestMsgSentByPeer(e)}},{key:"pushIntoNoticeResult",value:function(e,t){return!(!this._msgListHandler.pushIn(t)||this._sll.has(t.random)||(e.push(t),0))}},{key:"getLocalLastMessage",value:function(e){return this._msgListHandler.getLocalLastMsg(e)}},{key:"getLocalSecondLastMessage",value:function(e){return this._msgListHandler.getLocalSecondLastMsg(e)}},{key:"checkAndPatchRemark",value:function(){var e,t,n=this.get(8);this._convMap.size===0||!n||(e=q(this._convMap.values()).filter(function(s){return s.type===I.CONV_C2C})).length!==0&&(t=0,e.forEach(function(s){var r=s.conversationID.replace(I.CONV_C2C,"");n.isMyFriend(r)&&(r=n.getFriendRemark(r),s.remark!==r&&(s.remark=r,t+=1))}),m.l("".concat(this._n,".checkAndPatchRemark. c2cConvCount:").concat(e.length," patchedCount:").concat(t)),0<t&&this.emitConvUpdate(!0,!1))}},{key:"updateTopicConversation",value:function(e){this._updateLocalConvList({conversationOptionsList:e,isFromGetConversations:!0,updateUnreadCount:!0})}},{key:"sendReadReceipt",value:function(e){var t=e[0],n=null;return t.conversationType===I.CONV_C2C?n=this._m.get(6):t.conversationType===I.CONV_GROUP&&(n=this._m.get(7)),n?n.sendReadReceipt(e):A({code:F.NO_MODULE})}},{key:"getReadReceiptList",value:function(e){var t=e[0],n=null;return t.conversationType===I.CONV_C2C?n=this._m.get(6):t.conversationType===I.CONV_GROUP&&(n=this._m.get(7)),n?n.getReadReceiptList(e):A({code:F.NO_MODULE})}},{key:"getLastMessageTime",value:function(e){return e=this.getLocalConversation(e),e?e.lastMessage.lastTime:0}},{key:"getTotalUnreadCount",value:function(){var e=this.getLocalConvList(),t=0;return e.forEach(function(n){n.type!==I.CONV_SYSTEM&&(n.messageRemindType!==""&&n.messageRemindType!==I.MSG_REMIND_ACPT_AND_NOTE||(t+=n.unreadCount))}),t}},{key:"onTotalUnreadCountUpdate",value:function(){var e=this.getTotalUnreadCount();this._convTotalUnreadCount!==e&&(m.l("".concat(this._n,".onTotalUnreadCountUpdate from ").concat(this._convTotalUnreadCount," to ").concat(e)),this._convTotalUnreadCount=e,this.emitOEvt($.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED))}},{key:"_isConvNeedShow",value:function(s){if(s=this.getLocalConversation(s),H(s))return!0;var t=s.type===I.CONV_TOPIC,n=s.type===I.CONV_GROUP&&s.groupProfile.type===I.GRP_ROOM,s=s.type===I.CONV_GROUP&&s.groupProfile.type===I.GRP_LIVE;return!(t||n||s)}},{key:"setAllRcvMsgOpt",value:function(e){return this._msgRemindHandler.setAllRcvMsgOpt(e)}},{key:"getAllRcvMsgOpt",value:function(){return this._msgRemindHandler.getAllRcvMsgOpt()}},{key:"onAllRcvMsgOptNotify",value:function(e){this._msgRemindHandler.onAllRcvMsgOptNotify(e)}},{key:"clearUnreadCount",value:function(e){e=this.getLocalConversation(e),e&&0<e.unreadCount&&(e.unreadCount=0,this.emitConvUpdate(!0,!1))}},{key:"storeHoppingMessageList",value:function(e){this._msgListHandler.storeHoppingMsgList(e)}},{key:"clearMemMsg",value:function(e){var t=1<arguments.length&&arguments[1]!==void 0&&arguments[1];m.l("".concat(this._n,".clearMemMsg convID:").concat(e," isOverLimit:").concat(t)),this._msgListHandler.removeByConvID(e),this._completedMap.delete(e),this._roamingMsgKeyAndTimeMap.delete(e),this._everClearedMap.set(e,1)}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._setStorageConvList(!0),this._pagingStatus=yo,this._msgListHandler.reset(),this._msgRemindHandler.reset(),this._roamingMsgKeyAndTimeMap.clear(),this._sll.reset(),this._peerReadTimeMap.clear(),this._completedMap.clear(),this._convMap.clear(),this._pagingTs=0,this._pagingStartIdx=0,this._pagingPinnedTs=0,this._pagingPinnedStartIdx=0,this._remoteGroupReadSeqMap.clear(),this._convTotalUnreadCount=0,this._pagingGetCostList.length=0,this._pagingConvIDMap.clear(),this._convIDFromUnreadDBMap.clear(),this._pagingGetCostList.length=0,this._convMapForDiff.clear(),this._partialUpdatedConvMap.clear(),this._everClearedMap.clear(),this._bPullOnInvite=!0,this._convGroupHandler.reset(),this.resetReady()}}]),Br),wy=(y(Fu,[{key:"onCheckTimer",value:function(e){e%1==0&&0<this._cachedGroupTipsMap.size&&this._check()}},{key:"_check",value:function(){var e=this;this._cachedGroupTipsMap.forEach(function(t,n){var s=e._checkCountMap.get(n),r=e._grpM.hasLocalGroup(n);m.l("".concat(e._n,"._check groupID:").concat(n," hasLocalGroup:").concat(r," checkCount:").concat(s)),r?(e._notifyCachedGroupTips(n),e._checkCountMap.delete(n),e._grpM.deleteUnjoinedAVChatRoom(n)):s>=e.MAX_CHECK_COUNT?(e._deleteCachedGroupTips(n),e._checkCountMap.delete(n)):e._checkCountMap.set(n,++s)})}},{key:"onNewGroupTips",value:function(s){m.l("".concat(this._n,".onNewGroupTips options:").concat(JSON.stringify(s.dataList)));var s=this._assembly(s),t=s.eventDataList,n=s.result,s=s.AVChatRoomMessageList;0<s.length&&this._grpM.onAVChatRoomMessage(s),0<n.length&&(this._grpM.emitOEvt($.MESSAGE_RECEIVED,n),this._handleTips(n)),0<t.length&&(this._grpM.updateNextMessageSeq(t),this._grpM.get(11).onNewMessage({conversationOptionsList:t,isInstantMessage:!0}))}},{key:"_assembly",value:function(e){for(var t=e.event,n=e.dataList,s=null,r=[],a=[],l={},d=[],h=0,g=n.length;h<g;h++){var _=qc(n[h]);if(!(t===6&&(this._grpM.isGroupAttributesUpdatedNotice(_)||this._grpM.isGroupCountersNotice(_)))){var B=_.groupProfile,M=B.groupID,S=B.communityType,S=S===void 0?0:S,D=B.topicID,D=D===void 0?void 0:D,O=B.invisible,B=B.groupType,B=B===void 0?void 0:B,U=void 0,de=this._grpM.isMessageFromTopic(S,D),J=(de&&(U=I.CONV_TOPIC,_.to=D),this._grpM.hasLocalGroup(M));if(J||!this._grpM.isUnjoinedAVChatRoom(M))if(J||de)if(this._grpM.isMessageFromOrToAVChatroom(M))_.event=t,d.push(_);else if(_.currentUser=this._grpM.getMyUserID(),_.conversationType=I.CONV_GROUP,(s=new Bt(_)).setElement({type:I.MSG_GRP_TIP,content:c(c({},_.elements),{},{groupProfile:_.groupProfile})}),s.isSystemMessage=!1,O!==1){var J=this._grpM.get(11),de=s,O=de.conversationID,de=de.sequence;if(t===6)s._onlineOnlyFlag=!0,a.push(s);else if(!J.pushIntoNoticeResult(a,s))continue;this._grpM.isMessageFromCommunityOfTopic(S,D)||t===6&&J.getLocalConversation(O)||(t!==6&&this._qualityStat(s),S=J.isRemoteRead({conversationID:O,sequence:de}),H(l[O])?(D=0,s.flow==="in"&&(s._isExcludedFromUnreadCount||s._onlineOnlyFlag||S||(D=1)),l[O]=r.push({conversationID:O,unreadCount:D,type:H(U)?s.conversationType:U,subType:s.conversationSubType,lastMessage:s._isExcludedFromLastMessage?"":s})-1):(r[J=l[O]].type=s.conversationType,r[J].subType=s.conversationSubType,r[J].lastMessage=s._isExcludedFromLastMessage?"":s,s.flow==="in"&&(s._isExcludedFromUnreadCount||s._onlineOnlyFlag||S||r[J].unreadCount++)))}else this._qualityStat(s);else this._cacheAndCompare({groupID:M,event:t,item:_,groupType:B})}}return{eventDataList:r,result:a,AVChatRoomMessageList:d}}},{key:"_qualityStat",value:function(e){this._grpM.get(26).addMessageSequence({key:Ys,message:e})}},{key:"_handleTips",value:function(e){var t=this;e.forEach(function(n){switch(n.payload.operationType){case 1:t._onNewMemberComeIn(n);break;case 2:t._onMemberQuit(n);break;case 3:t._onMemberKickedOut(n);break;case 4:t._onMemberSetAdmin(n);break;case 5:t._onMemberCancelledAdmin(n);break;case 6:t._onGroupProfileModified(n);break;case 7:t._onMemberInfoModified(n);break;case 8:t._onTopicProfileUpdated(n);break;default:m.w("".concat(t._n,"._handleTips unknown operationType:").concat(n.payload.operationType))}})}},{key:"_onNewMemberComeIn",value:function(n){var n=n.payload,t=n.memberNum,n=n.groupProfile.groupID,n=this._grpM.getLocalGroupProfile(n);n&&Qe(t)&&n.memberCount!==t&&(n.memberCount=t,this._updateConvGroupProfile(n))}},{key:"_onMemberQuit",value:function(e){var n=e.payload,t=n.memberNum,n=n.groupProfile.groupID,s=this._grpM.getLocalGroupProfile(n);s&&Qe(t)&&s.memberCount!==t&&(s.memberCount=t,this._updateConvGroupProfile(s)),this._grpM.getGroupMemberHandler().deleteLocalGroupMembers(n,e.payload.userIDList)}},{key:"_onMemberKickedOut",value:function(e){var n=e.payload,t=n.memberNum,n=n.groupProfile.groupID,s=this._grpM.getLocalGroupProfile(n);s&&Qe(t)&&s.memberCount!==t&&(s.memberCount=t,this._updateConvGroupProfile(s)),this._grpM.getGroupMemberHandler().deleteLocalGroupMembers(n,e.payload.userIDList)}},{key:"_updateConvGroupProfile",value:function(e){this._grpM.get(11).updateConvGroupProfile([e])}},{key:"_onMemberSetAdmin",value:function(n){var t=n.payload.groupProfile.groupID,n=n.payload.userIDList,s=this._grpM.getGroupMemberHandler();n.forEach(function(r){r=s.getLocalGroupMemberInfo(t,r),r&&r.updateRole(I.GRP_MBR_ROLE_ADMIN)})}},{key:"_onMemberCancelledAdmin",value:function(n){var t=n.payload.groupProfile.groupID,n=n.payload.userIDList,s=this._grpM.getGroupMemberHandler();n.forEach(function(r){r=s.getLocalGroupMemberInfo(t,r),r&&r.updateRole(I.GRP_MBR_ROLE_MEMBER)})}},{key:"_onGroupProfileModified",value:function(r){var t=this,r=r.payload,n=r.newGroupProfile,l=r.groupProfile,s=r.operatorInfo,r=l.groupID,a=this._grpM.getLocalGroupProfile(r),l=(Object.keys(n).forEach(function(d){switch(d){case"ownerID":t._ownerChanged(a,n);break;case"groupName":a.name=n[d];break;default:a[d]=n[d]}}),H(s)||Object.keys(s).forEach(function(d){var h;d==="nameCard"?a.updateSelfInfo({nameCard:s[d]}):d==="role"&&(h="",s[d]===400?h=I.GRP_MBR_ROLE_OWNER:s[d]===300?h=I.GRP_MBR_ROLE_ADMIN:s[d]===200&&(h=I.GRP_MBR_ROLE_MEMBER),a.updateSelfInfo({role:h}))}),!a.isSupportTopic);this._grpM.emitGroupListUpdate(!0,l)}},{key:"_ownerChanged",value:function(n,t){var n=n.groupID,s=this._grpM.getLocalGroupProfile(n),r=this._grpM.getMyUserID();r===t.ownerID&&(s.updateGroup({selfInfo:{role:I.GRP_MBR_ROLE_OWNER}}),s=(t=this._grpM.getGroupMemberHandler()).getLocalGroupMemberInfo(n,r),r=this._grpM.getLocalGroupProfile(n).ownerID,t=t.getLocalGroupMemberInfo(n,r),s&&s.updateRole(I.GRP_MBR_ROLE_OWNER),t&&t.updateRole(I.GRP_MBR_ROLE_MEMBER))}},{key:"_onMemberInfoModified",value:function(e){var t=e.to,s=e.payload,n=s.groupProfile,s=s.memberList,r=n.groupID,a=(Vt(t)&&this._updateTopicMuteTime(e),this._grpM.getGroupMemberHandler());s.forEach(function(l){var d=a.getLocalGroupMemberInfo(r,l.userID);d&&Qe(l.muteTime)&&d.updateMuteUntil(l.muteTime)})}},{key:"_updateTopicMuteTime",value:function(s){var t=s.to,s=s.payload,r=s.groupProfile,s=s.memberList,n=s===void 0?[]:s,s=this._grpM.get(10),r=r.groupID,a=s.getLocalTopic(r,t);if(a){for(var l=!1,d=0;d<n.length;d++){var h=n[d];if(h.userID===this._grpM.getMyUserID()&&0<=h.muteTime){a.updateSelfInfo({muteTime:h.muteTime}),l=!0;break}}l&&this._grpM.emitOEvt($.TOPIC_UPDATED,{groupID:r,topic:a})}}},{key:"_onTopicProfileUpdated",value:function(e){var n=e.payload,t=n.groupProfile.groupID,n=n.newTopicInfo;this._grpM.get(10).onTopicProfileUpdated(c({groupID:t,topicID:e.to},n))}},{key:"_cacheGroupTips",value:function(e,t){this._cachedGroupTipsMap.has(e)||this._cachedGroupTipsMap.set(e,[]),this._cachedGroupTipsMap.get(e).push(t)}},{key:"_deleteCachedGroupTips",value:function(e){this._cachedGroupTipsMap.has(e)&&this._cachedGroupTipsMap.delete(e)}},{key:"_notifyCachedGroupTips",value:function(e,t){var n=this,s=this._cachedGroupTipsMap.get(e)||[];m.l("".concat(this._n,"._notifyCachedGroupTips groupID:").concat(e," groupType:").concat(t," count:").concat(s.length)),s.forEach(function(r){n.onNewGroupTips(r)}),this._deleteCachedGroupTips(e)}},{key:"_cacheAndCompare",value:function(s){var t=s.groupID,r=s.event,n=s.item,s=s.groupType,r=(m.l("".concat(this._n,"._cacheAndCompare groupID:").concat(t," groupType:").concat(s)),this._cacheGroupTips(t,{event:r,dataList:[n]}),{groupID:t,type:s});s===I.GRP_AVCHATROOM?this._grpM.hasLocalGroup(t)?this._notifyCachedGroupTips(t,s):this._grpM.setUnjoinedAVChatRoom(t):(this._grpM.updateGroupMap([r]),this._notifyCachedGroupTips(t,s)),this._checkCountMap.has(t)||this._checkCountMap.set(t,0)}},{key:"reset",value:function(){this._cachedGroupTipsMap.clear(),this._checkCountMap.clear()}}]),Fu),Uy=(y(Uu,[{key:"onCheckTimer",value:function(e){e%1==0&&0<this._cachedGroupMessageMap.size&&this._check()}},{key:"_check",value:function(){var e=this;this._cachedGroupMessageMap.forEach(function(t,n){var s=e._checkCountMap.get(n),r=e._grpM.hasLocalGroup(n);m.l("".concat(e._n,"._check groupID:").concat(n," hasLocalGroup:").concat(r," checkCount:").concat(s)),r?(e._notifyCachedGroupMessage(n),e._checkCountMap.delete(n),e._grpM.deleteUnjoinedAVChatRoom(n)):s>=e.MAX_CHECK_COUNT?(e._deleteCachedGroupMessage(n),e._checkCountMap.delete(n)):e._checkCountMap.set(n,++s)})}},{key:"updateLastMsg",value:function(e){var t="".concat(this._n,".updateLastMsg");if(this._grpM.getGroupMap().size!==0){for(var n,s,r,a,l=!1,d=e.length,h=0;h<d;h++)(n=e[h]).type===I.CONV_GROUP&&n.lastMessage.lastSequence!==0&&n.lastMessage.payload!==null&&(s=n.conversationID.split(/^GROUP/)[1],(s=this._grpM.getLocalGroupProfile(s))&&(r=s.lastMessage,a=n.lastMessage,JSON.stringify(r)!==JSON.stringify(a)&&(s.lastMessage=c({},n.lastMessage),l=!0)));m.l("".concat(t," convCount:").concat(d," groupCount:").concat(this._grpM.getLocalGroupList().length," isUpdated:").concat(l)),l&&(this._grpM.sortLocalGroupList(),this._grpM.emitGroupListUpdate(!0,!1))}else this.tempConversationList=e}},{key:"onNewMessage",value:function(e){var s=this._assembly(e),t=s.conversationOptionsList,n=s.messageList,s=s.AVChatRoomMessageList,s=(0<s.length&&this._grpM.onAVChatRoomMessage(s),Vc(n)),s=(0<s.length&&this._grpM.emitOEvt($.MESSAGE_MODIFIED,s),0<t.length&&(this._grpM.get(11).onNewMessage({conversationOptionsList:t,isInstantMessage:e.isInstantMessage!==!1,updateUnreadCount:e.updateUnreadCount!==!1}),this._grpM.updateNextMessageSeq(t)),Bc(n));0<s.length&&this._grpM.emitOEvt($.MESSAGE_RECEIVED,s),n.length=0}},{key:"_assembly",value:function(e){var t=e.dataList,n=e.event,s=e.isInstantMessage,r=null,a=[],l=[],d=[],h={},g=this._grpM.getFileDownloadProxy(),_=this._grpM.getDowloadFileAuthKey(),M=this._grpM.get(17).getFileDNList(),S=t.length;1<S&&t.sort(function(gt,Ot){return gt.sequence-Ot.sequence});for(var D=this._grpM.get(11),O=this._grpM.get(4),B=0;B<S;B++){var U,de=qc(t[B]),We=de.groupProfile,J=We.groupID,ke=We.communityType,ke=ke===void 0?0:ke,Ae=We.topicID,Ae=Ae===void 0?void 0:Ae,Be=We.invisible,We=We.groupType,We=We===void 0?void 0:We,ot=void 0,Lt=this._grpM.isMessageFromTopic(ke,Ae),vt=(Lt&&(ot=I.CONV_TOPIC,de.to=Ae),this._grpM.hasLocalGroup(J));!vt&&this._grpM.isUnjoinedAVChatRoom(J)||(vt||Lt?this._grpM.isMessageFromOrToAVChatroom(J)?(de.event=n,d.push(de)):(de.currentUser=this._grpM.getMyUserID(),de.conversationType=I.CONV_GROUP,de.isSystemMessage=!!de.isSystemMessage,(r=new Bt(de)).setElement(de.elements,g,_,M),Be!==1?(vt=t[B].isModified===1,D.isMessageSentByCurrentInstance(r)?r.isModified=vt:vt=!1,de.onlineOnlyFlag===1?(r._onlineOnlyFlag=!0,D.isMessageSentByCurrentInstance(r)||l.push(r)):this._grpM.isMessageFromCommunityOfTopic(ke,Ae)?l.push(r):(r.from!==this._grpM.getMyUserID()||(Lt=D.getLatestMessageSentByMe(r.conversationID))&&(Be=Lt.nick,ke=Lt.avatar,Be===r.nick&&ke===r.avatar||(D.modifyMessageSentByMe({conversationID:U,latestNick:r.nick,latestAvatar:r.avatar}),O.mockOnNickAvatarModified(r.nick,r.avatar))),D.pushIntoMessageList(l,r,vt)&&(this._qualityStat(s,r),U=(Ae=r).conversationID,Lt=Ae.sequence,Be=D.isRemoteRead({conversationID:U,sequence:Lt}),H(h[U])?(ke=0,r.flow==="in"&&(r._isExcludedFromUnreadCount||Be||(ke=1)),h[U]=a.push({conversationID:U,unreadCount:ke,type:H(ot)?r.conversationType:ot,subType:r.conversationSubType,lastMessage:r._isExcludedFromLastMessage?"":r})-1):(a[vt=h[U]].type=H(ot)?r.conversationType:ot,a[vt].subType=r.conversationSubType,a[vt].lastMessage=r._isExcludedFromLastMessage?"":r,r.flow==="in"&&(r._isExcludedFromUnreadCount||Be||a[vt].unreadCount++))))):this._qualityStat(s,r)):this._cacheAndCompare({groupID:J,event:n,item:de,groupType:We}))}return{conversationOptionsList:a,messageList:l,AVChatRoomMessageList:d}}},{key:"_qualityStat",value:function(e,t){var n=this._grpM.get(26);n.addMessageSequence({key:Ys,message:t}),e&&0<t.clientTime&&n.addMessageDelay(t.clientTime)}},{key:"onMsgRevoked",value:function(e,t){var n=this,s=this._grpM.get(11),r=[],a=[];e.dataList.forEach(function(l){var d=l.elements.revokedInfos,h=l.revokerInfo,g=l.groupProfile,_=!1;g&&(_=rn({groupID:g.groupID})||!se(g.topicID)),H(d)||d.forEach(function(M){var S,D=se(M.topicID)?"GROUP".concat(M.groupID):"GROUP".concat(M.topicID),O=s.getLocalConversation(D),B=M.revokerInfo&&M.revokerInfo.revoker||h&&h.revoker,U=h&&h.reason||"";O&&nn(O.type)?S={conversationID:D,sequence:M.sequence,ID:"".concat(M.tinyID,"-").concat(M.clientTime,"-").concat(M.random)}:(O=s.revoke(D,M.sequence,M.random))?S=O:(S={conversationID:D,sequence:M.sequence},M.tinyID&&M.clientTime&&M.random&&(S.ID="".concat(M.tinyID,"-").concat(M.clientTime,"-").concat(M.random)),M.time&&(S.time=M.time)),S&&(S.revoker=B,S.revokeReason=U,S.revokerInfo={userID:B,nick:"",avatar:""},_?(S.revokerInfo.nick=g.nick,S.revokerInfo.avatar=g.avatar,r.push(S)):a.push(S))})}),a.length===0&&r.length===0||(s.onMessageRevoked([].concat(r,a),t),0<r.length&&this._grpM.emitOEvt($.MESSAGE_REVOKED,r),0<a.length&&s.updateRevokerInfo(a).then(function(l){n._grpM.emitOEvt($.MESSAGE_REVOKED,l)}))}},{key:"_groupListTreeShaking",value:function(e){for(var t=new Map(q(this._grpM.getGroupMap())),n=0,s=e.length;n<s;n++)t.delete(e[n].groupID);this._grpM.hasJoinedAVChatRoom()&&this._grpM.getJoinedAVChatRoom().forEach(function(d){t.delete(d)}),this._grpM.getGroupMap().forEach(function(d,h){d.isSupportTopic&&t.delete(h)});for(var r=q(t.keys()),a=0,l=r.length;a<l;a++)this._grpM.deleteGroup(r[a])}},{key:"syncGroupList",value:function(){var e=this,r=0<arguments.length&&arguments[0]!==void 0&&arguments[0],t=(this._pagingStatus===yo&&this._grpM.clearGroupMap(),q($e)),n=this.PAGING_GRP_COUNT_LIMIT,s=[];if(r===!0)return this._pagingGetGroupListWithTopic({limit:n,offset:0,groupBaseInfoFilter:t,groupList:s});var r="syncGroupList",a="".concat(this._n,".").concat(r),l=new K(r);return this._pagingGetGroupList({limit:n,offset:0,groupBaseInfoFilter:t,groupList:s}).then(function(){var d=Qp(e._pagingGetCostList),h=Zp(e._pagingGetCostList),g=(e._pagingGetCostList.length=0,e._pagingStatus=Or,e._groupListTreeShaking(s),e._grpM.updateGroupMap(s),e._grpM.getLocalGroupList().length),g="count:".concat(g," sum:").concat(h," avg:").concat(d);return m.l("".concat(a," ok. ").concat(g)),l.setMessage(g).end(),e.tempConversationList&&(e.updateLastMsg(e.tempConversationList),e.tempConversationList=null),e._grpM.emitGroupListUpdate(!0,!0),me({groupList:e._grpM.getLocalGroupList()})}).catch(function(d){return e._pagingStatus=Hs,l.setError(d).end(),m.e("".concat(a," failed. error:"),d),A(d)})}},{key:"getGroupList",value:function(){var e=this,t="".concat(this._n,".").concat("getGroupList");if(m.l("".concat(t," pagingStatus:").concat(this._pagingStatus)),this._pagingStatus===Hs||this._pagingStatus===yo)return this.syncGroupList().then(function(){var s=e._grpM.getLocalGroupList();return me({groupList:s,isSyncCompleted:e.isPagingGetCompleted()})}).catch(function(s){return m.e("".concat(t," failed. error:"),s),A(s)});var n=this._grpM.getLocalGroupList();return m.l("".concat(t,". returned group count:").concat(n.length)),Pe({groupList:n,isSyncCompleted:this.isPagingGetCompleted()})}},{key:"isPagingGetCompleted",value:function(){return this._pagingStatus===Or}},{key:"_pagingGetGroupList",value:function(e){var t=this,n="".concat(this._n,".").concat("_pagingGetGroupList"),s=e.isCommunityRelay,r=s!==void 0&&s,a=e.limit,l=e.offset,d=e.groupBaseInfoFilter,h=e.groupList,g=Date.now();return this._grpM.req({P:E.GET_GRP_LIST,data:{type:r?I.GRP_COMMUNITY:void 0,memberAccount:this._grpM.getMyUserID(),limit:a,offset:l,responseFilter:{groupBaseInfoFilter:d,selfInfoFilter:["Role","JoinTime","MsgFlag","MsgSeq"]}}}).then(function(D){var D=D.data,M=D.groups,M=M===void 0?[]:M,D=D.totalCount,M=(h.push.apply(h,q(M)),t._handleGroupAtInfoWithoutTopic(r,M),l+a),S=!(M<D),D="offset:".concat(l," limit:").concat(a," total:").concat(D," isCompleted:").concat(S," ")+"current:".concat(h.length," isCommunityRelay:").concat(r);return t._pagingGetCostList.push(Kt(g,!1)),m.l("".concat(n," ok. ").concat(D," cost:").concat(Kt(g))),r||S?!r&&S?(m.l("".concat(n," start to get community list")),l=0,t._pagingGetGroupList({limit:a,offset:l,groupBaseInfoFilter:d,groupList:h,isCommunityRelay:!0})):r&&!S?(l=M,t._pagingGetGroupList({limit:a,offset:l,groupBaseInfoFilter:d,groupList:h,isCommunityRelay:!0})):me({groupList:h}):(l=M,t._pagingGetGroupList({limit:a,offset:l,groupBaseInfoFilter:d,groupList:h}))}).catch(function(_){return _.code===10018?(m.w("".concat(t.logPrefix," response size exceeds the limit, request count:").concat(a)),a=50,t._pagingGetGroupList({limit:a,offset:l,groupBaseInfoFilter:d,groupList:h,isCommunityRelay:r})):r?(_.code===11e3&&m.l("".concat(n," ok. community unavailable")),Pe({groupList:h})):A(_)})}},{key:"_pagingGetGroupListWithTopic",value:function(e){var t=this,n="".concat(this._n,"._pagingGetGroupListWithTopic"),s=e.limit,r=e.offset,a=e.groupBaseInfoFilter,l=e.groupList,d=Date.now();return this._grpM.req({P:E.GET_GRP_LIST,data:{type:I.GRP_COMMUNITY,memberAccount:this._grpM.getMyUserID(),limit:s,offset:r,responseFilter:{groupBaseInfoFilter:a,selfInfoFilter:q(Xe)},isSupportTopic:1,needAppDefineData:1}}).then(function(g){var g=g.data,_=g.groups,g=g.totalCount,_=(l.push.apply(l,q(_===void 0?[]:_)),r+s),M=!(_<g);return m.l("".concat(n," ok. offset:").concat(r," limit:").concat(s," totalCount:").concat(g," isCompleted:").concat(M," currentCount:").concat(l.length," cost:").concat(Kt(d))),M?(t._grpM.updateGroupMap(l),t._grpM.emitGroupListUpdate(!0,!1),g=t._grpM.getLocalGroupList().filter(function(S){return S.isSupportTopic===!0}),me({groupList:g})):(r=_,t._pagingGetGroupListWithTopic({limit:s,offset:r,groupBaseInfoFilter:a,groupList:l}))}).catch(function(h){return h.code===10018?(m.w("".concat(t.logPrefix," response size exceeds the limit, request count:").concat(s)),s=50,t._pagingGetGroupListWithTopic({limit:s,offset:r,groupBaseInfoFilter:a,groupList:l})):A(h)})}},{key:"_cacheGroupMessage",value:function(e,t){this._cachedGroupMessageMap.has(e)||this._cachedGroupMessageMap.set(e,[]),this._cachedGroupMessageMap.get(e).push(t)}},{key:"_deleteCachedGroupMessage",value:function(e){this._cachedGroupMessageMap.has(e)&&this._cachedGroupMessageMap.delete(e)}},{key:"_notifyCachedGroupMessage",value:function(e,t){var n=this,s=this._cachedGroupMessageMap.get(e)||[];m.l("".concat(this._n,"._notifyCachedGroupMessage groupID:").concat(e," groupType:").concat(t," count:").concat(s.length)),s.forEach(function(r){n.onNewMessage(r)}),this._deleteCachedGroupMessage(e)}},{key:"_cacheAndCompare",value:function(s){var t=s.groupID,r=s.event,n=s.item,s=s.groupType,r=(m.l("".concat(this._n,"._cacheAndCompare groupID:").concat(t," groupType:").concat(s)),this._cacheGroupMessage(t,{event:r,dataList:[n]}),{groupID:t,type:s});s===I.GRP_AVCHATROOM?this._grpM.hasLocalGroup(t)?this._notifyCachedGroupMessage(t,s):this._grpM.setUnjoinedAVChatRoom(t):(this._grpM.updateGroupMap([r]),this._notifyCachedGroupMessage(t,s)),this._checkCountMap.has(t)||this._checkCountMap.set(t,0)}},{key:"_handleGroupAtInfoWithoutTopic",value:function(e,t){var n=this;e&&t.length!==0&&t.forEach(function(a){var r=a.groupID,a=a.groupAtInfoList,l=[];H(a)||(a.forEach(function(d){l.push(c(c({},d),{},{groupID:r}))}),n._grpM.get(11).onNewGroupAtTips({dataList:l}))})}},{key:"setPagingGroupCount",value:function(e){H(e)||(this.PAGING_GRP_COUNT_LIMIT=parseInt(e,10))}},{key:"reset",value:function(){this.PAGING_GRP_COUNT_LIMIT=200,this._cachedGroupMessageMap.clear(),this._checkCountMap.clear(),this._pagingStatus=yo,this._pagingGetCostList=[]}}]),Uu),Fy=(y(wu,[{key:"_onCloudConfig",value:function(){var e=this._grpM.getCloudConfig("grp_attr_cache_time");H(e)||(this.CACHE_EXPIRE_TIME=Number(e))}},{key:"updateLocalMainSequenceOnReconnected",value:function(){this._groupAttributesMap.forEach(function(e){e.localMainSequence=0})}},{key:"isGroupAttributesUpdatedNotice",value:function(n){var t=n.to,n=n.elements.newGroupProfile,s=!H(n)&&!se(n.groupAttributeOption);return s&&this._onGroupAttributesUpdated({groupID:t,groupAttributeOption:n.groupAttributeOption}),s}},{key:"_onGroupAttributesUpdated",value:function(l){var t=this,n=l.groupID,l=l.groupAttributeOption,s=l.mainSequence,r=l.isWithChangedAttributeInfo,a=l.groupAttributeList,a=a===void 0?[]:a,l=l.operationType;if(m.l("".concat(this._n,".onGroupAttributesUpdated. ")+"groupID:".concat(n," isWithChangedAttributeInfo:").concat(r," operationType:").concat(l)),!H(l)){this._groupAttributesCopy=this._getCachedAttributes({groupID:n});var d=s-this._getLocalGroupAttributes(n).localMainSequence;if(d!=0){if(r===1&&d==1)return this._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:s,groupAttributeList:a,operationType:l}),void this._emitGroupAttributesUpdated(n);this._hasLocalGroupAttributes(n)&&(r=this._getLocalGroupAttributes(n).avChatRoomKey,this._getGroupAttributes({groupID:n,avChatRoomKey:r}).then(function(){t._emitGroupAttributesUpdated(n)}))}}}},{key:"initGroupAttributesCache",value:function(n){var t=n.groupID,n=n.avChatRoomKey,n=n===void 0?void 0:n;this._groupAttributesMap.set(t,{lastUpdateTime:0,localMainSequence:0,remoteMainSequence:0,attributes:new Map,avChatRoomKey:n}),m.l("".concat(this._n,".initGroupAttributesCache groupID:").concat(t," avChatRoomKey:").concat(n))}},{key:"initGroupAttributes",value:function(a){var t=this,n=a.groupID,s=a.groupAttributes,a=this._getLocalGroupAttributes(n),r=a.remoteMainSequence,a=a.avChatRoomKey,l=new K("initGroupAttributes");return l.setMessage("groupID:".concat(n," avChatRoomKey:").concat(a," mainSequence:").concat(r)),this._grpM.req({P:E.SET_GRP_ATTR,data:{groupID:n,avChatRoomKey:a,mainSequence:r,groupAttributeList:this._transformGroupAttributes(s)}}).then(function(g){m.l("".concat(t._n,".").concat("initGroupAttributes"," ok. groupID:").concat(n));var g=g.data,h=g.mainSequence,g=q(g.groupAttributeList);return g.forEach(function(_){_.value=s[_.key]}),t._groupAttributesCopy=t._getCachedAttributes({groupID:n}),t._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:h,groupAttributeList:g,operationType:1}),t._emitGroupAttributesUpdated(n),l.end(),me({groupAttributes:s})}).catch(function(d){return l.setError(d).end(),A(d)})}},{key:"setGroupAttributes",value:function(h){var t=this,n="".concat(this._n,".").concat("setGroupAttributes"),s=h.groupID,r=h.groupAttributes,h=this._getLocalGroupAttributes(s),a=h.remoteMainSequence,l=h.avChatRoomKey,d=h.attributes,h=this._transformGroupAttributes(r),g=(h.forEach(function(_){var M=_.key;_.sequence=0,d.has(M)&&(_.sequence=d.get(M).sequence)}),new K("setGroupAttributes"));return g.setMessage("groupID:".concat(s," groupAttributes:").concat(JSON.stringify(r))),m.l("".concat(n,". groupID:").concat(s," mainSequence:").concat(a)),this._grpM.req({P:E.MODIFY_GRP_ATTR,data:{groupID:s,avChatRoomKey:l,mainSequence:a,groupAttributeList:h}}).then(function(S){m.l("".concat(n," ok."));var S=S.data,M=S.mainSequence,S=q(S.groupAttributeList);return S.forEach(function(D){D.value=r[D.key]}),t._groupAttributesCopy=t._getCachedAttributes({groupID:s}),t._refreshCachedGroupAttributes({groupID:s,remoteMainSequence:M,groupAttributeList:S,operationType:2}),t._emitGroupAttributesUpdated(s),g.end(),me({groupAttributes:r})}).catch(function(_){return g.setError(_).end(),A(_)})}},{key:"deleteGroupAttributes",value:function(s){var t=this,n=s.groupID,s=s.keyList,s=s===void 0?[]:s,d=this._getLocalGroupAttributes(n),r=d.remoteMainSequence,g=d.avChatRoomKey,a=d.attributes,l=q(a.keys()),d=E.CLEAR_GRP_ATTR,h=3,g={groupID:n,avChatRoomKey:g,mainSequence:r},_=[],M=(0<s.length&&(l=[],d=E.DEL_GRP_ATTR,h=4,s.forEach(function(S){var D=0;a.has(S)&&(D=a.get(S).sequence,l.push(S)),_.push({key:S,sequence:D})}),g.groupAttributeList=_),new K("deleteGroupAttributes"));return M.setMessage("groupID:".concat(n," mainSequence:").concat(r," keyList:").concat(s," proto:").concat(d)),this._grpM.req({P:d,data:g}).then(function(S){return m.l("".concat(t._n,".").concat("deleteGroupAttributes"," ok. groupID:").concat(n)),S=S.data.mainSequence,t._groupAttributesCopy=t._getCachedAttributes({groupID:n}),t._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:S,groupAttributeList:_,operationType:h}),t._emitGroupAttributesUpdated(n),M.end(),me({keyList:l})}).catch(function(S){return M.setError(S).end(),A(S)})}},{key:"getGroupAttributes",value:function(e){var t=this,n="".concat(this._n,".").concat("getGroupAttributes"),s=e.groupID,d=this._getLocalGroupAttributes(s),r=d.avChatRoomKey,a=d.lastUpdateTime,l=d.localMainSequence,d=d.remoteMainSequence,h=new K("getGroupAttributes");return h.setMessage("groupID:".concat(s," localMainSequence:").concat(l," remoteMainSequence:").concat(d," keyList:").concat(e.keyList)),Date.now()-a>=this.CACHE_EXPIRE_TIME||l<d?this._getGroupAttributes({groupID:s,avChatRoomKey:r}).then(function(g){return h.setMoreMessage("get attributes from remote. count:".concat(g.length)).end(),m.l("".concat(n," from remote. groupID:").concat(s)),g=t._getCachedAttributes(e),me({groupAttributes:g})}).catch(function(g){return h.setError(g).end(),A(g)}):(h.setMoreMessage("get attributes from cache").end(),m.l("".concat(n," from cache. groupID:").concat(s)),a=this._getCachedAttributes(e),Pe({groupAttributes:a}))}},{key:"_getGroupAttributes",value:function(e){var t=this,n=0;return H(e.avChatRoomKey)||(n=1),this._grpM.req({P:E.GET_GRP_ATTR,data:c(c({},e),{},{groupType:n})}).then(function(a){m.l("".concat(t._n,"._getGroupAttributes ok. groupID:").concat(e.groupID));var a=a.data,r=a.mainSequence,a=a.groupAttributeList,l=q(a);return H(r)||t._refreshCachedGroupAttributes({groupID:e.groupID,remoteMainSequence:r,groupAttributeList:l,operationType:5}),a}).catch(function(s){return A(s)})}},{key:"_refreshCachedGroupAttributes",value:function(r){var t=r.groupID,n=r.remoteMainSequence,s=r.groupAttributeList,r=r.operationType;if(this._hasLocalGroupAttributes(t)){var a=this._getLocalGroupAttributes(t),l=a.localMainSequence;if(r===5||n-l==1)a.remoteMainSequence=n,a.localMainSequence=n,a.lastUpdateTime=Date.now(),this._updateCachedAttributes({groupAttributes:a,groupAttributeList:s,operationType:r});else{if(l===n)return;a.remoteMainSequence=n}this._groupAttributesMap.set(t,a),s="operationType:".concat(r," localMainSequence:").concat(l," remoteMainSequence:").concat(n),m.l("".concat(this._n,"._refreshCachedGroupAttributes. ").concat(s))}}},{key:"_getCachedAttributes",value:function(n){var t=n.groupID,n=n.keyList,n=n===void 0?[]:n,s={};if(this._hasLocalGroupAttributes(t)){var r=this._getLocalGroupAttributes(t).attributes;if(0<n.length)n.forEach(function(h){r.has(h)&&(s[h]=r.get(h).value)});else{var a,l=ye(r.keys());try{for(l.s();!(a=l.n()).done;){var d=a.value;s[d]=r.get(d).value}}catch(h){l.e(h)}finally{l.f()}}}return s}},{key:"_updateCachedAttributes",value:function(s){var t=s.groupAttributes,n=s.groupAttributeList,s=s.operationType;s!==3?s!==4?(s===1&&t.attributes.clear(),n.forEach(function(d){var a=d.key,l=d.value,d=d.sequence;t.attributes.set(a,{value:l,sequence:d})})):n.forEach(function(r){t.attributes.delete(r.key)}):t.attributes.clear()}},{key:"_hasLocalGroupAttributes",value:function(e){return this._groupAttributesMap.has(e)}},{key:"_getLocalGroupAttributes",value:function(e){return this._hasLocalGroupAttributes(e)||this.initGroupAttributesCache({groupID:e}),this._groupAttributesMap.get(e)}},{key:"_transformGroupAttributes",value:function(e){var t=[];return Object.keys(e).forEach(function(n){t.push({key:n,value:e[n]})}),t}},{key:"_emitGroupAttributesUpdated",value:function(e){var t=this._getCachedAttributes({groupID:e}),s=this._computeAttrChangedInfo(t),n=s.updatedKeyList,s=s.deletedKeyList;m.l("".concat(this._n,"._emitGroupAttributesUpdated update:").concat(n.length,", delete:").concat(s.length)),n.length===0&&s.length===0||this._grpM.emitOEvt($.GROUP_ATTRIBUTES_UPDATED,{groupID:e,groupAttributes:t,updatedKeyList:n,deletedKeyList:s})}},{key:"_computeAttrChangedInfo",value:function(e){var t=this,n=[],s=[];return Object.keys(e).forEach(function(r){e[r]!==t._groupAttributesCopy[r]&&n.push(r)}),Object.keys(this._groupAttributesCopy).forEach(function(r){H(e[r])&&s.push(r)}),this._groupAttributesCopy={},{updatedKeyList:n,deletedKeyList:s}}},{key:"deleteLocalGroupAttributes",value:function(e){this._hasLocalGroupAttributes(e)&&this._groupAttributesMap.delete(e)}},{key:"reset",value:function(){this._groupAttributesMap.clear(),this._groupAttributesCopy={},this.CACHE_EXPIRE_TIME=3e4}}]),wu),xy=(y(Gu,[{key:"_onCloudConfig",value:function(){var e=this._grpM.getCloudConfig("grp_counter_expire_time");H(e)||(this.EXPIRE_TIME=Number(e))}},{key:"isGroupCountersNotice",value:function(n){var t=n.to,n=n.elements.groupCounterInfo,s=!1;return se(n)||(this._onGroupCountersUpdated({groupID:t,groupCounterInfo:n}),s=!0),s}},{key:"_onGroupCountersUpdated",value:function(e){var t=this,n=e.groupID;e.groupCounterInfo.forEach(function(l){var r=l.type,a=l.groupCounterSeq,l=l.counterList,l=l===void 0?[]:l;r!==0&&r!==2||(t._updateLocalGroupCounters({groupID:n,groupCounterSeq:a,counterList:l}),l.forEach(function(d){t._grpM.emitOEvt($.GROUP_COUNTER_UPDATED,{groupID:n,key:d.key,value:d.value})})),r===1&&t._deleteLocalGroupCounters({groupID:n,groupCounterSeq:a,counterList:l})}),m.l("".concat(this._n,"._onGroupCountersUpdated groupID:").concat(n))}},{key:"initGroupCountersCache",value:function(n){var t=n.groupID,n=n.avChatRoomKey;this._groupCountersMap.set(t,{lastUpdateTime:0,groupCounterSeq:0,counters:new Map,avChatRoomKey:n}),m.l("".concat(this._n,".initGroupCountersCache groupID:").concat(t," avChatRoomKey:").concat(n))}},{key:"setGroupCounters",value:function(s){if(!this._grpM.canIUse(he.GRP_COUNTER))return this._grpM.noUse("setGroupCounters");var t="".concat(this._n,".").concat("setGroupCounters"),n=s.groupID,s=s.counters,s=this._convertObjectToList(s),r=this._getLocalGroupCounters(n).avChatRoomKey,a="groupID:".concat(n," count:").concat(s.length),l=new K("setGroupCounters");return l.setMessage("".concat(a)),m.l("".concat(t,". ").concat(a)),this._updateGroupCounters({groupID:n,counterList:s,avChatRoomKey:r,mode:"Set"}).then(function(d){return l.end(),m.l("".concat(t," ok.")),me({counters:d})}).catch(function(d){return l.setError(d).end(),m.e("".concat(t," failed. error:"),d),A(d)})}},{key:"increaseGroupCounter",value:function(a){var t="increaseGroupCounter";if(!this._grpM.canIUse(he.GRP_COUNTER))return this._grpM.noUse(t);var n="".concat(this._n,".").concat(t),s=a.groupID,r=a.key,a=a.value,l=this._getLocalGroupCounters(s).avChatRoomKey,d="groupID:".concat(s," key:").concat(r," value:").concat(a),h=new K(t);return h.setMessage("".concat(d)),m.l("".concat(n,". ").concat(d)),this._updateGroupCounters({groupID:s,counterList:[{key:r,value:a}],avChatRoomKey:l,mode:"Increase"}).then(function(g){return h.end(),m.l("".concat(n," ok.")),me({counters:g})}).catch(function(g){return h.setError(g).end(),m.e("".concat(n," failed. error:"),g),A(g)})}},{key:"decreaseGroupCounter",value:function(a){var t="decreaseGroupCounter";if(!this._grpM.canIUse(he.GRP_COUNTER))return this._grpM.noUse(t);var n="".concat(this._n,".").concat(t),s=a.groupID,r=a.key,a=a.value,l=this._getLocalGroupCounters(s).avChatRoomKey,d="groupID:".concat(s," key:").concat(r," value:").concat(a),h=new K(t);return h.setMessage("".concat(d)),m.l("".concat(n,". ").concat(d)),this._updateGroupCounters({groupID:s,counterList:[{key:r,value:a}],avChatRoomKey:l,mode:"Decrease"}).then(function(g){return h.end(),m.l("".concat(n," ok.")),me({counters:g})}).catch(function(g){return h.setError(g).end(),m.e("".concat(n," failed. error:"),g),A(g)})}},{key:"getGroupCounters",value:function(l){var t=this;if(!this._grpM.canIUse(he.GRP_COUNTER))return this._grpM.noUse("getGroupCounters");var n="".concat(this._n,".").concat("getGroupCounters"),s=l.groupID,l=l.keyList,r=l===void 0?[]:l,l=this._getLocalGroupCounters(s),a=l.avChatRoomKey,l=l.lastUpdateTime,d=new K("getGroupCounters");return d.setMessage("groupID:".concat(s)),Date.now()-l>=this.EXPIRE_TIME?this._getRemoteGroupCounters({groupID:s,avChatRoomKey:a}).then(function(h){return d.setMoreMessage("from remote. count:".concat(h.length)).end(),m.l("".concat(n," from remote. groupID:").concat(s)),h=t._getLocalCounters(s,r),me({counters:h})}).catch(function(h){return d.setError(h).end(),A(h)}):(d.setMoreMessage("from cache").end(),m.l("".concat(n," from cache. groupID:").concat(s)),l=this._getLocalCounters(s,r),Pe({counters:l}))}},{key:"_getRemoteGroupCounters",value:function(e){var t=this;return this._grpM.req({P:E.GET_GRP_COUNTER,data:c({},e)}).then(function(r){var r=r.data,s=r.counterList,s=s===void 0?[]:s,r=r.groupCounterSeq;return t._updateLocalGroupCounters({groupID:e.groupID,counterList:s,groupCounterSeq:r}),m.l("".concat(t._n,"._getRemoteGroupCounters ok. groupID:").concat(e.groupID)),s}).catch(function(n){return A(n)})}},{key:"_convertObjectToList",value:function(e){var t=[];return Object.keys(e).forEach(function(n){t.push({key:n,value:e[n]})}),t}},{key:"_updateGroupCounters",value:function(e){var t="".concat(this._n,"._updateGroupCounters"),n=e.groupID,s=e.avChatRoomKey,r=e.mode;return m.l("".concat(t,". groupID:").concat(n," avChatRoomKey:").concat(s," mode:").concat(r)),this._grpM.req({P:E.UPDATE_GRP_COUNTER,data:c({},e)}).then(function(l){m.l("".concat(t," ok."));var l=l.data.counterList,d={};return(l===void 0?[]:l).forEach(function(_){var g=_.key,_=_.value;d[g]=_}),d}).catch(function(a){return A(a)})}},{key:"_hasLocalGroupCounters",value:function(e){return this._groupCountersMap.has(e)}},{key:"_getLocalGroupCounters",value:function(e){return this._hasLocalGroupCounters(e)||this.initGroupCountersCache({groupID:e}),this._groupCountersMap.get(e)}},{key:"_updateLocalGroupCounters",value:function(l){var t,n,s,r=l.groupID,a=l.counterList,a=a===void 0?[]:a,l=l.groupCounterSeq;this._hasLocalGroupCounters(r)&&(s=this._getLocalGroupCounters(r),t=s.counters,n=s.avChatRoomKey,s=s.groupCounterSeq,0<l&&l<s||(a.forEach(function(g){var h=g.key,g=g.value;t.set(h,g)}),this._groupCountersMap.set(r,{lastUpdateTime:Date.now(),groupCounterSeq:l,counters:t,avChatRoomKey:n})))}},{key:"_deleteLocalGroupCounters",value:function(a){var t,n,s=a.groupID,r=a.counterList,r=r===void 0?[]:r,a=a.groupCounterSeq;this._hasLocalGroupCounters(s)&&(n=this._getLocalGroupCounters(s),t=n.counters,n=n.avChatRoomKey,r.forEach(function(l){t.delete(l.key)}),this._groupCountersMap.set(s,{lastUpdateTime:Date.now(),groupCounterSeq:a,counters:t,avChatRoomKey:n}))}},{key:"_getLocalCounters",value:function(e,t){var n={};if(!this._hasLocalGroupCounters(e))return n;var s=this._getLocalGroupCounters(e).counters;if(0<t.length)t.forEach(function(d){s.has(d)&&(n[d]=s.get(d))});else{var r,a=ye(s.keys());try{for(a.s();!(r=a.n()).done;){var l=r.value;n[l]=s.get(l)}}catch(d){a.e(d)}finally{a.f()}}return n}},{key:"reset",value:function(){this._groupCountersMap.clear(),this.EXPIRE_TIME=3e4}}]),Gu),qy=(y(bu,[{key:"start",value:function(){var e=this._grpM.isLoggedIn();e||(this._proto=E.AV_NOAUTH_POLLING),m.l("".concat(this._n,".start pollingInterval:").concat(this._manager.getPollingInterval()," isLoggedIn:").concat(e)),this._isRunning=!0,this._request()}},{key:"isRunning",value:function(){return this._isRunning}},{key:"_request",value:function(){var e=this,t=this._onInit(this._groupID);this._grpM.req({P:this._proto,data:t}).then(function(n){e._onSuccess(e._groupID,n),e.isRunning()&&(-1<e._timeoutID&&clearTimeout(e._timeoutID),e._timeoutID=setTimeout(e._request.bind(e),e._manager.getPollingInterval()))}).catch(function(n){e._onFail(e._groupID,n),e.isRunning()&&(-1<e._timeoutID&&clearTimeout(e._timeoutID),e._timeoutID=setTimeout(e._request.bind(e),e._manager.MAX_POLLING_INTERVAL))})}},{key:"stop",value:function(){m.l("".concat(this._n,".stop")),-1<this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=-1),this._isRunning=!1}},{key:"getPollingTimerID",value:function(){return this._timeoutID}}]),bu),Ef={3:!0,4:!0,5:!0,6:!0,17:!0,20:!0,21:!0,100:!0},Vy=(y(Pu,[{key:"hasJoinedAVChatRoom",value:function(){var e=[];return 0<(e=0<this._joinedGroupMap.size?q(this._joinedGroupMap.values()).filter(function(t){return t.type===I.GRP_AVCHATROOM}):e).length}},{key:"getJoinedLiveList",value:function(){var e=[];return e=0<this._joinedGroupMap.size?q(this._joinedGroupMap.values()).filter(function(t){return t.type===I.GRP_LIVE}):e}},{key:"checkJoinedAVChatRoomByID",value:function(e){return this._joinedGroupMap.has(e)}},{key:"getJoinedAVChatRoom",value:function(){return 0<this._joinedGroupMap.size?q(this._joinedGroupMap.keys()):[]}},{key:"_updatedata",value:function(e){var t=this._pollingRequestInfoMap.get(e);return e===q(this._pollingInstanceMap.keys())[0]?c(c({},t),{},{startBroadcastSeq:this._startBroadcastSeq,simplifiedMessage:this.DEFAULT_POLLING_SIMPLIFIED_MSG}):c(c({},t),{},{simplifiedMessage:this.DEFAULT_POLLING_SIMPLIFIED_MSG})}},{key:"_handleSuccess",value:function(e,t){var n,h=t.data,s=h.key,r=h.nextSeq,a=h.rspMsgList,l=h.errorCode,d=h.nextBroadcastSeq,h=h.broadcastMessageList;l!==0?(l=this._pollingRequestInfoMap.get(e),n=new K("longPollingAVError"),l=l?"".concat(l.key,"-").concat(l.startSeq):"requestInfo is undefined",n.setMessage("".concat(e,"-").concat(l,"-").concat(t.errorInfo)).setCode(t.errorCode).end(!0)):this.checkJoinedAVChatRoomByID(e)&&(xe(s)&&Qe(r)&&this._pollingRequestInfoMap.set(e,{key:s,startSeq:r}),Qe(d)&&d>this._startBroadcastSeq&&(this._startBroadcastSeq=d),_e(a)&&0<a.length?(a.forEach(function(g){g.to=g.groupID}),this.onMessage(a,e)):(this._pollingNoMessageCount+=1,this._pollingNoMessageCount===this.DEFAULT_POLLING_NO_MESSAGE_COUNT&&(this._pollingInterval=this.DEFAULT_POLLING_INTERVAL+this.DEFAULT_POLLING_INTERVAL_PLUS)),this._onBroadcastMessage(h))}},{key:"_handleFailure",value:function(e,t){}},{key:"onMessage",value:function(e,t){if(_e(e)&&e.length!==0){var n="".concat(this._n,".onMessage"),s=(t&&(n+=" groupID:".concat(t)),this._pollingNoMessageCount!==0&&(this._pollingNoMessageCount=0,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL),null),r=[],a=this._get(11),l=this._get(26),d=e.length,h=(1<d&&e.sort(function(O,B){return O.sequence-B.sequence}),this._get(12).isUnlimitedAVChatRoom()),g=!1;m.getLevel()<=0&&(t=e.map(function(O){return O.sequence}),m.l("".concat(n," count:").concat(t.length," sequenceList:").concat(t)),t.length=0);for(var _=0;_<d;_++){var M=this.restoreMessageFromSimplified(e[_]);if(Ef[M.event]){if(M.event===6&&(this._grpM.isGroupAttributesUpdatedNotice(M)||this._grpM.isGroupCountersNotice(M)))continue;if(M.event!==20)if(M.event!==21)if(M.event!==100){var s=this.packMessage(M,M.event),S=M.isModified===1,g=M.isHistoryMessage===1;if(!h){if(this._seqSll.has(s.sequence))continue;this._seqSll.set(s.sequence)}var D=this._IDSll.has(s.ID);D?m.w("".concat(n," ID:").concat(s.ID," has:").concat(D)):(this._IDSll.set(s.ID),D=!1,!g&&this._isMessageSentByCurrentInstance(s)?S&&(D=!0,s.isModified=S,a.updateMsgIsModifiedProp(s)):D=!0,D&&(s.conversationType===I.CONV_SYSTEM&&s.payload.operationType===5&&this._onGroupDismissed(s.payload.groupProfile.groupID),g||s.conversationType===I.CONV_SYSTEM||(S=s.conversationID.replace(I.CONV_GROUP,""),this._pollingInstanceMap.has(S)?this._grpM.isLoggedIn()&&l.addMessageSequence({key:Pr,message:s}):(s.type!==I.MSG_GRP_TIP&&0<s.clientTime&&l.addMessageDelay(s.clientTime),l.addMessageSequence({key:Nr,message:s}))),r.push(s)))}else this.onRoomCustomData(M);else this._get(34).onMessageReactionNotify({event:21,dataList:M.elements.messageReactionNotifyList});else this.handleMessageRevokedNotice(M)}else m.w("".concat(n,". unknown event:").concat(M.event))}r.length!==0&&(0<(t=Vc(r)).length&&this._grpM.emitOEvt($.MESSAGE_MODIFIED,t),g||0<(t=this.packConversationOption(r)).length&&a.onNewMessage({conversationOptionsList:t,isInstantMessage:!0}),this._checkMessageStacked(r),0<(t=Bc(r)).length&&this._grpM.emitOEvt($.MESSAGE_RECEIVED,t),r.length=0)}}},{key:"handleMessageRevokedNotice",value:function(e){var t=this,n=e.groupID,s=e.elements.revokeMsgList,r=e.revokerInfo,a=[];s.forEach(function(g){var _=g.tinyID,d=g.clientTime,h=g.random,g=g.sequence,_={conversationID:"".concat(I.CONV_GROUP).concat(n),ID:"".concat(_,"-").concat(d,"-").concat(h),revoker:r.revoker,revokeReason:r.reason||"",revokerInfo:{userID:r.revoker,nick:"",avatar:""},sequence:g};a.push(_)}),a.length!==0&&this._get(11).updateRevokerInfo(a).then(function(l){t._grpM.emitOEvt($.MESSAGE_REVOKED,l)})}},{key:"isBroadcastOrNormal",value:function(e){return e===3||e===17}},{key:"isGroupTip",value:function(e){return e===4||e===6}},{key:"isGroupSystemNotice",value:function(e){return e===5}},{key:"restoreGroupTipElements",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},r=e.operatorInfo,r=r===void 0?{}:r,a=e.operatorID,t=e.userIDList,t=t===void 0?[]:t,n=e.operationType,n=(Qe(e.groupJoinType)||n!==1&&n!==2||(e.groupJoinType=n===2?0:1),r.userID),s=r.avatar,r=r.nick,a=(e.operatorInfo={userID:n===void 0?a:n,avatar:s===void 0?"":s,nick:r===void 0?"":r},t.map(function(l){return{userID:l}}));return e.memberInfoList=e.memberInfoList||a,e}},{key:"restoreMessageFromSimplified",value:function(e){var t,n,s,r=e.event;return this.isBroadcastOrNormal(r)&&(e.cloudCustomData=e.cloudCustomData||"",e.elements=e.elements.map(function(a){var l;return a.type===I.MSG_CUSTOM&&(l=a.content,a.content=c({data:"",description:"",extension:""},l===void 0?{}:l)),a})),(this.isGroupTip(r)||this.isGroupSystemNotice(r))&&(e.from=e.from||"@TIM#SYSTEM"),this.isGroupTip(r)&&(e.elements=this.restoreGroupTipElements(e.elements),n=(s=(s=e.elements)===void 0?{}:s).operationType,t=s.operatorInfo,n===1&&(n=[{userID:(t===void 0?{}:t).userID}],s.memberInfoList=s.memberInfoList||n)),this.isGroupSystemNotice(r)&&(s=(t=e.elements).memberInfoList,n=t.operatorInfo,e.elements.memberInfoList=c({userID:e.elements.operatorID,avatar:"",nick:""},s=s||(n===void 0?{}:n)),e.elements=c({authentication:"",remarkInfo:"",messageKey:1e3*e.time},e.elements),r=Object.keys(e.elements).filter(function(a){return a!=="operatorInfo"}).reduce(function(a,l){return c(c({},a),{},C({},l,e.elements[l]))},{}),e.elements=r),e}},{key:"_onGroupDismissed",value:function(e){m.l("".concat(this._n,"._onGroupDismissed groupID:").concat(e)),this._grpM.deleteLocalGroupAndConversation(e),this.reset(e)}},{key:"_checkMessageStacked",value:function(n){var t="MessageStacked",n=n.length;100<=n&&(this._grpM.warn(t,n),this._reportMessageStackedCount<5&&(new K(t).setMessage("count:".concat(n," groupID:").concat(q(this._joinedGroupMap.keys()))).setLevel("warning").end(),this._reportMessageStackedCount+=1))}},{key:"_isMessageSentByCurrentInstance",value:function(e){return!!this._get(11).isMessageSentByCurrentInstance(e)}},{key:"packMessage",value:function(s,r){s.currentUser=this._grpM.getMyUserID(),s.conversationType=r===5?I.CONV_SYSTEM:I.CONV_GROUP,s.isSystemMessage=!!s.isSystemMessage;var n=new Bt(s),s=this.packElements(s,r),r=this._grpM.getFileDownloadProxy(),a=this._grpM.getDowloadFileAuthKey(),l=this._get(17).getFileDNList();return n.setElement(s,r,a,l),n}},{key:"packElements",value:function(e,t){return t===4||t===6?(this._updateMemberCountByGroupTips(e),{type:I.MSG_GRP_TIP,content:c(c({},e.elements),{},{groupProfile:e.groupProfile})}):t===5?{type:I.MSG_GRP_SYS_NOTICE,content:c(c({},e.elements),{},{groupProfile:c(c({},e.groupProfile),{},{groupID:e.groupID})})}:e.elements}},{key:"packConversationOption",value:function(e){for(var t=new Map,n=0;n<e.length;n++){var s,r=e[n],a=r.conversationID;t.has(a)?((s=t.get(a)).lastMessage=r).flow==="in"&&s.unreadCount++:t.set(a,{conversationID:r.conversationID,unreadCount:r.flow==="out"?0:1,type:r.conversationType,subType:r.conversationSubType,lastMessage:r})}return q(t.values())}},{key:"_updateMemberCountByGroupTips",value:function(a){var t,n,s,r=a.groupProfile.groupID,a=a.elements.onlineMemberInfo,a=a===void 0?void 0:a;se(a)||(t=(t=a.onlineMemberNum)===void 0?0:t,a=(a=a.expireTime)===void 0?this.DEFAULT_EXPIRE_TIME:a,n=this._onlineMemberCountMap.get(r)||{},s=Date.now(),se(n)?Object.assign(n,{lastReqTime:0,lastSyncTime:0,latestUpdateTime:s,memberCount:t,expireTime:a}):(n.latestUpdateTime=s,n.memberCount=t),this._onlineMemberCountMap.set(r,n))}},{key:"_onBroadcastMessage",value:function(e){if(!se(e)){for(var t=[],n=e.length,s=null,r=0;r<n;r++){var a=this.restoreMessageFromSimplified(e[r]);Ef[a.event]?((s=this.packMessage(a,a.event)).isBroadcastMessage=!0,this._broadcastMessageIDMap.has(s.ID)||(t.push(s),this._broadcastMessageIDMap.set(s.ID,1))):m.w("".concat(this._n,"._onBroadcastMessage unknown event:").concat(a.event))}0<t.length&&this._grpM.emitOEvt($.MESSAGE_RECEIVED,t)}}},{key:"start",value:function(e){var t;this._pollingInstanceMap.has(e)?(t=this._pollingInstanceMap.get(e)).isRunning()||t.start():((t=new qy({manager:this,groupID:e,onInit:this._updatedata.bind(this),onSuccess:this._handleSuccess.bind(this),onFail:this._handleFailure.bind(this)})).start(),this._pollingInstanceMap.set(e,t),m.l("".concat(this._n,".start groupID:").concat(e)))}},{key:"handleJoinResult",value:function(e){var t=this;return this._preCheck(e.group).then(function(){var n=e.longPollingKey,s=e.group,r=s.groupID;return t._joinedGroupMap.set(r,s),t._grpM.updateGroupMap([s]),t._grpM.deleteUnjoinedAVChatRoom(r),t._grpM.emitGroupListUpdate(!0,!1),H(n)?Pe({status:Gs,group:s}):Promise.resolve()})}},{key:"startRunLoop",value:function(e){var t=this;return this.handleJoinResult(e).then(function(){var n=e.longPollingKey,s=e.group,r=e.startSeq,a=s.groupID;return t._pollingRequestInfoMap.set(a,{key:n,startSeq:r===void 0?0:r}),t.start(a),t._grpM.isLoggedIn()?Pe({status:Gs,group:s}):Pe({status:Gs})})}},{key:"_preCheck",value:function(n){if(this._get(12).isUnlimitedAVChatRoom()||!this.hasJoinedAVChatRoom()||n.type===I.GRP_LIVE)return Promise.resolve();var n=te(this._joinedGroupMap.entries().next().value,2),t=n[0],n=n[1];if(this._grpM.isLoggedIn()){if(n.selfInfo.role!==I.GRP_MBR_ROLE_OWNER&&n.ownerID!==this._grpM.getMyUserID())return this._grpM.quitGroup(t);this._grpM.deleteLocalGroupAndConversation(t)}else this._grpM.deleteLocalGroupAndConversation(t);return this.reset(t),Promise.resolve()}},{key:"joinWithoutAuth",value:function(e){var t=this,n=e.groupID,s="".concat(this._n,".").concat("joinWithoutAuth"),r=new K("joinWithoutAuth");return this._grpM.req({P:E.APPLY_JOIN_GRP_NOAUTH,data:e}).then(function(a){if(a=a.data.longPollingKey,r.setMessage("groupID:".concat(n," longPollingKey:").concat(a)).end(!0),H(a))return A({code:F.CANNOT_JOIN_NON_AV_WITHOUT_LOGIN});m.l("".concat(s," ok. groupID:").concat(n)),t._get(11).setCompleted("".concat(I.CONV_GROUP).concat(n));var l=new co({groupID:n});return t.startRunLoop({group:l,longPollingKey:a}),me({status:Gs})}).catch(function(a){return m.e("".concat(s," failed. groupID:").concat(n," error:"),a),r.setError(a).setMessage("groupID:".concat(n)).end(!0),A(a)}).finally(function(){t._grpM.get(14).reportAtOnce()})}},{key:"getGroupOnlineMemberCount",value:function(e){var t=this._onlineMemberCountMap.get(e)||{},n=Date.now();return se(t)||n-t.lastSyncTime>1e3*t.expireTime&&1e4<n-t.latestUpdateTime&&3e3<n-t.lastReqTime?(t.lastReqTime=n,this._onlineMemberCountMap.set(e,t),this._getGroupOnlineMemberCount(e).then(function(s){return me({memberCount:s.memberCount})}).catch(function(s){return A(s)})):Pe({memberCount:t.memberCount})}},{key:"_getGroupOnlineMemberCount",value:function(e){var t=this,n="".concat(this._n,".").concat("_getGroupOnlineMemberCount"),s=new K("_getGroupOnlineMemberCount");return this._grpM.requestOnlineCount(e).then(function(d){var a=t._onlineMemberCountMap.get(e)||{},d=d.data,l=d.memberCount,l=l===void 0?0:l,d=d.expireTime,d=d===void 0?t.DEFAULT_EXPIRE_TIME:d,h=(m.l("".concat(n," ok. groupID:").concat(e," memberCount:").concat(l," expireTime:").concat(d)),Date.now());return se(a)&&(a.lastReqTime=h),t._onlineMemberCountMap.set(e,Object.assign(a,{lastSyncTime:h,latestUpdateTime:h,memberCount:l,expireTime:d})),{memberCount:l}}).catch(function(r){return m.w("".concat(n," failed. error:"),r),s.setCode(r.code).setMessage("groupID:".concat(e," error:").concat(JSON.stringify(r))).end(),Promise.reject(r)})}},{key:"_get",value:function(e){return this._grpM.get(e)}},{key:"setPollingInterval",value:function(e){H(e)||(Qe(e)?this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=e:this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=parseInt(e,10))}},{key:"setPollingIntervalPlus",value:function(e){H(e)||(Qe(e)?this.DEFAULT_POLLING_INTERVAL_PLUS=e:this.DEFAULT_POLLING_INTERVAL_PLUS=parseInt(e,10))}},{key:"setPollingNoMessageCount",value:function(e){H(e)||(Qe(e)?this.DEFAULT_POLLING_NO_MESSAGE_COUNT=e:this.DEFAULT_POLLING_NO_MESSAGE_COUNT=parseInt(e,10))}},{key:"setPollingSimplifiedMessage",value:function(e){H(e)||e!=="0"&&e!=="1"||(this.DEFAULT_POLLING_SIMPLIFIED_MSG=parseInt(e,10))}},{key:"getPollingInterval",value:function(){return this._pollingInterval}},{key:"onAVChatRoomMemberBanned",value:function(e){e=e.payload.groupProfile.groupID,m.l("".concat(this._n,".onAVChatRoomMemberBanned groupID:").concat(e)),this._grpM.deleteLocalGroupAndConversation(e),this.reset(e)}},{key:"restartPolling",value:function(){m.l("".concat(this._n,".restartPolling count:").concat(this._pollingInstanceMap.size));var e,t=ye(this._pollingInstanceMap.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;n.stop(),n.start()}}catch(s){t.e(s)}finally{t.f()}}},{key:"getPollingTimerID",value:function(e){if(!this._pollingInstanceMap.has(e))return-1;var t=this._pollingInstanceMap.get(e).getPollingTimerID();return m.l("".concat(this._n,".getPollingTimerID groupID:").concat(e," timerID:").concat(t)),t}},{key:"hasPollingInstance",value:function(e){return this._pollingInstanceMap.has(e)}},{key:"onRoomCustomData",value:function(r){var t=r.groupID,n=r.sequence,s=r.time,r=r.elements,r=r&&r.content;this._get(30).onRoomCustomDataReceived(r),m.l("".concat(this._n,".onRoomCustomData groupID:").concat(t," sequence:").concat(n," time:").concat(s," data:").concat(r))}},{key:"reset",value:function(e){if(e){m.l("".concat(this._n,".reset groupID:").concat(e));var t=this._pollingInstanceMap.get(e);t&&t.stop(),this._pollingInstanceMap.delete(e),this._joinedGroupMap.delete(e),this._pollingRequestInfoMap.delete(e),this._onlineMemberCountMap.delete(e)}else{m.l("".concat(this._n,".reset all"));var n,s=ye(this._pollingInstanceMap.values());try{for(s.s();!(n=s.n()).done;)n.value.stop()}catch(r){s.e(r)}finally{s.f()}this._pollingInstanceMap.clear(),this._joinedGroupMap.clear(),this._pollingRequestInfoMap.clear(),this._onlineMemberCountMap.clear(),this._broadcastMessageIDMap.clear()}this._seqSll.reset(),this._IDSll.reset(),this._reportMessageStackedCount=0,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=300,this.DEFAULT_POLLING_NO_MESSAGE_COUNT=20,this.DEFAULT_POLLING_INTERVAL_PLUS=2e3,this._pollingNoMessageCount=0}}]),Pu),By=(y(Nu,[{key:"updateMember",value:function(e){H(e.onlineStatus)||(this.isOnline=e.onlineStatus==="Online");var t=[null,void 0,"",0,NaN];e.memberCustomField&&Dr(this.memberCustomField,e.memberCustomField),zn(this,e,["memberCustomField","marks","onlineStatus"],t)}},{key:"updateRole",value:function(e){["Owner","Admin","Member"].indexOf(e)<0||(this.role=e)}},{key:"updateMuteUntil",value:function(e){H(e)||(this.muteUntil=Math.floor((Date.now()+1e3*e)/1e3))}},{key:"updateNameCard",value:function(e){H(e)||(this.nameCard=e)}},{key:"updateMemberCustomField",value:function(e){e&&Dr(this.memberCustomField,e)}}]),Nu),Hy=(y(Ou,[{key:"_onProfileUpdated",value:function(e){for(var t=this,n=e.data,s=0;s<n.length;s++)(function(r){var a=n[r];t.groupMemberListMap.forEach(function(l){l.has(a.userID)&&l.get(a.userID).updateMember({nick:a.nick,avatar:a.avatar})})})(s)}},{key:"deleteGroupMemberList",value:function(e){this.groupMemberListMap.delete(e)}},{key:"getGroupMemberList",value:function(d){var t,n=this,s=d.groupID,r=d.role,r=r===void 0?void 0:r,M=d.offset,a=M===void 0?0:M,M=d.count,l=M===void 0?15:M,M=d.filter,d=M===void 0?void 0:M,h="".concat(this._n,".").concat("getGroupMemberList"),M=this._grpM.hasLocalGroup(s);if(m.l("".concat(h," groupID:").concat(s," role:").concat(r," offset:").concat(a," count:").concat(l," hasLocalGroup:").concat(M)),!M)return Pe({memberList:[],offset:0});if(this._grpM.getLocalGroupProfile(s).type===I.GRP_AVCHATROOM){if(this._grpM.canIUse(he.AV_MBR_LIST))return this._getAVChatRoomMemberList({groupID:s,offset:a,filter:d});this._grpM.warn("LiveOnlineMember")}r!==I.GRP_MBR_ROLE_ADMIN&&r!==I.GRP_MBR_ROLE_OWNER&&r!==I.GRP_MBR_ROLE_MEMBER||(t=r);var g=new K("getGroupMemberList"),_=0,M={groupID:s,limit:100<l?100:l,memberRoleFilter:t?[t]:void 0,memberInfoFilter:this.DEFAULT_MEMBER_INFO_FILTER},S=(rn({groupID:s})?M.next="".concat(a):(M.offset=a,_=a+l),[]);return this._grpM.req({P:E.GET_GRP_MBR_LIST,data:M}).then(function(U){var U=U.data,O=U.members,B=U.memberNum,U=U.next,U=U===void 0?void 0:U;return H(U)||(_=se(U)?0:U),_e(O)&&O.length!==0?(n._grpM.hasLocalGroup(s)&&(n._grpM.getLocalGroupProfile(s).memberNum=B),S=n._updateLocalGroupMemberMap(s,O),n._grpM.get(4).getUserProfile({userIDList:O.map(function(de){return de.userID}),tagList:[Ve.NICK,Ve.AVATAR]})):(_=0,Promise.resolve([]))}).then(function(D){return D=D.data,!_e(D)||D.length===0?Pe({memberList:[],offset:_}):(D=D.map(function(O){return{userID:O.userID,nick:O.nick,avatar:O.avatar}}),n._updateLocalGroupMemberMap(s,D),S.length<l&&(_=0),g.setMessage("groupID:".concat(s," offset:").concat(a," count:").concat(l)).end(),m.l("".concat(h," ok.")),me({memberList:S,offset:_}))}).catch(function(D){return g.setError(D).end(),m.e("".concat(h," failed. error:"),D),A(D)})}},{key:"_getAVChatRoomMemberList",value:function(r){var t=this,n=r.groupID,s=r.offset,r=r.filter,a="".concat(this._n,".").concat("_getAVChatRoomMemberList"),l=new K("_getAVChatRoomMemberList");return l.setMessage("groupID:".concat(n," offset:").concat(s," filter:").concat(r)),this._grpM.req({P:E.GET_AV_MBR_LIST,data:{groupID:n,offset:s,filter:r}}).then(function(h){var h=h.data,g=h.memberList,g=g===void 0?[]:g,h=h.offset,h=h===void 0?0:h,g=(l.end(),m.l("".concat(a," ok. member count:").concat(g.length,", next request timestamp:").concat(h)),g.map(function(_){return c(c({},_),{},{onlineStatus:"Online"})})),g=t._updateLocalGroupMemberMap(n,g);return me({memberList:g,offset:h})}).catch(function(d){return l.setError(d).end(),m.e("".concat(a," failed. error:"),d),A(d)})}},{key:"getGroupMemberProfile",value:function(e){var t=this,n="getGroupMemberProfile",l="".concat(this._n,".").concat(n),s="groupID:".concat(e.groupID),r=(5<e.userIDList.length?s+=" userIDList.length:".concat(e.userIDList.length):s+=" userIDList:".concat(e.userIDList),m.l("".concat(l," ").concat(s)),50<e.userIDList.length&&(e.userIDList=e.userIDList.slice(0,50)),e.groupID),a=e.userIDList,l=this._grpM.getLocalGroupProfile(r);if(l&&nn(l.type))return A({code:l=F.OPERATION_NOT_SUPPORTED_IN_AV,message:this._grpM.getErrMsg(l,n)});var d=new K(n);return d.setMessage(s),this._getGroupMemberProfileAdvance(c(c({},e),{},{userIDList:a})).then(function(h){return h=h.data.members,_e(h)&&h.length!==0?(t._updateLocalGroupMemberMap(r,h),t._grpM.get(4).getUserProfile({userIDList:h.map(function(g){return g.userID}),tagList:[Ve.NICK,Ve.AVATAR]})):Pe([])}).then(function(h){return h=h.data.map(function(g){return{userID:g.userID,nick:g.nick,avatar:g.avatar}}),t._updateLocalGroupMemberMap(r,h),h=a.filter(function(g){return t.hasLocalGroupMember(r,g)}).map(function(g){return t.getLocalGroupMemberInfo(r,g)}),d.end(),me({memberList:h})})}},{key:"addGroupMember",value:function(e){var t=this,n="".concat(this._n,".").concat("addGroupMember"),s=e.groupID,r=this._grpM.getLocalGroupProfile(s),a=r.type,l=new K("addGroupMember");return l.setMessage("groupID:".concat(s," groupType:").concat(a)),nn(a)?(a=new yt({code:F.CANNOT_ADD_MEMBER_IN_AV}),l.setError(a).end(),A(a)):(e.userIDList=e.userIDList.map(function(d){return{userID:d}}),m.l("".concat(n," groupID:").concat(s)),this._grpM.req({P:E.ADD_GRP_MBR,data:e}).then(function(M){var M=M.data.members,h=(m.l("".concat(n," ok")),M.filter(function(D){return D.result===1}).map(function(D){return D.userID})),g=M.filter(function(D){return D.result===0}).map(function(D){return D.userID}),_=M.filter(function(D){return D.result===2}).map(function(D){return D.userID}),M=M.filter(function(D){return D.result===4}).map(function(D){return D.userID}),S="groupID:".concat(e.groupID,", ")+"successUserIDList:".concat(h,", ")+"failureUserIDList:".concat(g,", ")+"existedUserIDList:".concat(_,", ")+"overLimitUserIDList:".concat(M);return l.setMoreMessage(S).end(),h.length===0?me({successUserIDList:h,failureUserIDList:g,existedUserIDList:_,overLimitUserIDList:M}):(t._updateConvGroupProfile(r),me({successUserIDList:h,failureUserIDList:g,existedUserIDList:_,overLimitUserIDList:M,group:r}))}).catch(function(d){return l.setError(d).end(),m.e("".concat(n," failed. error:"),d),A(d)}))}},{key:"deleteGroupMember",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteGroupMember"),s=e.groupID,r=e.userIDList,a=this._grpM.getLocalGroupProfile(s);if(H(a))return A({code:F.CANNOT_FIND_GRP});if(nn(a.type))return this._grpM.canIUse(he.AV_BAN_MBR)?this._banAVChatRoomMember(e):this._grpM.noUse("deleteGroupMember");var l="groupID:".concat(s," ").concat(5<r.length?"userIDList.length:".concat(r.length):"userIDList:".concat(r)),d=(m.l("".concat(n," groupID:").concat(s," userIDList:"),r),new K("deleteGroupMember"));return d.setMessage(l),this._grpM.req({P:E.DEL_GRP_MBR,data:e}).then(function(){return d.end(),m.l("".concat(n," ok")),t._updateConvGroupProfile(a),t.deleteLocalGroupMembers(s,r),me({group:a,userIDList:r})}).catch(function(h){return d.setError(h).end(),m.e("".concat(n," failed. error:"),h),A(h)})}},{key:"_updateConvGroupProfile",value:function(e){this._grpM.get(11).updateConvGroupProfile([e])}},{key:"_banAVChatRoomMember",value:function(e){var t=this,n="".concat(this._n,".").concat("_banAVChatRoomMember"),s=e.groupID,r=e.userIDList,a="groupID:".concat(s," ").concat(5<r.length?"userIDList.length:".concat(r.length):"userIDList:".concat(r)),l=new K("_banAVChatRoomMember"),d=(l.setMessage(a),m.l("".concat(n," groupID:").concat(s," userIDList:"),r),this._grpM.getLocalGroupProfile(s));return H(e.duration)||e.duration===0?A({code:F.BAN_DURATION_INVALID}):this._grpM.req({P:E.BAN_AV_MBR,data:e}).then(function(){return l.end(),m.l("".concat(n," ok")),t.deleteLocalGroupMembers(s,r),me({group:d,userIDList:r})}).catch(function(h){return l.setError(h).end(),m.e("".concat(n," failed. error:"),h),A(h)})}},{key:"setGroupMemberMuteTime",value:function(r){var t=this,n=r.groupID,s=r.userID,r=r.muteTime,a="".concat(this._n,".").concat("setGroupMemberMuteTime");if(s===this._grpM.getMyUserID())return A({code:F.CANNOT_MUTE_SELF});var l="groupID:".concat(n," userID:").concat(s," muteTime:").concat(r),d=(m.l("".concat(a," ").concat(l)),new K("setGroupMemberMuteTime"));return d.setMessage(l),this.modifyGroupMemberInfo({groupID:n,userID:s,muteTime:r}).then(function(h){d.end(),m.l("".concat(a," ok"));var g=t._grpM.getLocalGroupProfile(n);return me({group:g,member:h})}).catch(function(h){return d.setError(h).end(),m.e("".concat(a," failed. error:"),h),A(h)})}},{key:"setGroupMemberRole",value:function(r){var t="".concat(this._n,".").concat("setGroupMemberRole"),n=r.groupID,s=r.userID,r=r.role,a="groupID:".concat(n," userID:").concat(s," role:").concat(r),l=this._grpM.getLocalGroupProfile(n);if(l&&l.selfInfo.role!==I.GRP_MBR_ROLE_OWNER)return A({code:F.NOT_OWNER});var d=[I.GRP_MBR_ROLE_ADMIN,I.GRP_MBR_ROLE_MEMBER];if(rn({groupID:n})&&d.push(I.GRP_MBR_ROLE_CUSTOM),d.indexOf(r)<0)return A({code:F.INVALID_MEMBER_ROLE});if(s===this._grpM.getMyUserID())return A({code:F.CANNOT_SET_SELF_MEMBER_ROLE});var h=new K("setGroupMemberRole");return h.setMessage(a),m.l("".concat(t," ").concat(a)),this.modifyGroupMemberInfo({groupID:n,userID:s,role:r}).then(function(g){return h.end(),m.l("".concat(t," ok")),me({group:l,member:g})}).catch(function(g){return h.setError(g).end(),m.e("".concat(t," failed. error:"),g),A(g)})}},{key:"_filterProfanity",value:function(e,t){var s=this._grpM.get(29);if(!s)return!0;var s=s.filterText(t[e],"group_member_profile"),n=s.isAllowedToSend,s=s.modifiedText;return n===!0&&(t[e]=s,!0)}},{key:"setGroupMemberNameCard",value:function(h){var t=this,n="setGroupMemberNameCard",s="".concat(this._n,".").concat(n);if(h.nameCard&&this._filterProfanity("nameCard",h)===!1)return A({code:F.PROFANITY_FOUND});var r=h.groupID,d=h.userID,a=d===void 0?this._grpM.getMyUserID():d,l=h.nameCard,d="groupID:".concat(r," userID:").concat(a," nameCard:").concat(l),h=(m.l("".concat(s," ").concat(d)),this._grpM.getLocalGroupProfile(r));if(h&&nn(h.type))return A({code:h=F.OPERATION_NOT_SUPPORTED_IN_AV,message:this._grpM.getErrMsg(h,n)});var g=new K(n);return g.setMessage(d),this.modifyGroupMemberInfo({groupID:r,userID:a,nameCard:l}).then(function(_){m.l("".concat(s," ok")),g.end();var M=t._grpM.getLocalGroupProfile(r);return a===t._grpM.getMyUserID()&&M&&M.setSelfNameCard(l),me({group:M,member:_})}).catch(function(_){return g.setError(_).end(),m.e("".concat(s," failed. error:"),_),A(_)})}},{key:"setGroupMemberCustomField",value:function(l){var t=this,n="setGroupMemberCustomField",s="".concat(this._n,".").concat(n),r=l.groupID,a=l.userID,a=a===void 0?this._grpM.getMyUserID():a,l=l.memberCustomField,d="groupID:".concat(r," userID:").concat(a," memberCustomField:").concat(JSON.stringify(l)),h=(m.l("".concat(s," ").concat(d)),this._grpM.getLocalGroupProfile(r));if(h&&nn(h.type))return A({code:h=F.OPERATION_NOT_SUPPORTED_IN_AV,message:this._grpM.getErrMsg(h,n)});var g=new K(n);return g.setMessage(d),this.modifyGroupMemberInfo({groupID:r,userID:a,memberCustomField:l}).then(function(_){g.end(),m.l("".concat(s," ok"));var M=t._grpM.getLocalGroupProfile(r);return me({group:M,member:_})}).catch(function(_){return g.setError(_).end(),m.e("".concat(s," failed. error:"),_),A(_)})}},{key:"modifyGroupMemberInfo",value:function(e){var t=this,n=e.groupID,s=e.userID,r=void 0;return Vt(n)&&(n=wt(r=n)),this._grpM.req({P:E.MODIFY_GRP_MBR_INFO,data:c(c({},e),{},{groupID:n,topicID:r})}).then(function(){if(t.hasLocalGroupMember(n,s))return a=t.getLocalGroupMemberInfo(n,s),H(e.muteTime)||a.updateMuteUntil(e.muteTime),H(e.role)||a.updateRole(e.role),H(e.nameCard)||a.updateNameCard(e.nameCard),H(e.memberCustomField)||a.updateMemberCustomField(e.memberCustomField),a;var a=t._grpM.getLocalGroupProfile(n);return a&&!nn(a.type)?t.getGroupMemberProfile({groupID:n,userIDList:[s]}).then(function(l){return te(l.data.memberList,1)[0]}):void 0})}},{key:"markGroupMemberList",value:function(a){var t="".concat(this._n,".").concat("markGroupMemberList"),n=a.groupID,s=a.markType,h=a.enableMark,a=a.userIDList,r=a===void 0?[]:a,a="groupID:".concat(n," markType:").concat(s," enableMark:").concat(h," userIDList count:").concat(r.length),l=(m.l("".concat(t," ").concat(a)),2),d=[],h=(h===!0&&(l=1),q(r)),g=(500<r.length&&(h=r.slice(0,500),m.w("".concat(t," ").concat(os(500)))),h.forEach(function(_){d.push({userID:_,markType:[s]})}),h=null,new K("markGroupMemberList"));return g.setMessage(a),this._grpM.req({P:E.MARK_AV_MBR_INFO,data:{groupID:n,operationType:l,memberList:d}}).then(function(D){var D=D.data.memberList,D=D===void 0?[]:D,M=[],S=[],D=(D.length===r.length?M.push.apply(M,q(r)):(D.forEach(function(O){M.push(O.userID)}),r.forEach(function(O){M.includes(O)||S.push(O)})),"success count:".concat(M.length," fail count:").concat(S.length));return g.setMessage(D).end(),m.l("".concat(t," ok. ").concat(D)),me({successUserIDList:M,failureUserIDList:S})}).catch(function(_){return g.setError(_).end(),m.e("".concat(t," failed. error:"),_),A(_)})}},{key:"_getGroupMemberProfileAdvance",value:function(e){return this._grpM.req({P:E.GET_GRP_MBR_PROFILE,data:c(c({},e),{},{memberInfoFilter:e.memberInfoFilter||this.DEFAULT_MEMBER_INFO_FILTER})})}},{key:"_updateLocalGroupMemberMap",value:function(e,t){var n=this;return _e(t)&&t.length!==0?t.map(function(s){return n.hasLocalGroupMember(e,s.userID)?n.getLocalGroupMemberInfo(e,s.userID).updateMember(s):n.setLocalGroupMember(e,new By(s)),n.getLocalGroupMemberInfo(e,s.userID)}):[]}},{key:"deleteLocalGroupMembers",value:function(e,t){var n=this.groupMemberListMap.get(e);n&&t.forEach(function(s){n.delete(s)})}},{key:"getLocalGroupMemberInfo",value:function(e,t){return this.groupMemberListMap.has(e)?this.groupMemberListMap.get(e).get(t):null}},{key:"setLocalGroupMember",value:function(e,t){this.groupMemberListMap.has(e)?this.groupMemberListMap.get(e).set(t.userID,t):(t=new Map().set(t.userID,t),this.groupMemberListMap.set(e,t))}},{key:"getLocalGroupMemberList",value:function(e){return this.groupMemberListMap.get(e)}},{key:"hasLocalGroupMember",value:function(e,t){return this.groupMemberListMap.has(e)&&this.groupMemberListMap.get(e).has(t)}},{key:"hasLocalGroupMemberMap",value:function(e){return this.groupMemberListMap.has(e)}},{key:"reset",value:function(){this.groupMemberListMap.clear()}}]),Ou),Ky=[17,18,20],jy=(y(Au,[{key:"onNewGroupSystemNotice",value:function(n){var r=n.dataList,t=n.isSyncingEnded,n=n.isInstantMessage,r=(m.d("".concat(this._n,".onReceiveSystemNotice count:").concat(r.length)),this._assembly({notifiesList:r,isInstantMessage:n})),s=r.eventDataList,r=r.result;0<s.length&&(this._grpM.get(11).onNewMessage({conversationOptionsList:s,isInstantMessage:n}),this._onReceivedGroupSystemNotice({result:r,isInstantMessage:n})),n?0<r.length&&this._grpM.emitOEvt($.MESSAGE_RECEIVED,r):t===!0&&this._clearGroupSystemNotice()}},{key:"_assembly",value:function(e){for(var t=e.notifiesList,n=e.isInstantMessage,s=null,r=t.length,d=0,a=[],l={conversationID:I.CONV_SYSTEM,unreadCount:0,type:I.CONV_SYSTEM,subType:null,lastMessage:null},d=0;d<r;d++){var h=t[d],_=h.groupProfile,g=_.communityType,_=_.topicID,_=_===void 0?void 0:_,S=h.elements,M=S.topicIDList,M=M===void 0?void 0:M,S=S.operationType;if(!((g===void 0?0:g)!==2||se(_)&&se(M))){if(Ky.includes(S)){this._handleTopicSystemNotice(h);continue}se(_)||(h.to=_)}h.elements.operationType!==15&&(h.currentUser=this._grpM.getMyUserID(),h.conversationType=I.CONV_SYSTEM,h.conversationID=I.CONV_SYSTEM,(s=new Bt(h)).setElement({type:I.MSG_GRP_SYS_NOTICE,content:c(c({},h.elements),{},{groupProfile:c({},h.groupProfile)})}),s.isSystemMessage=!0,(s.sequence===1&&s.random===1||s.sequence===2&&s.random===2)&&(s.sequence=wn(),s.random=wn(),s.generateMessageID(),m.l("".concat(this._n,"._assembly regenerate ID:").concat(s.ID))),this._grpM.get(11).pushIntoNoticeResult(a,s)&&(n?l.unreadCount++:s.setIsRead(!0),l.subType=s.conversationSubType))}return l.lastMessage=a[a.length-1],{eventDataList:0<a.length?[l]:[],result:a}}},{key:"_clearGroupSystemNotice",value:function(){var e=this;this._getPendencyList().then(function(n){n.forEach(function(r){e.pendencyMap.set("".concat(r.from,"_").concat(r.groupID,"_").concat(r.to),r)});var n=e._grpM.get(11).getLocalMessageList(I.CONV_SYSTEM),s=[];n.forEach(function(r){var d=r.payload,a=d.operatorID,l=d.operationType,d=d.groupProfile;l===1&&(l="".concat(a,"_").concat(d.groupID,"_").concat(d.to),(a=e.pendencyMap.get(l))&&Qe(a.handled)&&a.handled!==0&&s.push(r))}),e.deleteGroupSystemNotice({messageList:s})})}},{key:"deleteGroupSystemNotice",value:function(e){var t=this,n="".concat(this._n,".deleteGroupSystemNotice");return _e(e.messageList)&&e.messageList.length!==0?(m.l("".concat(n," ")+e.messageList.map(function(s){return s.ID})),this._grpM.req({P:E.DEL_GRP_SYSTEM_NOTICE,data:{messageListToDelete:e.messageList.map(function(s){return{from:I.CONV_SYSTEM,messageSeq:s.clientSequence,messageRandom:s.random}})}}).then(function(){m.l("".concat(n," ok"));var s=t._grpM.get(11);return e.messageList.forEach(function(r){s.deleteLocalMessage(r)}),me()}).catch(function(s){return m.e("".concat(n," error:"),s),A(s)})):Pe()}},{key:"_getPendencyList",value:function(){var e=this,s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},t=s.type,n=s.startTime,s=s.limit;return this._grpM.req({P:E.GET_GRP_PENDENCY,data:{type:t===void 0?void 0:t,startTime:n===void 0?0:n,limit:s===void 0?20:s,handleAccount:this._grpM.getMyUserID()}}).then(function(r){var a=r.data.pendencyList;return r.data.nextStartTime!==0?e._getPendencyList({startTime:r.data.nextStartTime}).then(function(l){return[].concat(q(a),q(l))}):a})}},{key:"getGroupApplicationList",value:function(){var e=this;return this._getPendencyList().then(function(t){return e._getPendencyList({type:I.GRP_COMMUNITY}).then(function(n){return t.push.apply(t,q(n)),e._handlePendencyResult(t)}).catch(function(n){return e._handlePendencyResult(t)})})}},{key:"_handlePendencyResult",value:function(e){var t=this,n=[];return e.forEach(function(s){t.pendencyMap.set("".concat(s.from,"_").concat(s.groupID,"_").concat(s.to),s),s.handled===0&&n.push({applicant:s.from,applicantNick:s.fromUserNickName,groupName:s.groupName,groupID:s.groupID,authentication:s.authentication,messageKey:s.time,applicationType:s.applicationType,userID:s.userID,note:s.note})}),Pe({applicationList:n})}},{key:"_onReceivedGroupSystemNotice",value:function(e){var t=this,n=e.result;e.isInstantMessage&&n.forEach(function(s){switch(s.payload.operationType){case 1:break;case 2:t._onApplyJoinGroup(s);break;case 3:break;case 4:t._onMemberKicked(s);break;case 5:t._onGroupDismissed(s);break;case 6:break;case 7:t._onInviteGroup(s);break;case 8:t._onQuitGroup(s);break;case 9:t._onSetManager(s);break;case 10:t._onDeleteManager(s);break;case 11:case 12:case 15:break;case 20:t._onMessageRemindTypeSynced(s);break;case 21:t._grpM.onAVChatRoomMemberBanned(s)}})}},{key:"_onApplyJoinGroup",value:function(s){var t=this,s=s.payload.groupProfile,n=s.groupID,s=s.groupType,r=this._grpM.hasLocalGroup(n);m.l("".concat(this._n,"._onApplyJoinGroup groupID:").concat(n," groupType:").concat(s," hasGroup:").concat(r)),r||nn(s)||this._grpM.getGroupProfile({groupID:n}).then(function(l){var l=l.data.group;l&&(t._grpM.updateGroupMap([l]),l=!l.isSupportTopic,t._grpM.emitGroupListUpdate(!0,l))})}},{key:"_onMemberKicked",value:function(e){e=e.payload.groupProfile.groupID,this._grpM.hasLocalGroup(e)&&this._grpM.deleteLocalGroupAndConversation(e)}},{key:"_onGroupDismissed",value:function(t){var t=t.payload.groupProfile.groupID,n=(this._grpM.hasLocalGroup(t)&&this._grpM.deleteLocalGroupAndConversation(t),this._grpM._AVChatRoomHandler);n&&n.checkJoinedAVChatRoomByID(t)&&n.reset(t)}},{key:"_onInviteGroup",value:function(s){var t=this,n=s.payload.groupProfile.groupID,s=this._grpM.hasLocalGroup(n);m.l("".concat(this._n,"._onInviteGroup groupID:").concat(n," hasGroup:").concat(s)),this._grpM.getGroupProfile({groupID:n}).then(function(){t._grpM.emitGroupListUpdate(),t._grpM.get(11).pullMsgOnInvite("".concat(I.CONV_GROUP).concat(n))})}},{key:"_onQuitGroup",value:function(n){var n=n.payload.groupProfile,t=n.groupID,n=n.groupType,s=this._grpM.hasLocalGroup(t);m.l("".concat(this._n,"._onQuitGroup groupID:").concat(t," groupType:").concat(n," hasGroup:").concat(s)),s&&this._grpM.deleteLocalGroupAndConversation(t)}},{key:"_onSetManager",value:function(n){var n=n.payload.groupProfile,t=n.to,n=n.groupID,n=this._grpM.getGroupMemberHandler().getLocalGroupMemberInfo(n,t);n&&n.updateRole(I.GRP_MBR_ROLE_ADMIN)}},{key:"_onDeleteManager",value:function(n){var n=n.payload.groupProfile,t=n.to,n=n.groupID,n=this._grpM.getGroupMemberHandler().getLocalGroupMemberInfo(n,t);n&&n.updateRole(I.GRP_MBR_ROLE_MEMBER)}},{key:"_onMessageRemindTypeSynced",value:function(n){var t=n.payload.groupProfile.groupID,n=n.payload.messageRemindType;this._grpM.get(11).onGroupMsgRemindTypeUpdated({groupID:t,messageRemindType:n})}},{key:"_handleTopicSystemNotice",value:function(a){var n=a.groupProfile,t=n.groupID,n=n.topicID,a=a.elements,s=a.operationType,r=a.topicIDList,a=a.messageRemindType,l=this._grpM.get(10);s===17?l.onTopicCreated({groupID:t,topicID:n}):s===18?l.onTopicDeleted({groupID:t,topicIDList:r}):s===20&&l.onMessageRemindTypeUpdated({groupID:t,topicID:n,messageRemindType:a})}},{key:"reset",value:function(){this.pendencyMap.clear()}}]),Au),Wy=["relayFlag"],Yy=(T(Vr,St),Mf=z(Vr),y(Vr,[{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("polling_interval"),t=this.getCloudConfig("polling_interval_plus"),n=this.getCloudConfig("polling_no_msg_count"),s=this.getCloudConfig("polling_simplified_msg"),r=this.getCloudConfig("paging_grp_count");m.l("".concat(this._n,"._onCloudConfig pollingInterval:").concat(e)+" pollingIntervalPlus:".concat(t," pollingNoMessageCount:").concat(n)+" pollingSimplifiedMessage:".concat(s," pagingGroupCount:").concat(r)),this._AVChatRoomHandler.setPollingInterval(e),this._AVChatRoomHandler.setPollingIntervalPlus(t),this._AVChatRoomHandler.setPollingNoMessageCount(n),this._AVChatRoomHandler.setPollingSimplifiedMessage(s),this._commonGroupHandler.setPagingGroupCount(r)}},{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&(this._commonGroupHandler.onCheckTimer(e),this._groupTipsHandler.onCheckTimer(e))}},{key:"guardForAVChatRoom",value:function(e){var t,n=this;return e.conversationType===I.CONV_GROUP?(t=Vt(e.to)?wt(e.to):e.to,this.hasLocalGroup(t)?Pe():this.getGroupProfile({groupID:t}).then(function(r){var r=r.data.group.type;return m.l("".concat(n._n,".guardForAVChatRoom. groupID:").concat(t," type:").concat(r)),r===I.GRP_AVCHATROOM?A(new yt({code:r=F.MSG_SEND_FAIL_NOT_IN_AV,message:n.getErrMsg(r,e.from,t),data:{message:e}})):Pe()})):Pe()}},{key:"checkJoinedAVChatRoomByID",value:function(e){return this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e)}},{key:"onNewMessage",value:function(e){this._commonGroupHandler.onNewMessage(e)}},{key:"updateNextMessageSeq",value:function(e){var t,n=this;_e(e)&&(t=this.get(10),e.forEach(function(s){var r=s.conversationID.replace(I.CONV_GROUP,"");Vt(r)&&t.updateUnreadCountAndLastMsg(r,s.lastMessage),n.groupMap.has(r)&&(n.groupMap.get(r).nextMessageSeq=s.lastMessage.sequence+1)}))}},{key:"onNewGroupTips",value:function(e){this._groupTipsHandler.onNewGroupTips(e)}},{key:"onMsgRevoked",value:function(e){this._commonGroupHandler.onMsgRevoked(e,!(1<arguments.length&&arguments[1]!==void 0)||arguments[1])}},{key:"onNewGroupSystemNotice",value:function(e){this._groupSystemNoticeHandler.onNewGroupSystemNotice(e)}},{key:"onMsgReadNotice",value:function(e){var t=this;e.dataList.forEach(function(r){var s,r=r.elements.groupMessageReadNotice;H(r)||(s=t.get(11),r.forEach(function(d){var h=d.groupID,l=d.topicID,l=l===void 0?void 0:l,d=d.lastMessageSeq,h=(m.l("".concat(t._n,".onMsgReadNotice groupID:").concat(h," lastMessageSeq:").concat(d)),"".concat(I.CONV_GROUP).concat(h)),g=!0;se(l)||(h="".concat(I.CONV_GROUP).concat(l),g=!1),s.updateIsReadAfterReadReport({conversationID:h,lastMessageSeq:d}),s.updateUnreadCount(h,g),s.clearGroupAtInfoList(h,g)}))})}},{key:"onReadReceiptList",value:function(e){var t=this;m.l("".concat(this._n,".onReadReceiptList options:"),e),e.dataList.forEach(function(a){var s=a.groupProfile,a=a.elements,s=s.groupID,r=t.get(11),a=a.readReceiptList;r.updateReadReceiptInfo({groupID:s,readReceiptList:a})})}},{key:"onMsgModified",value:function(e){m.l("".concat(this._n,".onMsgModified options:"),e);var t=this.get(11);e.dataList.forEach(function(n){t.onMessageModified(c(c({},n),{},{conversationType:I.CONV_GROUP,to:n.topicID||n.groupID}))})}},{key:"deleteGroupSystemNotice",value:function(e){this._groupSystemNoticeHandler.deleteGroupSystemNotice(e)}},{key:"initGroupMap",value:function(e){this.groupMap.set(e.groupID,new co(e))}},{key:"clearGroupMap",value:function(){this.groupMap.clear()}},{key:"deleteGroup",value:function(e){this.groupMap.delete(e)}},{key:"updateGroupMap",value:function(e){var t,n=this,s=this.get(11);e.forEach(function(h){t=h.groupID,n.groupMap.has(t)?n.groupMap.get(t).updateGroup(h):(n.groupMap.set(t,new co(h)),s.deleteGroupRoamingInfo(t))});var r,a=this.getMyUserID(),l=ye(this.groupMap);try{for(l.s();!(r=l.n()).done;){var d=te(r.value,2)[1];d.selfInfo.userID=a,d.selfInfo.role==="Owner"&&(d.ownerID=a)}}catch(h){l.e(h)}finally{l.f()}}},{key:"getGroupMap",value:function(){return this.groupMap}},{key:"getLocalGroupList",value:function(){return q(this.groupMap.values()).filter(function(e){return e.type!==I.GRP_ROOM&&e.type!==I.GRP_LIVE})}},{key:"getLocalGroupProfile",value:function(e){return this.groupMap.get(e)}},{key:"sortLocalGroupList",value:function(){var e=q(this.groupMap).filter(function(t){return t=te(t,2),t[0],!se(t[1].lastMessage)});e.sort(function(t,n){return n[1].lastMessage.lastTime-t[1].lastMessage.lastTime}),this.groupMap=new Map(q(e))}},{key:"updateGroupLastMessage",value:function(e){this._commonGroupHandler.updateLastMsg(e)}},{key:"emitGroupListUpdate",value:function(){var e=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],t=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],n=this.getLocalGroupList();e&&this.emitOEvt($.GROUP_LIST_UPDATED),t&&(e=JSON.parse(JSON.stringify(n)),this.get(11).updateConvGroupProfile(e))}},{key:"getMyNameCardByGroupID",value:function(e){return e=this.getLocalGroupProfile(e),e?e.selfInfo.nameCard:""}},{key:"isPagingGetCompleted",value:function(){return this._commonGroupHandler.isPagingGetCompleted()}},{key:"getMsgRemindType",value:function(e){var t=this;return!_e(e)||e.length===0?Promise.resolve():(e=e.filter(function(n){return!nn(t.getLocalGroupProfile(n).type)}),e.length===0?Promise.resolve():(m.l("".concat(this._n,".getMsgRemindType groupIDList:").concat(e)),this.getGroupProfileAdvance({groupIDList:e,responseFilter:{memberInfoFilter:["MsgFlag"]}}).then(function(s){var s=s.data.successGroupList,r=t.get(11);s.forEach(function(a){r.onGroupMsgRemindTypeUpdated({groupID:a.groupID,messageRemindType:_e(a.members)?a.members[0].messageRemindType:""})})})))}},{key:"getGroupList",value:function(){return this._commonGroupHandler.getGroupList()}},{key:"syncCommunityWithTopic",value:function(){return this._commonGroupHandler.syncGroupList(!0)}},{key:"getGroupProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("getGroupProfile"),s=new K("getGroupProfile"),r=e.groupID,a=e.groupCustomFieldFilter,a=(m.l("".concat(n," groupID:").concat(r)),{groupIDList:[r],responseFilter:{groupBaseInfoFilter:q($e),groupCustomFieldFilter:a,memberInfoFilter:[].concat(q(Xe),["NameCard"])}});return this.getGroupProfileAdvance(a).then(function(h){var h=h.data,d=h.successGroupList,h=h.failureGroupList;return m.l("".concat(n," ok")),0<h.length?A(h[0]):((h=nn(d[0].type)&&!t.hasLocalGroup(r)?new co(d[0]):(t.updateGroupMap(d),t.getLocalGroupProfile(r))).isSupportTopic||t.get(11).updateConvGroupProfile([h]),s.setMessage("groupID:".concat(r," type:").concat(h.type," muteAllMembers:").concat(h.muteAllMembers," ownerID:").concat(h.ownerID)).end(),me({group:h}))}).catch(function(l){return s.setError(l).setMessage("groupID:".concat(e.groupID)).end(),m.e("".concat(n," failed. error:"),l),A(l)})}},{key:"getGroupProfileAdvance",value:function(e){var t,n="".concat(this._n,".getGroupProfileAdvance"),a=e.groupIDList,s=(_e(a)&&50<a.length&&(this.warn("GetGroupProfileLimit"),a.length=50),[]),r=[],a=(a.forEach(function(l){(rn({groupID:l})?r:s).push(l)}),[]);return 0<s.length&&(t=this._getGroupProfileAdvance(c(c({},e),{},{groupIDList:s})),a.push(t)),0<r.length&&(t=this._getGroupProfileAdvance(c(c({},e),{},{groupIDList:r,relayFlag:0<s.length})),a.push(t)),Promise.all(a).then(function(l){var d=[],h=[];return l.forEach(function(g){d.push.apply(d,q(g.successGroupList)),h.push.apply(h,q(g.failureGroupList))}),me({successGroupList:d,failureGroupList:h})}).catch(function(l){return m.e("".concat(n," failed. error:"),l),A(l)})}},{key:"_getGroupProfileAdvance",value:function(e){var t=this,n=e.relayFlag,s=n!==void 0&&n,r=G(e,Wy);return this.req({P:E.GET_GRP_PROFILE,data:r}).then(function(a){return m.l("".concat(t._n,"._getGroupProfileAdvance ok. options:"),r),a=a.data.groups,{successGroupList:a.filter(function(l){return H(l.errorCode)||l.errorCode===0}),failureGroupList:a.filter(function(l){return l.errorCode&&l.errorCode!==0}).map(function(l){return new yt({code:l.errorCode,message:l.errorInfo,data:{groupID:l.groupID}})})}}).catch(function(a){return s&&rn({groupID:e.groupIDList[0]})?{successGroupList:[],failureGroupList:[]}:A(a)})}},{key:"createGroup",value:function(e){var t=this,n=[I.GRP_PUBLIC,I.GRP_WORK,I.GRP_MEETING,I.GRP_AVCHATROOM,I.GRP_COMMUNITY],s="".concat(this._n,".").concat("createGroup"),r=e.type,a=e.groupID;if(e.name&&this._filterProfanity("name",e)===!1)return A({code:F.PROFANITY_FOUND});if(e.introduction&&this._filterProfanity("introduction",e)===!1)return A({code:F.PROFANITY_FOUND});if(e.notification&&this._filterProfanity("notification",e)===!1)return A({code:F.PROFANITY_FOUND});if(!n.includes(r))return A({code:F.ILLEGAL_GRP_TYPE});if(!rn({type:r})){if(!se(a)&&rn({groupID:a}))return A({code:F.ILLEGAL_GRP_ID});e.isSupportTopic=void 0}if(nn(r)&&!H(e.memberList)&&0<e.memberList.length&&(e.memberList=void 0),this._canIUseJoinOption(r)||H(e.joinOption)||(e.joinOption=void 0),rn({type:r})){if(!se(a)&&!rn({groupID:a}))return A({code:F.ILLEGAL_GRP_ID});e.isSupportTopic=e.isSupportTopic===!0?1:0}var l=new K("createGroup"),d=(m.l("".concat(s," options:"),e),null),h=[];return this.req({P:E.CREATE_GRP,data:c(c({},e),{},{ownerID:this.getMyUserID(),webPushFlag:1})}).then(function(S){var S=S.data,_=S.groupID,S=S.overLimitUserIDList,M=S===void 0?[]:S,S=(d=_,h=M,"groupType:".concat(e.type," groupID:").concat(_," overLimitUserIDList:").concat(M));if(l.setMessage(S).end(),m.l("".concat(s," ok. ").concat(S)),e.type===I.GRP_AVCHATROOM)return t.getGroupProfile({groupID:_});if(e.type===I.GRP_COMMUNITY&&e.isSupportTopic===1)return t.getGroupProfile({groupID:_});se(e.memberList)||se(M)||(e.memberList=e.memberList.filter(function(U){return M.indexOf(U.userID)===-1})),t.updateGroupMap([c(c({},e),{},{groupID:_})]);var S=t.get(2),B="",D=0,O=(e.type===I.GRP_COMMUNITY?(B=t.isIntl()?"Create Community":"",D=1):B=t.isIntl()?"Create Group":"",t.get(4).getMyNick()),B=S.createCustomMessage({to:_,conversationType:I.CONV_GROUP,payload:{data:JSON.stringify({businessID:"group_create",content:B,cmd:D,opUser:O||t.getMyUserID(),version:4})}});return S.sendMessageInstance(B),t.emitGroupListUpdate(),t.getGroupProfile({groupID:_})}).then(function(_){var _=_.data.group,S=_.selfInfo,M=S.nameCard,S=S.joinTime;return _.updateSelfInfo({nameCard:M,joinTime:S,messageRemindType:I.MSG_REMIND_ACPT_AND_NOTE,role:I.GRP_MBR_ROLE_OWNER}),me({group:_,overLimitUserIDList:h})}).catch(function(g){var _;return l.setMessage("groupType:".concat(e.type)).setError(g).end(),g.code===10010||g.code===10007?(t._silentlyGetGroupProfile(g.code,d),t.updateGroupMap([c(c({},e),{},{groupID:d})]),(_=t.getLocalGroupProfile(d)).selfInfo.role=I.GRP_MBR_ROLE_OWNER,me({group:_,overLimitUserIDList:h})):(m.e("".concat(s," failed. error:"),g),A(g))})}},{key:"dismissGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("dismissGroup"),s="groupID:".concat(e),r=new K("dismissGroup");return r.setMessage(s),m.l("".concat(n," ").concat(s)),this.req({P:E.DISMISS_GRP,data:{groupID:e}}).then(function(){return r.end(),m.l("".concat(n," ok")),t.deleteLocalGroupAndConversation(e),t.checkJoinedAVChatRoomByID(e)&&t._AVChatRoomHandler.reset(e),t._groupAttributesHandler.deleteLocalGroupAttributes(e),me({groupID:e})}).catch(function(a){return r.setError(a).end(),m.e("".concat(n," failed. error:"),a),A(a)})}},{key:"updateGroupProfile",value:function(e){var t,n=this,s="".concat(this._n,".").concat("updateGroupProfile");if(this.hasLocalGroup(e.groupID)&&(t=this.getLocalGroupProfile(e.groupID).type,this._canIUseJoinOption(t)||H(e.joinOption)||(m.w("".concat(s," joinOption is unavailable for Work/Meeting/AVChatRoom")),e.joinOption=void 0)),H(e.muteAllMembers)||(e.muteAllMembers?e.muteAllMembers="On":e.muteAllMembers="Off"),e.name&&this._filterProfanity("name",e)===!1)return A({code:F.PROFANITY_FOUND});if(e.introduction&&this._filterProfanity("introduction",e)===!1)return A({code:F.PROFANITY_FOUND});if(e.notification&&this._filterProfanity("notification",e)===!1)return A({code:F.PROFANITY_FOUND});var r=new K("updateGroupProfile");return r.setMessage(JSON.stringify(e)),m.l("".concat(s," groupID:").concat(e.groupID)),this.req({P:E.UPDATE_GRP_PROFILE,data:e}).then(function(){return r.end(),m.l("".concat(s," ok")),n.hasLocalGroup(e.groupID)&&n.groupMap.get(e.groupID).updateGroup(e),me({group:n.groupMap.get(e.groupID)})}).catch(function(a){return r.setError(a).end(),m.l("".concat(s," failed. error:"),a),A(a)})}},{key:"_filterProfanity",value:function(e,t){var s=this.get(29);if(!s)return!0;var s=s.filterText(t[e],Fe),n=s.isAllowedToSend,s=s.modifiedText;return n===!0&&(t[e]=s,!0)}},{key:"joinGroup",value:function(e){var t=this,n=e.groupID,s="".concat(this._n,".joinGroup");if(this.deleteUnjoinedAVChatRoom(n),this.hasLocalGroup(n)){if(!this.isLoggedIn())return Pe({status:I.JOIN_STATUS_ALREADY_IN_GROUP});var r=new K("applyJoinGroup");return this.getGroupProfile({groupID:n}).then(function(){return r.setMessage("groupID:".concat(n," joinedStatus:").concat(I.JOIN_STATUS_ALREADY_IN_GROUP)).end(),Pe({status:I.JOIN_STATUS_ALREADY_IN_GROUP})}).catch(function(a){return r.setMessage("groupID:".concat(n," unjoined")).end(),m.w("".concat(s," ").concat(n," was unjoined, now join!")),t.groupMap.delete(n),t.applyJoinGroup(e)})}return m.l("".concat(s," groupID:").concat(n)),this.isLoggedIn()?this.applyJoinGroup(e):this._AVChatRoomHandler.joinWithoutAuth(e)}},{key:"applyJoinGroup",value:function(a){var t=this,n="".concat(this._n,".").concat("applyJoinGroup"),s=a.groupID;if(!se(a.applyMessage)&&this._filterProfanity("applyMessage",a)===!1)return A({code:F.PROFANITY_FOUND});var r=new K("applyJoinGroup"),a=c({},a),l=this.canIUse(he.AV_HISTORY_MSG);return l&&(a.historyMessageFlag=1),this.get(11).deleteTopicRoamingInfo(s),this.req({P:E.APPLY_JOIN_GRP,data:a}).then(function(O){var O=O.data,h=O.joinedStatus,g=O.longPollingKey,_=O.startSeq,M=O.avChatRoomFlag,S=O.avChatRoomKey,D=O.messageList,O="groupID:".concat(s," joinedStatus:").concat(h," longPollingKey:").concat(g," startSeq:").concat(_)+" avChatRoomFlag:".concat(M," canGetAVChatRoomHistoryMsg:").concat(l,",")+" historyMsgCount:".concat(se(D)?0:D.length);switch(r.setMessage(O).end(),m.l("".concat(n," ok. ").concat(O)),h){case Up:return me({status:Up});case Gs:return t.getGroupProfile({groupID:s}).then(function(U){return U=U.data.group,t._handleJoinResult({group:U,avChatRoomFlag:M,longPollingKey:g,startSeq:_,avChatRoomKey:S,messageList:D})}).catch(function(U){var de;return U.code===10010||U.code===10007?(t._silentlyGetGroupProfile(U.code,s),de=new co({groupID:s}),t.updateGroupMap([de]),t._handleJoinResult({group:de,avChatRoomFlag:M,longPollingKey:g,startSeq:_,avChatRoomKey:S,messageList:D})):(m.e("".concat(n," failed. error:"),U),A(U))});default:var B=new yt({code:F.JOIN_GRP_FAIL});return m.e("".concat(n," failed. error:"),B),A(B)}}).catch(function(d){return r.setMessage("groupID:".concat(s)).setError(d).end(),m.e("".concat(n," failed. error:"),d),A(d)})}},{key:"_handleJoinResult",value:function(e){var t=this,n=e.group,s=e.avChatRoomFlag,r=e.longPollingKey,a=e.startSeq,l=e.avChatRoomKey,d=e.messageList,h=n.groupID;return s===1?(this.get(11).setCompleted("".concat(I.CONV_GROUP).concat(h)),this._groupAttributesHandler.initGroupAttributesCache({groupID:h,avChatRoomKey:l}),this._groupCountersHandler.initGroupCountersCache({groupID:h,avChatRoomKey:l}),(e=H(r)?this._AVChatRoomHandler.handleJoinResult({group:n}):this._AVChatRoomHandler.startRunLoop({group:n,longPollingKey:r,startSeq:a})).then(function(){t._onAVChatRoomHistoryMessage(d,h)}),e):(this.emitGroupListUpdate(!0,!1),me({status:Gs,group:n}))}},{key:"quitGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("quitGroup"),s="groupID:".concat(e),r=(m.l("".concat(n," ").concat(s)),this.checkJoinedAVChatRoomByID(e));if(!r&&!this.hasLocalGroup(e))return A({code:F.MEMBER_NOT_IN_GRP});if(r&&!this.isLoggedIn())return m.l("".concat(n," anonymously ok. ").concat(s)),this.deleteLocalGroupAndConversation(e),this._AVChatRoomHandler.reset(e),Pe({groupID:e});var a=new K("quitGroup");return a.setMessage(s),this.req({P:E.QUIT_GRP,data:{groupID:e}}).then(function(){return a.end(),m.l("".concat(n," ok")),t.deleteLocalGroupAndConversation(e),r&&t._AVChatRoomHandler.reset(e),t._groupAttributesHandler.deleteLocalGroupAttributes(e),me({groupID:e})}).catch(function(l){return a.setError(l).end(),m.e("".concat(n," failed. error:"),l),A(l)})}},{key:"searchGroupByID",value:function(e){var t="".concat(this._n,".").concat("searchGroupByID"),n={groupIDList:[e]},s=new K("searchGroupByID");return s.setMessage("groupID:".concat(e)),m.l("".concat(t," groupID:").concat(e)),this.req({P:E.SEARCH_GRP,data:n}).then(function(r){if(r=r.data.groupProfile,r[0].errorCode!==0)throw new yt({code:r[0].errorCode,message:r[0].errorInfo});return s.end(),m.l("".concat(t," ok")),me({group:new co(r[0])})}).catch(function(r){return s.setError(r).end(),m.w("".concat(t," failed. error:"),r),A(r)})}},{key:"changeGroupOwner",value:function(e){var t=this,n="".concat(this._n,".").concat("changeGroupOwner");if(this.hasLocalGroup(e.groupID)&&this.getLocalGroupProfile(e.groupID).type===I.GRP_AVCHATROOM)return A({code:F.CANNOT_CHANGE_OWNER_IN_AV});if(e.newOwnerID===this.getMyUserID())return A({code:F.CANNOT_CHANGE_OWNER_TO_SELF});var s=new K("changeGroupOwner");return s.setMessage("groupID:".concat(e.groupID," newOwnerID:").concat(e.newOwnerID)),m.l("".concat(n," groupID:").concat(e.groupID)),this.req({P:E.CHANGE_GRP_OWNER,data:e}).then(function(){s.end(),m.l("".concat(n," ok"));var r,a=e.groupID,l=e.newOwnerID,d=(t.groupMap.get(a).ownerID=l,t._groupMemberHandler.getLocalGroupMemberList(a));return d instanceof Map&&(r=d.get(t.getMyUserID()),H(r)||(r.updateRole("Member"),t.groupMap.get(a).selfInfo.role="Member"),r=d.get(l),H(r)||r.updateRole("Owner")),t.emitGroupListUpdate(!0,!1),me({group:t.groupMap.get(a)})}).catch(function(r){return s.setError(r).end(),m.e("".concat(n," failed. error:"),r),A(r)})}},{key:"getGroupApplicationList",value:function(){return this._groupSystemNoticeHandler.getGroupApplicationList()}},{key:"handleGroupApplication",value:function(e){var t,n,s,r,a,l=this,d="".concat(this._n,".").concat("handleGroupApplication"),h=e.handleAction,g=e.handleMessage,_=e.message,M=e.application,S=(_?(t=_.payload.operatorID,n=_.payload.groupProfile.groupID,s=_.payload.authentication,r=_.payload.messageKey):M&&(t=M.applicant,n=M.groupID,s=M.authentication,r=M.messageKey),E.HANDLE_GRP_APPLICATION),D=(M&&M.applicationType===2&&(S=E.HANDLE_INVITE_JOIN_GRP,a=M.userID),new K("handleGroupApplication"));return D.setMessage("groupID:".concat(n)),m.l("".concat(d," groupID:").concat(n)),this.req({P:S,data:{handleAction:h,handleMessage:g,applicant:t,invitee:a,groupID:n,authentication:s,messageKey:r}}).then(function(){return D.end(),m.l("".concat(d," ok")),_&&l._groupSystemNoticeHandler.deleteGroupSystemNotice({messageList:[e.message]}),me({group:l.getLocalGroupProfile(n)})}).catch(function(O){return D.setError(O).end(),m.e("".concat(d," failed. error"),O),A(O)})}},{key:"handleGroupInvitation",value:function(e){var t=this,n="".concat(this._n,".").concat("handleGroupInvitation"),l=e.message.payload,s=l.groupProfile.groupID,r=l.authentication,a=l.messageKey,l=l.operatorID,d=e.handleAction,h=new K("handleGroupInvitation");return h.setMessage("groupID:".concat(s," inviter:").concat(l," handleAction:").concat(d)),m.l("".concat(n," groupID:").concat(s," inviter:").concat(l," handleAction:").concat(d)),this.req({P:E.HANDLE_GRP_INVITATION,data:c(c({},e),{},{inviter:l,groupID:s,authentication:r,messageKey:a})}).then(function(){return h.end(),m.l("".concat(n," ok")),t._groupSystemNoticeHandler.deleteGroupSystemNotice({messageList:[e.message]}),me({group:t.getLocalGroupProfile(s)})}).catch(function(g){return h.setError(g).end(),m.e("".concat(n," failed. error"),g),A(g)})}},{key:"getGroupOnlineMemberCount",value:function(e){var t=this,n="".concat(this._n,".getGroupOnlineMemberCount"),s=this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e),r=this.hasLocalGroup(e);if(m.l("".concat(n," groupID:").concat(e," isAVChatRoom:").concat(s," has:").concat(r)),s)return this._AVChatRoomHandler.getGroupOnlineMemberCount(e);if(!r)return Pe({memberCount:0});if(s=Date.now(),this._onlineMemberCountMap.has(e)){if(r=this._onlineMemberCountMap.get(e),s-r.lastReqTime<=6e4)return Pe({memberCount:r.memberCount});r.lastReqTime=s}return this.requestOnlineCount(e).then(function(a){return a=a.data.memberCount,a=a===void 0?0:a,t._onlineMemberCountMap.set(e,{lastReqTime:Date.now(),memberCount:a}),m.l("".concat(n," ok. groupID:").concat(e," memberCount:").concat(a)),Pe({memberCount:a})}).catch(function(a){return m.w("".concat(n," failed. error:"),a),Promise.reject(a)})}},{key:"requestOnlineCount",value:function(e){return this.req({P:E.GET_ONLINE_MBR_NUM,data:{groupID:e}})}},{key:"hasLocalGroup",value:function(e){return this.groupMap.has(e)}},{key:"deleteLocalGroupAndConversation",value:function(e){var t,n=this.checkJoinedAVChatRoomByID(e),s=(m.l("".concat(this._n,".deleteLocalGroupAndConversation groupID:").concat(e," isJoinedAVChatRoom:").concat(n)),this.get(11)),r="".concat(I.CONV_GROUP).concat(e);n&&(this.stopMessageLongPolling({groupID:e}),s.deleteLocalConv(r)),rn({groupID:e})&&(t=this.getLocalGroupProfile(e))&&t.isSupportTopic===!0&&this.get(10).deleteTopicListInCommunity(e),s.clearUnreadCount(r),s.setCompleted(r),this._deleteLocalGroup(e),this._onlineMemberCountMap.delete(e),this.emitGroupListUpdate(!0,!1)}},{key:"_deleteLocalGroup",value:function(e){this.groupMap.delete(e),this._groupMemberHandler.deleteGroupMemberList(e)}},{key:"sendMessage",value:function(e,t){return _e(e._receiverList)&&0<e._receiverList.length&&!this.canIUse(he.MSG_TO_SPECIFIED_GRP_MBR)?this.noUse("Targeted Group Message"):(e=this.createGroupMessagePack(e,t),this.req(e))}},{key:"createGroupMessagePack",value:function(e,t){var n=null,s=(t&&t.offlinePushInfo&&(n=t.offlinePushInfo),""),r=(xe(e.cloudCustomData)&&0<e.cloudCustomData.length&&(s=e.cloudCustomData),[]),a=(dt(t)&&dt(t.messageControlInfo)&&(a=(g=t.messageControlInfo).excludedFromUnreadCount,l=g.excludedFromLastMessage,g=g.excludedFromContentModeration,a===!0&&r.push("NoUnread"),l===!0&&r.push("NoLastMsg"),g===!0&&r.push("NoMsgCheck")),void 0),l=(_e(e._receiverList)&&0<e._receiverList.length&&(a=e._receiverList,50<e._receiverList.length&&(a=e._receiverList.slice(0,50),this.warn("ReceiverListLimit"))),this.isOnlineMessage(e,t)?1:0),g=JSON.parse(JSON.stringify(e.getElements())),d=this.get(17).getFileDNList(),h=e.getGroupAtInfoList(),g={fromAccount:this.getMyUserID(),groupID:e.to,msgBody:pa(e.type,g,d),cloudCustomData:s,random:e.random,priority:e.priority,clientSequence:e.clientSequence,groupAtInfo:e.type!==I.MSG_TEXT||se(h)?void 0:h,onlineOnlyFlag:l,clientTime:e.clientTime,offlinePushInfo:ha(n),messageControlInfo:l==0?r:void 0,needReadReceipt:e.needReadReceipt!==!0||this.isMessageFromOrToAVChatroom(e.to)?0:1,receiverList:a,isSupportExtension:e.isSupportExtension===!0?1:0,isRelayMessage:e._relayFlag===!0?1:0,cmConfigID:e._cmConfigID,forbidCallbackControl:Hp(t)};return Vt(e.to)&&(g.groupID=wt(e.to),g.topicID=e.to),{P:E.SEND_GRP_MSG,data:g}}},{key:"revokeMessage",value:function(e){var t={groupID:e.to,msgSeqList:[{msgSeq:e.sequence}]};return Vt(e.to)&&(t.groupID=wt(e.to),t.topicID=e.to),this.req({P:E.REVOKE_GRP_MSG,data:t})}},{key:"deleteMessage",value:function(n){var t=n.to,n=n.keyList,n=(m.l("".concat(this._n,".deleteMessage groupID:").concat(t," count:").concat(n.length)),{groupID:t,deleter:this.getMyUserID(),keyList:n});return Vt(t)&&(n.groupID=wt(t),n.topicID=t),this.req({P:E.DEL_GRP_MSG,data:n})}},{key:"modifyRemoteMessage",value:function(l){var g=l.to,t=l.sequence,n=l.payload,s=l.type,r=l.version,r=r===void 0?0:r,a=l.cloudCustomData,l=l._elements,d=g,h=void 0,g=(Vt(g)&&(d=wt(g),h=g),void 0);return Xp(s)&&(1<l.length&&l.splice(0,1,{type:s,content:n}),g=l),this.req({P:E.MODIFY_GRP_MSG,data:{groupID:d,topicID:h,sequence:t,version:r,elements:g,cloudCustomData:a}})}},{key:"getRoamingMessage",value:function(a){var t=this,n="".concat(this._n,".").concat("getRoamingMessage"),s=a.conversationID,r=a.groupID,a=a.sequence,l=new K("getRoamingMessage"),d=0,h=void 0;return Vt(r)&&(r=wt(h=r)),this._computeLastSequence({groupID:r,topicID:h,sequence:a}).then(function(g){return d=g,m.l("".concat(n," groupID:").concat(r," startSequence:").concat(d)),t.req({P:E.GET_GRP_ROAMING_MSG,data:{groupID:r,count:21,sequence:d,topicID:h}})}).then(function(S){var M=S.data,U=M.messageList,_=M.complete,M=M.invisibleSequenceList,M=M===void 0?[]:M,S=S.data.nextSequence,S=S===void 0?0:S,D=(H(U)?m.l("".concat(n," ok. complete:").concat(_," nextSequence:").concat(S," but messageList is undefined!")):m.l("".concat(n," ok. complete:").concat(_," nextSequence:").concat(S," count:").concat(U.length)),l.setMessage("groupID:".concat(r," topicID:").concat(h," startSequence:").concat(d," complete:").concat(_," nextSequence:").concat(S)).end(),t.get(11)),O=[],B=[],U=(se(U)||(O=D.onRoamingMessage(U,s,!0,B),D.updateIsRead(s),D.patchConvLastMessage(s)),_===2||S<1);return U&&(D.setCompleted(s),S=""),m.l("".concat(n," isPullingCompleted:").concat(U," nextReqID:").concat(S," storedMsgCount:").concat(O.length)+" invisibleSeqCount:".concat(M.length)),{nextReqID:S+"",storedMessageList:O,assembledMessageList:B,isPullingCompleted:U}}).catch(function(g){return l.setError(g).setMessage("groupID:".concat(r," topicID:").concat(h," startSequence:").concat(d)).end(),m.w("".concat(n," failed. error:"),g),A(g)})}},{key:"_getGroupIDOfMessage",value:function(e){return e.conversationID.replace(I.CONV_GROUP,"")}},{key:"getReadReceiptList",value:function(e){var t="".concat(this._n,".").concat("getReadReceiptList"),n=this._getGroupIDOfMessage(e[0]),s=this.getMyUserID(),r=e.filter(function(l){return l.from===s&&l.needReadReceipt===!0}).map(function(l){return{sequence:l.sequence}});if(m.l("".concat(t," groupID:").concat(n," sequenceList:").concat(JSON.stringify(r))),r.length===0)return Pe({messageList:e});var a=new K("getReadReceiptList");return a.setMessage("groupID:".concat(n)),this.req({P:E.GET_READ_RECEIPT,data:{groupID:n,sequenceList:r}}).then(function(l){return a.end(),m.l("".concat(t," ok")),l=l.data.readReceiptList,_e(l)&&l.forEach(function(d){e.forEach(function(h){d.code===0&&d.sequence===h.sequence&&(h.readReceiptInfo.readCount=d.readCount,h.readReceiptInfo.unreadCount=d.unreadCount)})}),me({messageList:e})}).catch(function(l){return a.setError(l).end(),m.w("".concat(t," failed. error:"),l),A(l)})}},{key:"sendReadReceipt",value:function(a){var t="".concat(this._n,".").concat("sendReadReceipt"),n=this._getGroupIDOfMessage(a[0]),s=new K("sendReadReceipt"),r=(s.setMessage("groupID:".concat(n)),this.getMyUserID()),a=a.filter(function(l){return l.from!==r&&l.needReadReceipt===!0}).map(function(l){return{sequence:l.sequence}});return a.length===0?A({code:F.READ_RECEIPT_MSG_LIST_EMPTY}):(m.l("".concat(t,". sequenceList:").concat(JSON.stringify(a))),this.req({P:E.SEND_READ_RECEIPT,data:{groupID:n,sequenceList:a}}).then(function(l){return s.end(),m.l("".concat(t," ok")),me()}).catch(function(l){return s.setError(l).end(),m.w("".concat(t," failed. error:"),l),A(l)}))}},{key:"getReadReceiptDetail",value:function(_){var t=this,r=_.message,h=_.filter,g=_.cursor,_=_.count,n=this._getGroupIDOfMessage(r),s=r.ID,r=r.sequence,a="".concat(this._n,".").concat("getReadReceiptDetail"),l=this._receiptDetailCompleteMap.get(s)||!1,d=h!==0&&h!==1?0:h,h=xe(g)?g:"",g=!Qe(_)||_<=0||100<=_?100:_,_="groupID:".concat(n," sequence:").concat(r," cursor:").concat(h," filter:").concat(d," completeFlag:").concat(l),M=(m.l("".concat(a," ").concat(_)),{cursor:"",isCompleted:!1,messageID:s,unreadUserIDList:[],readUserIDList:[]}),S=new K("getReadReceiptDetail");return S.setMessage(_),this.req({P:E.GET_READ_RECEIPT_DETAIL,data:{groupID:n,sequence:r,flag:d,cursor:h,count:g}}).then(function(de){S.end();var de=de.data,O=de.cursor,B=de.isCompleted,U=de.unreadUserIDList,de=de.readUserIDList;return M.cursor=O,B===1&&(M.isCompleted=!0,t._receiptDetailCompleteMap.set(s,!0)),d===0?M.readUserIDList=de.map(function(J){return J.userID}):d===1&&(M.unreadUserIDList=U.map(function(J){return J.userID})),m.l("".concat(a," ok")),me(M)}).catch(function(D){return S.setError(D).end(),m.w("".concat(a," failed. error:"),D),A(D)})}},{key:"getRoamingMessagesHopping",value:function(e){var t=this,n="".concat(this._n,".").concat("getRoamingMessagesHopping"),s=e.groupID,r=e.count,a=e.sequence,l=e.direction,d=void 0;return H(a)&&l===1?Pe({messageList:[],isCompleted:!0,nextMessageSeq:""}):(Vt(s)&&(s=wt(d=s)),this._computeReqSeqHopping({groupID:s,topicID:d,sequence:a}).then(function(h){H(a)||l!==1||(h=a+r-1);var g="".concat(d?"topicID:".concat(d):"groupID:".concat(s)," sequence:").concat(a," reqSeq:").concat(h," direction:").concat(l),_=(m.l("".concat(n," ").concat(g)),new K("getRoamingMessagesHopping"));return t.req({P:E.GET_GRP_ROAMING_MSG,data:{groupID:s,topicID:d,count:r,sequence:h}}).then(function(O){var O=O.data,de=O.messageList,de=de===void 0?[]:de,S=O.complete,D=O.nextSequence,D=D===void 0?0:D,O=O.invisibleSequenceList,O=O===void 0?[]:O,U="complete:".concat(S," nextSequence:").concat(D," remoteMsgCount:").concat(de.length," invisibleSequenceList:").concat(O),U=(_.setMessage("".concat(g," ").concat(U)).end(),m.l("".concat(n," ok. ").concat(U)),"".concat(I.CONV_GROUP).concat(e.groupID)),B=t.get(11),U=B.onRoamingMessage(de,U,!1),de=t._computeResult({groupID:e.groupID,direction:l,sequence:a,remoteMessageList:de,processedMessageList:U,complete:S,nextSequence:D,invisibleSequenceList:O});return B.storeHoppingMessageList(de.messageList),me(de)}).catch(function(M){return _.setError(M).setMessage("groupID:".concat(s," sequence:").concat(a," count:").concat(r)).end(),m.w("".concat(n," failed. error:"),M),A(M)})}))}},{key:"_computeReqSeqHopping",value:function(r){var t=this,n=r.groupID,s=r.topicID,s=s===void 0?void 0:s,r=r.sequence,r=r===void 0?void 0:r;return 0<r?Promise.resolve(r):H(s)?this.getGroupProfileAdvance({groupIDList:[n],responseFilter:{groupBaseInfoFilter:["NextMsgSeq"]}}).then(function(l){var l=l.data.successGroupList,d=0;return se(l)||(d=l[0].nextMessageSeq-1),m.l("".concat(t._n,"._computeReqSeqHopping groupID:").concat(n," lastSequence:").concat(d," from remote")),d}).catch(function(a){return A(a)}):Promise.resolve(0)}},{key:"_computeResult",value:function(g){var t={messageList:[],isCompleted:!1,nextMessageSeq:""},n=g.groupID,s=g.direction,r=g.sequence,a=g.remoteMessageList,a=a===void 0?[]:a,l=g.processedMessageList,l=l===void 0?[]:l,d=g.complete,h=g.nextSequence,g=g.invisibleSequenceList;if(s===0)return t.nextMessageSeq=h,(d===2||h<1)&&(t.isCompleted=!0,t.nextMessageSeq=""),t.messageList=l,t;if(s===1){if(se(a)){if(se(g))return t.isCompleted=!0,t.nextMessageSeq="",t;t.nextMessageSeq=g[0]+1}else d=a[0].sequence,h=g[0]||0,t.nextMessageSeq=h<d?d+1:h+1;return l.forEach(function(_){_.sequence>=r&&t.messageList.push(_)}),(rn({groupID:n})||Vt(n))&&t.messageList.length===0&&a[0].sequence<r&&(t.isCompleted=!0,t.nextMessageSeq=""),t}}},{key:"setMessageRead",value:function(a){var t=this,n=a.conversationID,s=a.lastMessageSeq,r="".concat(this._n,".").concat("setMessageRead"),a="convID:".concat(n," lastMessageSeq:").concat(s),l=(m.l("".concat(r," ").concat(a)),Qe(s)||this.warn("DoNotModifyLastSeq"),new K("setMessageRead")),d=(l.setMessage(a),n.replace(I.CONV_GROUP,"")),h=void 0;return Vt(d)&&(d=wt(h=d)),this.req({P:E.SET_GRP_MSG_READ,data:{groupID:d,topicID:h,messageReadSeq:s}}).then(function(){l.end(),m.l("".concat(r," ok"));var g,_=t.get(11),M=(_.updateIsReadAfterReadReport({conversationID:n,lastMessageSeq:s}),!0);return H(h)||(M=!1,(g=t.get(10).getLocalTopic(d,h))&&g.updateSelfInfo({readedSequence:s})),_.updateUnreadCount(n,M),me()}).catch(function(g){return l.setError(g).end(),m.l("".concat(r," failed. error:"),g),A(g)})}},{key:"_computeLastSequence",value:function(s){var t=s.groupID,n=s.topicID,n=n===void 0?void 0:n,s=s.sequence;return 0<s?Promise.resolve(s):H(n)?this.getGroupLastSequence(t):Promise.resolve(0)}},{key:"getGroupLastSequence",value:function(e){var t="".concat(this._n,".").concat("getGroupLastSequence"),n=new K("getGroupLastSequence"),s=0,r="",a="groupID:".concat(e);if(this.hasLocalGroup(e)){var l=this.getLocalGroupProfile(e),d=l.lastMessage;if(0<d.lastSequence&&d.onlineOnlyFlag===!1)return s=d.lastSequence,r="".concat(a,", ").concat(s," from group.lastMessage.lastSequence"),m.l("".concat(t," ").concat(r)),n.setMessage(r).end(),Promise.resolve(s);if(1<l.nextMessageSeq)return s=l.nextMessageSeq-1,r="".concat(a,", ").concat(s," from group.nextMessageSeq"),m.l("".concat(t," ").concat(r)),n.setMessage(r).end(),Promise.resolve(s)}return d=this.get(11).getLocalConversation("GROUP".concat(e)),d&&d.lastMessage.lastSequence&&d.lastMessage.onlineOnlyFlag===!1?(s=d.lastMessage.lastSequence,r="".concat(a,", ").concat(s," from conversation.lastMessage.lastSequence"),m.l("".concat(t," ").concat(r)),n.setMessage(r).end(),Promise.resolve(s)):this.getGroupProfileAdvance({groupIDList:[e],responseFilter:{groupBaseInfoFilter:["NextMsgSeq"]}}).then(function(h){return h=h.data.successGroupList,se(h)?m.w("".concat(t," ").concat(a,", empty successGroupList")):(s=h[0].nextMessageSeq-1,r="".concat(a,", ").concat(s," from remote"),m.l("".concat(t," ").concat(r))),n.setMessage(r).end(),s}).catch(function(h){return n.setError(h).setMessage(a).end(),m.w("".concat(t," failed. error:"),h),A(h)})}},{key:"isMessageFromOrToAVChatroom",value:function(e){return this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e)}},{key:"hasJoinedAVChatRoom",value:function(){return this._AVChatRoomHandler.hasJoinedAVChatRoom()}},{key:"getJoinedAVChatRoom",value:function(){return this._AVChatRoomHandler.getJoinedAVChatRoom()}},{key:"getGroupRemoteLastSeq",value:function(e){return e=this.getLocalGroupProfile(e),e?e.nextMessageSeq-1:1}},{key:"isOnlineMessage",value:function(e,t){return!(!this._canIUseOnlineOnlyFlag(e)||!t||t.onlineUserOnly!==!0)}},{key:"_canIUseOnlineOnlyFlag",value:function(e){var t=this.getJoinedAVChatRoom();return!t||!t.includes(e.to)||e.conversationType!==I.CONV_GROUP}},{key:"_onAVChatRoomHistoryMessage",value:function(e,t){var n;se(e)||(m.l("".concat(this._n,"._onAVChatRoomHistoryMessage groupID:").concat(t," count:").concat(e.length)),n=[],e.forEach(function(s){n.push(c(c({},s),{},{isHistoryMessage:1}))}),this.onAVChatRoomMessage(n,t))}},{key:"onAVChatRoomMessage",value:function(e){this._AVChatRoomHandler.onMessage(e,1<arguments.length&&arguments[1]!==void 0?arguments[1]:"")}},{key:"onAVChatRoomMemberBanned",value:function(e){this._AVChatRoomHandler.onAVChatRoomMemberBanned(e)}},{key:"setUnjoinedAVChatRoom",value:function(e){this._unjoinedAVChatRoomList.set(e,1)}},{key:"deleteUnjoinedAVChatRoom",value:function(e){this._unjoinedAVChatRoomList.has(e)&&this._unjoinedAVChatRoomList.delete(e)}},{key:"isUnjoinedAVChatRoom",value:function(e){return this._unjoinedAVChatRoomList.has(e)}},{key:"isGroupAttributesUpdatedNotice",value:function(e){return this._groupAttributesHandler.isGroupAttributesUpdatedNotice(e)}},{key:"updateLocalMainSequenceOnReconnected",value:function(){this._groupAttributesHandler.updateLocalMainSequenceOnReconnected()}},{key:"initGroupAttributes",value:function(e){return this._groupAttributesHandler.initGroupAttributes(e)}},{key:"setGroupAttributes",value:function(e){return this._groupAttributesHandler.setGroupAttributes(e)}},{key:"deleteGroupAttributes",value:function(e){return this._groupAttributesHandler.deleteGroupAttributes(e)}},{key:"getGroupAttributes",value:function(e){return this._groupAttributesHandler.getGroupAttributes(e)}},{key:"isMessageFromTopic",value:function(e,t){return e===2&&!se(t)}},{key:"isMessageFromCommunityOfTopic",value:function(e,t){return e===2&&se(t)}},{key:"getMessageExtensions",value:function(e,t){return m.l("".concat(this._n,".getMessageExtensions startSequence:").concat(t)),this.req({P:E.GET_GRP_MSG_EXT,data:{groupID:e.to,messageSequence:e.sequence,startSequence:t}})}},{key:"modifyMsgExts",value:function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1;return m.l("".concat(this._n,".modifyMsgExts operateType:").concat(n)),this.req({P:E.MODIFY_GRP_MSG_EXT,data:{groupID:e.to,messageSequence:e.sequence,extensionList:t,operateType:n}})}},{key:"_genNotifyReqList",value:function(e){for(var t,n,s,r,a=[],l=0,d=e.length;l<d;l++)t=e[l],r=this.getLocalGroupProfile(t).type,n=this._getGroupLastRevokedTime(t),s=1e3*Wn(),r={notifyType:1,limit:20,type:rn({type:r,groupID:t})?I.GRP_COMMUNITY:void 0,groupID:t,beginTime:n,endTime:s},a.push(r);return a}},{key:"getNotice",value:function(s){var t=this,n="".concat(this._n,".getNotice"),s=s.filter(function(l){if(!t.hasLocalGroup(l))return!1;var l=t.getLocalGroupProfile(l),a=l.type,l=l.isSupportTopic;return!nn(a)&&!l});s.length!==0&&(m.l("".concat(n," list:").concat(s)),this.req({P:E.GET_GRP_NOTIFY,data:{notifyReqList:this._genNotifyReqList(s)}}).then(function(d){var a,l,d=d.data.notifyRspList,h=[];_e(d)&&(a={dataList:[]},l="".concat(n," ok."),d.forEach(function(g){var _=g.nextRevokedTime,M=g.groupID,S=g.notifyList;l+=" groupID:".concat(M," nextRevokedTime:").concat(_," count:").concat(S.length,`
`),a.dataList.push({elements:{revokedInfos:t._genRevokedInfos(g)}}),_!==0?(t._setGroupLastRevokedTime(M,_),h.push(M)):t._setGroupLastRevokedTime(M,1e3*Wn())}),m.l(l),t.onMsgRevoked(a,!1)),0<h.length&&t.getNotice(h)}).catch(function(r){m.e("".concat(n," failed. error:"),r)}))}},{key:"_genRevokedInfos",value:function(e){var t=e.notifyList,n=e.groupID,s=[];return _e(t)&&t.forEach(function(r){s.push({groupID:n,sequence:r.sequence,random:r.random,revokerInfo:c({},r.revokerInfo)})}),s}},{key:"_getGroupLastRevokedTime",value:function(e){return this.hasLocalGroup(e)?this.getLocalGroupProfile(e)._lastRevokedTime:0}},{key:"_setGroupLastRevokedTime",value:function(e,t){this.hasLocalGroup(e)&&(this.getLocalGroupProfile(e)._lastRevokedTime=t)}},{key:"isGroupCountersNotice",value:function(e){return this._groupCountersHandler.isGroupCountersNotice(e)}},{key:"setGroupCounters",value:function(e){return this._groupCountersHandler.setGroupCounters(e)}},{key:"increaseGroupCounter",value:function(e){return this._groupCountersHandler.increaseGroupCounter(e)}},{key:"decreaseGroupCounter",value:function(e){return this._groupCountersHandler.decreaseGroupCounter(e)}},{key:"getGroupCounters",value:function(e){return this._groupCountersHandler.getGroupCounters(e)}},{key:"getGroupMemberHandler",value:function(){return this._groupMemberHandler}},{key:"getGroupMemberList",value:function(e){return this._groupMemberHandler.getGroupMemberList(e)}},{key:"getGroupMemberProfile",value:function(e){return this._groupMemberHandler.getGroupMemberProfile(e)}},{key:"addGroupMember",value:function(e){return this._groupMemberHandler.addGroupMember(e)}},{key:"deleteGroupMember",value:function(e){return this._groupMemberHandler.deleteGroupMember(e)}},{key:"setGroupMemberMuteTime",value:function(e){return this._groupMemberHandler.setGroupMemberMuteTime(e)}},{key:"setGroupMemberRole",value:function(e){return this._groupMemberHandler.setGroupMemberRole(e)}},{key:"setGroupMemberNameCard",value:function(e){return this._groupMemberHandler.setGroupMemberNameCard(e)}},{key:"setGroupMemberCustomField",value:function(e){return this._groupMemberHandler.setGroupMemberCustomField(e)}},{key:"markGroupMemberList",value:function(e){return this._groupMemberHandler.markGroupMemberList(e)}},{key:"modifyGroupMemberInfo",value:function(e){return this._groupMemberHandler.modifyGroupMemberInfo(e)}},{key:"restartPolling",value:function(){this._AVChatRoomHandler.restartPolling()}},{key:"getPollingTimerID",value:function(e){if(!e)return-1;var t=this.getLocalGroupProfile(e);return t&&nn(t.type)?this._AVChatRoomHandler.getPollingTimerID(e):-1}},{key:"_canIUseJoinOption",value:function(e){return e===I.GRP_PUBLIC||rn({type:e})}},{key:"_silentlyGetGroupProfile",value:function(e,t){var n=setTimeout(this.getGroupProfile.bind(this,{groupID:t}),3e3);this._timeoutIDs.push(n),m.l("".concat(this._n,"._silentlyGetGroupProfile errorCode:").concat(e," groupID:").concat(t," timeoutIDs:").concat(this._timeoutIDs))}},{key:"_clearTimeoutIDs",value:function(){this._timeoutIDs.forEach(function(e){e&&clearTimeout(e)}),this._timeoutIDs=[]}},{key:"startMessageLongPolling",value:function(s){var t=s.groupID,n=s.longPollingKey,s=s.longPollingSequence,s=s===void 0?1:s,a=this.get(12).isUnlimitedAVChatRoom(),r=(this._AVChatRoomHandler.hasPollingInstance(t)&&this.stopMessageLongPolling({groupID:t}),this._AVChatRoomHandler.getJoinedLiveList()),a=(!a&&0<r.length&&this.stopMessageLongPolling({groupID:r[0]}),new co({groupID:t,type:I.GRP_LIVE}));return m.l("".concat(this._n,".startMessageLongPolling groupID:").concat(t," longPollingKey:").concat(n," longPollingSequence:").concat(s)),this._AVChatRoomHandler.startRunLoop({group:a,longPollingKey:n,startSeq:s})}},{key:"stopMessageLongPolling",value:function(t){var t=t.groupID,n=this.get(11);return this._AVChatRoomHandler.reset(t),this._deleteLocalGroup(t),n.deleteLocalConv("".concat(I.CONV_GROUP).concat(t)),m.l("".concat(this._n,".stopMessageLongPolling ok, groupID:").concat(t)),Pe({groupID:t})}},{key:"reset",value:function(){this.groupMap.clear(),this._unjoinedAVChatRoomList.clear(),this._receiptDetailCompleteMap.clear(),this._onlineMemberCountMap.clear(),this._commonGroupHandler.reset(),this._groupSystemNoticeHandler.reset(),this._groupTipsHandler.reset(),this._groupAttributesHandler.reset(),this._groupCountersHandler.reset(),this._AVChatRoomHandler.reset(),this._groupMemberHandler.reset(),this._clearTimeoutIDs()}}]),Vr),zy=["topicID","topicName","avatar","introduction","notification","unreadCount","muteAllMembers","customData","groupAtInfoList","nextMessageSeq","selfInfo"],$y=(y(ku,[{key:"_initTopic",value:function(e){for(var t in e)zy.indexOf(t)<0||(t==="selfInfo"?this.updateSelfInfo(e[t]):this[t]=t==="muteAllMembers"?e[t]===1:e[t])}},{key:"updateUnreadCount",value:function(){this.unreadCount=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0}},{key:"updateNextMessageSeq",value:function(e){this.nextMessageSeq=e}},{key:"updateLastMessage",value:function(e){this.lastMessage=mf(e)}},{key:"updateGroupAtInfoList",value:function(e){this.groupAtInfoList=JSON.parse(JSON.stringify(e))}},{key:"updateTopic",value:function(e){H(e.selfInfo)||this.updateSelfInfo(e.selfInfo),H(e.muteAllMembers)||(this.muteAllMembers=e.muteAllMembers===1),zn(this,e,["groupID","lastMessageTime","selfInfo","muteAllMembers","lastMsg"])}},{key:"updateSelfInfo",value:function(e){return zn(this.selfInfo,e,[],[""])===0}},{key:"reduceUnreadCount",value:function(){return 1<=this.unreadCount&&(--this.unreadCount,!0)}},{key:"isLastMessageRevoked",value:function(e){return e.sequence===this.lastMessage.lastSequence}},{key:"setLastMessageRevoked",value:function(e){this.lastMessage.isRevoked=e}},{key:"setLastMessageRevoker",value:function(e){this.lastMessage.revoker=e}}]),ku),Jy=(T(qr,St),If=z(qr),y(qr,[{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("topic_cache_time"),t=this.getCloudConfig("topic_last_active_time");H(e)||(this.TOPIC_CACHE_TIME=Number(e)),H(t)||(this.TOPIC_LAST_ACTIVE_TIME=Number(t))}},{key:"onTopicCreated",value:function(e){var t=e.groupID;this.resetGetTopicTime(t),this.emitOEvt($.TOPIC_CREATED,e)}},{key:"onTopicDeleted",value:function(e){var t=this,n=e.groupID,s=e.topicIDList;(s===void 0?[]:s).forEach(function(r){t._deleteLocalTopic(n,r)}),this.emitOEvt($.TOPIC_DELETED,e)}},{key:"onTopicProfileUpdated",value:function(e){var t=e.groupID,n=e.topicID,n=this.getLocalTopic(t,n);n&&(n.updateTopic(e),this.emitOEvt($.TOPIC_UPDATED,{groupID:t,topic:n}))}},{key:"onTopicLatestMsg",value:function(r){var t,n,r=r||{},s=r.topicLatestMessage,r=r.excludedUnreadSequenceList;se(s)||(t=s.groupProfile.topicID,s.conversationType=I.CONV_GROUP,s.to=t,(n=new Bt(s)).setElement(s.elements),this.updateUnreadCountAndLastMsg(t,n,r))}},{key:"onMessageRemindTypeUpdated",value:function(r){var t,n=r.groupID,s=r.topicID,r=r.messageRemindType,a=this.getLocalTopic(n,s);a&&((t=a.updateSelfInfo({messageRemindType:r}))&&this.emitOEvt($.TOPIC_UPDATED,{groupID:n,topic:a}),m.l("".concat(this._n,".onMessageRemindTypeUpdated topicID:").concat(s," messageRemindType:").concat(r," isUpdated:").concat(t)))}},{key:"onAtInfoUpdated",value:function(t){var s=t.topicID,t=t.groupAtInfoList,n=wt(s),s=this.getLocalTopic(n,s);s&&!H(t)&&(s.updateGroupAtInfoList(t),this.emitOEvt($.TOPIC_UPDATED,{groupID:n,topic:s}))}},{key:"onUnreadCountUpdatedFromConv",value:function(s){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,n=wt(s),s=this.getLocalTopic(n,s);s&&s.unreadCount!==t&&(s.updateUnreadCount(t),t===0&&s.updateSelfInfo({readedSequence:s.lastMessage.lastSequence}),this.emitOEvt($.TOPIC_UPDATED,{groupID:n,topic:s}))}},{key:"onMessageSent",value:function(r){var t,n,s=r.groupID,a=r.topicID,r=r.lastMessage,a=this.getLocalTopic(s,a);!a||(n=(t=(t=r.sequence)===void 0?0:t)+1)>a.nextMessageSeq&&(a.updateNextMessageSeq(n),a.updateLastMessage(r),a.updateSelfInfo({readedSequence:t}),a.updateUnreadCount(0),this.emitOEvt($.TOPIC_UPDATED,{groupID:s,topic:a}))}},{key:"onMessageModified",value:function(e){var t,n=e.to,s=e.time,r=e.sequence,a=e.elements,l=e.cloudCustomData,d=e.messageVersion,h=wt(n),g=this.getLocalTopic(h,n);g&&(t=g.lastMessage,m.d("".concat(this._n,".onMessageModified topicID:").concat(n," lastMessage:"),JSON.stringify(t),"options:",JSON.stringify(e)),t&&(t.payload===null||t.lastTime===s&&t.lastSequence===r&&t.version!==d)&&(t.type=a[0].type,t.payload=a[0].content,t.messageForShow=Lr(t.type,t.payload,this.isIntl()),t.cloudCustomData=l,t.version=d,t.lastSequence=r,t.lastTime=s,this.emitOEvt($.TOPIC_UPDATED,{groupID:h,topic:g})))}},{key:"onMessageRevoked",value:function(e){var t,n,s,r=this;e.length!==0&&(n=t=null,s=!1,e.forEach(function(a){var l=a.to;n=wt(l),(t=r.getLocalTopic(n,l))&&(t.reduceUnreadCount()&&(s=!0),t.isLastMessageRevoked(a)&&(t.setLastMessageRevoked(!0),t.setLastMessageRevoker(a.revoker),s=!0),(l=t.selfInfo.excludedUnreadSequenceList||[]).push(a.sequence),t.updateSelfInfo({excludedUnreadSequenceList:l}))}),s&&this.emitOEvt($.TOPIC_UPDATED,{groupID:n,topic:t}))}},{key:"isLastMessageRevoked",value:function(t){var s=t.topicID,t=t.sequence,n=wt(s),n=this.getLocalTopic(n,s),s=!1;return s=n?n.isLastMessageRevoked({sequence:t}):s}},{key:"updateUnreadCountAndLastMsg",value:function(e,t,n){var s,r=wt(e),a=this.getLocalTopic(r,e);a&&(s=a.selfInfo.excludedUnreadSequenceList||[],H(n)||(s=n),t._isExcludedFromUnreadCount&&s.push(t.sequence),a.updateSelfInfo({excludedUnreadSequenceList:s}),m.l("".concat(this._n,".updateUnreadCountAndLastMsg seq:").concat(t.sequence," lastSeq:").concat(a.lastMessage.lastSequence)),t.sequence>a.lastMessage.lastSequence&&(a.updateLastMessage(t),n=t.sequence+1,a.updateNextMessageSeq(n),s=this._computeUnreadCount(a),a.updateUnreadCount(s),(t=this.get(11).getLocalConversation("".concat(I.CONV_GROUP).concat(e)))&&t.updateUnreadCount({nextUnreadCount:s,isFromGetConversations:!0}),this.emitOEvt($.TOPIC_UPDATED,{groupID:r,topic:a})))}},{key:"getJoinedCommunityList",value:function(){return this.get(7).syncCommunityWithTopic()}},{key:"createTopicInCommunity",value:function(e){var t=this,n="".concat(this._n,".").concat("createTopicInCommunity"),s=e.topicID;if(!H(s)&&!Vt(s))return A({code:F.ILLEGAL_TOPIC_ID});if(e.topicName&&this._filterProfanity("topicName",e)===!1)return A({code:F.PROFANITY_FOUND});if(e.introduction&&this._filterProfanity("introduction",e)===!1)return A({code:F.PROFANITY_FOUND});if(e.notification&&this._filterProfanity("notification",e)===!1)return A({code:F.PROFANITY_FOUND});var r=new K("createTopicInCommunity");return this.req({P:E.CREATE_TOPIC,data:c({},e)}).then(function(a){return a=a.data.topicID,r.setMessage("topicID:".concat(a)).end(),m.l("".concat(n," ok. topicID:").concat(a)),t._updateTopicMap([c(c({},e),{},{topicID:a})]),me({topicID:a})}).catch(function(a){return r.setError(a).end(),m.e("".concat(n," failed. error:"),a),A(a)})}},{key:"deleteTopicFromCommunity",value:function(r){var t=this,n="".concat(this._n,".").concat("deleteTopicFromCommunity"),s=r.groupID,r=r.topicIDList,r=r===void 0?[]:r,a=new K("deleteTopicFromCommunity");return a.setMessage("groupID:".concat(s," topicIDList:").concat(r)),this.req({P:E.DEL_TOPIC,data:{groupID:s,topicIDList:r}}).then(function(g){var g=g.data.resultList,d=[],h=[],g=((g===void 0?[]:g).forEach(function(D){var M=D.topicID,S=D.errorCode,D=D.errorInfo;S===0?d.push({topicID:M}):h.push({topicID:M,code:S,message:D})}),"success count:".concat(d.length,", fail count:").concat(h.length));return a.setMoreMessage(g).end(),m.l("".concat(n," ok. ").concat(g)),d.forEach(function(_){t._deleteLocalTopic(s,_.topicID)}),me({successTopicList:d,failureTopicList:h})}).catch(function(l){return a.setError(l).end(),m.e("".concat(n," failed. error:"),l),A(l)})}},{key:"updateTopicProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("updateTopicProfile");if(m.l("".concat(n," options:"),e),e.topicName&&this._filterProfanity("topicName",e)===!1)return A({code:F.PROFANITY_FOUND});if(e.introduction&&this._filterProfanity("introduction",e)===!1)return A({code:F.PROFANITY_FOUND});if(e.notification&&this._filterProfanity("notification",e)===!1)return A({code:F.PROFANITY_FOUND});var s=new K("updateTopicProfile");return s.setMessage("groupID:".concat(e.groupID," topicID:").concat(e.topicID)),H(e.muteAllMembers)||(e.muteAllMembers=e.muteAllMembers===!0?"On":"Off"),this.req({P:E.UPDATE_TOPIC_PROFILE,data:c({},e)}).then(function(){return s.end(),m.l("".concat(n," ok")),t._updateTopicMap([e]),me({topic:t.getLocalTopic(e.groupID,e.topicID)})}).catch(function(r){return s.setError(r).end(),m.e("".concat(n," failed. error:"),r),A(r)})}},{key:"getTopicList",value:function(r){var t=this,n="".concat(this._n,".").concat("getTopicList"),s=r.groupID,r=r.topicIDList,r=r===void 0?[]:r,a=r.length===0,l=new K("getTopicList");if(l.setMessage("groupID:".concat(s)),this._getTopicTimeMap.has(s)){var h=this._getTopicTimeMap.get(s),d=h.isGetAll,h=h.time;if((d||!d&&!a)&&Date.now()-h<1e3*this.TOPIC_CACHE_TIME&&(d=this._getLocalTopicList(s,r),a||d.length===r.length))return l.setMoreMessage("from cache, topic count:".concat(d.length)).end(),m.l("".concat(n," groupID:").concat(s," from cache, topic count:").concat(d.length)),Pe({successTopicList:d,failureTopicList:[]})}return this.req({P:E.GET_TOPIC_LIST,data:{groupID:s,topicIDList:r}}).then(function(D){var D=D.data.topicInfoList,_=[],M=[],S=[],D=((D===void 0?[]:D).forEach(function(J){var B=J.topic,U=J.selfInfo,de=J.errorCode,J=J.errorInfo,ke=B.topicID;de===0?(_.push(c(c({},B),{},{selfInfo:U})),M.push(ke)):S.push({topicID:ke,code:de,message:J})}),t._updateTopicMap(_),t._handleTopicAtInfo(_),"success count:".concat(M.length,", fail count:").concat(S.length)),D=(l.setMoreMessage(D).end(),m.l("".concat(n," groupID:").concat(s," from remote, ").concat(D)),[]);return se(M)||(t._getTopicTimeMap.set(s,{time:Date.now(),isGetAll:a}),D=t._getLocalTopicList(s,M)),me({successTopicList:D,failureTopicList:S})}).catch(function(g){return l.setError(g).end(),m.e("".concat(n," failed. error:"),g),A(g)})}},{key:"hasLocalTopic",value:function(e,t){return!!this._topicMap.has(e)&&this._topicMap.get(e).has(t)}},{key:"getLocalTopic",value:function(e,t){var n=null;return n=this._topicMap.has(e)?this._topicMap.get(e).get(t):n}},{key:"_getLocalTopicList",value:function(n){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[],n=this._topicMap.get(n),s=[];return n&&(s=q(n.values())),t.length===0?s:s.filter(function(r){return t.includes(r.topicID)})}},{key:"_deleteLocalTopic",value:function(e,t){this._topicMap.has(e)&&this._topicMap.get(e).has(t)&&(this._topicMap.get(e).delete(t),m.l("".concat(this._n,"._deleteLocalTopic groupID:").concat(e," topicID:").concat(t)))}},{key:"_updateTopicMap",value:function(e){var t=this,n=[];e.forEach(function(d){var r=d.groupID,a=d.topicID,l=null,d=(t._topicMap.has(r)||t._topicMap.set(r,new Map),t._topicMap.get(r).has(a)?(l=t._topicMap.get(r).get(a)).updateTopic(d):(t._getTopicLastMessage(d),l=new $y(d,t.isIntl()),t._topicMap.get(r).set(a,l)),t._computeUnreadCount(l));l.updateUnreadCount(d),n.push({conversationID:"".concat(I.CONV_GROUP).concat(a),type:I.CONV_TOPIC,unreadCount:d})}),0<n.length&&this.get(11).updateTopicConversation(n)}},{key:"resetGetTopicTime",value:function(e){var t=this;H(e)?q(this._getTopicTimeMap.keys()).forEach(function(n){t._getTopicTimeMap.set(n,0)}):this._getTopicTimeMap.set(e,0)}},{key:"getTopicListOnReconnected",value:function(){var e=this,t=q(this._topicMap.keys()),n=[],s=this.get(11);t.forEach(function(r){var a=[],l=e._getLocalTopicList(r);s.deleteTopicRoamingInfo(r),l.forEach(function(d){var h=d.lastMessage.lastTime,h=h===void 0?0:h;Date.now()-1e3*h<1e3*e.TOPIC_LAST_ACTIVE_TIME&&a.push(d.topicID)}),0<a.length&&n.push({groupID:r,topicIDList:a})}),m.l("".concat(this._n,".getTopicListOnReconnected. active community count:").concat(n.length)),this._relayGetTopicList(n)}},{key:"_relayGetTopicList",value:function(e){var t,n,s,r=this;e.length!==0&&(n=5<(t=e.shift()).topicIDList.length?"topicIDList.length:".concat(t.topicIDList.length):"topicIDList:".concat(t.topicIDList),(s=new K("relayGetTopicList")).setMessage(n),m.l("".concat(this._n,"._relayGetTopicList. ").concat(n)),this.getTopicList(t).then(function(){s.end(),r._relayGetTopicList(e)}).catch(function(a){s.setError(a).end(),r._relayGetTopicList(e)}))}},{key:"_handleTopicAtInfo",value:function(e){var t=this;e.length!==0&&e.forEach(function(a){var s=a.groupID,r=a.topicID,a=a.groupAtInfoList,l=[];H(a)||(a.forEach(function(d){l.push(c(c({},d),{},{groupID:s,topicID:r}))}),t.get(11).onNewGroupAtTips({dataList:l}))})}},{key:"_getTopicLastMessage",value:function(e){var t;H(e.lastMsg)||(t={time:e.lastMsg.time,sequence:e.lastMsg.sequence,from:e.lastMsg.from,payload:e.lastMsg.elements[0]?e.lastMsg.elements[0].content:null,type:e.lastMsg.elements[0]?e.lastMsg.elements[0].type:"",nick:e.lastMsg.nick,avatar:e.lastMsg.avatar,version:e.lastMsg.messageVersion,cloudCustomData:e.lastMsg.cloudCustomData,isRevoked:e.lastMsg.isPlaceMessage===2,revoker:se(e.lastMsg.revokerInfo)?null:e.lastMsg.revokerInfo.revoker},e.lastMessage=t)}},{key:"deleteTopicListInCommunity",value:function(e){var t=this,n=this._getLocalTopicList(e),s=this.get(11);n.forEach(function(r){r=r.topicID,t._deleteLocalTopic(e,r),t._getTopicTimeMap.delete(e),s.deleteLocalConv("".concat(I.CONV_GROUP).concat(r))})}},{key:"_computeUnreadCount",value:function(e){var t,r=e.selfInfo,n=r.excludedUnreadSequenceList,s=r.readedSequence,r=e.nextMessageSeq-e.selfInfo.readedSequence-1;return _e(n)&&(t=0,n.forEach(function(a){s<a&&a<=e.nextMessageSeq-1&&(t+=1)}),1<=t&&(r-=t)),r<0?0:r}},{key:"_filterProfanity",value:function(e,t){var s=this.get(29);if(!s)return!0;var s=s.filterText(t[e],Fe),n=s.isAllowedToSend,s=s.modifiedText;return n===!0&&(t[e]=s,!0)}},{key:"getMessageExtensions",value:function(e,t){m.l("".concat(this._n,".getMessageExtensions startSequence:").concat(t));var n=wt(e.to);return this.req({P:E.GET_GRP_MSG_EXT,data:{groupID:n,topicID:e.to,messageSequence:e.sequence,startSequence:t}})}},{key:"modifyMsgExts",value:function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1,s=(m.l("".concat(this._n,".modifyMsgExts operateType:").concat(n)),wt(e.to));return this.req({P:E.MODIFY_GRP_MSG_EXT,data:{groupID:s,topicID:e.to,messageSequence:e.sequence,extensionList:t,operateType:n}})}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._topicMap.clear(),this._getTopicTimeMap.clear(),this.TOPIC_CACHE_TIME=300,this.TOPIC_LAST_ACTIVE_TIME=3600}}]),qr),Xy=(y(Ru,[{key:"setExpirationTime",value:function(e){this.expirationTime=e}},{key:"getUserProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("getUserProfile"),s=e.userIDList;e.fromAccount=this._userM.getMyAccount(),100<s.length&&(m.w("".concat(n," ").concat(os(100))),s.length=100);for(var r,a=[],l=[],d=0,h=s.length;d<h;d++)r=s[d],this._userM.isMyFriend(r)&&this._contains(r)?l.push(this._getProfileFromMap(r)):a.push(r);if(a.length===0)return Pe(l);e.toAccount=a;var g=e.bFromGetMyProfile||!1,_=[],M=(e.toAccount.forEach(function(S){_.push({toAccount:S,standardSequence:0,customSequence:0})}),e.userItem=_,new K("getUserProfile"));return M.setMessage(5<s.length?"userIDList.length:".concat(s.length):"userIDList:".concat(s)),this._userM.req({P:E.GET_USER_PROFILE,data:e}).then(function(S){return M.end(),m.i("".concat(n," ok")),S=t._handleResponse(S).concat(l),me(g?S[0]:S)}).catch(function(S){return M.setError(S).end(),m.e("".concat(n," failed. error:"),S),A(S)})}},{key:"getMyProfile",value:function(){var e,t=this._userM.getMyAccount(),n="".concat(this._n,".getMyProfile");return m.l("".concat(n," myAccount:").concat(t)),this._fill(),this._contains(t)?(e=this._getProfileFromMap(t),m.d("".concat(n," from cache, myProfile:").concat(JSON.stringify(e))),Pe(e)):this.getUserProfile({fromAccount:t,userIDList:[t],bFromGetMyProfile:!0})}},{key:"_handleResponse",value:function(e){var t=e.data.userProfileItem;if(!_e(t))return[];for(var n=[],e=Date.now(),s=0,r=t.length;s<r;s++){var l=t[s],a=l.to,l=l.profileItem;a!=="@TLS#NOT_FOUND"&&a!==""&&(a=this._update(a,this._getLatestProfileFromResponse(a,l)).latestProfile,n.push(a))}return m.l("".concat(this._n,"._handleResponse cost:").concat(Kt(e))),n}},{key:"_getLatestProfileFromResponse",value:function(e,t){var n={userID:e,profileCustomField:[]};if(!se(t))for(var s=0,r=t.length;s<r;s++)if(-1<t[s].tag.indexOf("Tag_Profile_Custom"))n.profileCustomField.push({key:t[s].tag,value:t[s].value});else switch(t[s].tag){case Ve.NICK:n.nick=t[s].value;break;case Ve.GENDER:n.gender=t[s].value;break;case Ve.BIRTHDAY:n.birthday=t[s].value;break;case Ve.LOCATION:n.location=t[s].value;break;case Ve.SELFSIGNATURE:n.selfSignature=t[s].value;break;case Ve.ALLOWTYPE:n.allowType=t[s].value;break;case Ve.LANGUAGE:n.language=t[s].value;break;case Ve.AVATAR:n.avatar=t[s].value;break;case Ve.MESSAGESETTINGS:n.messageSettings=t[s].value;break;case Ve.ADMINFORBIDTYPE:n.adminForbidType=t[s].value;break;case Ve.LEVEL:n.level=t[s].value;break;case Ve.ROLE:n.role=t[s].value;break;default:m.w("".concat(this._n,"._getLatestProfileFromResponse unknown tag:"),t[s].tag,t[s].value)}return n}},{key:"updateMyProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("updateMyProfile");if(e.nick&&this._userM.filterProfanity("nick",e)===!1)return A({code:F.PROFANITY_FOUND});if(e.selfSignature&&this._userM.filterProfanity("selfSignature",e)===!1)return A({code:F.PROFANITY_FOUND});var s=new K("updateMyProfile"),r=(s.setMessage(JSON.stringify(e)),new wr().validate(e));if(!r.valid)return s.setCode(F.UPDATE_PROFILE_INVALID_PARAM).setMoreMessage("info:".concat(r.tips)).end(),m.e("".concat(n," info:").concat(r.tips)),A({code:F.UPDATE_PROFILE_INVALID_PARAM});var a,l=[];for(a in e)Object.prototype.hasOwnProperty.call(e,a)&&(a==="profileCustomField"?e.profileCustomField.forEach(function(h){l.push({tag:h.key,value:h.value})}):l.push({tag:Ve[a.toUpperCase()],value:e[a]}));if(l.length===0)return r=new yt({code:F.UPDATE_PROFILE_NO_KEY}),s.setError(r).end(),m.e("".concat(n," failed. error:"),r),A(r);var d=this._userM.getMyAccount();return this._userM.req({P:E.UPDATE_MY_PROFILE,data:{fromAccount:d,profileItem:l}}).then(function(h){s.end(),m.i("".concat(n," ok"));var _=t._update(d,e),g=_.isProfileUpdated,_=_.latestProfile;return g===!0&&t._userM.emitOEvt($.PROFILE_UPDATED,[_]),Pe(_)}).catch(function(h){return s.setError(h).end(),m.e("".concat(n," failed. error:"),h),A(h)})}},{key:"onProfileModified",value:function(e){var t=e.dataList;if(!se(t)){var n=t.length;m.d("".concat(this._n,".onProfileModified count:").concat(n," dataList:"),e.dataList);for(var s=[],r=0;r<n;r++){var l=t[r].userID,l=this._update(l,this._getLatestProfileFromResponse(l,t[r].profileList)),a=l.isProfileUpdated,l=l.latestProfile;a===!0&&s.push(l)}0<s.length&&(this._userM.emitIEvt(mt.PROFILE_UPDATED,s),this._userM.emitOEvt($.PROFILE_UPDATED,s))}}},{key:"_fill",value:function(){if(this.accountProfileMap.size===0){for(var e=this._getCachedProfiles(),t=Date.now(),n=0,s=e.length;n<s;n++)t-e[n].lastUpdatedTime<this.expirationTime&&this.accountProfileMap.set(e[n].userID,e[n]);m.l("".concat(this._n,"._fill from cache, size:").concat(this.accountProfileMap.size))}}},{key:"_update",value:function(e,t){var n,s=!1,r=Date.now();return this._contains(e)?(n=this._getProfileFromMap(e),t.profileCustomField&&Dr(n.profileCustomField,t.profileCustomField)===!0&&(n.lastUpdatedTime=r,s=!0),0<zn(n,t,["profileCustomField"])&&(n.lastUpdatedTime=r,s=!0)):(n=new wr(t),!this._userM.isMyFriend(e)&&e!==this._userM.getMyAccount()||(n.lastUpdatedTime=r,s=!0,this.accountProfileMap.set(e,n))),this._flush(e===this._userM.getMyAccount()),s===!0&&m.l("".concat(this._n,"._update account:").concat(e," isUpdated:").concat(s)),{isProfileUpdated:s,latestProfile:n}}},{key:"_flush",value:function(e){var t=q(this.accountProfileMap.values()),n=this._userM.getStorageModule();m.d("".concat(this._n,"._flush length:").concat(t.length," flushAtOnce:").concat(e)),n.setItem(this.TAG,t,e)}},{key:"_contains",value:function(e){return this.accountProfileMap.has(e)}},{key:"_getProfileFromMap",value:function(e){return this.accountProfileMap.get(e)}},{key:"_getCachedProfiles",value:function(){var e=this._userM.getStorageModule().getItem(this.TAG);return se(e)?[]:e}},{key:"onConvProfileUpdated",value:function(e){for(var t,n,s,r=[],a=0,l=e.length;a<l;a++)n=(t=e[a]).userID,this._userM.isMyFriend(n)&&(this._contains(n)?(s=this._getProfileFromMap(n),0<zn(s,t)&&r.push(n)):r.push(t.userID));r.length!==0&&(m.l("".concat(this._n,".onConvProfileUpdated toAccountList:").concat(r)),this.getUserProfile({userIDList:r}))}},{key:"getNickAndAvatarByUserID",value:function(e){return this._contains(e)?{nick:(e=this._getProfileFromMap(e)).nick,avatar:e.avatar}:{nick:"",avatar:""}}},{key:"getUserNickAndAvatar",value:function(r){var t=this,n=q(new Set(r)),s=(m.l("".concat(this._n,".getUserNickAndAvatar userIDList.length:").concat(r.length," uniqueUserIDList.length:").concat(n.length)),[]);if(r.length===0)return Promise.resolve(s);var r=this._createUserIDListGroup(n),a=[];return r.forEach(function(l){a.push(t.getUserProfile({userIDList:l}))}),Promise.all(a).then(function(l){return l.forEach(function(d){d=d.data.map(function(h){return{userID:h.userID,nick:h.nick,avatar:h.avatar}}),s.push.apply(s,q(d))}),s})}},{key:"_createUserIDListGroup",value:function(e){for(var t=[],n=0;n<e.length;)t.push(e.slice(n,n+=100));return t}},{key:"reset",value:function(){this._flush(!0),this.accountProfileMap.clear()}}]),Ru),Df=y(function e(t){f(this,e)}),Zy=(y(Lu,[{key:"getLocalBlacklist",value:function(){return q(this._blacklistMap.keys())}},{key:"getBlacklist",value:function(){var e=this,t="".concat(this._n,".getBlacklist"),n={fromAccount:this._userM.getMyAccount(),maxLimited:100,startIndex:this._startIndex},s=new K("getBlacklist");return this._userM.req({P:E.GET_BL,data:n}).then(function(l){var l=l.data,a=l.blackListItem,l=l.startIndex,d=se(a)?0:a.length;s.setMessage("count:".concat(d)).end(),m.i("".concat(t," ok")),e._startIndex=l,e._handleResponse(a,!0),e._userM.emitOEvt($.BLACKLIST_UPDATED,q(e._blacklistMap.keys())),e._startIndex!==0&&e.getBlacklist()}).catch(function(r){return s.setError(r).end(),m.e("".concat(t," failed. error:"),r),A(r)})}},{key:"addBlacklist",value:function(e){var t,n,s=this,r=new K("addToBlacklist"),a="".concat(this._n,".addBlacklist"),l=this._userM.getMyAccount();return e.userIDList.length===1&&e.userIDList[0]===l?(n=this._userM.getErrMsg(t=F.CANNOT_ADD_SELF_TO_BLACKLIST),r.setCode(t).setMessage(n).end(),n=new yt({code:t}),m.e("".concat(a," failed. error:"),n),A(n)):(e.userIDList.includes(l)&&(e.userIDList=e.userIDList.filter(function(d){return d!==l})),e.fromAccount=this._userM.getMyAccount(),e.toAccount=e.userIDList,this._userM.req({P:E.ADD_TO_BL,data:e}).then(function(d){return r.setMessage(5<e.userIDList.length?"userIDList.length:".concat(e.userIDList.length):"userIDList:".concat(e.userIDList)).end(),m.i("".concat(a," ok")),s._handleResponse(d.resultItem,!0),me(q(s._blacklistMap.keys()))}).catch(function(d){return r.setError(d).end(),m.e("".concat(a," failed. error:"),d),A(d)}))}},{key:"_handleResponse",value:function(e,t){if(!se(e))for(var n,s,r,a=0,l=e.length;a<l;a++)s=e[a].to,r=e[a].resultCode,!H(r)&&r!==0||(t?((n=this._blacklistMap.has(s)?this._blacklistMap.get(s):new Df).userID=s,se(e[a].addBlackTimeStamp)||(n.timeStamp=e[a].addBlackTimeStamp),this._blacklistMap.set(s,n)):this._blacklistMap.has(s)&&(n=this._blacklistMap.get(s),this._blacklistMap.delete(s)));m.l("".concat(this._n,"._handleResponse total:").concat(this._blacklistMap.size," bAdd:").concat(t))}},{key:"deleteBlacklist",value:function(e){var t=this,n="".concat(this._n,".deleteBlacklist"),s=new K("removeFromBlacklist");return e.fromAccount=this._userM.getMyAccount(),e.toAccount=e.userIDList,this._userM.req({P:E.RM_FROM_BL,data:e}).then(function(r){return s.setMessage(5<e.userIDList.length?"userIDList.length:".concat(e.userIDList.length):"userIDList:".concat(e.userIDList)).end(),m.i("".concat(n," ok")),t._handleResponse(r.data.resultItem,!1),me(q(t._blacklistMap.keys()))}).catch(function(r){return s.setError(r).end(),m.e("".concat(n," failed. error:"),r),A(r)})}},{key:"onAccountDeleted",value:function(e){for(var t=0,n=e.length;t<n;t++){var s=e[t];this._blacklistMap.has(s)&&this._blacklistMap.delete(s)}var r=e.length;0<r&&(m.l("".concat(this._n,".onAccountDeleted count:").concat(r," ").concat(r<30?"userIDList:".concat(e):"")),this._userM.emitOEvt($.BLACKLIST_UPDATED,q(this._blacklistMap.keys())))}},{key:"onAccountAdded",value:function(e){for(var t,n=[],s=0,r=e.length;s<r;s++)t=e[s],this._blacklistMap.has(t)||(this._blacklistMap.set(t,new Df({userID:t})),n.push(t));0<n.length&&(m.l("".concat(this._n,".onAccountAdded count:").concat(n.length," userIDList:"),n),this._userM.emitOEvt($.BLACKLIST_UPDATED,q(this._blacklistMap.keys())))}},{key:"reset",value:function(){this._blacklistMap.clear(),this._startIndex=0}}]),Lu),Qy=(y(Su,[{key:"_onCloudConfig",value:function(){var e=this._userM.getCloudConfig("status_query_count"),t=this._userM.getCloudConfig("status_sub_count"),n=this._userM.getCloudConfig("status_unsub_count");m.l("".concat(this._n,"._onCloudConfig statusQueryCount:").concat(e," statusSubscribeCount:").concat(t)+" statusUnsubscribeCount:".concat(n)),H(e)||(this.MAX_QUERY_USER_COUNT=parseInt(e,10)),H(e)||(this.MAX_SUBSCRIBE_USER_COUNT=parseInt(t,10)),H(e)||(this.MAX_UNSUBSCRIBE_USER_COUNT=parseInt(n,10))}},{key:"onUserStatusUpdated",value:function(s){var s=s.dataList,t=this._userM.getMyUserID(),n=this._userM.get(12),s=s.map(function(d){var a=d.to,l=d.statusType,d=d.customStatus,d=ga(d);return a===t&&n.setCustomStatus(d),{userID:a,statusType:l,customStatus:d}});m.l("".concat(this._n,".onUserStatusUpdated list:").concat(JSON.stringify(s))),this._userM.emitOEvt($.USER_STATUS_UPDATED,s)}},{key:"setSelfStatus",value:function(e){var t=this,n="".concat(this._n,".setSelfStatus");if(this._userM.filterProfanity("customStatus",e)===!1)return A({code:F.PROFANITY_FOUND});var s=new K("setSelfStatus"),r=e.customStatus;return this._userM.req({P:E.SET_SELF_STATUS,data:{customStatus:r}}).then(function(a){return s.setMessage("customStatus:".concat(r)).end(),m.l("".concat(n," ok. customStatus:").concat(r)),t._userM.get(12).setCustomStatus(r),me({userID:t._userM.getMyUserID(),statusType:1,customStatus:r})}).catch(function(a){return s.setError(a).end(),m.e("".concat(n," failed. error:"),a),A(a)})}},{key:"getUserStatus",value:function(s){var t="".concat(this._n,".").concat("getUserStatus"),s=s.userIDList,n=s===void 0?[]:s,s=this._userM.getMyUserID(),r=q(n),a=void 0,l=r.indexOf(s);if(-1<l&&(r.splice(l,1),a={userID:s,statusType:1,customStatus:this._userM.get(12).getCustomStatus()}),r.length===0)return Pe({successUserList:[a],failureUserList:[]});if(!this._userM.canIUse(he.USER_STATUS))return this._userM.noUse("getUserStatus");r.length>this.MAX_QUERY_USER_COUNT&&(m.w("".concat(t," ").concat(os(this.MAX_QUERY_USER_COUNT))),r=n.slice(0,this.MAX_QUERY_USER_COUNT));var d=new K("getUserStatus");return this._userM.req({P:E.GET_USER_STATUS,data:{userIDList:r}}).then(function(_){var _=_.data,g=_.successUserList,g=g===void 0?[]:g,_=_.failureUserList,_=_===void 0?[]:_,g=g.map(function(B){var D=B.userID,O=B.statusType,B=B.customStatus;return{userID:D,statusType:O,customStatus:ga(B)}}),_=_.map(function(U){var D=U.userID,O=U.invalidUserID,B=U.errorCode,U=U.errorInfo;return{userID:se(O)?D:O,code:B,message:U}}),M=(H(a)||g.unshift(a),"userID count:".concat(n.length,", success count:").concat(g.length,", fail count:").concat(_.length));return d.setMessage("".concat(M)).end(),m.l("".concat(t," ok. ").concat(M,".")),me({successUserList:g,failureUserList:_})}).catch(function(h){return d.setMessage("userID count:".concat(n.length)).setError(h).end(),m.e("".concat(t," failed. error:"),h),A(h)})}},{key:"subscribeUserStatus",value:function(s){var t="subscribeUserStatus";if(!this._userM.canIUse(he.USER_STATUS))return this._userM.noUse(t);var n="".concat(this._n,".").concat(t),s=s.userIDList,s=s===void 0?[]:s,r=q(s),a=(r.length>this.MAX_SUBSCRIBE_USER_COUNT&&(m.w("".concat(n," ").concat(os(this.MAX_SUBSCRIBE_USER_COUNT))),r=s.slice(0,this.MAX_SUBSCRIBE_USER_COUNT)),new K(t)),l="userID count:".concat(s.length);return m.l("".concat(n," ").concat(l)),this._userM.req({P:E.SUB_USER_STATUS,data:{userIDList:r}}).then(function(d){return d=d.data.failureUserList,d=(d===void 0?[]:d).map(function(S){var g=S.userID,_=S.invalidUserID,M=S.errorCode,S=S.errorInfo;return{userID:se(_)?g:_,code:M,message:S}}),a.setMessage("".concat(l," fail count:").concat(d.length)).end(),m.l("".concat(n," ok. fail count:").concat(d.length,".")),me({failureUserList:d})}).catch(function(d){return a.setMessage(l).setError(d).end(),m.e("".concat(n," failed. error:"),d),A(d)})}},{key:"unsubscribeUserStatus",value:function(n){var l="unsubscribeUserStatus";if(!this._userM.canIUse(he.USER_STATUS))return this._userM.noUse(l);var t="".concat(this._n,".").concat(l),n=(n||{}).userIDList,n=n===void 0?[]:n,s=q(n),r=(n.length>this.MAX_UNSUBSCRIBE_USER_COUNT&&(m.w("".concat(t," ").concat(os(this.MAX_UNSUBSCRIBE_USER_COUNT))),s=n.slice(0,this.MAX_UNSUBSCRIBE_USER_COUNT)),new K(l)),a="userID count:".concat(n.length),l=(m.l("".concat(t," ").concat(a)),{userIDList:s});return s.length===0&&(l.userIDList=void 0,l.unsubscribeAll=1),this._userM.req({P:E.UNSUB_USER_STATUS,data:l}).then(function(d){return d=d.data.failureUserList,d=(d===void 0?[]:d).map(function(S){var g=S.userID,_=S.invalidUserID,M=S.errorCode,S=S.errorInfo;return{userID:se(_)?g:_,code:M,message:S}}),r.setMessage("".concat(a," fail count:").concat(d.length)).end(),m.l("".concat(t," ok. fail count:").concat(d.length,".")),me({failureUserList:d})}).catch(function(d){return r.setMessage("".concat(a)).setError(d).end(),m.e("".concat(t," failed. error:"),d),A(d)})}},{key:"reset",value:function(){this.MAX_QUERY_USER_COUNT=500,this.MAX_SUBSCRIBE_USER_COUNT=100,this.MAX_UNSUBSCRIBE_USER_COUNT=100}}]),Su),eI=(T(xr,St),yf=z(xr),y(xr,[{key:"onContextUpdated",value:function(e){this._profileHandler.getMyProfile(),this._blacklistHandler.getBlacklist()}},{key:"mockOnNickAvatarModified",value:function(e,t){m.l("".concat(this._n,"._mockOnNickAvatarModified nick:").concat(e," avatar:").concat(t)),this.onProfileModified({dataList:[{pushType:1,userID:this.getMyUserID(),profileList:[{tag:Ve.NICK,value:e},{tag:Ve.AVATAR,value:t}]}]})}},{key:"onProfileModified",value:function(e){this._profileHandler.onProfileModified(e)}},{key:"onRelationChainModified",value:function(s){var t,n,s=s.dataList;se(s)||(t=[],s.forEach(function(r){r.blackListDelAccount&&t.push.apply(t,q(r.blackListDelAccount))}),0<t.length&&this._blacklistHandler.onAccountDeleted(t),n=[],s.forEach(function(r){r.blackListAddAccount&&n.push.apply(n,q(r.blackListAddAccount))}),0<n.length&&this._blacklistHandler.onAccountAdded(n))}},{key:"onConvProfileUpdated",value:function(e){this._profileHandler.onConvProfileUpdated(e)}},{key:"getMyAccount",value:function(){return this.getMyUserID()}},{key:"getMyNick",value:function(){return this._profileHandler.getNickAndAvatarByUserID(this.getMyUserID()).nick}},{key:"getMyProfile",value:function(){return this._profileHandler.getMyProfile()}},{key:"getStorageModule",value:function(){return this.get(13)}},{key:"filterProfanity",value:function(e,t){var s=this.get(29);if(!s)return!0;var s=s.filterText(t[e],"user_profile"),n=s.isAllowedToSend,s=s.modifiedText;return n===!0&&(t[e]=s,!0)}},{key:"isMyFriend",value:function(e){var t=this.get(8);return!!t&&t.isMyFriend(e)}},{key:"getUserProfile",value:function(e){return this._profileHandler.getUserProfile(e)}},{key:"updateMyProfile",value:function(e){return this._profileHandler.updateMyProfile(e)}},{key:"getNickAndAvatarByUserID",value:function(e){return this._profileHandler.getNickAndAvatarByUserID(e)}},{key:"getUserNickAndAvatar",value:function(e){return this._profileHandler.getUserNickAndAvatar(e)}},{key:"getLocalBlacklist",value:function(){var e=this._blacklistHandler.getLocalBlacklist();return Pe(e)}},{key:"addBlacklist",value:function(e){return this._blacklistHandler.addBlacklist(e)}},{key:"deleteBlacklist",value:function(e){return this._blacklistHandler.deleteBlacklist(e)}},{key:"onUserStatusUpdated",value:function(e){this._userStatusHandler.onUserStatusUpdated(e)}},{key:"setSelfStatus",value:function(e){return this._userStatusHandler.setSelfStatus(e)}},{key:"getUserStatus",value:function(e){return this._userStatusHandler.getUserStatus(e)}},{key:"subscribeUserStatus",value:function(e){return this._userStatusHandler.subscribeUserStatus(e)}},{key:"unsubscribeUserStatus",value:function(e){return this._userStatusHandler.unsubscribeUserStatus(e)}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._profileHandler.reset(),this._blacklistHandler.reset(),this._userStatusHandler.reset()}}]),xr),tI=(y(Du,[{key:"isLoggedIn",value:function(){return this._isLoggedIn}},{key:"isOversea",value:function(){return this._oversea}},{key:"isPrivateNetWork",value:function(){return this._proxyServer}},{key:"isDevMode",value:function(){return this._isDevMode}},{key:"isTestEnv",value:function(){return this._isTestEnv}},{key:"isPartialUpdatedConvs",value:function(){return this._isPartialUpdatedConvs}},{key:"isIndependentDomainDisabled",value:function(){return this._isIndependentDomainDisabled}},{key:"isSingaporeSite",value:function(){return 2e7<=this._SDKAppID&&this._SDKAppID<3e7||172e7<=this._SDKAppID&&this._SDKAppID<173e7}},{key:"isKoreaSite",value:function(){return 3e7<=this._SDKAppID&&this._SDKAppID<4e7||173e7<=this._SDKAppID&&this._SDKAppID<174e7}},{key:"isGermanySite",value:function(){return 4e7<=this._SDKAppID&&this._SDKAppID<5e7||174e7<=this._SDKAppID&&this._SDKAppID<175e7}},{key:"isIndiaSite",value:function(){return 5e7<=this._SDKAppID&&this._SDKAppID<6e7||175e7<=this._SDKAppID&&this._SDKAppID<176e7}},{key:"isJapanSite",value:function(){return 6e7<=this._SDKAppID&&this._SDKAppID<7e7||176e7<=this._SDKAppID&&this._SDKAppID<177e7}},{key:"isUSASite",value:function(){return 7e7<=this._SDKAppID&&this._SDKAppID<8e7||177e7<=this._SDKAppID&&this._SDKAppID<178e7}},{key:"isIndonesiaSite",value:function(){return 8e7<=this._SDKAppID&&this._SDKAppID<9e7||178e7<=this._SDKAppID&&this._SDKAppID<179e7}},{key:"isIntl",value:function(){return(e=this._SDKAppID)===0||2e7<=e&&e<9e7||172e7<=e&&e<179e7;var e}},{key:"isUnlimitedAVChatRoom",value:function(){return this._unlimitedAVChatRoom}},{key:"isUsingChatCore",value:function(){return this._isUsingChatCore}},{key:"setUsingChatCore",value:function(e){this._isUsingChatCore=e}},{key:"getUIPlatform",value:function(){return this._uiPlatform}},{key:"setUIPlatform",value:function(e){this._uiPlatform=e}},{key:"setUserID",value:function(e){this._userID=e}},{key:"getUserID",value:function(){return this._userID}},{key:"setUserSig",value:function(e){this._userSig=e}},{key:"getUserSig",value:function(){return this._userSig}},{key:"getSDKAppID",value:function(){return this._SDKAppID}},{key:"setTinyID",value:function(e){this._tinyID=e,this._isLoggedIn=!0}},{key:"getTinyID",value:function(){return this._tinyID}},{key:"setCustomStatus",value:function(e){this._customStatus=e}},{key:"getCustomStatus",value:function(){return this._customStatus}},{key:"getScene",value:function(){return ko?window.tencent_cloud_im_csig_flutter_for_web_25F_cy:this._isTUIKit()?"tuikit":this._scene}},{key:"getInstanceID",value:function(){return this._instanceID}},{key:"getStatusInstanceID",value:function(){return this._statusInstanceID}},{key:"setStatusInstanceID",value:function(e){this._statusInstanceID=e}},{key:"getVersion",value:function(){return this._version}},{key:"getA2Key",value:function(){return this._a2Key}},{key:"setA2Key",value:function(e){this._a2Key=e}},{key:"getContentType",value:function(){return this._contentType}},{key:"getProxyServer",value:function(){return this._proxyServer}},{key:"getFileUploadProxy",value:function(){return this._fileUploadProxy}},{key:"getFileDownloadProxy",value:function(){return this._fileDownloadProxy}},{key:"setApplicationID",value:function(e){this._applicationID=e}},{key:"getApplicationID",value:function(){return this._applicationID}},{key:"setDowloadFileAuthKey",value:function(e){this._authKey=e}},{key:"getDowloadFileAuthKey",value:function(){return this._authKey}},{key:"setCustomLoginInfo",value:function(e){this._customLoginInfo=e}},{key:"getCustomLoginInfo",value:function(){return this._customLoginInfo}},{key:"_isTUIKit",value:function(){var e=!1,t=!1,n=!1,s=!1,d=[];ee&&(d=Object.keys(le));for(var r=0,a=(d=Te?Object.keys(ce?uni:window):d).length;r<a;r++)if(d[r].toLowerCase().includes("uikit")){e=!0;break}var l,d=null,h=(ee&&!Yt(le.createGamePortal)&&Yt(getApp)&&!H(getApp())&&(l=getApp().globalData,dt(l)&&l.isTUIKit===!0&&(t=!0)),this._m.get(13).getStorageSync("TIM_".concat(this._SDKAppID,"_isTUIKit"))===!0&&(n=!0),null);if(Ce&&!Je&&typeof uni>"u"&&__wxConfig&&(h=__wxConfig.pages),Re&&typeof uni>"u"&&__qqConfig&&(h=__qqConfig.pages),_e(h)&&0<h.length){for(var g=0,_=h.length;g<_;g++)if(h[g].toLowerCase().includes("tui")){s=!0;break}h=null}return e||t||n||s}},{key:"reset",value:function(){this._isLoggedIn=!1,this._userSig="",this._a2Key="",this._tinyID="",this._customStatus="",this._statusInstanceID=0}}]),Du),nI={"k-vue2-pc":1,"k-vue2-h5":2,"k-vue2-h5-uni":3,"k-vue2-app-uni":4,"k-vue2-mp-uni":5,"k-vue2-pc-uni":6,"k-vue3-pc":7,"k-vue3-h5":8,"k-vue3-h5-uni":9,"k-vue3-app-uni":10,"k-vue3-mp-uni":11,"k-vue3-pc-uni":12,"k-rn":13},oI=(T(Fr,St),vf=z(Fr),y(Fr,[{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&e%this._helloInterval==0&&this._hello()}},{key:"getPushModule",value:function(){var e=void 0,t=this.get(36),n=this.get(28);return t.canIUseTIMPush()?e=t:n.canIUseOfflinePush()&&(e=n),e}},{key:"login",value:function(s){if(this.isLoggedIn())return t=this.getMyUserID(),(t=this.getErrMsg("RepeatLogin",t))&&m.w(t),Pe({actionStatus:"OK",errorCode:0,errorInfo:t,repeatLogin:!0});if(Date.now()-this._lastLoginTs<=15e3)return this.warn("LoggingIn",s.userID),A({code:F.REPEAT_LOGIN});m.l("".concat(this._n,".login userID:").concat(s.userID));var t=this._checkLoginInfo(s);if(t.code!==0)return A(t);var t=this.get(12),n=s.userID,s=s.userSig;return t.setUserID(n),t.setUserSig(s),this.get(20).updateProtocolConfig(),this._login()}},{key:"_login",value:function(){var e=this,t=this.get(12),n=t.getScene(),s=0,r=n,a=(n&&n.startsWith("k-")&&(r=nI[n],n="tuikit"),new K("login")),d=(a.setMessage("".concat(r)).setMoreMessage("identifier:".concat(this.getMyUserID())),n==="tuikit"),l=0,d=(ce?l=d?r===3||r===4||r===5||r===6?31:r===9||r===10||r===11||r===12?32:4:3:ee?l=De?36:n==="tuikit"?12:11:Te?l=ko?n==="flutter_web_uikit"?21:20:this._isReactUIKit()?bs?25:24:d?r===1||r===2?29:r===7||r===8?30:bs?17:14:bs?16:13:r===13&&(l=38),a.setUIPlatform(l),t.setUIPlatform(l),this.getPushModule()),h=(d&&(this._isWebUniapp=d.getUniAppPlatform(),r=this._getStatusInstanceID(),t.setStatusInstanceID(r),this.get(20).updateProtocolConfig(),s=d.getDeviceBrand()),"".concat(this._n,"._login"));return this._lastLoginTs=Date.now(),this.req({P:E.LOGIN,data:{deviceBrand:s,isWebUniapp:this._isWebUniapp,customInfo:t.getCustomLoginInfo()}}).then(function(g){e._lastLoginTs=0;var Be=Date.now(),_=null,J=g.data,M=J.a2Key,S=J.tinyID,D=J.helloInterval,O=J.instanceID,B=J.timeStamp,U=J.customStatus,U=U===void 0?"":U,de=J.purchaseBits,J=J.authKey,J=J===void 0?"":J,ke=1e3*B,Ae=Be-a.getStartTs(),Ae=ke+parseInt(Ae/2)-Be,Be=a.getStartTs()+Ae;if(a.start(Be),Be=ke,Cr=Ae,(ke=new Date).setTime(Be),m.i("baseTime from server:".concat(ke," offset:").concat(Cr)),!S)throw _=new yt({code:F.NO_TINYID}),a.setError(_).end(),_;if(!M)throw _=new yt({code:F.NO_A2KEY}),a.setError(_).end(),_;return Be=e.get(21).getSocketID(),ke=ga(U),_="socketID:".concat(Be," scene:").concat(n," helloInterval:").concat(D," instanceID:").concat(O," timeStamp:").concat(B)+" offset:".concat(Ae," customStatus:").concat(ke," isWebUniapp:").concat(e._isWebUniapp),m.l("".concat(h," ok. ").concat(_)),U="",Be="",Ce&&Yt(le.getAccountInfoSync)&&(B=le.getAccountInfoSync().miniProgram)&&(U=B.appId,Be=B.envVersion),a.setMoreMessage("".concat(_," href:").concat(Te?window.location.href:""," mpAppId:").concat(U," envVersion:").concat(Be," authKey:").concat(J)).end(),t.setA2Key(M),t.setTinyID(S),t.setStatusInstanceID(O),t.setCustomStatus(ke),t.setDowloadFileAuthKey(J),de&&e.get(27).onPushedConfig({errorCode:0,expiredTime:0,purchaseBits:de}),e.get(20).updateProtocolConfig(),e.emitIEvt(mt.A2KEY_AND_TINYID_UPDATED),e._helloInterval=D,e.triggerReady(),Ae=e.getPushModule(),Ae&&(uni.setStorageSync("timUniAppInstanceID",O),Ae.init()),e._fetchCloudControlConfig(),e.get(29).init(),g}).catch(function(g){return a.setError(g).end(!0),e._m.setNotReadyReason(F.LOGIN_FAILED),m.e("".concat(h," failed. error:"),g),e._lastLoginTs=0,e._m.onLoginFailed(),A(g)})}},{key:"logout",value:function(){var e=this,t=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,n="".concat(this._n,".logout"),s=this.isLoggedIn();return m.i("".concat(n," type:").concat(t," isLoggedIn:").concat(s," isWebUniapp:").concat(this._isWebUniapp)),s?(new K("logout").setMessage("identifier:".concat(this.getMyUserID())).end(!0),t===0&&this._m.setNotReadyReason(F.LOGGED_OUT),this.req({P:E.LOGOUT,data:{type:t,isWebUniapp:this._isWebUniapp}}).then(function(){return e.resetReady(),Pe({})}).catch(function(r){return m.e("".concat(n," error:"),r),e.resetReady(),Pe({})})):A({code:F.USER_NOT_LOGGED_IN})}},{key:"getLoginUser",value:function(){return this.isLoggedIn()?this.getMyUserID():""}},{key:"_fetchCloudControlConfig",value:function(){this.get(23).fetchConfig()}},{key:"_getStatusInstanceID",value:function(){return uni.getStorageSync("timUniAppInstanceID")||0}},{key:"_hello",value:function(){var e=this;this._lastWsHelloTs=Date.now(),this.req({P:E.HELLO,data:{isWebUniapp:this._isWebUniapp}}).catch(function(t){m.w("".concat(e._n,"._hello error:"),t)})}},{key:"getLastWsHelloTs",value:function(){return this._lastWsHelloTs}},{key:"_checkLoginInfo",value:function(e){var t=0;return se(this.get(12).getSDKAppID())?t=F.NO_SDKAPPID:se(e.userID)?t=F.NO_IDENTIFIER:se(e.userSig)&&(t=F.NO_USERSIG),{code:t}}},{key:"_isReactUIKit",value:function(){return Te&&window.tencent_cloud_im_csig_react_uikit_23F_xa!==void 0}},{key:"onMultipleAccountKickedOut",value:function(e){var t=this;new K("kickedOut").setMessage("type:".concat(I.KICKED_OUT_MULT_ACCOUNT," newInstanceInfo:").concat(JSON.stringify(e))).end(!0),m.w("".concat(this._n,".onMultipleAccountKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),e),this.logout(1).then(function(){t.emitOEvt($.KICKED_OUT,{type:I.KICKED_OUT_MULT_ACCOUNT}),t._m.setNotReadyReason(F.KICKED_OUT_MULT_ACCOUNT),t._m.reset()})}},{key:"onMultipleDeviceKickedOut",value:function(e){var t=this;new K("kickedOut").setMessage("type:".concat(I.KICKED_OUT_MULT_DEVICE," newInstanceInfo:").concat(JSON.stringify(e))).end(!0),m.w("".concat(this._n,".onMultipleDeviceKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),e),this.logout(1).then(function(){t.emitOEvt($.KICKED_OUT,{type:I.KICKED_OUT_MULT_DEVICE}),t._m.setNotReadyReason(F.KICKED_OUT_MULT_DEVICE),t._m.reset()})}},{key:"onUserSigExpired",value:function(){new K("kickedOut").setMessage(I.KICKED_OUT_USERSIG_EXPIRED).end(!0),m.w("".concat(this._n,".onUserSigExpired userID:").concat(this.getMyUserID())),this.get(12).getStatusInstanceID()!==0&&(this.emitOEvt($.KICKED_OUT,{type:I.KICKED_OUT_USERSIG_EXPIRED}),this._m.setNotReadyReason(F.KICKED_OUT_USERSIG_EXPIRED),this._m.reset())}},{key:"onRestApiKickedOut",value:function(e){new K("kickedOut").setMessage("type:".concat(I.KICKED_OUT_REST_API," newInstanceInfo:").concat(JSON.stringify(e))).end(!0),m.w("".concat(this._n,".onRestApiKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),e),this.get(12).getStatusInstanceID()!==0&&(this.emitOEvt($.KICKED_OUT,{type:I.KICKED_OUT_REST_API}),this._m.setNotReadyReason(F.KICKED_OUT_REST_API),this._m.reset(),this.get(21).onRestApiKickedOut())}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this.resetReady(),this._helloInterval=120,this._lastLoginTs=0,this._lastWsHelloTs=0,this._isWebUniapp=0}}]),Fr);function Fr(e){return f(this,Fr),(e=vf.call(this,e))._n="SignModule",e._helloInterval=120,e._lastLoginTs=0,e._lastWsHelloTs=0,e._isWebUniapp=0,Tu.mixin(V(e)),e}function Du(e,t){f(this,Du),this._m=e,this._isLoggedIn=!1,this._SDKAppID=t.SDKAppID,this._userID=t.userID||"",this._userSig=t.userSig||"",this._version="3.5.2",this._a2Key="",this._tinyID="",this._customStatus="",this._contentType="json",this._unlimitedAVChatRoom=t.unlimitedAVChatRoom,this._scene=t.scene||"",this._oversea=t.oversea,this._instanceID=t.instanceID,this._statusInstanceID=0,this._isDevMode=t.devMode,this._isTestEnv=t.testEnv,this._proxyServer=t.proxyServer,this._fileUploadProxy=t.fileUploadProxy,this._fileDownloadProxy=t.fileDownloadProxy,this._applicationID=0,this._isPartialUpdatedConvs=t.partialUpdatedConversations,this._isIndependentDomainDisabled=t.disableIndependentDomain,this._isUsingChatCore=!1,this._uiPlatform=0,this._authKey="",this._customLoginInfo=""}function xr(e){return f(this,xr),(e=yf.call(this,e))._n="UserModule",e._profileHandler=new Xy(V(e)),e._blacklistHandler=new Zy(V(e)),e._userStatusHandler=new Qy(V(e)),e.getIEmitInst().on(mt.A2KEY_AND_TINYID_UPDATED,e.onContextUpdated,V(e)),e}function Su(e){f(this,Su),this._userM=e,this._n="UserStatusHandler",this.MAX_QUERY_USER_COUNT=500,this.MAX_SUBSCRIBE_USER_COUNT=100,this.MAX_UNSUBSCRIBE_USER_COUNT=100,this._userM.getIEmitInst().on(mt.CLOUD_CONFIG,this._onCloudConfig,this)}function Lu(e){f(this,Lu),this._userM=e,this._n="BlacklistHandler",this._blacklistMap=new Map,this._startIndex=0}function Ru(e){f(this,Ru),this._userM=e,this._n="ProfileHandler",this.TAG="profile",this.accountProfileMap=new Map,this.expirationTime=864e5}function qr(e){return f(this,qr),(e=If.call(this,e))._n="TopicModule",e._topicMap=new Map,e._getTopicTimeMap=new Map,e.TOPIC_CACHE_TIME=300,e.TOPIC_LAST_ACTIVE_TIME=3600,e.getIEmitInst().on(mt.CLOUD_CONFIG,e._onCloudConfig,V(e)),e}function ku(e,t){f(this,ku),this.topicID="",this.topicName="",this.avatar="",this.introduction="",this.notification="",this.unreadCount=0,this.muteAllMembers=!1,this.customData="",this.groupAtInfoList=[],this.nextMessageSeq=0,this.lastMessage=mf(e.lastMessage,t),this.selfInfo={muteTime:0,readedSequence:0,messageRemindType:"",excludedUnreadSequenceList:void 0},this._initTopic(e)}function Vr(e){return f(this,Vr),(e=Mf.call(this,e))._n="GroupModule",e._commonGroupHandler=new Uy(V(e)),e._groupAttributesHandler=new Fy(V(e)),e._groupCountersHandler=new xy(V(e)),e._AVChatRoomHandler=new Vy(V(e)),e._groupTipsHandler=new wy(V(e)),e._groupSystemNoticeHandler=new jy(V(e)),e._groupMemberHandler=new Hy(V(e)),e.groupMap=new Map,e._unjoinedAVChatRoomList=new Map,e._receiptDetailCompleteMap=new Map,e._onlineMemberCountMap=new Map,e._timeoutIDs=[],e.getIEmitInst().on(mt.CLOUD_CONFIG,e._onCloudConfig,V(e)),e}function Au(e){f(this,Au),this._grpM=e,this._n="GroupSystemNoticeHandler",this.pendencyMap=new Map}function Ou(e){f(this,Ou),this._grpM=e,this._n="GroupMemberHandler",this.groupMemberListMap=new Map,this.DEFAULT_MEMBER_INFO_FILTER=["Role","JoinTime","NameCard","ShutUpUntil","OnlineStatus"],this._grpM.getIEmitInst().on(mt.PROFILE_UPDATED,this._onProfileUpdated,this)}function Nu(e){f(this,Nu),this.userID="",this.avatar="",this.nick="",this.role="",this.joinTime="",this.lastSendMsgTime="",this.nameCard="",this.muteUntil=0,this.memberCustomField=[],this.isOnline=!1,this.updateMember(e)}function Pu(e){f(this,Pu),this._grpM=e,this._n="AVChatRoomHandler",this._joinedGroupMap=new Map,this._pollingRequestInfoMap=new Map,this._pollingInstanceMap=new Map,this._seqSll=new Eu(200),this._IDSll=new Eu(100),this._reportMessageStackedCount=0,this._onlineMemberCountMap=new Map,this.DEFAULT_EXPIRE_TIME=60,this.DEFAULT_POLLING_INTERVAL=300,this.MAX_POLLING_INTERVAL=2e3,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL,this.DEFAULT_POLLING_NO_MESSAGE_COUNT=20,this.DEFAULT_POLLING_INTERVAL_PLUS=2e3,this._pollingNoMessageCount=0,this._startBroadcastSeq=1,this._broadcastMessageIDMap=new Map,this.DEFAULT_POLLING_SIMPLIFIED_MSG=0}function bu(a){f(this,bu);var t=a.manager,n=a.groupID,s=a.onInit,r=a.onSuccess,a=a.onFail;this._n="Polling",this._manager=t,this._grpM=t._grpM,this._onInit=s,this._onSuccess=r,this._onFail=a,this._groupID=n,this._timeoutID=-1,this._isRunning=!1,this._proto=E.AV_POLLING}function Gu(e){f(this,Gu),this._grpM=e,this._n="GroupCountersHandler",this._groupCountersMap=new Map,this.EXPIRE_TIME=3e4,this._grpM.getIEmitInst().on(mt.CLOUD_CONFIG,this._onCloudConfig,this)}function wu(e){f(this,wu),this._grpM=e,this._n="GroupAttributesHandler",this._groupAttributesMap=new Map,this._groupAttributesCopy={},this.CACHE_EXPIRE_TIME=3e4,this._grpM.getIEmitInst().on(mt.CLOUD_CONFIG,this._onCloudConfig,this)}function Uu(e){f(this,Uu),this._grpM=e,this._n="CommonGroupHandler",this.tempConversationList=null,this._cachedGroupMessageMap=new Map,this._checkCountMap=new Map,this.MAX_CHECK_COUNT=4,this.PAGING_GRP_COUNT_LIMIT=200,this._pagingStatus=yo,this._pagingGetCostList=[],e.getIEmitInst().on(mt.A2KEY_AND_TINYID_UPDATED,this.syncGroupList,this)}function Fu(e){f(this,Fu),this._grpM=e,this._n="GroupTipsHandler",this._cachedGroupTipsMap=new Map,this._checkCountMap=new Map,this.MAX_CHECK_COUNT=4}function Br(e){return f(this,Br),(e=Cf.call(this,e))._n="ConvModule",Tu.mixin(V(e)),e._msgListHandler=new ky(V(e)),e._msgRemindHandler=new Py(V(e)),e._convGroupHandler=new by(V(e)),e._sll=new Eu(100),e._pagingStatus=yo,e._pagingTs=0,e._pagingStartIdx=0,e._pagingPinnedTs=0,e._pagingPinnedStartIdx=0,e._pagingConvIDMap=new Map,e._convIDFromUnreadDBMap=new Map,e._convMap=new Map,e._tmpGroupList=[],e._tmpGroupAtTipsList=[],e._peerReadTimeMap=new Map,e._completedMap=new Map,e._roamingMsgKeyAndTimeMap=new Map,e._remoteGroupReadSeqMap=new Map,e._convTotalUnreadCount=0,e._pagingGetCostList=[],e._convMapForDiff=new Map,e._partialUpdatedConvMap=new Map,e._everClearedMap=new Map,e._bPullOnInvite=!0,e._initListeners(),e}function xu(e){f(this,xu),this._convM=e,this._n="ConvGroupHandler",this._convGroupMap=new Map,this._startIndex=0,this._pagingStatus=yo}function qu(e){f(this,qu),this._convM=e,this._n="MsgRemindHandler"}function Vu(e,t){var n=2<arguments.length&&arguments[2]!==void 0&&arguments[2];f(this,Vu),this.conversationID=e.conversationID||"",this.unreadCount=e.unreadCount||0,this.type=e.type||"",this.lastMessage=_f(e.lastMessage,t,n),e.lastMsgTime&&(this.lastMessage.lastTime=e.lastMsgTime),this._isInfoCompleted=!1,this.peerReadTime=e.peerReadTime||0,this.groupAtInfoList=[],this.remark="",this.isPinned=e.isPinned||!1,this.messageRemindType=e.messageRemindType,this.markList=e.markList||[],this.customData=e.customData||"",this.conversationGroupList=e.conversationGroupList||[],this.draftText=e.draftText||"",this._initProfile(e),this.subType=this.groupProfile?this.groupProfile.type:""}function Bu(e){f(this,Bu),this.groupID="",this.name="",this.avatar="",this.type="",this.introduction="",this.notification="",this.ownerID="",this.createTime="",this.infoSequence="",this.lastInfoTime="",this.selfInfo={messageRemindType:"",joinTime:"",nameCard:"",role:"",userID:"",memberCustomField:void 0,readedSequence:0,excludedUnreadSequenceList:void 0},this.lastMessage={lastTime:"",lastSequence:"",fromAccount:"",messageForShow:""},this.nextMessageSeq="",this.memberNum="",this.memberCount="",this.maxMemberNum="",this.maxMemberCount="",this.joinOption="",this.inviteOption="",this.groupCustomField=[],this.muteAllMembers=!1,this.isSupportTopic=!1,this._lastRevokedTime=0,this._initGroup(e)}function Hu(e){f(this,Hu),this.MAX_LENGTH=e,this.map=new Map}function Ku(e){var t=this;f(this,Ku),se(e)||(this.userID=e.userID||"",this.nick=e.nick||"",this.gender=e.gender||"",this.birthday=e.birthday||0,this.location=e.location||"",this.selfSignature=e.selfSignature||"",this.allowType=e.allowType||I.ALLOW_TYPE_ALLOW_ANY,this.language=e.language||0,this.avatar=e.avatar||"",this.messageSettings=e.messageSettings||0,this.adminForbidType=e.adminForbidType||I.FORBID_TYPE_NONE,this.level=e.level||0,this.role=e.role||0,this.lastUpdatedTime=0,this.profileCustomField=[],se(e.profileCustomField)||e.profileCustomField.forEach(function(n){t.profileCustomField.push({key:n.key,value:n.value})}))}function _a(){return null}function Sf(e){var t=e.get(12);return{SDKType:10,SDKAppID:t.getSDKAppID(),SDKVersion:t.getVersion(),tinyID:Number(t.getTinyID()),userID:t.getUserID(),platform:e.getPlatform(),instanceID:t.getInstanceID(),traceID:Wn()}}y($u,[{key:"_errorTolerantHandle",value:function(){ee||typeof window<"u"&&this._canIUseCookies()||(this.getItem=_a,this.setItem=_a,this.removeItem=_a,this.clear=_a)}},{key:"onCheckTimer",value:function(e){e%20==0&&this._storageQueue.size!==0&&this._doFlush()}},{key:"_doFlush",value:function(){try{var e,t=ye(this._storageQueue);try{for(t.s();!(e=t.n()).done;){var n=te(e.value,2),s=n[0],r=n[1];this._setStorageSync(this._getKey(s),r)}}catch(a){t.e(a)}finally{t.f()}this._storageQueue.clear()}catch(a){m.w("".concat(this._n,"._doFlush error:"),a)}}},{key:"_getPrefix",value:function(){var e=this._m.get(12);return"TIM_".concat(e.getSDKAppID(),"_").concat(e.getUserID(),"_")}},{key:"_getKey",value:function(e){return"".concat(this._getPrefix()).concat(e)}},{key:"getItem",value:function(e){var t=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1];try{var n=t?this._getKey(e):e;return this.getStorageSync(n)}catch(s){return m.w("".concat(this._n,".getItem error:"),s),{}}}},{key:"setItem",value:function(e,t){var n;2<arguments.length&&arguments[2]!==void 0&&arguments[2]?(n=!(3<arguments.length&&arguments[3]!==void 0)||arguments[3]?this._getKey(e):e,this._setStorageSync(n,t)):this._storageQueue.set(e,t)}},{key:"clear",value:function(){try{ee?le.clearStorageSync():this._canIUseCookies()&&localStorage.clear()}catch(e){m.w("".concat(this._n,".clear error:"),e)}}},{key:"removeItem",value:function(e){var t=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1];try{var n=t?this._getKey(e):e;this._removeStorageSync(n)}catch(s){m.w("".concat(this._n,".removeItem error:"),s)}}},{key:"getSize",value:function(e){var t=this,n=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"b";try{var s={size:0,limitSize:5242880,unit:n};if(Object.defineProperty(s,"leftSize",{enumerable:!0,get:function(){return s.limitSize-s.size}}),ee&&(s.limitSize=1024*le.getStorageInfoSync().limitSize),e)s.size=JSON.stringify(this.getItem(e)).length+this._getKey(e).length;else if(ee)le.getStorageInfoSync().keys.forEach(function(a){s.size+=JSON.stringify(t.getStorageSync(a)).length+t._getKey(a).length});else if(this._canIUseCookies())for(var r in localStorage)localStorage.hasOwnProperty(r)&&(s.size+=localStorage.getItem(r).length+r.length);return this._convertUnit(s)}catch(a){m.w("".concat(this._n," error:"),a)}}},{key:"_convertUnit",value:function(e){var t,n={},s=e.unit;for(t in n.unit=s,e)typeof e[t]=="number"&&(s.toLowerCase()==="kb"?n[t]=Math.round(e[t]/1024):s.toLowerCase()==="mb"?n[t]=Math.round(e[t]/1024/1024):n[t]=e[t]);return n}},{key:"_setStorageSync",value:function(e,t){ee?w?my.setStorageSync({key:e,data:t}):le.setStorageSync(e,t):this._canIUseCookies()&&localStorage.setItem(e,JSON.stringify(t))}},{key:"getStorageSync",value:function(e){return ee?w?my.getStorageSync({key:e}).data:le.getStorageSync(e):this._canIUseCookies()?JSON.parse(localStorage.getItem(e)):{}}},{key:"_removeStorageSync",value:function(e){ee?w?my.removeStorageSync({key:e}):le.removeStorageSync(e):this._canIUseCookies()&&localStorage.removeItem(e)}},{key:"_canIUseCookies",value:function(){return typeof window<"u"&&navigator&&navigator.cookieEnabled&&localStorage}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._doFlush()}}]);var Lf,sI=$u,rI=(y(zu,[{key:"pushIn",value:function(e){m.d("".concat(this._n,".pushIn"),this._report.length,e),this._report.push(e)}},{key:"backfill",value:function(e){var t;_e(e)&&e.length!==0&&(m.d("".concat(this._n,".backfill"),this._report.length,e.length),(t=this._report).unshift.apply(t,q(e)))}},{key:"getLogsNumInMemory",value:function(){return this._report.length}},{key:"isEmpty",value:function(){return this._report.length===0}},{key:"_reset",value:function(){this._report.length=0,this._report=[]}},{key:"getLogsInMemory",value:function(){var e=this._report.slice();return this._reset(),e}}]),zu),iI=(T(Hr,St),Lf=z(Hr),y(Hr,[{key:"reportAtOnce",value:function(){this._report()}},{key:"_onLoginSuccess",value:function(){var e=this,t=this.get(13),n=t.getItem(this.TAG,!1);!se(n)&&Yt(n.forEach)&&(m.l("".concat(this._n,"._onLoginSuccess. logs count:").concat(n.length)),n.forEach(function(s){e._reportBody.pushIn(s)}),t.removeItem(this.TAG,!1))}},{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("evt_rpt_threshold"),t=this.getCloudConfig("evt_rpt_waiting"),n=this.getCloudConfig("evt_rpt_level"),s=this.getCloudConfig("evt_rpt_sdkappid_bl"),r=this.getCloudConfig("evt_rpt_tinyid_wl");H(e)||(this.MIN_THRESHOLD=Number(e)),H(t)||(this.WAITING_TIME=Number(t)),H(n)||(this.REPORT_LEVEL=n.split(",").map(function(a){return Number(a)})),H(s)||(this.REPORT_SDKAPPID_BLACKLIST=s.split(",").map(function(a){return Number(a)})),H(r)||(this.REPORT_TINYID_WHITELIST=r.split(","))}},{key:"pushIn",value:function(e){e instanceof K&&(e.updateTimeStamp(),this._reportBody.pushIn(e),this._reportBody.getLogsNumInMemory()>=this.MIN_THRESHOLD&&this._report())}},{key:"onCheckTimer",value:function(){Date.now()<this._lastReportTime+this.WAITING_TIME||this._reportBody.isEmpty()||this._report()}},{key:"_filterLogs",value:function(e){var t=this,s=this.get(12),n=s.getSDKAppID(),s=s.getTinyID();return $p(this.REPORT_SDKAPPID_BLACKLIST,n)&&!Jp(this.REPORT_TINYID_WHITELIST,s)?[]:e.filter(function(r){return t.REPORT_LEVEL.includes(r.level)})}},{key:"_report",value:function(){var e,t,n=this;this._reportBody.isEmpty()||(e=this._reportBody.getLogsInMemory(),(t=this._filterLogs(e)).length!==0?(t={header:Sf(this),event:t},this.req({P:E.SSO_STAT,data:c({},t)}).then(function(){n._lastReportTime=Date.now()}).catch(function(s){m.w("".concat(n._n,"._report failed. error:"),s),n._lastReportTime=Date.now(),n._reportBody.backfill(e),n._reportBody.getLogsNumInMemory()>n.MAX_THRESHOLD&&n._flushAtOnce()})):this._lastReportTime=Date.now())}},{key:"_flushAtOnce",value:function(){var e=this.get(13),t=e.getItem(this.TAG,!1),n=this._reportBody.getLogsInMemory(),s="".concat(this._n,"._flushAtOnce");se(t)?(m.l("".concat(s," count:").concat(n.length)),e.setItem(this.TAG,n,!0,!1)):((n=n.concat(t)).length>this.MAX_THRESHOLD&&(n=n.slice(0,this.MAX_THRESHOLD)),m.l("".concat(s," count:").concat(n.length)),e.setItem(this.TAG,n,!0,!1))}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._lastReportTime=0,this._report(),this.REPORT_SDKAPPID_BLACKLIST=[],this.REPORT_TINYID_WHITELIST=[]}}]),Hr),ju="none",Wu="online",aI=(y(Yu,[{key:"_startRN",value:function(){var e,t=this;!pe||(e=this._m.get(18).getPlugin("chat-network-monitor"))&&(this._removeListener=e.addEventListener(function(r){var s=r.isConnected,r=r.type;t._networkType!==r&&t._onNetworkStatusChange({isConnected:s!==void 0&&s,networkType:r})}))}},{key:"start",value:function(){var e=this,t="".concat(this._n,".start");ee?(le.getNetworkType({success:function(n){e._networkType=n.networkType||n.subtype||"",n.networkType===ju?m.w("".concat(t," no network, please check!")):m.i("".concat(t," networkType:").concat(n.networkType))}}),this._mpNetworkStatusCallback=this._onNetworkStatusChange.bind(this),le.onNetworkStatusChange(this._mpNetworkStatusCallback)):Te&&(this._networkType=Wu,this._webOnlineCallback=this._onWebOnline.bind(this),this._webOfflineCallback=this._onWebOffline.bind(this),window.addEventListener("online",this._webOnlineCallback),window.addEventListener("offline",this._webOfflineCallback))}},{key:"_onWebOnline",value:function(){this._onNetworkStatusChange({isConnected:!0,networkType:Wu})}},{key:"_onWebOffline",value:function(){this._onNetworkStatusChange({isConnected:!1,networkType:ju})}},{key:"_onNetworkStatusChange",value:function(n){var t=n.isConnected,n=n.networkType,s="".concat(this._n,"._onNetworkStatusChange"),r=!1,a="previous:".concat(this._networkType," current:").concat(n);t?(m.i("".concat(s," ").concat(a)),this._networkType!==n&&(r=!0,this._networkType=n,this._m.get(21).reConnect(!0))):this._networkType!==n&&(r=!0,this._networkType=n,m.w("".concat(s," no network, please check!")),this._m.get(21).offline()),r&&new K("networkChange").setMessage("isConnected:".concat(t," ").concat(a)).end()}},{key:"isOnline",value:function(){return this._networkType!==ju}},{key:"getNetworkType",value:function(){return this._networkType}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),ee?this._mpNetworkStatusCallback!==null&&(le.offNetworkStatusChange&&le.offNetworkStatusChange(this._mpNetworkStatusCallback),this._mpNetworkStatusCallback=null):Te?(this._webOnlineCallback!==null&&(window.removeEventListener("online",this._webOnlineCallback),this._webOnlineCallback=null),this._onWebOffline!==null&&(window.removeEventListener("offline",this._webOfflineCallback),this._webOfflineCallback=null)):pe&&this._removeListener&&(this._removeListener(),this._removeListener=null)}}]),Yu);function Yu(e){f(this,Yu),this._m=e,this._networkType=Wu,this._n="NetMonitorModule",this._mpNetworkStatusCallback=null,this._webOnlineCallback=null,this._webOfflineCallback=null,this._removeListener=null,this._m.getIEmitInst().on(mt.A2KEY_AND_TINYID_UPDATED,this._startRN,this)}function Hr(e){f(this,Hr),(e=Lf.call(this,e))._n="EventStatModule",e.TAG="im-ssolog-event",e._reportBody=new rI,e.MIN_THRESHOLD=20,e.MAX_THRESHOLD=100,e.WAITING_TIME=6e4,e.REPORT_LEVEL=[4,5,6],e.REPORT_SDKAPPID_BLACKLIST=[],e.REPORT_TINYID_WHITELIST=[],e._lastReportTime=Date.now();var t=e.getIEmitInst();return t.on(mt.A2KEY_AND_TINYID_UPDATED,e._onLoginSuccess,V(e)),t.on(mt.CLOUD_CONFIG,e._onCloudConfig,V(e)),e}function zu(e){f(this,zu),this._n="SSOLogBody",this._report=[]}function $u(e){f(this,$u),this._m=e,this._n="StorageModule",this._storageQueue=new Map,this._errorTolerantHandle()}function Rf(e,t){return e(t={exports:{}},t.exports),t.exports}var kf,Af=Rf(function(e){var t=Object.prototype.hasOwnProperty,n="~";function s(){}function r(h,g,_){this.fn=h,this.context=g,this.once=_||!1}function a(h,g,_,M,S){if(typeof _!="function")throw new TypeError("The listener must be a function");return _=new r(_,M||h,S),M=n?n+g:g,h._events[M]?h._events[M].fn?h._events[M]=[h._events[M],_]:h._events[M].push(_):(h._events[M]=_,h._eventsCount++),h}function l(h,g){--h._eventsCount==0?h._events=new s:delete h._events[g]}function d(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(n=!1)),d.prototype.eventNames=function(){var h,g,_=[];if(this._eventsCount===0)return _;for(g in h=this._events)t.call(h,g)&&_.push(n?g.slice(1):g);return Object.getOwnPropertySymbols?_.concat(Object.getOwnPropertySymbols(h)):_},d.prototype.listeners=function(g){var g=n?n+g:g,_=this._events[g];if(!_)return[];if(_.fn)return[_.fn];for(var M=0,S=_.length,D=new Array(S);M<S;M++)D[M]=_[M].fn;return D},d.prototype.listenerCount=function(h){return h=n?n+h:h,h=this._events[h],h?h.fn?1:h.length:0},d.prototype.emit=function(h,g,_,M,S,D){var O=n?n+h:h;if(!this._events[O])return!1;var B,U=this._events[O],de=arguments.length;if(U.fn){switch(U.once&&this.removeListener(h,U.fn,void 0,!0),de){case 1:return U.fn.call(U.context),!0;case 2:return U.fn.call(U.context,g),!0;case 3:return U.fn.call(U.context,g,_),!0;case 4:return U.fn.call(U.context,g,_,M),!0;case 5:return U.fn.call(U.context,g,_,M,S),!0;case 6:return U.fn.call(U.context,g,_,M,S,D),!0}for(Ae=1,B=new Array(de-1);Ae<de;Ae++)B[Ae-1]=arguments[Ae];U.fn.apply(U.context,B)}else for(var J,ke=U.length,Ae=0;Ae<ke;Ae++)switch(U[Ae].once&&this.removeListener(h,U[Ae].fn,void 0,!0),de){case 1:U[Ae].fn.call(U[Ae].context);break;case 2:U[Ae].fn.call(U[Ae].context,g);break;case 3:U[Ae].fn.call(U[Ae].context,g,_);break;case 4:U[Ae].fn.call(U[Ae].context,g,_,M);break;default:if(!B)for(J=1,B=new Array(de-1);J<de;J++)B[J-1]=arguments[J];U[Ae].fn.apply(U[Ae].context,B)}return!0},d.prototype.on=function(h,g,_){return a(this,h,g,_,!1)},d.prototype.once=function(h,g,_){return a(this,h,g,_,!0)},d.prototype.removeListener=function(h,g,_,M){if(h=n?n+h:h,!this._events[h])return this;if(!g)return l(this,h),this;var S=this._events[h];if(S.fn)S.fn!==g||M&&!S.once||_&&S.context!==_||l(this,h);else{for(var D=0,O=[],B=S.length;D<B;D++)(S[D].fn!==g||M&&!S[D].once||_&&S[D].context!==_)&&O.push(S[D]);O.length?this._events[h]=O.length===1?O[0]:O:l(this,h)}return this},d.prototype.removeAllListeners=function(h){return h?(h=n?n+h:h,this._events[h]&&l(this,h)):(this._events=new s,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=n,e.exports=d.EventEmitter=d}),cI=["rich.my-imcloud.com","imrich.qcloud.com"],uI=["requestSnapshotUrl"],lI=(T(Kr,St),kf=z(Kr),y(Kr,[{key:"_init",value:function(){this._fileDownloadProxy=this.getFileDownloadProxy(),this._authKey=this.getDowloadFileAuthKey();var e=this.get(18);this.TIMUploadPlugin=e.getPlugin("tim-upload-plugin"),this.TIMUploadPlugin?this._initUploaderMethod():(this.COSSDK=e.getPlugin(e=ee?"cos-wx-sdk":"cos-js-sdk"),this.COSSDK?(this._getAuthorizationKey(),this.warn("CosReplacement",e)):this.warn("PluginUndetected"))}},{key:"_onCloudConfig",value:function(){var e=this,t="".concat(this._n,"._onCloudConfig"),n=this.getCloudConfig("upload_size_limit"),s=this.getCloudConfig("simple_cos"),r=this.getCloudConfig("file_dn_list");if(m.l("".concat(t," uploadSizeLimit:").concat(n," simpleCos:").concat(s)),!H(n))try{var a=JSON.parse(n);this.UPLOAD_SIZE_LIMIT={A:a.a?1048576*parseInt(a.a):this.UPLOAD_SIZE_LIMIT.A,F:a.f?1048576*parseInt(a.f):this.UPLOAD_SIZE_LIMIT.F,I:a.i?1048576*parseInt(a.i):this.UPLOAD_SIZE_LIMIT.I,V:a.v?1048576*parseInt(a.v):this.UPLOAD_SIZE_LIMIT.V}}catch{}if(H(s)||(this.isSimpleCos=s==="1"),!H(r))try{JSON.parse(r).forEach(function(l){e._fileDNList.includes(l)||e._fileDNList.push(l)})}catch{}}},{key:"_getAuthorizationKey",value:function(){var e=this,t="".concat(this._n,".").concat("_getAuthorizationKey"),n=new K("_getAuthorizationKey"),s=Math.ceil(Date.now()/1e3);this.req({P:E.COS_SIGN,data:{duration:this.expiredTimeLimit}}).then(function(a){var a=a.data,l=(m.l("".concat(t," ok. data:"),a),a.expiredTime-s);n.setMessage("requestId:".concat(a.requestId," requestTime:").concat(s," expiredTime:").concat(a.expiredTime," diff:").concat(l,"s")).end(),!ee&&a.region&&(e.region=a.region),e.appid=a.appid,e.bucketName=a.bucketName,e.ciUrl=a.ciUrl,e.directory=a.directory,e.downloadUrl=a.downloadUrl,e.uploadUrl=a.uploadUrl,e.cosOptions={secretId:a.secretId,secretKey:a.secretKey,sessionToken:a.sessionToken,expiredTime:a.expiredTime},m.l("".concat(t," ok. region:").concat(e.region," bucketName:").concat(e.bucketName)),e._initUploaderMethod()}).catch(function(r){n.setError(r).end(),m.w("".concat(t," failed. error:"),r)})}},{key:"_getCosPreSigUrl",value:function(e){var t=this,n="".concat(this._n,".").concat("_getCosPreSigUrl"),s=Math.ceil(Date.now()/1e3),r=new K("_getCosPreSigUrl"),a={uploadMethod:e.uploadMethod,platform:this.getPlatform(),SDKAppID:this.getSDKAppID(),userID:e.userID,conversationType:e.conversationType,uploadConfig:[{fileID:1,fileType:e.fileType,fileName:e.fileName}]},l=E.SIMPLE_COS_PRE_SIG;return this.isSimpleCos||(a={fileType:e.fileType,fileName:e.fileName,uploadMethod:e.uploadMethod,duration:e.duration},l=E.COS_PRE_SIG),this.req({P:l,data:a}).then(function(_){t.tryCount=0;var h,g,_=_.data||{},M=(m.l("".concat(n," ok. isSimpleCos:").concat(t.isSimpleCos," data:"),_),"");return M=t.isSimpleCos?(h=(g=_.preSig[0]).uploadUrl,g=g.fileKey,"uploadIP:".concat(_.uploadIP," uploadUrl:").concat(h," fileKey:").concat(g," cost:").concat(Kt(s))):"requestId:".concat(_.requestId," expiredTime:").concat(_.expiredTime," diff:").concat(_.expiredTime-s,"s"),r.setMessage(M).end(),_}).catch(function(d){return d.code===-1&&(d.code=F.COS_GET_SIG_FAIL),r.setError(d).end(),m.w("".concat(n," failed. error:"),d),t.tryCount<1?(t.tryCount++,t._getCosPreSigUrl(e)):(t.tryCount=0,A({code:F.COS_GET_SIG_FAIL}))})}},{key:"_initUploaderMethod",value:function(){var e=this;if(this.TIMUploadPlugin)return this.timUploadPlugin=new this.TIMUploadPlugin,void(this._cosUploadMethod=function(t,n){e.timUploadPlugin.uploadFile(t,n)});this.appid&&(this.cos=ee?new this.COSSDK({ForcePathStyle:!0,getAuthorization:this._getAuthorization.bind(this)}):new this.COSSDK({getAuthorization:this._getAuthorization.bind(this)}),this._cosUploadMethod=ee?function(t,n){e.cos.postObject(t,n)}:function(t,n){e.cos.uploadFiles(t,n)})}},{key:"onCheckTimer",value:function(e){this.COSSDK&&(this.TIMUploadPlugin||this.isLoggedIn()&&e%60==0&&Math.ceil(Date.now()/1e3)>=this.cosOptions.expiredTime-120&&this._getAuthorizationKey())}},{key:"getFileDNList",value:function(){return this._fileDNList}},{key:"_getAuthorization",value:function(e,t){t({TmpSecretId:this.cosOptions.secretId,TmpSecretKey:this.cosOptions.secretKey,XCosSecurityToken:this.cosOptions.sessionToken,ExpiredTime:this.cosOptions.expiredTime})}},{key:"upload",value:function(e){if(e._relayFlag===!0)return Promise.resolve();var t=this.get(26);switch(e.type){case I.MSG_IMAGE:return t.addTotalCount(yn),this._uploadImage(e);case I.MSG_FILE:return t.addTotalCount(yn),this._uploadFile(e);case I.MSG_AUDIO:return t.addTotalCount(yn),this._uploadAudio(e);case I.MSG_VIDEO:return t.addTotalCount(yn),this._uploadVideo(e);default:return Promise.resolve()}}},{key:"_uploadImage",value:function(e){var t=this,n=this.get(2),s=e.getElements()[0],r=n.getMessageOption(e.clientSequence);return this.doUploadImage({file:r.payload.file,to:r.to,message:e,onProgress:function(a){if(s.updatePercent(a),Yt(r.onProgress))try{r.onProgress(a)}catch{return A({code:F.MSG_ONPROGRESS_ERR})}}}).then(function(J){var l=J.location,d=J.fileType,h=J.fileSize,g=J.width,_=J.height,M=J.smallImageUrl,S=J.smallImageWidth,D=J.smallImageHeight,O=J.largeImageUrl,B=J.largeImageWidth,U=J.largeImageHeight,de=J.imageInfoArray,J=t.isPrivateNetWork()?l:Tr(l);s.updateImageFormat(d);var ke,Ae,Be={size:h,url:J,width:g,height:_};if(de&&0<de.length)for(var We=0;We<de.length;We++){var ot=de[We];ot.type===1?ke=ot:ot.type===2?Ae=ot:Be=c(c({},Be),ot)}else Ae=M&&O?(ke={url:M,width:S,height:D},{url:O,width:B,height:U}):(ke=Hc({originUrl:J,originWidth:g,originHeight:_,min:198}),Hc({originUrl:J,originWidth:g,originHeight:_,min:720}));return s.updateImageInfoArray([c({},Be),c({},Ae),c({},ke)]),e})}},{key:"_uploadFile",value:function(e){var t=this,n=this.get(2),s=e.getElements()[0],r=n.getMessageOption(e.clientSequence);return this.doUploadFile({file:r.payload.file,to:r.to,message:e,onProgress:function(a){if(s.updatePercent(a),Yt(r.onProgress))try{r.onProgress(a)}catch{return A({code:F.MSG_ONPROGRESS_ERR})}}}).then(function(l){var l=l.location,d=l;return t.isPrivateNetWork()||(d=hn(d=Tr(l),t._fileDownloadProxy,t._authKey,t._fileDNList)),s.updateFileUrl(d),e})}},{key:"_uploadAudio",value:function(e){var t=this,n=this.get(2),s=e.getElements()[0],r=n.getMessageOption(e.clientSequence);return this.doUploadAudio({file:r.payload.file,to:r.to,message:e,onProgress:function(a){if(s.updatePercent(a),Yt(r.onProgress))try{r.onProgress(a)}catch{return A({code:F.MSG_ONPROGRESS_ERR})}}}).then(function(a){return a=a.location,a=t.isPrivateNetWork()?a:Tr(a),s.updateAudioUrl(a),e})}},{key:"_uploadVideo",value:function(e){var t=this,n=this.get(2),s=e.getElements()[0],r=n.getMessageOption(e.clientSequence);return this.doUploadVideo({file:r.payload.file,to:r.to,message:e,onProgress:function(a){if(s.updatePercent(a),Yt(r.onProgress))try{r.onProgress(a)}catch{return A({code:F.MSG_ONPROGRESS_ERR})}}}).then(function(l){var d=l.location,l=l.snapshotInfo,d=t.isPrivateNetWork()?d:Tr(d);return s.updateVideoUrl(d),se(l)||s.updateSnapshotInfo(l),e})}},{key:"_checkSizeError",value:function(e){var t="";return e==="A"?t="audio":e==="I"?t="image":e==="V"?t="video":e==="F"&&(t="file"),A({code:F["MSG_".concat(e,"_SIZE_LIMIT")],message:this.getErrMsg("UploadSizeLimit",t,"".concat(this.UPLOAD_SIZE_LIMIT[e]/1048576,"MB"))})}},{key:"doUploadImage",value:function(e){var t=this;if(!e.file||this._isEmptyFileList(e.file.files))return A({code:F.MSG_I_SELECT_F_FIRST});var n=this._checkImageType(e.file);if(n!==!0||(n=this._checkImageSize(e.file),n!==!0))return n;var s=null;return this._setUploadFileType(1),this.uploadByCOS(e).then(function(r){if(s=r,t.isPrivateNetWork())return Fs(l);if(_e(s.imageInfoArray)){var a=s.imageInfoArray.find(function(d){return d.type===3});if(a)return a}if(pe)return{width:e.file.width,height:e.file.height};var l=Tr(r.location);return t.COSSDK?Fs(l):Fs(l=hn(l,t._fileDownloadProxy,t._authKey,t._fileDNList))}).then(function(r){return s.width=r.width,s.height=r.height,Promise.resolve(s)})}},{key:"_checkImageType",value:function(e){var t="",t=ee?e.url.slice(e.url.lastIndexOf(".")+1):pe?e.type.split("/")[1]:e.files[0].name.slice(e.files[0].name.lastIndexOf(".")+1);return 0<=Ay.indexOf(t.toLowerCase())||A({code:F.MSG_I_TYPES_LIMIT})}},{key:"_checkImageSize",value:function(e){return(e=(ee||pe?e:e.files[0]).size)===0?A({code:F.MSG_F_IS_EMPTY}):e<this.UPLOAD_SIZE_LIMIT.I||this._checkSizeError("I")}},{key:"doUploadFile",value:function(e){return!e.file||this._isEmptyFileList(e.file.files)?A({code:F.MSG_F_SELECT_F_FIRST}):e.file.files[0].size>this.UPLOAD_SIZE_LIMIT.F?this._checkSizeError("F"):e.file.files[0].size===0?A({code:F.MSG_F_IS_EMPTY}):(this._setUploadFileType(255),this.uploadByCOS(e))}},{key:"doUploadVideo",value:function(e){return e.file.videoFile.size>this.UPLOAD_SIZE_LIMIT.V?this._checkSizeError("V"):e.file.videoFile.size===0?A({code:F.MSG_F_IS_EMPTY}):Oy.indexOf(e.file.videoFile.type)===-1?A({code:F.MSG_V_TYPES_LIMIT}):(this._setUploadFileType(2),ee||pe?this.handleVideoUpload(c(c({},e),{},{file:e.file.videoFile})):Te?this.handleVideoUpload(e):void 0)}},{key:"handleVideoUpload",value:function(e){var t=this;return new Promise(function(n,s){t.uploadByCOS(e).then(function(r){n(r)}).catch(function(){t.uploadByCOS(e).then(function(r){n(r)}).catch(function(){s(new yt({code:F.MSG_V_UPLOAD_FAIL}))})})})}},{key:"doUploadAudio",value:function(e){return e.file?e.file.size>this.UPLOAD_SIZE_LIMIT.A?this._checkSizeError("A"):e.file.size===0?A({code:F.MSG_F_IS_EMPTY}):(this._setUploadFileType(3),this.uploadByCOS(e)):A({code:F.MSG_A_UPLOAD_FAIL})}},{key:"uploadByCOS",value:function(e){var t=this;if(!Yt(this._cosUploadMethod))return this.warn("PluginUndetected"),A({code:F.COS_UNDETECTED});if(this.timUploadPlugin)return this._uploadWithPreSigUrl(e);var n=new K("upload"),s="".concat(this._n,".uploadByCOS"),r=Date.now(),a=this._getFile(e);return new Promise(function(l,d){var h=ee?t._createCosOptionsWXMiniApp(e):t._createCosOptionsWeb(e),g=t;t._cosUploadMethod(h,function(_,M){var S=Object.create(null);if(M){if(_||_e(M.files)&&M.files[0].error)return D=new yt({code:F.MSG_F_UPLOAD_FAIL}),n.setError(D).end(),m.l("".concat(s," failed. error:"),M.files[0].error),M.files[0].error.statusCode===403&&t._getAuthorizationKey(),void d(D);S.fileName=a.name,S.fileSize=a.size,S.fileType=a.type.slice(a.type.indexOf("/")+1).toLowerCase(),S.location=(ee?M:M.files[0].data).Location;var D=Date.now()-r,M=g._formatFileSize(a.size),O=g._formatSpeed(1e3*a.size/D),M="size:".concat(M," time:").concat(D,"ms speed:").concat(O),O=(m.l("".concat(s," success. name:").concat(a.name," ").concat(M)),l(S),t.get(26));return O.addCost(yn,D),O.addFileSize(yn,a.size),void n.setMessage(M).end()}S=new yt({code:F.MSG_F_UPLOAD_FAIL}),n.setError(S).end(),m.w("".concat(s," failed. error:"),_),_.statusCode===403&&t._getAuthorizationKey(),d(S)})})}},{key:"_uploadWithPreSigUrl",value:function(e){var t=this,n="".concat(this._n,"._uploadWithPreSigUrl"),s=this._getFile(e);return this._createCosOptionsPreSigUrl(e).then(function(r){return new Promise(function(a,l){var d=new K("upload"),h=r.requestSnapshotUrl,g=h===void 0?void 0:h,_=G(r,uI),M=Date.now();t._cosUploadMethod(_,function(S,D){var O,B,U;return S||D.statusCode===403?(d.setError(new yt(S)).end(),B={HttpStatusCode:9999,CostTime:Kt(M,!1),error:S,url:r.url},D.data&&D.data.uploadIP&&(B.uploadIP=D.data.uploadIP),t._uploadSSOLog(B),m.l("".concat(n," failed, error:"),S),void l(new yt({code:F.MSG_F_UPLOAD_FAIL}))):(O=Object.create(null),B=D.data.location||"",t.isPrivateNetWork()||B.indexOf("https://")!==0&&B.indexOf("http://")!==0||(B=B.split("//")[1]),O.fileName=s.name,O.fileSize=s.size,O.fileType=s.type.slice(s.type.indexOf("/")+1).toLowerCase(),O.location=B,S=Kt(M,!1),B=t._formatFileSize(s.size),U=t._formatSpeed(1e3*s.size/S),B="size:".concat(B," time:").concat(S,"ms speed:").concat(U," res:").concat(JSON.stringify(D.data)),m.l("".concat(n," ok. name:").concat(s.name," ").concat(B)),d.setMessage(B).end(),U={HttpStatusCode:D.statusCode,FileSize:s.size,CostTime:S,url:r.url},D.data&&D.data.uploadIP&&(U.uploadIP=D.data.uploadIP),t._uploadSSOLog(U),(B=t.get(26)).addCost(yn,S),B.addFileSize(yn,s.size),U=[],_.thumbUrl&&_.largeUrl&&U.push.apply(U,[t._getSmallImageInfoByUrl(_.thumbUrl,O),t._getLargeImageInfoByUrl(_.largeUrl,O)]),t.uploadFileType===1&&t.isSimpleCos&&!t.isPrivateNetWork()&&(U.push(t._getImageInfoArray(_.downloadUrl,O)),D.data.uploadIP&&U.push(t._getDownloadIP(_.downloadUrl.split("//")[1].split("/")[0],O))),g&&U.push(t._getSnapshotInfoByUrl(g,O)),0<U.length?Promise.all(U).then(function(){a(O)}):void a(O))})})})}},{key:"_getDownloadIP",value:function(e,t){var n="".concat(this._n,"._getDownloadIP"),s=Date.now();return this.req({P:E.GET_IP,data:{domainName:e}}).then(function(r){var a;r.data&&r.data.ip&&(m.l("".concat(n," ok. downloadIP:").concat(r.data.ip," cost:").concat(Kt(s))),(a=t.location.split("/"))[0]=r.data.ip,t.location=a.join("/"))}).catch(function(r){})}},{key:"_getImageInfoArray",value:function(e,t){var n=this,s="".concat(this._n,"._getImageInfoArray"),r=Date.now();return this.req({P:E.GET_IMAGE_INFO,data:{imageUrl:e}}).then(function(a){return a=a.data||{},m.l("".concat(s," ok. data: ").concat(JSON.stringify(a)," cost:").concat(Kt(r))),t.imageInfoArray=a.imageInfoArray,a}).catch(function(a){t.imageInfoArray=void 0,n._uploadSSOLog({HttpStatusCode:1e4,CostTime:Kt(r,!1),url:e})})}},{key:"_uploadSSOLog",value:function(e){var t,n;this.isSimpleCos&&((t=new K).setEventType(18),e.error&&t.setError(new yt(e.error)),n="HttpStatusCode:".concat(e.HttpStatusCode,"|CosRequestId:").concat(e.CosRequestId||"","|")+"FileAlreadyExist:".concat(e.FileAlreadyExist||0,"|FileSize:").concat(e.FileSize||0,"|CostTime:").concat(e.CostTime),e.uploadIP&&(n+="|FinalIP:".concat(e.uploadIP)),t.setMessage("OK").setMoreMessage(e.url).setExtension(n).end())}},{key:"_getRawOrUploadProxyUrl",value:function(e){var t=this.get(12).getFileUploadProxy(),n=e;return n=t?e.replace(/^https:\/\/[^/]+/,t):n}},{key:"_getFile",value:function(e){return _e(e.file.files)||xp(e.file.files)?e.file.files[0]:e.file}},{key:"_formatFileSize",value:function(e){return e<1024?e+"B":e<1048576?Math.floor(e/1024)+"KB":Math.floor(e/1048576)+"MB"}},{key:"_formatSpeed",value:function(e){return e<=1048576?$n(e/1024,1)+"KB/s":$n(e/1048576,1)+"MB/s"}},{key:"_createCosOptionsWeb",value:function(e){var t=this._getFile(e),n=t.name,n=n.slice(n.lastIndexOf(".")),n=this._genFileName("".concat(wn(999999)).concat(n));return{files:[{Bucket:"".concat(this.bucketName,"-").concat(this.appid),Region:this.region,Key:"".concat(this.directory,"/").concat(n),Body:t}],SliceSize:1048576,onProgress:function(s){if(typeof e.onProgress=="function")try{e.onProgress(s.percent)}catch(r){m.w("onProgress callback error:",r)}},onFileFinish:function(s,r,a){}}}},{key:"_createCosOptionsWXMiniApp",value:function(e){var n=this._getFile(e),t=this._genFileName(n.name),n=n.url;return{Bucket:"".concat(this.bucketName,"-").concat(this.appid),Region:this.region,Key:"".concat(this.directory,"/").concat(t),FilePath:n,onProgress:function(s){if(m.l(JSON.stringify(s)),typeof e.onProgress=="function")try{e.onProgress(s.percent)}catch(r){m.w("onProgress callback error:",r)}}}}},{key:"_createCosOptionsPreSigUrl",value:function(e){var t,n=this,s="",r="",l=0,a=this._getFile(e),l=ee||pe?(s=e.message.type===I.MSG_FILE?(t=(t=a.name).slice(t.lastIndexOf(".")),this._genFileName("".concat(wn(999999)).concat(t))):this._genFileName(a.name),r=a.url,1):(t=(t=a.name).slice(t.lastIndexOf(".")),s=this._genFileName("".concat(wn(999999)).concat(t)),r=a,0);return this._getCosPreSigUrl({fileType:this.uploadFileType,fileName:s,uploadMethod:l,duration:this.duration,userID:e.message.from,conversationType:Zt(e.message.conversationID)?1:2}).then(function(O){var D=n.isSimpleCos?O.preSig[0]:O,h=D.uploadUrl,g=D.downloadUrl,_=D.requestSnapshotUrl,_=_===void 0?void 0:_,M=D.thumbUrl,S=D.largeUrl,D=D.fileKey,O=O.uploadIP,O=O===void 0?"":O;return{url:n._getRawOrUploadProxyUrl(h),fileType:n.uploadFileType,fileName:s,resources:r,downloadUrl:g,requestSnapshotUrl:_,thumbUrl:M,largeUrl:S,fileKey:D,uploadIP:!n.isPrivateNetWork()&&O,onProgress:function(B){if(typeof e.onProgress=="function")try{e.onProgress(B.percent)}catch(U){m.w("onProgress callback error:",U),m.e(U)}}}})}},{key:"_genFileName",value:function(e){return"".concat(jp(),"-").concat(e)}},{key:"_setUploadFileType",value:function(e){this.uploadFileType=e}},{key:"_getSnapshotInfoByUrl",value:function(e,t){var n=this,s="_getSnapshotInfoByUrl",r=new K(s);return this.req({P:E.VIDEO_COVER,data:{platform:this.getPlatform(),coverName:this._genFileName(wn(99999)),requestSnapshotUrl:e}}).then(function(a){if(a=(a.data||{}).snapshotUrl,m.l("".concat(n._n,".").concat(s," ok. snapshotUrl:").concat(a)),r.setMessage("snapshotUrl:".concat(a)).end(),se(a))return{};var l=hn(a,n._fileDownloadProxy,n._authKey,n._fileDNList);return Fs(l).then(function(d){t.snapshotInfo={snapshotUrl:l,snapshotWidth:d.width,snapshotHeight:d.height}})}).catch(function(a){return m.w("".concat(n._n,".").concat(s," failed. error:"),a),r.setCode(a.errorCode).setMessage(a.errorInfo).end(),{}})}},{key:"_getSmallImageInfoByUrl",value:function(e,t){return Fs(hn(e,this._fileDownloadProxy,this._authKey,this._fileDNList)).then(function(n){t.smallImageUrl=e,t.smallImageWidth=n.width,t.smallImageHeight=n.height})}},{key:"_getLargeImageInfoByUrl",value:function(e,t){return Fs(hn(e,this._fileDownloadProxy,this._authKey,this._fileDNList)).then(function(n){t.largeImageUrl=e,t.largeImageWidth=n.width,t.largeImageHeight=n.height})}},{key:"_isEmptyFileList",value:function(e){return!(!xp(e)||e.length!==0)}},{key:"reset",value:function(){m.l("".concat(this._n,".reset"))}}]),Kr),dI=["downloadKey","pbDownloadKey","messageList"],pI=(y(Ju,[{key:"uploadMergerMessage",value:function(s,t){var n="".concat(this._n,".").concat("uploadMergerMessage"),s=(m.d("".concat(n," message:"),s,"messageBytes:".concat(t)),JSON.parse(JSON.stringify(s.payload)).messageList),r=s.length,a=this._msgM.get(17).getFileDNList(),l=new K("uploadMergerMessage");return s.forEach(function(d){pa(d.messageBody[0].type,d.messageBody,a)}),this._msgM.req({P:E.UPLOAD_MERGER_MSG,data:{messageList:s}}).then(function(h){m.d("".concat(n," ok. response:"),h.data);var h=h.data,g=h.pbDownloadKey,h=h.downloadKey,g={pbDownloadKey:g,downloadKey:h,messageNumber:r};return l.setMessage("".concat(r,"-").concat(t,"-").concat(h)).end(),g}).catch(function(d){throw m.w("".concat(n," failed. error:"),d),l.setError(d).end(),d})}},{key:"downloadMergerMessage",value:function(e){var t=this,n="".concat(this._n,".").concat("downloadMergerMessage"),s=(m.d("".concat(n," message:"),e),e.payload.downloadKey),r=this._msgM.getFileDownloadProxy(),a=this._msgM.getDowloadFileAuthKey(),l=new K("downloadMergerMessage");return l.setMessage("downloadKey:".concat(s)),this._msgM.req({P:E.DOWNLOAD_MERGER_MSG,data:{downloadKey:s}}).then(function(d){m.d("".concat(n," ok. response:"),d.data);var h,g,_=t._msgM.get(17).getFileDNList();return Yt(e.clearElement)?((h=e.payload).downloadKey,h.pbDownloadKey,h.messageList,h=G(h,dI),e.clearElement(),e.setElement({type:e.type,content:c({messageList:d.data.messageList},h)},r,a,_)):(g=[],d.data.messageList.forEach(function(M){se(M)||(M=new hf(M,r,a,_),g.push(M))}),e.payload.messageList=g,e.payload.downloadKey="",e.payload.pbDownloadKey=""),l.end(),e}).catch(function(d){throw m.w("".concat(n," failed. key:").concat(s," error:"),d),l.setError(d).end(),d})}},{key:"createMergerMessagePack",value:function(e,t,n){return e.conversationType===I.CONV_C2C?this._createC2CMergerMessagePack(e,t,n):this._createGroupMergerMessagePack(e,t,n)}},{key:"_createC2CMergerMessagePack",value:function(e,t,h){var s=null,r=(t&&(t.offlinePushInfo&&(s=t.offlinePushInfo),t.onlineUserOnly===!0&&(s?s.disablePush=!0:s={disablePush:!0})),[]),a=(dt(t)&&dt(t.messageControlInfo)&&(a=(d=t.messageControlInfo).excludedFromUnreadCount,l=d.excludedFromLastMessage,d=d.excludedFromContentModeration,a===!0&&r.push("NoUnread"),l===!0&&r.push("NoLastMsg"),d===!0&&r.push("NoMsgCheck")),""),l=(xe(e.cloudCustomData)&&0<e.cloudCustomData.length&&(a=e.cloudCustomData),h.pbDownloadKey),d=h.downloadKey,h=h.messageNumber,M=e.payload,g=M.title,_=M.abstractList,M=M.compatibleText,S=this._msgM.get(6),S=S&&S.isOnlineMessage(e,t)?0:void 0;return{P:E.SEND_C2C_MSG,data:{fromAccount:this._msgM.getMyUserID(),toAccount:e.to,msgBody:[{msgType:e.type,msgContent:{pbDownloadKey:l,downloadKey:d,title:g,abstractList:_,compatibleText:M,messageNumber:h}}],cloudCustomData:a,clientTime:e.clientTime,msgSeq:e.sequence,msgRandom:e.random,msgLifeTime:S,offlinePushInfo:ha(s),messageControlInfo:S!==0?r:void 0,isSupportExtension:e.isSupportExtension===!0?1:0,isRelayMessage:e._relayFlag===!0?1:0}}}},{key:"_createGroupMergerMessagePack",value:function(e,D,h){var s=null,r=(D&&D.offlinePushInfo&&(s=D.offlinePushInfo),[]),a=(dt(D)&&dt(D.messageControlInfo)&&(a=(d=D.messageControlInfo).excludedFromUnreadCount,l=d.excludedFromLastMessage,d=d.excludedFromContentModeration,a===!0&&r.push("NoUnread"),l===!0&&r.push("NoLastMsg"),d===!0&&r.push("NoMsgCheck")),""),l=(xe(e.cloudCustomData)&&0<e.cloudCustomData.length&&(a=e.cloudCustomData),h.pbDownloadKey),d=h.downloadKey,h=h.messageNumber,M=e.payload,g=M.title,_=M.abstractList,M=M.compatibleText,S=this._msgM.get(7),D=S&&S.isOnlineMessage(e,D)?1:0;return{P:E.SEND_GRP_MSG,data:{fromAccount:this._msgM.getMyUserID(),groupID:e.to,msgBody:[{msgType:e.type,msgContent:{pbDownloadKey:l,downloadKey:d,title:g,abstractList:_,compatibleText:M,messageNumber:h}}],random:e.random,priority:e.priority,clientSequence:e.clientSequence,groupAtInfo:void 0,cloudCustomData:a,onlineOnlyFlag:D,offlinePushInfo:ha(s),clientTime:e.clientTime,needReadReceipt:e.needReadReceipt!==!0||S.isMessageFromOrToAVChatroom(e.to)?0:1,messageControlInfo:D==0?r:void 0,isSupportExtension:e.isSupportExtension===!0?1:0,isRelayMessage:e._relayFlag===!0?1:0}}}}]),Ju),fI={ERR_SVR_COMM_SENSITIVE_TEXT:80001,ERR_SVR_COMM_BODY_SIZE_LIMIT:80002,OPEN_SERVICE_OVERLOAD_ERROR:60022,ERR_SVR_MSG_PKG_PARSE_FAILED:20001,ERR_SVR_MSG_INTERNAL_AUTH_FAILED:20002,ERR_SVR_MSG_INVALID_ID:20003,ERR_SVR_MSG_PUSH_DENY:20006,ERR_SVR_MSG_IN_PEER_BLACKLIST:20007,ERR_SVR_MSG_BOTH_NOT_FRIEND:20009,ERR_SVR_MSG_NOT_PEER_FRIEND:20010,ERR_SVR_MSG_NOT_SELF_FRIEND:20011,ERR_SVR_MSG_SHUTUP_DENY:20012,ERR_SVR_GROUP_INVALID_PARAMETERS:10004,ERR_SVR_GROUP_PERMISSION_DENY:10007,ERR_SVR_GROUP_NOT_FOUND:10010,ERR_SVR_GROUP_INVALID_GROUPID:10015,ERR_SVR_GROUP_REJECT_FROM_THIRDPARTY:10016,ERR_SVR_GROUP_SHUTUP_DENY:10017,MSG_SEND_FAIL:2100,OVER_FREQUENCY_LIMIT:2996},hI=[F.MSG_ONPROGRESS_ERR,F.MSG_I_SELECT_F_FIRST,F.MSG_I_TYPES_LIMIT,F.MSG_F_IS_EMPTY,F.MSG_I_SIZE_LIMIT,F.MSG_F_SELECT_F_FIRST,F.MSG_F_SIZE_LIMIT,F.MSG_V_SIZE_LIMIT,F.MSG_V_TYPES_LIMIT,F.MSG_A_UPLOAD_FAIL,F.MSG_A_SIZE_LIMIT,F.COS_UNDETECTED];function Ju(e){f(this,Ju),this._n="MergerMessageHandler",this._msgM=e}function Kr(e){f(this,Kr),(e=kf.call(this,e))._n="UploadModule",e.TIMUploadPlugin=null,e.timUploadPlugin=null,e.COSSDK=null,e._cosUploadMethod=null,e.expiredTimeLimit=600,e.appid=0,e.bucketName="",e.ciUrl="",e.directory="",e.downloadUrl="",e.uploadUrl="",e.region="ap-shanghai",e.cos=null,e.cosOptions={secretId:"",secretKey:"",sessionToken:"",expiredTime:0},e.uploadFileType="",e.duration=900,e.tryCount=0,e.UPLOAD_SIZE_LIMIT={A:20971520,F:104857600,I:20971520,V:104857600},e.isSimpleCos=!1,e._fileDownloadProxy="",e._authKey="",e._fileDNList=cI;var t=e.getIEmitInst();return t.on(mt.A2KEY_AND_TINYID_UPDATED,e._init,V(e)),t.on(mt.CLOUD_CONFIG,e._onCloudConfig,V(e)),e}function Of(e){var t=!1;return Object.values(fI).includes(e)&&(t=!0),t=120001<=e&&e<=13e4||10100<=e&&e<=10200?!0:t}T(Jr,St),Uf=z(Jr),y(Jr,[{key:"createTextMessage",value:function(n){var s=this.getMyUserID(),t=(n.currentUser=s,n.senderTinyID=this.getMyTinyID(),new Bt(n)),n=xe(n.payload)?n.payload:n.payload.text,n=new Zc({text:n}),s=this._getNickAndAvatarByUserID(s);return t.setElement(n),t.setNickAndAvatar(s),t.setNameCard(this._getNameCardByGroupID(t)),t}},{key:"createImageMessage",value:function(e){var t=this.getMyUserID(),n=(e.currentUser=t,e.senderTinyID=this.getMyTinyID(),new Bt(e));if(ee){var r=e.payload.file;if(io(r))return void this.warn("FileUnsupportedInMP","createImageMessage");var s=r.tempFiles[0].path||r.tempFiles[0].tempFilePath,r={url:s,name:s.slice(s.lastIndexOf("/")+1),size:r.tempFiles&&r.tempFiles[0].size||1,type:s.slice(s.lastIndexOf(".")+1).toLowerCase()};e.payload.file=r}else pe?(r={url:(s=e.payload.file).uri,name:s.fileName,size:s.fileSize||1,type:s.type,width:s.width,height:s.height},e.payload.file=r):Te&&(io(e.payload.file)?(s=e.payload.file,e.payload.file={files:[s]}):dt(e.payload.file)&&typeof uni<"u"&&(r=e.payload.file.tempFiles[0],e.payload.file={files:[r]}));return s=new nu({imageFormat:na.UNKNOWN,uuid:this._generateUUID(e.payload.file),file:e.payload.file}),r=this._getNickAndAvatarByUserID(t),n.setElement(s),n.setNickAndAvatar(r),n.setNameCard(this._getNameCardByGroupID(n)),this._messageOptionsMap.set(n.clientSequence,e),n}},{key:"createAudioMessage",value:function(e){var n=e.payload.file,s=(ee&&(s={url:n.tempFilePath,name:n.tempFilePath.slice(n.tempFilePath.lastIndexOf("/")+1),size:n.fileSize,second:parseInt(n.duration)/1e3,type:n.tempFilePath.slice(n.tempFilePath.lastIndexOf(".")+1).toLowerCase()},e.payload.file=s),pe&&(s={url:n.uri,name:n.uri.slice(n.uri.lastIndexOf("/")+1),size:n.fileSize||1,second:Math.floor(n.duration/1e3),type:n.uri.slice(n.uri.lastIndexOf(".")+1).toLowerCase()},e.payload.file=s,se(n.uri)&&this.warn("VoiceFileInRN")),this.getMyUserID()),t=(e.currentUser=s,e.senderTinyID=this.getMyTinyID(),new Bt(e)),n=new su({second:Math.floor(n.duration/1e3),size:n.fileSize||n.size||1,url:n.tempFilePath||n.uri,uuid:this._generateUUID(e.payload.file)}),s=this._getNickAndAvatarByUserID(s);return t.setElement(n),t.setNickAndAvatar(s),t.setNameCard(this._getNameCardByGroupID(t)),this._messageOptionsMap.set(t.clientSequence,e),t}},{key:"createVideoMessage",value:function(e){var t=this.getMyUserID(),n=(e.currentUser=t,e.senderTinyID=this.getMyTinyID(),e.payload.file.thumbUrl="",e.payload.file.thumbSize=0,{});if(ee){if(w)return void this.warn("VideoUnsupportedInAlipay");if(io(e.payload.file))return void this.warn("FileUnsupportedInMP","createVideoMessage");var s=e.payload.file;_e(s.tempFiles)&&(s=s.tempFiles[0]),n.url=s.tempFilePath,n.name=s.tempFilePath.slice(s.tempFilePath.lastIndexOf("/")+1),n.size=s.size||1,n.second=s.duration||0,n.type=s.tempFilePath.slice(s.tempFilePath.lastIndexOf(".")+1).toLowerCase()}else pe?(s=e.payload.file,n.url=s.uri,n.name=s.fileName,n.size=s.fileSize||1,n.second=s.duration||0,n.type=s.type.split("/")[1]):Te&&(io(e.payload.file)?(s=e.payload.file,e.payload.file.files=[s]):dt(e.payload.file)&&typeof uni<"u"&&(s=e.payload.file.tempFile,e.payload.file.files=[s]),s=e.payload.file,n.url=window.URL.createObjectURL(s.files[0]),n.name=s.files[0].name,n.size=s.files[0].size||1,n.second=s.files[0].duration||0,n.type=s.files[0].type.split("/")[1]);return e.payload.file.videoFile=n,s=new Bt(e),n=new au({videoFormat:n.type,videoSecond:$n(n.second,0),videoSize:n.size,remoteVideoUrl:"",videoUrl:n.url,videoUUID:this._generateUUID(e.payload.file.videoFile),thumbUUID:this._generateUUID(e.payload.file.videoFile),thumbWidth:e.payload.file.width||200,thumbHeight:e.payload.file.height||200,thumbUrl:e.payload.file.thumbUrl,thumbSize:e.payload.file.thumbSize,thumbFormat:e.payload.file.thumbUrl.slice(e.payload.file.thumbUrl.lastIndexOf(".")+1).toLowerCase()}),t=this._getNickAndAvatarByUserID(t),s.setElement(n),s.setNickAndAvatar(t),s.setNameCard(this._getNameCardByGroupID(s)),this._messageOptionsMap.set(s.clientSequence,e),s}},{key:"createCustomMessage",value:function(n){var s=this.getMyUserID(),t=(n.currentUser=s,n.senderTinyID=this.getMyTinyID(),new Bt(n)),n=new iu({data:n.payload.data,description:n.payload.description,extension:n.payload.extension}),s=this._getNickAndAvatarByUserID(s);return t.setElement(n),t.setNickAndAvatar(s),t.setNameCard(this._getNameCardByGroupID(t)),t}},{key:"createFaceMessage",value:function(n){var s=this.getMyUserID(),t=(n.currentUser=s,n.senderTinyID=this.getMyTinyID(),new Bt(n)),n=new ou(n.payload),s=this._getNickAndAvatarByUserID(s);return t.setElement(n),t.setNickAndAvatar(s),t.setNameCard(this._getNameCardByGroupID(t)),t}},{key:"createMergerMessage",value:function(s){var t=this.getMyUserID(),t=(s.currentUser=t,s.senderTinyID=this.getMyTinyID(),this._getNickAndAvatarByUserID(t)),n=new Bt(s),s=new fa(s.payload);return n.setElement(s),n.setNickAndAvatar(t),n.setNameCard(this._getNameCardByGroupID(n)),n.setRelayFlag(!0),n}},{key:"createForwardMessage",value:function(e){var t=e.to,n=e.conversationType,s=e.priority,r=e.payload,a=e.needReadReceipt,l=e.receiverList;if(!_e(r._elements))return A({code:F.MSG_FORWARD_INVALID_ELEMENTS});var d=this.getMyUserID(),h=this._getNickAndAvatarByUserID(d);return r.type===I.MSG_GRP_TIP?A({code:F.MSG_FORWARD_TYPE_INVALID}):(n={to:t,conversationType:n,conversationID:"".concat(n).concat(t),priority:s,isPlaceMessage:0,status:la,currentUser:d,senderTinyID:this.getMyTinyID(),cloudCustomData:e.cloudCustomData||r.cloudCustomData||"",needReadReceipt:a,receiverList:l,isSupportExtension:e.isSupportExtension||!1},t=new Bt(n),t.setElement(r._elements[0]),t.setNickAndAvatar(h),t.setNameCard(this._getNameCardByGroupID(r)),t.setRelayFlag(!0),t)}},{key:"downloadMergerMessage",value:function(e){return this._mergerMessageHandler.downloadMergerMessage(e)}},{key:"createFileMessage",value:function(e){if(ee){if(!Ce&&!Re&&!j)return;var s=le.getSystemInfoSync().SDKVersion;if(Ce&&Yp(s,"2.5.0")<0)return void this.warn("WXChooseMessageFile");if(Re&&Yp(s,"1.18.0")<0)return void this.warn("QQChooseMessageFile")}Te||j?io(e.payload.file)?(s=e.payload.file,e.payload.file={files:[s]}):dt(e.payload.file)&&typeof uni<"u"&&(n=(s=e.payload.file).tempFiles,s=s.files,t=null,_e(n)?t=n[0]:_e(s)&&(t=s[0]),e.payload.file={files:[t]}):Ce||Re?(s=c(c({},(n=e.payload.file.tempFiles)[0]),{},{url:n[0].path}),e.payload.file={files:[s]}):pe&&(n=c(c({},t=e.payload.file),{},{url:t.uri}),e.payload.file={files:[n]});var s=this.getMyUserID(),t=(e.currentUser=s,e.senderTinyID=this.getMyTinyID(),new Bt(e)),n=new ru({uuid:this._generateUUID(e.payload.file),file:e.payload.file}),s=this._getNickAndAvatarByUserID(s);return t.setElement(n),t.setNickAndAvatar(s),t.setNameCard(this._getNameCardByGroupID(t)),this._messageOptionsMap.set(t.clientSequence,e),t}},{key:"createLocationMessage",value:function(n){var s=this.getMyUserID(),t=(n.currentUser=s,n.senderTinyID=this.getMyTinyID(),new Bt(n)),n=new cu(n.payload),s=this._getNickAndAvatarByUserID(s);return t.setElement(n),t.setNickAndAvatar(s),t.setNameCard(this._getNameCardByGroupID(t)),t}},{key:"_onNoModule",value:function(){return A({code:F.NO_MODULE})}},{key:"sendMessageInstance",value:function(e,t){var n=this;if(this.get(29).filterMessage(e,t)===!1)return e.hasRiskContent=!0,this._onSendMessageFailed(e,new yt({code:F.PROFANITY_FOUND}));var s=null;if(e.conversationType===I.CONV_C2C)s=this.get(6);else{if(e.conversationType!==I.CONV_GROUP)return A({code:F.MSG_INVALID_CONV_TYPE});s=this.get(7)}if(!s)return this._onNoModule();var r,a="".concat(this._n,".sendMessageInstance"),l=this.get(11),d=s.isOnlineMessage(e,t);return this.get(17).upload(e).then(function(){return n._getSendMessageSpecifiedKey(e)===is&&n.get(26).addSuccessCount(yn),n._guardForGroup(e).then(function(){if(!e.isSendable())return A({code:F.MSG_F_URL_IS_EMPTY});n._addSendMessageTotalCount(e),r=Date.now();var h=function(g){var _="utf-8";Te&&document&&(_=document.charset.toLowerCase());var M,S=0,D=g.length;if(_==="utf-8"||_==="utf8")for(var O=0;O<D;O++)(M=g.codePointAt(O))<=127?S+=1:M<=2047?S+=2:M<=65535?S+=3:(S+=4,O++);else if(_==="utf-16"||_==="utf16")for(var B=0;B<D;B++)(M=g.codePointAt(B))<=65535?S+=2:(S+=4,B++);else S=g.replace(/[^\x00-\xff]/g,"aa").length;return S}(JSON.stringify(e));return e.type===I.MSG_MERGER&&11264<h?n._mergerMessageHandler.uploadMergerMessage(e,h).then(function(g){return g=n._mergerMessageHandler.createMergerMessagePack(e,t,g),n.req(g)}):(l.setMessageRandom(e),s.sendMessage(e,t))}).then(function(S){var g,S=S.data,_=S.time,M=S.sequence,D=S.readReceiptCode,S=S.messageDropReason,D=(Qe(D)&&D!==0&&(new K("sendMessageWithReceipt").setMessage("from:".concat(e.from," to:").concat(e.to," sequence:").concat(M," readReceiptCode:").concat(D)).end(),m.w("".concat(a," readReceiptCode:").concat(D," message:").concat(n.getErrMsg(D)))),S&&(D=new K("messageDropReason"),S="from:".concat(e.from," to:").concat(e.to," sequence:").concat(M," messageDropReason:").concat(S),D.setMessage(S).end(),m.w("".concat(a," ").concat(S))),n._addSendMessageSuccessCount(e,r),n._messageOptionsMap.delete(e.clientSequence),e.isResend===!0&&(g=l.findMessage(e.ID))&&(m.l("".concat(a," resend ok. ID:").concat(g.ID)),l.deleteLocalMessage(g)),e.status=Fn,e.time=_,!1);return e.conversationType===I.CONV_GROUP?e.sequence=M:e.conversationType!==I.CONV_C2C||(S=l.getLatestMessageSentByMe(e.conversationID))&&(g=S.nick,_=S.avatar,g===e.nick&&_===e.avatar||(D=!0)),D&&l.modifyMessageSentByMe({conversationID:e.conversationID,latestNick:e.nick,latestAvatar:e.avatar}),d===!0?e._onlineOnlyFlag=!0:(l.appendToMessageList(e),M=e,dt(t)&&dt(t.messageControlInfo)&&(t.messageControlInfo.excludedFromLastMessage===!0&&(e._isExcludedFromLastMessage=!0,M=""),t.messageControlInfo.excludedFromUnreadCount===!0&&(e._isExcludedFromUnreadCount=!0)),S=e.conversationType,Vt(e.to)&&(S=I.CONV_TOPIC,n.get(10).onMessageSent({groupID:wt(e.to),topicID:e.to,lastMessage:M})),l.onMessageSent({conversationOptionsList:[{conversationID:e.conversationID,unreadCount:0,type:S,subType:e.conversationSubType,lastMessage:M}]})),e._relayFlag||e.type!=="TIMImageElem"||zp(e.payload.imageInfoArray),me({message:e})})}).catch(function(h){return n._onSendMessageFailed(e,h,d)})}},{key:"_guardForGroup",value:function(e){if(e.conversationType!==I.CONV_GROUP)return Promise.resolve();var t=this.get(7);if(!t)return this._onNoModule();if(rn({groupID:e.to})){var n=t.getLocalGroupProfile(e.to);if(n&&n.isSupportTopic)return A({code:F.MSG_SEND_GRP_WITH_TOPIC_FAIL})}return t.guardForAVChatRoom(e)}},{key:"_onSendMessageFailed",value:function(e,t){var r=2<arguments.length&&arguments[2]!==void 0&&arguments[2],n="".concat(this._n,"._onSendMessageFailed"),s=(e.status=$c,t.code!==80001&&t.code!==80004||(e.hasRiskContent=!0),this.get(11)),a=(s.deleteMessageRandom(e),10100<=t.code&&t.code<=10200||120001<=t.code&&t.code<=13e4),r=(r||a||s.appendToMessageList(e)===!0&&m.l("".concat(n," message stored, ID:").concat(e.ID)),this._addSendMessageFailCountOnUser(e,t),new K("sendMessage")),a="head.seq:".concat(t.data.headSeq," type:").concat(e.type," from:").concat(e.from," to:").concat(e.to);return Te&&("connection"in navigator&&(s=navigator.connection,a+=" downlink:".concat(s.downlink," effectiveType:").concat(s.effectiveType," rtt:").concat(s.rtt)),"memory"in window.performance&&(s=window.performance.memory,a+=" usedJSHeapSize:".concat(s.usedJSHeapSize," totalJSHeapSize:").concat(s.totalJSHeapSize," jsHeapSizeLimit:").concat(s.jsHeapSizeLimit))),r.setMessage(a).setError(t).end(),m.e("".concat(n," ").concat(a," error:"),t),A(new yt({code:t&&t.code?t.code:F.MSG_SEND_FAIL,message:t&&t.message?t.message:void 0,data:{message:e}}))}},{key:"_getSendMessageSpecifiedKey",value:function(e){if([I.MSG_IMAGE,I.MSG_AUDIO,I.MSG_VIDEO,I.MSG_FILE].includes(e.type))return is;if(e.conversationType===I.CONV_C2C)return Ks;if(e.conversationType===I.CONV_GROUP){var t=this.get(7);if(t&&(t=t.getLocalGroupProfile(e.to),t))return e=t.type,nn(e)?Ws:js}}},{key:"_addSendMessageTotalCount",value:function(e){e=this._getSendMessageSpecifiedKey(e),e&&this.get(26).addTotalCount(e)}},{key:"_addSendMessageSuccessCount",value:function(s,t){var n,s=this._getSendMessageSpecifiedKey(s);s&&((n=this.get(26)).addSuccessCount(s),n.addCost(s,Kt(t,!1)))}},{key:"_addSendMessageFailCountOnUser",value:function(a,s){var n,s=s.code,s=s===void 0?-1:s,r=this.get(26),a=this._getSendMessageSpecifiedKey(a);a===is&&(n=!1,n=hI.includes(s)?!0:n)?r.addFailedCountOfUserSide(yn):Of(s)&&a&&r.addFailedCountOfUserSide(a)}},{key:"resendMessage",value:function(e,t){return e.isResend=!0,e.status=la,this.sendMessageInstance(e,t)}},{key:"revokeMessage",value:function(e){var t=this,n=null;if(e.conversationType===I.CONV_C2C?n=this.get(6):e.conversationType===I.CONV_GROUP&&(n=this.get(7)),!n)return this._onNoModule();var s=new K("revokeMessage"),r=(s.setMessage("type:".concat(e.type," from:").concat(e.from," to:").concat(e.to)),"".concat(this._n,".").concat("revokeMessage"));return n.revokeMessage(e).then(function(l){var l=l.data.recallRetList;return se(l)||l[0].retCode===0?(m.i("".concat(r," ok. ID:").concat(e.ID)),e.isRevoked=!0,s.end(),t.get(11).onMessageRevoked([e]),me({message:e})):(l=new yt({code:l[0].retCode,data:{message:e}}),s.setCode(l.code).setMoreMessage(l.message).end(),A(l))}).catch(function(a){s.setError(a).end();var l=new yt({code:a&&a.code?a.code:F.MSG_REVOKE_FAIL,message:a&&a.message?a.message:void 0,data:{message:e}});return m.w("".concat(r," failed. error:"),a),A(l)})}},{key:"deleteMessage",value:function(e){var t=this,n=null,s=e[0],r=s.conversationID,a="",l=[],d=[];if(s.conversationType===I.CONV_C2C)n=this.get(6),a=r.replace(I.CONV_C2C,""),e.forEach(function(_){_&&_.status===Fn&&_.conversationID===r&&(_._onlineOnlyFlag||l.push("".concat(_.sequence,"_").concat(_.random,"_").concat(_.time)),d.push(_))});else if(s.conversationType===I.CONV_GROUP)n=this.get(7),a=r.replace(I.CONV_GROUP,""),e.forEach(function(_){_&&_.status===Fn&&_.conversationID===r&&(_._onlineOnlyFlag||l.push("".concat(_.sequence)),d.push(_))});else if(s.conversationType===I.CONV_SYSTEM)return A({code:F.CANNOT_DELETE_GRP_SYSTEM_NOTICE});if(!n)return this._onNoModule();if(l.length===0)return this._onMessageDeleted(d);30<l.length&&(l=l.slice(0,30),d=d.slice(0,30));var h=new K("deleteMessage"),g=(h.setMessage("to:".concat(a," count:").concat(l.length)),"".concat(this._n,".").concat("deleteMessage"));return n.deleteMessage({to:a,keyList:l}).then(function(_){return h.end(),m.i("".concat(g," ok")),t._onMessageDeleted(d)}).catch(function(_){return h.setError(_).end(),m.w("".concat(g," failed. error:"),_),_=new yt({code:_&&_.code?_.code:F.MSG_DELETE_FAIL,message:_&&_.message?_.message:void 0}),A(_)})}},{key:"_onMessageDeleted",value:function(e){return this.get(11).onMessageDeleted(e),Pe({messageList:e})}},{key:"translateText",value:function(r){var t="".concat(this._n,".").concat("translateText"),n=r.sourceTextList,s=r.sourceLanguage,r=r.targetLanguage,a=new K("translateText");return a.setMessage("sourceLanguage:".concat(s," targetLanguage:").concat(r)),this.req({P:E.TRANSLATE_TEXT,data:{sourceTextList:n,source:s||"auto",target:r,from:this.getMyTinyID(),SDKAppID:this.getSDKAppID()}}).then(function(g){var g=g.data,d=g.error,h=g.requestID,g=g.translatedTextList;if(d.code===0)return a.end(),m.i("".concat(t," ok. requestID:").concat(h)),me({translatedTextList:g});throw c(c({},d),{},{requestID:h})}).catch(function(l){return a.setCode(l.code).setMoreMessage(l.requestID).end(),m.w("".concat(t," failed. error:"),l),A({code:F.TRANSLATE_TEXT_FAIL})})}},{key:"convertVoiceToText",value:function(r){var n=r.message,r=r.language,t=n.payload.url,n=(n.from===this.getMyUserID()&&n.flow==="out"&&(t=n.payload.remoteAudioUrl),/\.(wav|pcm|ogg-opus|speex|silk|mp3|m4a|aac|amr)/);if(!n.test(t))return A({code:F.UNSUPPORTED_VOICE_FORMAT});var n=n.exec(t)[1]||"mp3",s="16k_zh-PY",r=(r?r==="zh (cmn-Hans-CN)"?s="16k_zh":r==="en-US"?s="16k_en":r==="yue-Hant-HK"?s="16k_yue":r==="ja-JP"&&(s="16k_ja"):s="16k_zh-PY","serviceType:".concat(s," url:").concat(t)),a="".concat(this._n,".").concat("convertVoiceToText"),l=(m.i("".concat(a," ").concat(r)),new K("convertVoiceToText"));return l.setMessage(r),this.req({P:E.VOICE_TO_TEXT,data:{url:t,language:s,SDKAppID:this.getSDKAppID(),format:n}}).then(function(_){var _=_.data,h=_.error,g=_.requestID,_=_.result;if(h.code===0)return l.end(),m.i("".concat(a," ok. requestID:").concat(g)),me({result:_});throw c(c({},h),{},{requestID:g})}).catch(function(d){return l.setCode(d.code).setMoreMessage(d.requestID||"").end(),m.w("".concat(a," failed. error:"),d),A({code:F.VOICE_TO_TEXT_FAIL})})}},{key:"modifyRemoteMessage",value:function(e){var t=this;if(this.get(29).filterMessage(e)===!1)return e.hasRiskContent=!0,A({code:F.PROFANITY_FOUND,data:{message:e}});var n=null,s=e.conversationType,r=e.to;if(s===I.CONV_C2C)n=this.get(6);else if(s===I.CONV_GROUP){if(!(n=this.get(7)))return this._onNoModule();if(n.isMessageFromOrToAVChatroom(r))return A({code:F.MSG_MODIFY_DISABLED_IN_AV,data:{message:e}})}var a=new K("modifyMessage"),l=(a.setMessage("to:".concat(r)),"".concat(this._n,".modifyRemoteMessage"));return n.modifyRemoteMessage(e).then(function(d){return a.end(),m.i("".concat(l," ok")),d=t._onModifyRemoteMessageResp(e,d.data),me({message:d})}).catch(function(d){var h;return a.setCode(d.code).setMoreMessage(d.message).end(),m.w("".concat(l," failed. error:"),d),d.code===20027?(h=t._onModifyRemoteMessageResp(e,d.data),A({code:F.MSG_MODIFY_CONFLICT,data:{message:h}})):A({code:d.code,message:d.message,data:{message:e}})})}},{key:"_onModifyRemoteMessageResp",value:function(d,_){m.d("".concat(this._n,"._onModifyRemoteMessageResp options:"),_);var n=d.conversationType,s=d.from,r=d.to,a=d.random,l=d.sequence,d=d.time,h=_.elements,g=_.messageVersion,_=_.cloudCustomData,_=_===void 0?"":_;return this.get(11).onMessageModified({conversationType:n,from:s,to:r,time:d,random:a,sequence:l,elements:h,cloudCustomData:_,messageVersion:g})}},{key:"_generateUUID",value:function(n){var t=this.get(12),t="".concat(t.getSDKAppID(),"-").concat(t.getUserID(),"-").concat(Vp()),n=n.name||n.value||n.url||n.tempFilePath,n=n&&n.slice(n.lastIndexOf(".")+1);return t=n?"".concat(t,".").concat(n):t}},{key:"getMessageOption",value:function(e){return this._messageOptionsMap.get(e)}},{key:"_getNickAndAvatarByUserID",value:function(e){return this.get(4).getNickAndAvatarByUserID(e)}},{key:"_getNameCardByGroupID",value:function(e){if(e.conversationType===I.CONV_GROUP){var t=this.get(7);if(t)return t.getMyNameCardByGroupID(e.to)}return""}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._messageOptionsMap.clear()}}]);var Nf,Pf,bf,Gf,wf,Uf,gI=Jr,_I=(T($r,St),wf=z($r),y($r,[{key:"onMsgExtNotify",value:function(a){var t=this,a=a.dataList,d=a.messageInfo,n=a.operateType,s=a.operateResultList,r=a.tinyID,a=a.globalSequence,l=d.clientTime,d=d.random,h="".concat(r,"-").concat(l,"-").concat(d),g=[],_=[],M=(m.l("".concat(this._n,".onMsgExtNotify messageID:").concat(h," operateType:").concat(n," globalSequence:").concat(a)),this._updateGlobalSeq(h,a),!1),S=!1;s.forEach(function(D){var O=D.extensions,O=O===void 0?[]:O,B=D.clearSequence;n===1?(M=!0,O.forEach(function(U){g.push({key:U.key,value:U.value})}),t._updateLocalExt(h,O)):n===2?(S=!0,O.forEach(function(U){_.push(U.key)}),t._updateLocalExt(h,O)):n===3&&(S=!0,t._hasLocalExt(h)&&t._getLocalExt(h).forEach(function(U,de){U.seq<=B&&!se(U.value)&&_.push(de)}),t._clearLocalExt(h,B))}),M&&this.emitOEvt($.MESSAGE_EXTENSIONS_UPDATED,{messageID:h,extensions:g}),S&&this.emitOEvt($.MESSAGE_EXTENSIONS_DELETED,{messageID:h,keyList:_})}},{key:"setMessageExtensions",value:function(e,g){var n="setMessageExtensions";if(!this.canIUse(he.MSG_EXT))return this.noUse(n);var s="".concat(this._n,".").concat(n),r=e.ID,a=e.conversationID,l=e.sequence,d=e.time,h=q(g),g=(20<g.length&&(h=g.slice(0,20),m.w("".concat(s,". the length of extensions cannot exceed 20."))),"convID:".concat(a," messageID:").concat(r," sequence:").concat(l," time:").concat(d," count:").concat(h.length)),_=new K(n);return _.setMessage(g),m.l("".concat(s," ").concat(g)),this._modifyMsgExts(e,h).then(function(D){var S=D.resultList,O=D.successCount,D=D.failureCount,O="successCount:".concat(O," failCount:").concat(D);return _.setMoreMessage(O).end(),m.l("".concat(s," ok. ").concat(O)),me({extensions:S})}).catch(function(M){return _.setError(M).end(),m.e("".concat(s," failed. error:"),M),A(M)})}},{key:"getMessageExtensions",value:function(e){var t=this,n="getMessageExtensions";if(!this.canIUse(he.MSG_EXT))return this.noUse(n);var s="".concat(this._n,".").concat(n),r=e.ID,d=e.conversationID,a=e.sequence,l=e.time,d="convID:".concat(d," messageID:").concat(r," sequence:").concat(a," time:").concat(l),h=new K(n),g=(h.setMessage(d),m.l("".concat(s," ").concat(d)),void 0);return this.getMsgExtsMap.has(r)&&(g=this._getGlobalSeq(r)),this._getMsgExts(e,g).then(function(_){return h.end(),m.l("".concat(s," ok. extCount:").concat(_.length)),H(g)&&0<_.length&&t.getMsgExtsMap.set(r,1),me({extensions:_})}).catch(function(_){return h.setError(_).end(),m.e("".concat(s," failed. error:"),_),A(_)})}},{key:"deleteMessageExtensions",value:function(e,l){var n="deleteMessageExtensions";if(!this.canIUse(he.MSG_EXT))return this.noUse(n);var s="".concat(this._n,".").concat(n),r=[],a=3,l=(se(l)||(a=2,l.forEach(function(M){r.push({key:M,value:"",seq:0})})),e.ID),g=e.conversationID,d=e.sequence,h=e.time,g="convID:".concat(g," messageID:").concat(l," sequence:").concat(d," time:").concat(h," operateType:").concat(a),_=new K(n);return _.setMessage(g),m.l("".concat(s," ").concat(g)),this._modifyMsgExts(e,r,a).then(function(O){var S=O.resultList,D=O.successCount,O=O.failureCount,B="";return a===2&&(B="success count:".concat(D," fail count:").concat(O)),_.setMoreMessage("".concat(B)).end(),m.l("".concat(s," ok. ").concat(B)),me({extensions:S})}).catch(function(M){return _.setError(M).end(),m.e("".concat(s," failed. error:"),M),A(M)})}},{key:"_modifyMsgExts",value:function(e,t){var n=this,s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1,r=Vt(e.to)?I.CONV_TOPIC:e.conversationType,a=void 0,l=(s!==3&&(a=this._getReqExts(e,t)),null);switch(r){case I.CONV_C2C:l=this.get(6);break;case I.CONV_GROUP:l=this.get(7);break;case I.CONV_TOPIC:l=this.get(10);break;default:return A({code:F.NO_MODULE})}return l.modifyMsgExts(e,a,s).then(function(g){var g=g.data,h=g.extensions,g=g.seq,_=[],M=0,S=0,D=[];return(h=se(h)?[]:h).forEach(function(J){var B=J.errorCode,J=J.extension,U=J.key,de=J.value,J=J.seq;_.push({code:B,key:U,value:de}),B===0?M++:S++,D.push({key:U,value:de,seq:J})}),n._updateGlobalSeq(e.ID,g),0<D.length&&(n._updateLocalExt(e.ID,D),D=null),{resultList:_,successCount:M,failureCount:S}}).catch(function(d){return A(d)})}},{key:"_getReqExts",value:function(e,t){var n,s=[];return this._hasLocalExt(e.ID)?(n=this._getLocalExt(e.ID),t.forEach(function(l){var a=l.key,l=l.value,d=0;n.has(a)&&(d=n.get(a).seq),s.push({key:a,value:l,seq:d})})):t.forEach(function(l){var a=l.key,l=l.value;s.push({key:a,value:l,seq:0})}),s}},{key:"_getMsgExts",value:function(e,t){var n=this,s="".concat(this._n,"._getMsgExts"),r=e.ID,a=e.to,l=null;switch(Vt(a)?I.CONV_TOPIC:e.conversationType){case I.CONV_C2C:l=this.get(6);break;case I.CONV_GROUP:l=this.get(7);break;case I.CONV_TOPIC:l=this.get(10);break;default:return A({code:F.NO_MODULE})}return l.getMessageExtensions(e,t).then(function(_){var _=_.data,M=_.extensions,h=_.completeFlag,g=_.globalSequence,_=_.clearSequence,M=se(M)?[]:M;return m.l("".concat(s," ok. completeFlag:").concat(h," globalSequence:").concat(g," clearSequence:").concat(_," count:").concat(M.length)),n._updateLocalExt(r,M),n._clearLocalExt(r,_),n._updateGlobalSeq(r,g),h!==1?(_=M.slice(-1)[0].seq+1,n._getMsgExts(e,_)):n._getLocalExtList(r)}).catch(function(d){return A(d)})}},{key:"_hasLocalExt",value:function(e){return this.msgExtMap.has(e)}},{key:"_getLocalExt",value:function(e){return this.msgExtMap.get(e)}},{key:"_updateLocalExt",value:function(e,t){this._hasLocalExt(e)||this.msgExtMap.set(e,new Map);var n=this._getLocalExt(e);t.forEach(function(l){var r=l.key,a=l.value,l=l.seq;n.set(r,{value:a===void 0?"":a,seq:l})})}},{key:"_clearLocalExt",value:function(e,t){var n;t<=0||!this._hasLocalExt(e)||(n=this._getLocalExt(e)).forEach(function(s,r){s.seq<=t&&n.delete(r)})}},{key:"_getLocalExtList",value:function(e){var t=[];return this._hasLocalExt(e)&&this._getLocalExt(e).forEach(function(n,s){n=n.value,se(n)||t.push({key:s,value:n})}),t}},{key:"_getGlobalSeq",value:function(e){return this.globalSeqMap.get(e)}},{key:"_updateGlobalSeq",value:function(e,t){this.globalSeqMap.set(e,t)}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this.msgExtMap.clear(),this.globalSeqMap.clear(),this.getMsgExtsMap.clear()}}]),$r),mI=(T(zr,St),Gf=z(zr),y(zr,[{key:"onReactionNotifyList",value:function(n){var t=this,n=(n||{}).dataList;(n===void 0?[]:n).forEach(function(r){var l=r.C2CMessageInfo,d=r.groupMessageInfo,d=d===void 0?{}:d,r=r.reactionList,r=r===void 0?[]:r,l=c(c({},l===void 0?{}:l),d),d=l.tinyID,a=l.clientTime,l=l.random,d="".concat(d,"-").concat(a,"-").concat(l),h=[];r.forEach(function(g){H(g.userIDList)&&(g.userIDList=[],g.count=0),h.push.apply(h,q(g.userIDList))}),m.l("".concat(t._n,".onReactionNotifyList messageID:").concat(d," reactionList:").concat(r.length)),t._handleReactionSummary([{messageID:d,reactionList:r}],h).then(function(g){t.emitOEvt($.MESSAGE_REACTIONS_UPDATED,c({},g[0]))})})}},{key:"onReactionNotify",value:function(n){var n=n.dataList||{},s=n.C2CMessageInfo,r=n.groupMessageInfo,r=r===void 0?{}:r,t=n.reactionID,n=n.operateType,s=c(c({},s===void 0?{}:s),r),r=s.tinyID,a=s.clientTime,s=s.random,r="".concat(r,"-").concat(a,"-").concat(s),a=(m.l("".concat(this._n,".onReactionNotify messageID:").concat(r," reactionID:").concat(t," operateType:").concat(n)),n===1?this._addReactedByMyselfMap(r,t):this._removeReactedByMyselfMap(r,t),"".concat(r,"-").concat(t));this._reactionInfoMap.has(a)&&((s=this._reactionInfoMap.get(a)).reactedByMyself=n===1,this.emitOEvt($.MESSAGE_REACTIONS_UPDATED,{messageID:r,reactionList:[s]}))}},{key:"addMessageReaction",value:function(e,t){var n=this,s="addMessageReaction";if(!this.canIUse(he.MSG_REACTION))return this.noUse(s);var r="".concat(this._n,".").concat(s),d=e.ID,a=e.conversationID,a="convID:".concat(a," messageID:").concat(d," reactionID:").concat(t),l=new K(s),d=(l.setMessage(a),m.l("".concat(r," ").concat(a)),this._createReactionOperationPack(e,t,1));return this._addReactedByMyselfMap(e.ID,t),this.req(d).then(function(){return l.end(),m.l("".concat(r," ok.")),me()}).catch(function(h){return n._removeReactedByMyselfMap(e.ID,t),l.setError(h).end(),m.e("".concat(r," failed. error:"),h),A(h)})}},{key:"removeMessageReaction",value:function(e,t){var n="removeMessageReaction";if(!this.canIUse(he.MSG_REACTION))return this.noUse(n);var s="".concat(this._n,".").concat(n),l=e.ID,r=e.conversationID,r="convID:".concat(r," messageID:").concat(l," reactionID:").concat(t),a=new K(n),l=(a.setMessage(r),m.l("".concat(s," ").concat(r)),this._createReactionOperationPack(e,t,2));return this._removeReactedByMyselfMap(e.ID,t),this.req(l).then(function(){return a.end(),m.l("".concat(s," ok.")),me()}).catch(function(d){return a.setError(d).end(),m.e("".concat(s," failed. error:"),d),A(d)})}},{key:"getMessageReactions",value:function(e){var t=this,n="getMessageReactions";if(!this.canIUse(he.MSG_REACTION))return this.noUse(n);var s="".concat(this._n,".").concat(n),r=e.messageList,h=e.maxUserCountPerReaction,a=r[0].conversationID,a="convID:".concat(a," maxUserCountPerReaction:").concat(h," msgCount:").concat(r.length),l=new K(n),d=(l.setMessage(a),m.l("".concat(s," ").concat(a)),new Map),h=this._createReactionSummaryPack(c(c({},e),{},{messageIDMap:d}));return this.req(h).then(function(_){var _=_.data.resultList,M=[],S=[];return(_===void 0?[]:_).forEach(function(B){var O=B.messageKey,O=O===void 0?void 0:O,U=B.messageSequence,U=U===void 0?void 0:U,B=B.reactionList,B=B===void 0?[]:B,U=H(O)?d.get(U):d.get(O);M.push({messageID:U,reactionList:B}),B.forEach(function(de){S.push.apply(S,q(de.userIDList))})}),t._handleReactionSummary(M,S)}).then(function(g){return l.end(),m.l("".concat(s," ok.")),d.clear(),me({resultList:g})}).catch(function(g){return l.setError(g).end(),m.e("".concat(s," failed. error:"),g),A(g)})}},{key:"getAllUserListOfMessageReaction",value:function(e){var t=this,n="getAllUserListOfMessageReaction";if(!this.canIUse(he.MSG_REACTION))return this.noUse(n);var s="".concat(this._n,".").concat(n),d=e.message,r=e.reactionID,a=e.nextSeq,l=e.count,_=d.ID,d=d.conversationID,d="convID:".concat(d," messageID:").concat(_," reactionID:").concat(r," nextSeq:").concat(a," count:").concat(l),h=new K(n),g=(h.setMessage(d),m.l("".concat(s," ").concat(d)),{userList:[],nextSeq:0,isCompleted:!1}),_=this._createReactionUserListPack(e);return this.req(_).then(function(D){var D=D.data,S=D.userIDList,S=S===void 0?[]:S,D=D.nextSeq,D=D===void 0?0:D;return g.nextSeq=D,g.isCompleted=D===0,t.get(4).getUserNickAndAvatar(S)}).then(function(M){return g.userList=M,h.end(),m.l("".concat(s," ok.")),me(g)}).catch(function(M){return h.setError(M).end(),m.e("".concat(s," failed. error:"),M),A(M)})}},{key:"_createReactionOperationPack",value:function(e,l,n){var s,r,a=void 0,l={reactionID:l,userIDList:[this.getMyUserID()]};return e.conversationType===I.CONV_C2C&&(s=this.get(6),a=n===1?E.ADD_C2C_MSG_REACTION:E.RM_C2C_MSG_REACTION,l.from=e.from,l.to=e.to,l.messageKey=s.getMessageKey(e)),e.conversationType===I.CONV_GROUP&&(s=void 0,r=e.to,Vt(e.to)&&(r=wt(s=e.to)),a=n===1?E.ADD_GRP_MSG_REACTION:E.RM_GRP_MSG_REACTION,l.groupID=r,l.topicID=s,l.messageSequence=e.sequence),{P:a,data:l}}},{key:"_createReactionSummaryPack",value:function(d){var t,n,s,r=d.messageList,a=d.maxUserCountPerReaction,a=a===void 0?10:a,l=d.messageIDMap,d=r[0],h=void 0,g=void 0;return d.conversationType===I.CONV_C2C&&(t=this.get(6),n=r.map(function(_){var M=t.getMessageKey(_);return l.set(M,_.ID),M}),h=E.GET_C2C_MSG_REACTIONS,g={from:d.from,to:d.to,messageKeyList:n,count:a}),d.conversationType===I.CONV_GROUP&&(n=void 0,s=d.to,Vt(d.to)&&(s=wt(n=d.to)),d=r.map(function(_){return l.set(_.sequence,_.ID),_.sequence}),h=E.GET_GRP_MSG_REACTIONS,g={groupID:s,topicID:n,messageSequenceList:d,count:a}),{P:h,data:g}}},{key:"_createReactionUserListPack",value:function(s){var t=s.message,a=s.reactionID,n=s.nextSeq,s=s.count,s=s===void 0?100:s,r=void 0,a={reactionID:a,nextSeq:n===void 0?0:n,count:100<s?100:s};return t.conversationType===I.CONV_C2C&&(n=this.get(6),r=E.GET_C2C_MSG_REACTION_USER_LIST,a.from=t.from,a.to=t.to,a.messageKey=n.getMessageKey(t)),t.conversationType===I.CONV_GROUP&&(s=void 0,n=t.to,Vt(t.to)&&(n=wt(s=t.to)),r=E.GET_GRP_MSG_REACTION_USER_LIST,a.groupID=n,a.topicID=s,a.messageSequence=t.sequence),{P:r,data:a}}},{key:"_handleReactionSummary",value:function(e,t){var n=this;return this.get(4).getUserNickAndAvatar(t).then(function(s){var r=[];return e.forEach(function(a){var l=[];a.reactionList.forEach(function(_){var h=_.reactionID,g=_.count,S=_.userIDList,_=_.reactedByMyself,_=_===void 0?void 0:_,M=[],S=(S.forEach(function(D){s.forEach(function(O){D===O.userID&&M.push(O)})}),{reactionID:h,totalUserCount:g,partialUserList:M,reactedByMyself:n._computeReactedByMyself({reactedByMyself:_,messageID:a.messageID,reactionID:h})});l.push(S),H(_)&&!n._reactedByMyselfMap.has(a.messageID)&&(g="".concat(a.messageID,"-").concat(h),n._reactionInfoMap.set(g,S))}),r.push({messageID:a.messageID,reactionList:l})}),r})}},{key:"_addReactedByMyselfMap",value:function(e,t){this._reactedByMyselfMap.has(e)||this._reactedByMyselfMap.set(e,[]),e=this._reactedByMyselfMap.get(e),e.indexOf(t)===-1&&e.push(t)}},{key:"_removeReactedByMyselfMap",value:function(e,t){!this._reactedByMyselfMap.has(e)||-1<(t=(e=this._reactedByMyselfMap.get(e)).indexOf(t))&&e.splice(t,1)}},{key:"_computeReactedByMyself",value:function(s){var t=s.reactedByMyself,n=s.messageID,s=s.reactionID;return H(t)?!!this._reactedByMyselfMap.has(n)&&this._reactedByMyselfMap.get(n).includes(s):t===1}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._reactedByMyselfMap.clear(),this._reactionInfoMap.clear()}}]),zr),vI=(T(Yr,St),bf=z(Yr),y(Yr,[{key:"sendMessage",value:function(e){var t=this,n=this._createMsg(e);if(n===null)return A({code:F.MSG_SEND_FAIL});this._addSendMessageTotalCount(n);var s=Date.now();return this.get(11).setMessageRandom(n),this._sendComboMessage(n,e).then(function(l){var l=l.data,d=l.time,a=l.sequence,l=l.readReceiptCode,l=(Qe(l)&&l!==0&&(new K("sendMessageWithReceipt").setMessage("from:".concat(n.from," to:").concat(n.to," sequence:").concat(a," readReceiptCode:").concat(l)).end(),m.w("".concat(t._n,".sendMessage readReceiptCode:").concat(l," message:").concat(t.getErrMsg(l)))),t._addSendMessageSuccessCount(n,s),t.get(11)),d=(n.status=Fn,n.time=d,n.conversationType===I.CONV_GROUP&&(n.sequence=a),l.appendToMessageList(n),n);return n._isExcludedFromLastMessage===!0&&(d=""),l.onMessageSent({conversationOptionsList:[{conversationID:n.conversationID,unreadCount:0,type:n.conversationType,subType:n.conversationSubType,lastMessage:d}]}),me({message:n})}).catch(function(r){return t._onSendMessageFailed(n,r)})}},{key:"_sendComboMessage",value:function(e,t){var n=this._m.get(20),s="";return e.conversationType===I.CONV_C2C&&(s="".concat(P.NAME.OPEN_IM,".").concat(E.SEND_C2C_MSG)),e.conversationType===I.CONV_GROUP&&(s="".concat(P.NAME.GRP,".").concat(E.SEND_GRP_MSG)),n.sendComboMessage({servcmd:s,data:t})}},{key:"_createMsg",value:function(e){var t="".concat(this._n,"._createMsg"),n=null;try{var s,r=this.getMyUserID(),a={};a.senderTinyID=this.getMyTinyID(),a.currentUser=r,a.from=e.From_Account||r,e.GroupId?(a.conversationID="".concat(I.CONV_GROUP).concat(e.GroupId),a.conversationType=I.CONV_GROUP,a.to=e.GroupId):e.To_Account&&(a.conversationID="".concat(I.CONV_C2C).concat(e.To_Account),a.conversationType=I.CONV_C2C,a.to=e.To_Account),a.time=e.MsgTimeStamp||0,a.random=e.Random||e.MsgRandom||0,a.priority=e.MsgPriority,xe(e.CloudCustomData)&&0<e.CloudCustomData.length&&(a.cloudCustomData=e.CloudCustomData),_e(e.SendMsgControl)&&(a.messageControlInfo={},e.SendMsgControl.includes("NoUnread")&&(a.messageControlInfo.excludedFromUnreadCount=1),e.SendMsgControl.includes("NoLastMsg")&&(a.messageControlInfo.excludedFromLastMessage=1)),a.conversationType===I.CONV_GROUP&&_e(e.To_Account)&&0<e.To_Account.length&&(s=e.To_Account,50<e.To_Account.length&&(s=e.To_Account.slice(0,50),m.w("".concat(t," To_Account must be less than or equal to 50."))),a.receiverList=q(s),e.To_Account=q(s)),e.IsNeedReadReceipt!==1&&e.NeedReadReceipt!==1||(a.needReadReceipt=!0),e.SupportMessageExtension===1&&(a.isSupportExtension=!0),(n=new Bt(a)).status=la,e.MsgClientTime=n.clientTime,n.conversationType===I.CONV_C2C&&(e.MsgSeq=n.sequence);for(var l,d=e.MsgBody.length,h=0;h<d;h++)(l=e.MsgBody[h]).MsgType==="TIMTextElem"?n.setTextElement(l.MsgContent.Text):l.MsgType==="TIMCustomElem"?n.setCustomElement({data:l.MsgContent.Data||"",description:l.MsgContent.Desc||"",extension:l.MsgContent.Ext||""}):l.MsgType==="TIMFaceElem"&&n.setFaceElement({index:l.MsgContent.Index,data:l.MsgContent.Data});var g=n.getElements();n.payload=g[0].content,n.type=g[0].type}catch(_){n=null,m.e("".concat(t," failed. error:"),_)}return n}},{key:"_onSendMessageFailed",value:function(e,t){e.status=$c,this.get(11).deleteMessageRandom(e),this._addSendMessageFailCountOnUser(e,t);var n=new K("sendMessage"),s="head.seq:".concat(t.data.headSeq,"  type:").concat(e.type," from:").concat(e.from," to:").concat(e.to);return n.setMessage(s).setError(t).end(),m.e("".concat(this._n,"._onSendMessageFailed ").concat(s," error:"),t),A(new yt({code:t&&t.code?t.code:F.MSG_SEND_FAIL,message:t&&t.message?t.message:void 0,data:{message:e}}))}},{key:"_getSendMessageSpecifiedKey",value:function(e){if(e.conversationType===I.CONV_C2C)return Ks;if(e.conversationType===I.CONV_GROUP){var e=this.get(7).getLocalGroupProfile(e.to);if(e)return e=e.type,nn(e)?Ws:js}}},{key:"_addSendMessageTotalCount",value:function(e){e=this._getSendMessageSpecifiedKey(e),e&&this.get(26).addTotalCount(e)}},{key:"_addSendMessageSuccessCount",value:function(s,t){var n,s=this._getSendMessageSpecifiedKey(s);s&&((n=this.get(26)).addSuccessCount(s),n.addCost(s,Kt(t,!1)))}},{key:"_addSendMessageFailCountOnUser",value:function(r,n){var n=n.code,n=n===void 0?-1:n,s=this.get(26),r=this._getSendMessageSpecifiedKey(r);Of(n)&&r&&s.addFailedCountOfUserSide(r)}}]),Yr),yI=(T(Wr,St),Pf=z(Wr),y(Wr,[{key:"registerPlugin",value:function(e){var t=this,n="0";Object.keys(e).forEach(function(s){t.plugins[s]=e[s],s==="tim-upload-plugin"&&typeof e[s].getVersion=="function"&&(n=e[s].getVersion())}),new K("registerPlugin").setMessage("".concat(Object.keys(e))).setMoreMessage("version:".concat(n)).end()}},{key:"getPlugin",value:function(e){return this.plugins[e]}},{key:"reset",value:function(){}}]),Wr),II=(T(jr,St),Nf=z(jr),y(jr,[{key:"_init",value:function(){this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:0})}},{key:"_startSync",value:function(e){var t=this,n=e.cookie,s=e.syncFlag,r=e.isOnlineSync,a="".concat(this._n,"._startSync"),l=(m.l("".concat(a," options:"),e),new K("syncUnread"));l.setMessage(JSON.stringify(e)),this.req({P:E.SYNC_UNREAD_MSG,data:{cookie:n,syncFlag:s,isOnlineSync:r}}).then(function(d){var g=d.data,h=g.cookie,g=g.syncFlag,_="$cookie:".concat(h," syncFlag:").concat(g);m.l("".concat(a," ok. ").concat(_)),t._cookie=h,l.setMoreMessage(_).end(),se(h)||(g===0||g===1?(t._dispatch(c(c({},d.data),{},{isSyncingEnded:!1})),t._startSync({cookie:h,syncFlag:g,isOnlineSync:0})):g===2&&t._dispatch(c(c({},d.data),{},{isSyncingEnded:!0})))}).catch(function(d){l.setError(d).end(),m.e("".concat(a," failed. error:"),d)})}},{key:"_dispatch",value:function(e){e.eventArray&&this.get(20).onMessage({head:{},body:{eventArray:e.eventArray,isInstantMessage:this._onlineSyncFlag,isSyncingEnded:e.isSyncingEnded}}),this.get(6).onNewMessage({dataList:e.messageList,isInstantMessage:!!e.isSyncingEnded&&this._onlineSyncFlag,C2CRemainingUnreadList:e.C2CRemainingUnreadList,C2CPairUnreadList:e.C2CPairUnreadList,isSyncingEnded:e.isSyncingEnded})}},{key:"syncOnNeed",value:function(){m.l("".concat(this._n,".syncOnNeed cookie:").concat(this._cookie)),this._onlineSyncFlag=!0,this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:1})}},{key:"syncOnReconnected",value:function(){m.l("".concat(this._n,".syncOnReconnected cookie:").concat(this._cookie)),this._onlineSyncFlag=!0,this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:0})}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._onlineSyncFlag=!1,this._cookie=""}}]),jr),ma={req:{toAccount:"To_Account",fromAccount:"From_Account",to:"To_Account",from:"From_Account",groupID:"GroupId",groupAtUserID:"GroupAt_Account",extension:"Ext",data:"Data",description:"Desc",elements:"MsgBody",sizeType:"Type",downloadFlag:"Download_Flag",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",videoUrl:"",imageUrl:"URL",fileUrl:"Url",uuid:"UUID",priority:"MsgPriority",receiverUserID:"To_Account",receiverGroupID:"GroupId",messageSender:"SenderId",messageReceiver:"ReceiverId",nick:"From_AccountNick",avatar:"From_AccountHeadurl",messageNumber:"MsgNum",pbDownloadKey:"PbMsgKey",downloadKey:"JsonMsgKey",applicationType:"PendencyType",userIDList:"To_Account",groupNameList:"GroupName",userID:"To_Account",groupAttributeList:"GroupAttr",mainSequence:"AttrMainSeq",avChatRoomKey:"BytesKey",attributeControl:"AttrControl",sequence:"seq",messageControlInfo:"SendMsgControl",updateSequence:"UpdateSeq",clientTime:"MsgClientTime",sequenceList:"MsgSeqList",topicID:"TopicId",customData:"CustomString",isSupportTopic:"SupportTopic",isWebUniapp:"is_web_uniapp",isSupportExtension:"SupportMessageExtension",messageSequence:"MsgSeq",messageKey:"MsgKey",startSequence:"startSeq",simplifiedMessage:"DownsizeFlag",isRelayMessage:"IsRelayMsg",reactionID:"Reaction",messageSequenceList:"MsgSeqList",messageKeyList:"MsgKeyList",cmConfigID:"CustomModerationConfigID"},res:{MsgPriority:"priority",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID",Download_Flag:"downloadFlag",GroupId:"groupID",Member_Account:"userID",MsgList:"messageList",SyncFlag:"syncFlag",To_Account:"to",From_Account:"from",MsgSeq:"sequence",MsgRandom:"random",MsgTime:"time",MsgTimeStamp:"time",MsgContent:"content",MsgBody:"elements",From_AccountNick:"nick",From_AccountHeadurl:"avatar",GroupWithdrawInfoArray:"revokedInfos",GroupReadInfoArray:"groupMessageReadNotice",LastReadMsgSeq:"lastMessageSeq",WithdrawC2cMsgNotify:"c2cMessageRevokedNotify",C2cWithdrawInfoArray:"revokedInfos",C2cReadedReceipt:"c2cMessageReadReceipt",ReadC2cMsgNotify:"c2cMessageReadNotice",LastReadTime:"peerReadTime",MsgRand:"random",MsgType:"type",MsgShow:"messageShow",NextMsgSeq:"nextMessageSeq",FaceUrl:"avatar",ProfileDataMod:"profileModify",Profile_Account:"userID",ValueBytes:"value",ValueNum:"value",NoticeSeq:"noticeSequence",NotifySeq:"notifySequence",MsgFrom_AccountExtraInfo:"messageFromAccountExtraInformation",Operator_Account:"operatorID",OpType:"operationType",ReportType:"operationType",UserId:"userID",User_Account:"userID",List_Account:"userIDList",MsgOperatorMemberExtraInfo:"operatorInfo",MsgMemberExtraInfo:"memberInfoList",ImageUrl:"avatar",NickName:"nick",MsgGroupNewInfo:"newGroupProfile",MsgAppDefinedData:"groupCustomField",Owner_Account:"ownerID",GroupFaceUrl:"avatar",GroupIntroduction:"introduction",GroupNotification:"notification",GroupApplyJoinOption:"joinOption",MsgKey:"messageKey",GroupInfo:"groupProfile",ShutupTime:"muteTime",Desc:"description",Ext:"extension",GroupAt_Account:"groupAtUserID",MsgNum:"messageNumber",PbMsgKey:"pbDownloadKey",JsonMsgKey:"downloadKey",MsgModifiedFlag:"isModified",PendencyItem:"applicationItem",PendencyType:"applicationType",AddTime:"time",AddSource:"source",AddWording:"wording",ProfileImImage:"avatar",PendencyAdd:"friendApplicationAdded",FrienPencydDel_Account:"friendApplicationDeletedUserIDList",Peer_Account:"userID",GroupAttr:"groupAttributeList",GroupAttrAry:"groupAttributeList",AttrMainSeq:"mainSequence",seq:"sequence",GroupAttrOption:"groupAttributeOption",BytesChangedKeys:"changedKeyList",GroupAttrInfo:"groupAttributeList",GroupAttrSeq:"mainSequence",PushChangedAttrValFlag:"isWithChangedAttributeInfo",SubKeySeq:"sequence",Val:"value",MsgGroupFromCardName:"senderNameCard",MsgGroupFromNickName:"senderNick",C2cNick:"peerNick",C2cImage:"peerAvatar",SendMsgControl:"messageControlInfo",NoLastMsg:"excludedFromLastMessage",NoUnread:"excludedFromUnreadCount",UpdateSeq:"updateSequence",MuteNotifications:"muteFlag",MsgClientTime:"clientTime",TinyId:"tinyID",GroupMsgReceiptList:"readReceiptList",ReadNum:"readCount",UnreadNum:"unreadCount",TopicId:"topicID",MillionGroupFlag:"communityType",SupportTopic:"isSupportTopic",MsgTopicNewInfo:"newTopicInfo",ShutupAll:"muteAllMembers",CustomString:"customData",TopicFaceUrl:"avatar",TopicIntroduction:"introduction",TopicNotification:"notification",TopicIdArray:"topicIDList",MsgVersion:"messageVersion",C2cMsgModNotifys:"c2cMessageModified",GroupMsgModNotifys:"groupMessageModified",ApplyJoinOption:"joinOption",MsgFlag:"messageRemindType",AtInfoList:"groupAtInfoList",AtFlagList:"groupAtType",AtMsgSeq:"sequence",BanDuration:"duration",BanDescription:"reason",NotVisible:"invisible",BytesTag:"tag",BytesValue:"value",RptBytesValue:"value",LatestSeq:"globalSequence",ClearSeq:"clearSequence",SupportMessageExtension:"isSupportExtension",ExtensionList:"extensions",GroupCounter:"counterList",Revoker_Account:"revoker",MsgExtensionNotify:"messageExtensionNotify",ExtensionC2cMsgInfo:"messageInfo",ExtensionGroupMsgInfo:"messageInfo",MsgOptType:"operateType",SetKVInfo:"operateResultList",DeleteKVInfo:"operateResultList",ClearKVInfo:"operateResultList",MsgKeyValue:"extensions",ClearMsgSeq:"clearSequence",MsgLastSeq:"globalSequence",InviteJoinOption:"inviteOption",MemberList_Account:"inviteeList",MsgMemberExtraInfoList:"inviteeInfoList",E:"event",GInf:"groupProfile",MCT:"clientTime",MR:"random",MP:"priority",MTS:"time",GId:"groupID",MS:"sequence",CCD:"cloudCustomData",F_Account:"from",F_Hd:"avatar",F_NN:"nick",GN:"groupName",GT:"groupType",IsSys:"isSystemMessage",OpInf:"operatorInfo",Img:"avatar",NN:"nick",OnlineInf:"onlineMemberInfo",ET:"expireTime",Num:"onlineMemberNum",Opt:"operationType",O_Account:"operatorID",RT:"operationType",UDF:"userDefinedField",L_Account:"userIDList",IsPlaceMsg:"isPlaceMessage",MsgCheckResult:"checkResult",Results:"resultList",Reaction:"reactionID",Reaction_Account:"userIDList",MsgReactionNotifyList:"messageReactionNotifyList",MsgReactionNotify:"messageReactionNotify",MsgReactionSummary:"reactionList",C2CMsgInfo:"C2CMessageInfo",GroupMsgInfo:"groupMessageInfo",int32_err_code:"errorCode",str_err_msg:"errorMsg",MsgDropReason:"messageDropReason",ReactedByMe:"reactedByMyself",Level:"messageRemindType",PeerReadTime:"timestamp",NoUnreadSeqList:"excludedUnreadSequenceList",NewMsg:"topicLatestMessage"},ignoreKeyWord:["C2C","ID","USP"]};function jr(e){return f(this,jr),(e=Nf.call(this,e))._n="SyncUnreadMsgModule",e._cookie="",e._onlineSyncFlag=!1,e.getIEmitInst().on(mt.A2KEY_AND_TINYID_UPDATED,e._init,V(e)),e}function Wr(e){return f(this,Wr),(e=Pf.call(this,e))._n="PluginModule",e.plugins={},e}function Yr(e){return f(this,Yr),(e=bf.call(this,e))._n="ComboMsgModule",e}function zr(e){return f(this,zr),(e=Gf.call(this,e))._n="MsgReactionModule",e._reactedByMyselfMap=new Map,e._reactionInfoMap=new Map,e}function $r(e){return f(this,$r),(e=wf.call(this,e))._n="MsgExtModule",e.msgExtMap=new Map,e.globalSeqMap=new Map,e.getMsgExtsMap=new Map,e}function Jr(e){return f(this,Jr),(e=Uf.call(this,e))._n="MessageModule",e._messageOptionsMap=new Map,e._mergerMessageHandler=new pI(V(e)),e}function Xu(e,t){if(typeof e!="string"&&!Array.isArray(e))throw new TypeError("Expected the input to be `string | string[]`");return t=Object.assign({pascalCase:!1},t),(e=Array.isArray(e)?e.map(function(n){return n.trim()}).filter(function(n){return n.length}).join("-"):e.trim()).length===0?"":e.length===1?t.pascalCase?e.toUpperCase():e.toLowerCase():(e=e=(e=e!==e.toLowerCase()?MI(e):e).replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,function(n,s){return s.toUpperCase()}).replace(/\d+(\w|$)/g,function(n){return n.toUpperCase()}),t.pascalCase?e.charAt(0).toUpperCase()+e.slice(1):e)}var MI=function(e){for(var t=!1,n=!1,s=!1,r=0;r<e.length;r++){var a=e[r];t&&/[a-zA-Z]/.test(a)&&a.toUpperCase()===a?(e=e.slice(0,r)+"-"+e.slice(r),s=n,n=!(t=!1),r++):n&&s&&/[a-zA-Z]/.test(a)&&a.toLowerCase()===a?(e=e.slice(0,r-1)+"-"+e.slice(r-1),s=n,t=!(n=!1)):(t=a.toLowerCase()===a&&a.toUpperCase()!==a,s=n,n=a.toUpperCase()===a&&a.toLowerCase()!==a)}return e};function CI(e,t){var n=0;return function s(r,a){return 100<++n?(n--,r):_e(r)?(l=r.map(function(_){return ao(_)?s(_,a):_}),n--,l):ao(r)?(d=r,h=function(_,M){if(!qp(M))return!1;if(M!==Xu(M))for(var S=0;S<ma.ignoreKeyWord.length&&!M.includes(ma.ignoreKeyWord[S]);S++);var D;return H(a[M])?(D=M)[0].toUpperCase()+Xu(D).slice(1):a[M]},g=Object.create(null),Object.keys(d).forEach(function(_){var M=h(d[_],_);M&&(g[M]=d[_])}),l=Kp(l=g,function(_,M){return _e(_)||ao(_)?s(_,a):_}),n--,l):void 0;var l,d,h,g}(e,t)}for(var Ff,Zu=String.fromCharCode,TI=function(e){var t=0|e.charCodeAt(0);if(55296<=t)if(t<56320)if(e=0|e.charCodeAt(1),56320<=e&&e<=57343){if(65535<(t=(t<<10)+e-56613888|0))return Zu(240|t>>>18,128|t>>>12&63,128|t>>>6&63,128|63&t)}else t=65533;else t<=57343&&(t=65533);return t<=2047?Zu(192|t>>>6,128|63&t):Zu(224|t>>>12,128|t>>>6&63,128|63&t)},va=function(e){for(var t=e===void 0?"":(""+e).replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,TI),n=0|t.length,s=new Uint8Array(n),r=0;r<n;r=r+1|0)s[r]=0|t.charCodeAt(r);return s},EI=(y(rl,[{key:"getID",value:function(){return this._id}},{key:"_onOpen",value:function(e){this._handler.onOpen({id:this._id,res:JSON.stringify(e)})}},{key:"_onClose",value:function(e){this._handler.onClose({id:this._id,e})}},{key:"_onMessage",value:function(e){e=this._canIUseBinaryFrame?this._isAppCompressedData(e.data)?this._handler.inflate(e.data):function(t){for(var n=new Uint8Array(t),s="",r=0,a=n.length;r<a;){var l=n[r],d=0,h=0;if(l<=127?(d=0,h=255&l):l<=223?(d=1,h=31&l):l<=239?(d=2,h=15&l):l<=244&&(d=3,h=7&l),0<a-r-d)for(var g=0;g<d;)h=h<<6|63&(l=n[r+g+1]),g+=1;else h=65533,d=a-r;s+=String.fromCodePoint(h),r+=d+1}return s}(e.data):e.data,this._handler.onMessage({data:e})}},{key:"_isAppCompressedData",value:function(e){return e=new Uint8Array(e),e[0]===67&&e[1]===79&&e[2]===77&&e[3]===80}},{key:"_onError",value:function(e){this._handler.onError({id:this._id,e})}},{key:"setIsWorkerEnabled",value:function(e){this._isWorkerEnabled=!0}},{key:"close",value:function(e){if(this._workerSocket&&(this._workerSocket.postMessage({cmd:"stop",code:e}),this._workerSocket.terminate(),this._workerSocket=null),w)return le.offSocketClose(),le.offSocketMessage(),le.offSocketOpen(),le.offSocketError(),void le.closeSocket();this._socket&&(ee?(this._socket.onClose(function(){}),this._socket.onOpen(function(){}),this._socket.onMessage(function(){}),this._socket.onError(function(){})):(this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null),b?this._socket.close({code:e}):this._socket.close(e),this._socket=null)}},{key:"send",value:function(e){this._workerSocket?this._workerSocket.postMessage({cmd:"sendMessage",data:this._canIUseBinaryFrame?va(e.data).buffer:e.data}):w?le.sendSocketMessage({data:e.data,fail:function(){e.fail&&e.requestID&&e.fail(e.requestID)}}):this._socket&&(ee?this._socket.send({data:this._canIUseBinaryFrame?va(e.data).buffer:e.data,fail:function(){e.fail&&e.requestID&&e.fail(e.requestID)}}):this._socket.send(this._canIUseBinaryFrame?va(e.data):e.data))}}]),rl),DI=["keyMap"],SI=["keyMap"],$s="connected",Qu="connecting",Js="disconnected",LI=(y(sl,[{key:"_setWebsocketHost",value:function(){var e=this._chM.get(12);this._currentSite=Ee,this._chM.isOversea()&&(this._currentSite="OVERSEA"),e.isSingaporeSite()?this._currentSite="SINGAPORE":e.isKoreaSite()?this._currentSite="KOREA":e.isGermanySite()?this._currentSite="GERMANY":e.isIndiaSite()?this._currentSite="IND":e.isJapanSite()?this._currentSite="JPN":e.isUSASite()?this._currentSite="USA":e.isIndonesiaSite()&&(this._currentSite="INDONESIA"),P.HOST.setCurrent(this._currentSite)}},{key:"_initConnection",value:function(){var t=this._chM.get(12).getSDKAppID()+"",e=this._chM.get(12).isIndependentDomainDisabled(),e=(H(P.HOST.CURRENT.BACKUP)?this._url=P.HOST.CURRENT.DEFAULT:this._url===""?this._url=e?P.HOST.CURRENT.DEFAULT:P.HOST.CURRENT.DEFAULT0.replace("*",t):-1<this._url.indexOf(t)?this._url=P.HOST.CURRENT.DEFAULT:this._url===P.HOST.CURRENT.DEFAULT?this._url=P.HOST.CURRENT.IPV6||P.HOST.CURRENT.BACKUP:this._url===P.HOST.CURRENT.IPV6?this._url=P.HOST.CURRENT.BACKUP:this._url===P.HOST.CURRENT.BACKUP?this._url=this._canIUseAnyCast()?P.HOST.CURRENT.ANYCAST:P.HOST.CURRENT.DEFAULT:this._url===P.HOST.CURRENT.ANYCAST&&(P.HOST.CURRENT.ANYCAST="",this._url=P.HOST.CURRENT.DEFAULT),this._chM.get(12)),t=e.getProxyServer();se(t)||(this._url=t),e.isTestEnv()&&(this._url=Q.TEST[this._currentSite].DEFAULT),this._connect(),this._nextPingTs=0}},{key:"_canIUseAnyCast",value:function(){return Te&&P.HOST.CURRENT.ANYCAST}},{key:"onCheckTimer",value:function(e){e%1==0&&(this._checkPromiseMap(),this._checkNativeAppWS())}},{key:"_checkPromiseMap",value:function(){var e=this;this._promiseMap.size!==0&&this._promiseMap.forEach(function(a,n){var s=a.reject,r=a.timestamp,a=a.headSeq,l=15e3;n.indexOf(E.LOGIN)!==-1?l=9e4:n.indexOf(E.PING)!==-1&&(l=3e3),Date.now()-r>=l&&(m.l("".concat(e._n,"._checkPromiseMap request timeout, delete requestID:").concat(n)),e._promiseMap.delete(n),s(new yt({code:F.NETWORK_TIMEOUT,data:{headSeq:a}})),e._chM.onRequestTimeout())})}},{key:"_checkNativeAppWS",value:function(){j&&!this.isConnected()&&this._reConnect()}},{key:"onOpen",value:function(e){var t,n;this._readyState!==Js&&(this._onOpenTs=Date.now(),n=e.id,e=e.res,this._socketID=n,t=Kt(this._startTs,!1),n="socketID:".concat(n," res:").concat(e),m.l("".concat(this._n,"._onOpen cost:").concat(t," ms. ").concat(n)),new K("wsOnOpen").setMessage(t).setCostTime(t).setMoreMessage(n).end(),this._readyState=$s,this._reConnectCount=0,this._resend(),this._reConnectFlag===!0&&(this._chM.onReconnected(),this._reConnectFlag=!1),this._chM.onOpen())}},{key:"onClose",value:function(s){var t=new K("wsOnClose"),n=s.id,s=s.e,r="sourceSocketID:".concat(n," currentSocketID:").concat(this._socketID," code:").concat(s.code," reason:").concat(s.reason),a=0;this._onOpenTs!==0&&(a=Date.now()-this._onOpenTs),t.setMessage(a).setCostTime(a).setMoreMessage(r).setCode(s.code).end(!0),m.l("".concat(this._n,"._onClose ").concat(r," onlineTime:").concat(a)),n===this._socketID&&(this._readyState=Js,a<1e3?this._chM.onReconnectFailed():this._chM.onClose())}},{key:"onError",value:function(n){var t=n.id,n=n.e,s="sourceSocketID:".concat(t," currentSocketID:").concat(this._socketID);new K("wsOnError").setMessage(n.errMsg||JSON.stringify(n,["message","code"])).setMoreMessage(s).setLevel("error").end(!0),m.w("".concat(this._n,"._onError"),n,s),t===this._socketID&&(this._readyState=Js,this._chM.onError())}},{key:"onMessage",value:function(e){var t;try{t=JSON.parse(e.data)}catch{new K("jsonParseError").setMessage(e.data).end()}if(t&&t.head){var n,s,r,a,e=this._getRequestIDFromHead(t.head),l=t.body;if(this._chM.get(30).isTRTCCommand(e)||(a=Kc(t.head),l=function h(g,_){return _e(g)?g.map(function(O){return ao(O)?h(O,_):O}):ao(g)?(M=g,S=function(O,B){return H(_[B])?Xu(B):_[B]},D={},Object.keys(M).forEach(function(O){D[S(M[O],O)]=M[O]}),Kp(D,function(O){return _e(O)||ao(O)?h(O,_):O})):void 0;var M,S,D}(t.body,this._getResKeyMap(a))),m.d("".concat(this._n,".onMessage ret:").concat(JSON.stringify(l)," requestID:").concat(e," has:").concat(this._promiseMap.has(e))),this._setNextPingTs(),this._promiseMap.has(e))return n=(a=this._promiseMap.get(e)).resolve,s=a.reject,r=a.timestamp,a=a.headSeq,this._promiseMap.delete(e),this._calcRTT(r),void(l.errorCode&&l.errorCode!==0?(this._chM.onErrorCodeNotZero(l),s(new yt({code:l.errorCode,message:l.errorInfo||"",data:e.includes(E.MODIFY_C2C_MSG)||e.includes(E.MODIFY_GRP_MSG)?{elements:l.elements,messageVersion:l.messageVersion,cloudCustomData:l.cloudCustomData,headSeq:a}:{headSeq:a}}))):n(me(l)));this._chM.onMessage({head:t.head,body:l})}}},{key:"_calcRTT",value:function(e){e=Date.now()-e,this._chM.get(26).addRTT(e)}},{key:"_connect",value:function(){this._readyState!==Qu&&this._readyState!==$s&&(this._startTs=Date.now(),this._onOpenTs=0,this._readyState=Qu,this._socket=new EI(this),this._socketID=this._socket.getID(),m.l("".concat(this._n,"._connect isWorkerEnabled:").concat(this.getIsWorkerEnabled()," socketID:").concat(this._socketID," url:").concat(this.getURL())),new K("wsConnect").setMessage("socketID:".concat(this._socketID," url:").concat(this.getURL())).end())}},{key:"getURL",value:function(){this._chM.isDevMode()&&(this._canIUseBinaryFrame=!1);var e=Wp(),t=((w||Ce&&e==="windows"||j)&&(this._canIUseBinaryFrame=!1),-1),s=(e==="ios"?t=Ye||-1:e==="android"&&(t=ae||-1),this._chM.get(12)),n=this._chM.getPlatform(),r=s.getSDKAppID(),s=s.getInstanceID(),r="sdkappid=".concat(r,"&instanceid=").concat(s,"&random=").concat(this._getRandom(),"&platform=").concat(n,"&host=").concat(e)+"&version=".concat(t,"&sdkversion=").concat("3.5.2");return De&&(r+="&isminigame=1"),this._chM.canIUseInflate()&&(r+="&compress=gzip"),(this._canIUseBinaryFrame?"".concat(this._url,"/binfo?"):"".concat(this._url,"/info?")).concat(r)}},{key:"_closeConnection",value:function(e){m.l("".concat(this._n,"._closeConnection socketID:").concat(this._socketID)),this._socket&&(this._socket.close(e),this._socketID=-1,this._socket=null,this._readyState=Js)}},{key:"_resend",value:function(){var e=this;if(m.l("".concat(this._n,"._resend reConnectFlag:").concat(this._reConnectFlag),"promiseMap.size:".concat(this._promiseMap.size," simpleRequestMap.size:").concat(this._simpleRequestMap.size)),0<this._promiseMap.size&&this._promiseMap.forEach(function(_,d){var h=_.uplinkData,g=_.resolve,_=_.reject;d.indexOf(E.AV_POLLING)!==-1?e._promiseMap.delete(d):(e._promiseMap.set(d,{resolve:g,reject:_,timestamp:Date.now(),uplinkData:h}),e._execute(d,h))}),0<this._simpleRequestMap.size){var t,n=ye(this._simpleRequestMap);try{for(n.s();!(t=n.n()).done;){var s=te(t.value,2),r=s[0],a=s[1];this._execute(r,a)}}catch(l){n.e(l)}finally{n.f()}this._simpleRequestMap.clear()}}},{key:"send",value:function(e){var t=this,n=(e.head.seq=this._getSequence(),e.head.reqtime=Math.floor(Date.now()/1e3),e.head.cs=this._calcCheckSum(e.head.servcmd,e.body),e.keyMap,G(e,DI)),s=this._getRequestIDFromHead(e.head),r=JSON.stringify(n);return new Promise(function(a,l){t._promiseMap.set(s,{resolve:a,reject:l,timestamp:Date.now(),uplinkData:r,headSeq:e.head.seq}),m.d("".concat(t._n,".send uplinkData:").concat(JSON.stringify(n)," requestID:").concat(s," readyState:").concat(t._readyState)),t._readyState!==$s?t._reConnect():(t._execute(s,r),t._chM.get(26).addRequestCount())})}},{key:"simplySend",value:function(t){t.head.seq=this._getSequence(),t.head.reqtime=Math.floor(Date.now()/1e3),t.keyMap;var n=G(t,SI),t=this._getRequestIDFromHead(t.head),n=JSON.stringify(n);this._readyState!==$s?(this._simpleRequestMap.size<this.MAX_SIZE?this._simpleRequestMap.set(t,n):m.l("".concat(this._n,".simplySend. simpleRequestMap is full, drop request!")),this._reConnect()):this._execute(t,n)}},{key:"_execute",value:function(e,t){this._socket.send({data:t,fail:ee?this._onSendFail.bind(this):void 0,requestID:e})}},{key:"_onSendFail",value:function(e){m.l("".concat(this._n,"._onSendFail requestID:").concat(e)),this._chM.onSendFail()}},{key:"_getSequence",value:function(){var e;if(this._startSequence<2415919103)return e=this._startSequence,this._startSequence+=1,this._startSequence===2415919103&&(this._startSequence=wn()),e}},{key:"_getRequestIDFromHead",value:function(e){return e.servcmd+e.seq}},{key:"_getResKeyMap",value:function(e){return e=this._chM.getKeyMap(e),c(c({},ma.res),e.res)}},{key:"_reConnect",value:function(){this._readyState!==$s&&this._readyState!==Qu&&this.forcedReconnect()}},{key:"forcedReconnect",value:function(){var e="".concat(this._n,".forcedReconnect");m.l("".concat(e," count:").concat(this._reConnectCount," readyState:").concat(this._readyState)),this._reConnectFlag=!0,this._resetRandom(),this._reConnectCount<this.MAX_RECONNECT_COUNT?(this._reConnectCount+=1,this._closeConnection(4001),this._initConnection()):(this._reConnectCount=0,this._chM.get(15).isOnline()?(m.w("".concat(e," disconnected from wsserver but network is ok, continue...")),this._closeConnection(4001),this._initConnection()):this._chM.onReconnectFailed())}},{key:"getReconnectFlag",value:function(){return this._reConnectFlag}},{key:"_setNextPingTs",value:function(){this._nextPingTs=j?Date.now()+5e3:Date.now()+1e4}},{key:"getNextPingTs",value:function(){return this._nextPingTs}},{key:"isConnected",value:function(){return this._readyState===$s}},{key:"canIUseBinaryFrame",value:function(){return this._canIUseBinaryFrame}},{key:"getSocketID",value:function(){return this._socketID}},{key:"inflate",value:function(e){if(this._chM.canIUseInflate())return this._chM.get(37).inflate(e)}},{key:"setIsWorkerEnabled",value:function(e){m.l("".concat(this._n,".setIsWorkerEnabled flag:").concat(e)),this._isWorkerEnabled=e}},{key:"getIsWorkerEnabled",value:function(){return this._isWorkerEnabled&&Gn}},{key:"_getRandom",value:function(){return this._random===0&&(this._random=Math.random()),this._random}},{key:"_resetRandom",value:function(){this._random=0}},{key:"_calcCheckSum",value:function(e,t){if(e.indexOf(E.PING)!==-1||e.indexOf(E.LOGIN)!==-1||e.indexOf(E.LOGOUT)!==-1||e.indexOf(E.AV_POLLING)!==-1||e.indexOf(E.AV_NOAUTH_POLLING)!==-1)return 0;for(var n=va(JSON.stringify(t)),s=4294967295,r=0,a=n.length;r<a;r++){s^=n[r];for(var l=0;l<8;l++)(1&s)==1?s=s>>>1^3988292384:s>>>=1}return(4294967295^s)>>>0}},{key:"close",value:function(){m.l("".concat(this._n,".close")),this._closeConnection(4e3),this._promiseMap.clear(),this._startSequence=wn(),this._readyState=Js,this._simpleRequestMap.clear(),this._reConnectFlag=!1,this._reConnectCount=0,this._onOpenTs=0,this._url="",this._random=0,this._canIUseBinaryFrame=!0,this._isWorkerEnabled=!0}}]),sl),el=function(e,t,n){return new Promise(function(s,r){var a,l,d="application/x-www-form-urlencoded;charset=UTF-8";ee?le.request({url:t,data:n,method:e,timeout:3e3,header:{"content-type":d},success:function(h){h&&h.data&&h.data.NetCheckInfo&&m.l("".concat("getconninfo ok in"," miniapp. ret:"),h.data),s()},fail:function(){r(new yt({code:F.NETWORK_ERROR}))}}):(a=new XMLHttpRequest,l=setTimeout(function(){a.abort(),r(new yt({code:F.NETWORK_TIMEOUT}))},3e3),a.onreadystatechange=function(){a.readyState===4&&(l&&clearTimeout(l),a.status===200||a.status===304?(a.responseText&&-1<a.responseText.indexOf("NetCheckInfo")&&m.l("".concat("getconninfo ok in"," web. ret:"),JSON.parse(a.responseText)),s()):r(new yt({code:F.NETWORK_ERROR})))},a.open(e,t,!0),a.setRequestHeader("Content-type",d),n?a.send(n):a.send())})},RI=(T(Xr,St),Ff=z(Xr),y(Xr,[{key:"onCheckTimer",value:function(e){this._socketHandler&&(this.isLoggedIn()?(0<this._timerForNotLoggedIn&&(clearInterval(this._timerForNotLoggedIn),this._timerForNotLoggedIn=-1),this._socketHandler.onCheckTimer(e)):this._socketHandler.onCheckTimer(1),this._checkNextPing())}},{key:"onErrorCodeNotZero",value:function(e){this.get(20).onErrorCodeNotZero(e)}},{key:"onMessage",value:function(e){this.get(20).onMessage(e)}},{key:"send",value:function(e){return this._socketHandler?this._previousState!==I.NET_STATE_CONNECTED&&e.head.servcmd.includes(E.SSO_STAT)?(this.reConnect(),this.isPrivateNetWork()?Promise.resolve():this._sendLogViaHTTP(e)):this._socketHandler.send(e):Promise.reject()}},{key:"_sendLogViaHTTP",value:function(n){var t=P.HOST.CURRENT.STAT,t="".concat(t,"/v4/imopenstat/tim_web_report_v2?sdkappid=").concat(n.head.sdkappid,"&reqtime=").concat(Date.now()),n=JSON.stringify(n.body);return el("POST",t,n)}},{key:"simplySend",value:function(e){return this._socketHandler?this._socketHandler.simplySend(e):Promise.reject()}},{key:"onOpen",value:function(){this._ping()}},{key:"onClose",value:function(){this._socketHandler&&this._socketHandler.getReconnectFlag()&&this._emitNetStateChangeEvent(I.NET_STATE_DISCONNECTED),this.reConnect()}},{key:"onError",value:function(){ee&&!j&&this.warn("DomainNameInMP"),this._emitNetStateChangeEvent(I.NET_STATE_DISCONNECTED)}},{key:"getKeyMap",value:function(e){return this.get(20).getKeyMap(e)}},{key:"onRequestTimeout",value:function(){3e4<=Date.now()-this._lastDiagnoseTS&&this.diagnose()}},{key:"onSendFail",value:function(){this._emitNetStateChangeEvent(I.NET_STATE_DISCONNECTED)}},{key:"onReconnected",value:function(){m.l("".concat(this._n,".onReconnected cost:").concat(Kt(this._disconnectedTS,!0,!0))),this._m.restartTimer(),this.get(20).onReconnected(Kt(this._disconnectedTS,!1,!1)),this._disconnectedTS=0,this._emitNetStateChangeEvent(I.NET_STATE_CONNECTED)}},{key:"onReconnectFailed",value:function(){m.l("".concat(this._n,".onReconnectFailed")),this._emitNetStateChangeEvent(I.NET_STATE_DISCONNECTED)}},{key:"setIsWorkerEnabled",value:function(e){this._socketHandler&&this._socketHandler.setIsWorkerEnabled(!1)}},{key:"offline",value:function(){this._emitNetStateChangeEvent(I.NET_STATE_DISCONNECTED)}},{key:"reConnect",value:function(){var e=0<arguments.length&&arguments[0]!==void 0&&arguments[0],t=!1,n=(this._socketHandler&&(t=this._socketHandler.getReconnectFlag()),"forcedFlag:".concat(e," fatalErrorFlag:").concat(this._fatalErrorFlag," previousState:").concat(this._previousState," reconnectFlag:").concat(t));if(m.l("".concat(this._n,".reConnect ").concat(n)),!this._fatalErrorFlag&&this._socketHandler){if(e===!0)this._socketHandler.forcedReconnect();else{if(this._previousState===I.NET_STATE_CONNECTING&&t)return;this._socketHandler.forcedReconnect()}this._emitNetStateChangeEvent(I.NET_STATE_CONNECTING)}}},{key:"_emitNetStateChangeEvent",value:function(e){this._previousState!==e&&(m.l("".concat(this._n,"._emitNetStateChangeEvent from ").concat(this._previousState," to ").concat(e)),e===I.NET_STATE_DISCONNECTED&&this._disconnectedTS===0&&(this._disconnectedTS=Date.now(),this.diagnose()),this._previousState=e,this.emitOEvt($.NET_STATE_CHANGE,{state:e}))}},{key:"_ping",value:function(){var e,t=this;this._probing!==!0&&(this._probing=!0,e=this.get(20).getProtocolData({P:E.PING}),this.send(e).then(function(){t._probing=!1}).catch(function(n){t._probing=!1;var s=t.get(15).isOnline();if(m.w("".concat(t._n,"._ping failed. bOnline:").concat(s," error:"),n),n&&n.code===60002)return new K("error").setMessage("code:".concat(n.code," message:").concat(n.message)).end(),t._fatalErrorFlag=!0,void t._emitNetStateChangeEvent(I.NET_STATE_DISCONNECTED);s?t.reConnect():t._emitNetStateChangeEvent(I.NET_STATE_DISCONNECTED)}))}},{key:"_checkNextPing",value:function(){this._socketHandler&&this._socketHandler.isConnected()&&Date.now()>=this._socketHandler.getNextPingTs()&&this._ping()}},{key:"dealloc",value:function(){this._socketHandler&&(this._socketHandler.close(),this._socketHandler=null),-1<this._timerForNotLoggedIn&&clearInterval(this._timerForNotLoggedIn)}},{key:"onRestApiKickedOut",value:function(){this._socketHandler&&(this._socketHandler.close(),this.reConnect(!0))}},{key:"canIUseInflate",value:function(){return this._m.canIUseInflate()}},{key:"getSocketID",value:function(){if(this._socketHandler)return this._socketHandler.getSocketID()}},{key:"diagnose",value:function(){this.isPrivateNetWork()||(this._lastDiagnoseTS=Date.now(),this._diagnoseBySSO(),this._diagnoseByCDN())}},{key:"_diagnoseBySSO",value:function(){var e=this,t=this._socketHandler.getURL(),n=t.split("/")[2];n.startsWith("ws")&&(t=t.slice(t.indexOf("info?")+5),n="https://".concat(n,"/v3/netcheck/getconninfo?").concat(t,"&reqtime=").concat(Date.now()),el("GET",n).catch(function(s){m.w("".concat(e._n,"._diagnoseBySSO failed. error:"),s)}))}},{key:"_diagnoseByCDN",value:function(){var e=this,t=this._socketHandler.getURL(),t=t.slice(t.indexOf("info?")+5),t="https://boce-cdn.my-imcloud.com/v3/netcheck/getconninfo?".concat(t,"&reqtime=").concat(Date.now());el("GET",t).catch(function(n){m.w("".concat(e._n,"._diagnoseByCDN failed. error:"),n)})}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._previousState=I.NET_STATE_CONNECTED,this._probing=!1,this._fatalErrorFlag=!1,this._timerForNotLoggedIn=setInterval(this.onCheckTimer.bind(this),1e3),this._disconnectedTS=0,this._lastDiagnoseTS=0}}]),Xr),kI=["a2","tinyid"],AI=["a2","tinyid"],OI=(y(ol,[{key:"_fillMap",value:function(){this._map.clear();var e=this._sessionM.genCommonHead(),t=this._sessionM.genCosSpecifiedHead(),n=this._sessionM.genSSOReportHead();this._map.set(E.LOGIN,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_OPEN_STATUS,".").concat(E.LOGIN)}),body:{state:"Online",isWebUniapp:0,deviceBrand:0,customInfo:""},keyMap:{req:{deviceBrand:"InstType"},res:{InstId:"instanceID",HelloInterval:"helloInterval",RichMsgAuthKey:"authKey"}}}),this._map.set(E.LOGOUT,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_OPEN_STATUS,".").concat(E.LOGOUT)}),body:{type:0,isWebUniapp:0},keyMap:{req:{type:"wslogout_type"}}}),this._map.set(E.HELLO,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_OPEN_STATUS,".").concat(E.HELLO)}),body:{isWebUniapp:0},keyMap:{res:{NewInstInfo:"newInstanceInfo"}}}),this._map.set(E.KICK_OTHER,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.STAT_SERVICE,".").concat(E.KICK_OTHER)}),body:{}}),this._map.set(E.COS_SIGN,{head:c(c({},t),{},{servcmd:"".concat(P.NAME.IM_COS_SIGN,".").concat(E.COS_SIGN)}),body:{cmd:"open_im_cos_svc",subCmd:"get_cos_token",duration:300,version:2},keyMap:{req:{userSig:"usersig",subCmd:"sub_cmd",cmd:"cmd",duration:"duration",version:"version"},res:{expired_time:"expiredTime",bucket_name:"bucketName",session_token:"sessionToken",tmp_secret_id:"secretId",tmp_secret_key:"secretKey"}}}),this._map.set(E.COS_PRE_SIG,{head:c(c({},t),{},{servcmd:"".concat(P.NAME.CUSTOM_UPLOAD,".").concat(E.COS_PRE_SIG)}),body:{fileType:void 0,fileName:void 0,uploadMethod:0,duration:900},keyMap:{req:{userSig:"usersig",fileType:"file_type",fileName:"file_name",uploadMethod:"upload_method"},res:{expired_time:"expiredTime",request_id:"requestId",head_url:"headUrl",upload_url:"uploadUrl",download_url:"downloadUrl",ci_url:"ciUrl",snapshot_url:"requestSnapshotUrl"}}}),this._map.set(E.SIMPLE_COS_PRE_SIG,{head:c(c({},t),{},{servcmd:"".concat(P.NAME.CUSTOM_UPLOAD,".").concat(E.SIMPLE_COS_PRE_SIG)}),body:{uploadMethod:0,platform:2,SDKAppID:0,userID:"",conversationType:1,uploadConfig:[{fileID:1,fileType:1,fileName:""}]},keyMap:{req:{platform:"uint32_platform",SDKAppID:"uint32_sdkappid",userID:"str_user_id",uploadMethod:"uint32_upload_method",conversationType:"uint32_scene",uploadConfig:"rpt_upload_object",fileID:"uint32_file_id",fileType:"uint32_file_type",fileName:"str_file_name"},res:{str_final_ip:"uploadIP",rpt_pre_sig:"preSig",uint32_file_id:"fileID",uint32_exist_flag:"existFlag",str_download_url:"downloadUrl",str_upload_url:"uploadUrl",str_snapshot_url:"requestSnapshotUrl",str_file_key:"fileKey"}}}),this._map.set(E.GET_IMAGE_INFO,{head:c(c({},t),{},{servcmd:"".concat(P.NAME.CUSTOM_UPLOAD,".").concat(E.GET_IMAGE_INFO)}),body:{imageUrl:""},keyMap:{req:{imageUrl:"str_image_url"},res:{rpt_msg_image_info:"imageInfoArray",uint32_image_type:"type",str_url:"url",uint32_width:"width",uint32_height:"height",str_image_format:"imageFormat"}}}),this._map.set(E.GET_IP,{head:c(c({},t),{},{servcmd:"".concat(P.NAME.CUSTOM_UPLOAD,".").concat(E.GET_IP)}),body:{domainName:""},keyMap:{req:{domainName:"str_domain"},res:{str_final_ip:"ip"}}}),this._map.set(E.VIDEO_COVER,{head:c(c({},t),{},{servcmd:"".concat(P.NAME.CUSTOM_UPLOAD,".").concat(E.VIDEO_COVER)}),body:{version:1,platform:void 0,coverName:void 0,requestSnapshotUrl:void 0},keyMap:{req:{version:"version",platform:"platform",coverName:"cover_name",requestSnapshotUrl:"snapshot_url"},res:{error_code:"errorCode",error_msg:"errorInfo",download_url:"snapshotUrl"}}}),this._map.set(E.FETCH_COMMERCIAL_CONFIG,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_CONFIG_MANAGER,".").concat(E.FETCH_COMMERCIAL_CONFIG)}),body:{SDKAppID:0},keyMap:{req:{SDKAppID:"uint32_sdkappid"},res:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_purchase_bits:"purchaseBits",uint32_expired_time:"expiredTime"}}}),this._map.set(E.PUSHED_COMMERCIAL_CONFIG,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_CONFIG_MANAGER,".").concat(E.PUSHED_COMMERCIAL_CONFIG)}),body:{},keyMap:{res:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_purchase_bits:"purchaseBits",uint32_expired_time:"expiredTime"}}}),this._map.set(E.FETCH_CLOUD_CTRL_CONFIG,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_CONFIG_MANAGER,".").concat(E.FETCH_CLOUD_CTRL_CONFIG)}),body:{SDKAppID:0,version:0},keyMap:{req:{SDKAppID:"uint32_sdkappid",version:"uint64_version"},res:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_json_config:"cloudControlConfig",uint32_expired_time:"expiredTime",uint32_sdkappid:"SDKAppID",uint64_version:"version"}}}),this._map.set(E.PUSHED_CLOUD_CTRL_CONFIG,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_CONFIG_MANAGER,".").concat(E.PUSHED_CLOUD_CTRL_CONFIG)}),body:{},keyMap:{res:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_json_config:"cloudControlConfig",uint32_expired_time:"expiredTime",uint32_sdkappid:"SDKAppID",uint64_version:"version"}}}),this._map.set(E.OVERLOAD_NOTIFY,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OVERLOAD_PUSH,".").concat(E.OVERLOAD_NOTIFY)}),body:{},keyMap:{res:{OverLoadServCmd:"overloadCommand",DelaySecs:"waitingTime"}}}),this._map.set(E.SYNC_UNREAD_MSG,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM,".").concat(E.SYNC_UNREAD_MSG)}),body:{cookie:"",syncFlag:0,needAbstract:1,isOnlineSync:0,needSignaling:1,needCachedMsg:1},keyMap:{req:{fromAccount:"From_Account",toAccount:"To_Account",from:"From_Account",to:"To_Account",time:"MsgTimeStamp",sequence:"MsgSeq",random:"MsgRandom",elements:"MsgBody"},res:{MsgList:"messageList",SyncFlag:"syncFlag",To_Account:"to",From_Account:"from",ClientSeq:"clientSequence",MsgSeq:"sequence",NoticeSeq:"noticeSequence",NotifySeq:"notifySequence",MsgRandom:"random",MsgTimeStamp:"time",MsgContent:"content",ToGroupId:"to",MsgKey:"messageKey",GroupTips:"groupTips",MsgBody:"elements",MsgType:"type",C2CRemainingUnreadCount:"C2CRemainingUnreadList",C2CPairUnreadCount:"C2CPairUnreadList"}}}),this._map.set(E.GET_PROFANITY_LIST,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_MSG_AUDIT_MGR,".").concat(E.GET_PROFANITY_LIST)}),body:{version:0,deviceID:"",startIndex:void 0},keyMap:{req:{version:"uint64_version",deviceID:"str_device_id",startIndex:"uint64_start_index"},res:{msg_cmd_error_code:"errorInfo",str_err_msg:"errorMessage",uint32_code:"errorCode",msg_scene_ctl_config:"filterConfig",uint64_c2c_custom_msg_flag:"c2c_custom_message",uint64_c2c_text_msg_flag:"c2c_text_message",uint64_group_custom_msg_flag:"group_custom_message",uint64_group_text_msg_flag:"group_text_message",uint64_group_info_flag:"group_profile",uint64_group_member_info_flag:"group_member_profile",uint64_relation_chain_flag:"sns",uint64_user_info_flag:"user_profile",rpt_msg_dirty_word:"lexicon",str_dirty_word:"profanity",str_replaced_content:"replacement",uint64_filter_type:"filterType",uint64_id:"id",uint64_word_type:"profanityType",uint64_complete_flag:"completeFlag",uint64_next_start_index:"nextStartIndex",uint64_version:"version",uint64_expired_time:"expiredTime"}}}),this._map.set(E.SEND_C2C_MSG,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM,".").concat(E.SEND_C2C_MSG)}),body:{fromAccount:"",toAccount:"",msgSeq:0,msgRandom:0,msgBody:[],cloudCustomData:void 0,nick:"",avatar:"",msgLifeTime:void 0,offlinePushInfo:{pushFlag:0,title:"",desc:"",ext:"",apnsInfo:{sound:"",badgeMode:0,isVoipPush:void 0,image:""},androidInfo:{sound:"",XiaoMiChannelID:"",OPPOChannelID:"",GoogleChannelID:"",VIVOClassification:1,VIVOCategory:"",HuaWeiCategory:"",OPPOCategory:"",HuaWeiImage:"",HonorImage:"",GoogleImage:"",HonorImportance:""}},messageControlInfo:void 0,clientTime:void 0,needReadReceipt:0,isSupportExtension:0,isRelayMessage:0,cmConfigID:void 0,forbidCallbackControl:void 0},keyMap:{req:{fromAccount:"From_Account",toAccount:"To_Account",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom",msgBody:"MsgBody",count:"MaxCnt",lastMessageTime:"LastMsgTime",messageKey:"MsgKey",peerAccount:"Peer_Account",data:"Data",description:"Desc",extension:"Ext",type:"MsgType",content:"MsgContent",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",nick:"From_AccountNick",avatar:"From_AccountHeadurl",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",elements:"MsgBody",clientSequence:"ClientSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody",needReadReceipt:"IsNeedReadReceipt",GoogleChannelID:"GoogleChannelID",XiaoMiChannelID:"XiaoMiChannelID",OPPOChannelID:"OPPOChannelID",OPPOCategory:"OPPOCategory",VIVOClassification:"VIVOClassification",VIVOCategory:"VIVOCategory",HonorImportance:"HonorImportance"}}}),this._map.set(E.SEND_GRP_MSG,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.SEND_GRP_MSG)}),body:{fromAccount:"",groupID:"",random:0,clientSequence:0,priority:"",msgBody:[],cloudCustomData:void 0,onlineOnlyFlag:0,offlinePushInfo:{pushFlag:0,title:"",desc:"",ext:"",apnsInfo:{sound:"",badgeMode:0,isVoipPush:void 0,image:""},androidInfo:{sound:"",XiaoMiChannelID:"",OPPOChannelID:"",GoogleChannelID:"",VIVOClassification:1,VIVOCategory:"",HuaWeiCategory:"",OPPOCategory:"",HuaWeiImage:"",HonorImage:"",GoogleImage:"",HonorImportance:""}},groupAtInfo:[],messageControlInfo:void 0,clientTime:void 0,needReadReceipt:0,topicID:void 0,receiverList:void 0,isSupportExtension:0,isRelayMessage:0,cmConfigID:void 0,forbidCallbackControl:void 0},keyMap:{req:{to:"GroupId",extension:"Ext",data:"Data",description:"Desc",random:"Random",sequence:"ReqMsgSeq",count:"ReqMsgNumber",type:"MsgType",priority:"MsgPriority",content:"MsgContent",elements:"MsgBody",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",clientSequence:"ClientSeq",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody",needReadReceipt:"NeedReadReceipt",receiverList:"To_Account",GoogleChannelID:"GoogleChannelID",XiaoMiChannelID:"XiaoMiChannelID",OPPOChannelID:"OPPOChannelID",OPPOCategory:"OPPOCategory",VIVOClassification:"VIVOClassification",VIVOCategory:"VIVOCategory",HonorImportance:"HonorImportance"},res:{MsgTime:"time",MsgSeq:"sequence"}}}),this._map.set(E.REVOKE_C2C_MSG,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM,".").concat(E.REVOKE_C2C_MSG)}),body:{msgInfo:{fromAccount:"",toAccount:"",msgTimeStamp:0,msgSeq:0,msgRandom:0}},keyMap:{req:{msgInfo:"MsgInfo",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom"}}}),this._map.set(E.REVOKE_GRP_MSG,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.REVOKE_GRP_MSG)}),body:{groupID:"",msgSeqList:void 0,topicID:""},keyMap:{req:{msgSeqList:"MsgSeqList",msgSeq:"MsgSeq"}}}),this._map.set(E.GET_C2C_ROAMING_MSG,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM,".").concat(E.GET_C2C_ROAMING_MSG)}),body:{peerAccount:"",count:15,lastMessageTime:0,messageKey:"",withRecalledMessage:1,direction:0},keyMap:{req:{messageKey:"MsgKey",peerAccount:"Peer_Account",count:"MaxCnt",lastMessageTime:"LastMsgTime",withRecalledMessage:"WithRecalledMsg",direction:"GetDirection"},res:{LastMsgTime:"lastMessageTime",IsNeedReadReceipt:"needReadReceipt",IsPeerRead:"readReceiptSentByPeer"}}}),this._map.set(E.MODIFY_C2C_MSG,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM,".").concat(E.MODIFY_C2C_MSG)}),body:{from:"",to:"",sequence:0,random:0,time:0,version:0,elements:void 0,cloudCustomData:void 0},keyMap:{req:{sequence:"MsgSeq",random:"MsgRandom",time:"MsgTime",version:"MsgVersion",type:"MsgType",content:"MsgContent"}}}),this._map.set(E.GET_GRP_ROAMING_MSG,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.GET_GRP_ROAMING_MSG)}),body:{withRecalledMsg:1,groupID:"",count:15,sequence:"",topicID:void 0},keyMap:{req:{sequence:"ReqMsgSeq",count:"ReqMsgNumber",withRecalledMessage:"WithRecalledMsg"},res:{Random:"random",MsgTime:"time",MsgSeq:"sequence",ReqMsgSeq:"sequence",RspMsgList:"messageList",IsSystemMsg:"isSystemMessage",ToGroupId:"to",EnumFrom_AccountType:"fromAccountType",EnumTo_AccountType:"toAccountType",GroupCode:"groupCode",MsgPriority:"priority",MsgBody:"elements",MsgType:"type",MsgContent:"content",IsFinished:"complete",Download_Flag:"downloadFlag",ClientSeq:"clientSequence",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID",ToTopicId:"topicID",InvisibleMsgSeq:"invisibleSequenceList",NextReqMsgSeq:"nextSequence"}}}),this._map.set(E.SET_C2C_MSG_READ,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM,".").concat(E.SET_C2C_MSG_READ)}),body:{C2CMsgReaded:void 0},keyMap:{req:{lastMessageTime:"LastedMsgTime"}}}),this._map.set(E.SET_C2C_PEER_MUTE_NOTIFICATIONS,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM,".").concat(E.SET_C2C_PEER_MUTE_NOTIFICATIONS)}),body:{userIDList:void 0,muteFlag:0},keyMap:{req:{userIDList:"Peer_Account",muteFlag:"Mute_Notifications"}}}),this._map.set(E.GET_C2C_PEER_MUTE_NOTIFICATIONS,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM,".").concat(E.GET_C2C_PEER_MUTE_NOTIFICATIONS)}),body:{toAccount:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Peer_Account"},res:{MuteNotificationsList:"muteFlagList"}}}),this._map.set(E.SET_GRP_MSG_READ,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.SET_GRP_MSG_READ)}),body:{groupID:void 0,messageReadSeq:void 0,topicID:void 0},keyMap:{req:{messageReadSeq:"MsgReadedSeq"}}}),this._map.set(E.SET_ALL_MSG_READ,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM,".").concat(E.SET_ALL_MSG_READ)}),body:{readAllC2CMessage:0,groupMessageReadInfoList:[]},keyMap:{req:{readAllC2CMessage:"C2CReadAllMsg",groupMessageReadInfoList:"GroupReadInfo",messageSequence:"MsgSeq"},res:{C2CReadAllMsg:"readAllC2CMessage",GroupReadInfoArray:"groupMessageReadInfoList"}}}),this._map.set(E.DEL_C2C_MSG,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM,".").concat(E.DEL_C2C_MSG)}),body:{fromAccount:"",to:"",keyList:void 0},keyMap:{req:{keyList:"MsgKeyList"}}}),this._map.set(E.DEL_GRP_MSG,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.DEL_GRP_MSG)}),body:{groupID:"",deleter:"",keyList:void 0,topicID:void 0},keyMap:{req:{deleter:"Deleter_Account",keyList:"Seqs"}}}),this._map.set(E.TRANSLATE_TEXT,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_OPEN_TRANSLATE,".").concat(E.TRANSLATE_TEXT)}),body:{sourceTextList:void 0,SDKAppID:0,from:0,source:"",target:""},keyMap:{req:{sourceTextList:"SourceText",SDKAppID:"SdkAppId",from:"FromAccount"},res:{TargetText:"translatedTextList",RequestId:"requestID",CmdErrorCode:"error",ErrorCode:"code",ErrorInfo:"message"}}}),this._map.set(E.VOICE_TO_TEXT,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_OPEN_SPEECH,".").concat(E.VOICE_TO_TEXT)}),body:{url:"",SDKAppID:0,format:"",sourceType:0,language:""},keyMap:{req:{url:"BytesUrl",SDKAppID:"Uint32Sdkappid",format:"BytesVoiceFormat",sourceType:"Uint64SourceType",language:"BytesEngServiceType"},res:{BytesRequestid:"requestID",BytesResult:"result",CmdErrorCode:"error",ErrorCode:"code",ErrorInfo:"message"}}}),this._map.set(E.MODIFY_GRP_MSG,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM,".").concat(E.MODIFY_GRP_MSG)}),body:{groupID:"",topicID:void 0,sequence:0,version:0,elements:void 0,cloudCustomData:void 0},keyMap:{req:{sequence:"MsgSeq",version:"MsgVersion",type:"MsgType",content:"MsgContent"}}}),this._map.set(E.GET_READ_RECEIPT,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.GET_READ_RECEIPT)}),body:{groupID:"",sequenceList:void 0},keyMap:{req:{sequence:"MsgSeq"}}}),this._map.set(E.SEND_C2C_READ_RECEIPT,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM,".").concat(E.SEND_C2C_READ_RECEIPT)}),body:{peerAccount:"",messageInfoList:void 0},keyMap:{req:{peerAccount:"Peer_Account",messageInfoList:"C2CMsgInfo",fromAccount:"From_Account",toAccount:"To_Account",sequence:"MsgSeq",random:"MsgRandom",time:"MsgTime",clientTime:"MsgClientTime"}}}),this._map.set(E.SEND_READ_RECEIPT,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.SEND_READ_RECEIPT)}),body:{groupID:"",sequenceList:void 0},keyMap:{req:{sequenceList:"MsgSeqList",sequence:"MsgSeq"}}}),this._map.set(E.GET_READ_RECEIPT_DETAIL,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.GET_READ_RECEIPT_DETAIL)}),body:{groupID:"",sequence:void 0,flag:0,cursor:0,count:0},keyMap:{req:{sequence:"MsgSeq",count:"Num"},res:{ReadList:"readUserIDList",Read_Account:"userID",UnreadList:"unreadUserIDList",Unread_Account:"userID",IsFinish:"isCompleted"}}}),this._map.set(E.MODIFY_C2C_MSG_EXT,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM_MSG_EXT,".").concat(E.MODIFY_C2C_MSG_EXT)}),body:{from:void 0,to:void 0,messageKey:void 0,operateType:void 0,extensionList:void 0}}),this._map.set(E.GET_C2C_MSG_EXT,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM_MSG_EXT,".").concat(E.GET_C2C_MSG_EXT)}),body:{from:void 0,to:void 0,messageKey:void 0,startSequence:void 0}}),this._map.set(E.MODIFY_GRP_MSG_EXT,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM_MSG_EXT,".").concat(E.MODIFY_GRP_MSG_EXT)}),body:{groupID:void 0,topicID:void 0,messageSequence:void 0,operateType:void 0,extensionList:void 0}}),this._map.set(E.GET_GRP_MSG_EXT,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM_MSG_EXT,".").concat(E.GET_GRP_MSG_EXT)}),body:{groupID:void 0,topicID:void 0,messageSequence:void 0,startSequence:void 0}}),this._map.set(E.ADD_C2C_MSG_REACTION,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM_MSG_EXT,".").concat(E.ADD_C2C_MSG_REACTION)}),body:{from:void 0,to:void 0,reactionID:void 0,messageKey:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Add_Account"}}}),this._map.set(E.RM_C2C_MSG_REACTION,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM_MSG_EXT,".").concat(E.RM_C2C_MSG_REACTION)}),body:{from:void 0,to:void 0,reactionID:void 0,messageKey:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Del_Account"}}}),this._map.set(E.GET_C2C_MSG_REACTIONS,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM_MSG_EXT,".").concat(E.GET_C2C_MSG_REACTIONS)}),body:{from:void 0,to:void 0,messageKeyList:void 0,count:void 0}}),this._map.set(E.GET_C2C_MSG_REACTION_USER_LIST,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM_MSG_EXT,".").concat(E.GET_C2C_MSG_REACTION_USER_LIST)}),body:{from:void 0,to:void 0,reactionID:void 0,messageKey:void 0,count:void 0}}),this._map.set(E.ADD_GRP_MSG_REACTION,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM_MSG_EXT,".").concat(E.ADD_GRP_MSG_REACTION)}),body:{groupID:void 0,topicID:void 0,reactionID:void 0,messageSequence:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Add_Account"}}}),this._map.set(E.RM_GRP_MSG_REACTION,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM_MSG_EXT,".").concat(E.RM_GRP_MSG_REACTION)}),body:{groupID:void 0,topicID:void 0,reactionID:void 0,messageSequence:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Del_Account"}}}),this._map.set(E.GET_GRP_MSG_REACTIONS,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM_MSG_EXT,".").concat(E.GET_GRP_MSG_REACTIONS)}),body:{groupID:void 0,topicID:void 0,messageSequenceList:void 0,count:void 0},keyMap:{res:{MsgSeq:"messageSequence"}}}),this._map.set(E.GET_GRP_MSG_REACTION_USER_LIST,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM_MSG_EXT,".").concat(E.GET_GRP_MSG_REACTION_USER_LIST)}),body:{groupID:void 0,topicID:void 0,reactionID:void 0,messageSequence:void 0,nextSeq:void 0,count:void 0}}),this._map.set(E.GET_C2C_PEER_READ_TIME,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM,".").concat(E.GET_C2C_PEER_READ_TIME)}),body:{userIDList:void 0},keyMap:{req:{userIDList:"To_Account"},res:{ReadTime:"peerReadTimeList"}}}),this._map.set(E.PAGING_GET_CONV_LIST,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.RECENT_CONTACT,".").concat(E.PAGING_GET_CONV_LIST)}),body:{fromAccount:void 0,timeStamp:void 0,startIndex:void 0,pinnedTimeStamp:void 0,pinnedStartIndex:void 0,orderType:void 0,messageAssistFlag:15,assistFlag:31},keyMap:{req:{messageAssistFlag:"MsgAssistFlags",assistFlag:"AssistFlags",pinnedTimeStamp:"TopTimeStamp",pinnedStartIndex:"TopStartIndex"},res:{SessionItem:"conversations",ToAccount:"groupID",To_Account:"userID",UnreadMsgCount:"unreadCount",MsgGroupReadedSeq:"messageReadSeq",C2cPeerReadTime:"c2cPeerReadTime",LastMsgFlags:"lastMessageFlag",TopFlags:"isPinned",TopTimeStamp:"pinnedTimeStamp",TopStartIndex:"pinnedStartIndex",GroupId:"convGroupID",C2cRemark:"friendRemark",MsgRecvOption:"messageRemindType",GroupIgnoredUnreadSeqCount:"noUnreadCount",GroupNextMsgSeq:"nextMessageSeq"}}}),this._map.set(E.DEL_CONV,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.RECENT_CONTACT,".").concat(E.DEL_CONV)}),body:{fromAccount:"",conversationList:void 0,clearHistoryMessage:void 0},keyMap:{req:{toGroupID:"ToGroupid",clearHistoryMessage:"ClearRamble",conversationList:"ContactItem"},res:{ResultItem:"resultList",ToGroupid:"groupID",ResultCode:"code",ResultInfo:"info"}}}),this._map.set(E.CLEAR_HISTORY_MSG,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.RECENT_CONTACT,".").concat(E.CLEAR_HISTORY_MSG)}),body:{fromAccount:"",toAccount:void 0,type:1,toGroupID:void 0},keyMap:{req:{toGroupID:"ToGroupid"}}}),this._map.set(E.PIN_CONV,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.RECENT_CONTACT,".").concat(E.PIN_CONV)}),body:{fromAccount:"",operationType:1,itemList:void 0},keyMap:{req:{itemList:"RecentContactItem"}}}),this._map.set(E.DEL_GROUP_AT_TIPS,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM,".").concat(E.DEL_GROUP_AT_TIPS)}),body:{messageListToDelete:void 0},keyMap:{req:{messageListToDelete:"DelMsgList",messageSeq:"MsgSeq",messageRandom:"MsgRandom"}}}),this._map.set(E.SET_CONV_CUSTOM_DATA,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.RECENT_CONTACT,".").concat(E.MARK_CONV)}),body:{fromAccount:"",itemList:void 0},keyMap:{req:{itemList:"MarkItem",operationType:"OptType",groupID:"ToGroupId"},res:{ToGroupId:"groupID",OptType:"operationType"}}}),this._map.set(E.MARK_CONV,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.RECENT_CONTACT,".").concat(E.MARK_CONV)}),body:{fromAccount:"",itemList:void 0},keyMap:{req:{itemList:"MarkItem",operationType:"OptType",groupID:"ToGroupId"},res:{ToGroupId:"groupID",OptType:"operationType"}}}),this._map.set(E.CREATE_CONV_GRP,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.RECENT_CONTACT,".").concat(E.CREATE_CONV_GRP)}),body:{fromAccount:"",itemList:void 0},keyMap:{req:{itemList:"GroupContactItem",groupID:"ToGroupId"},res:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType"}}}),this._map.set(E.DEL_CONV_GRP,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.RECENT_CONTACT,".").concat(E.DEL_CONV_GRP)}),body:{fromAccount:"",groupName:void 0},keyMap:{res:{GroupId:"convGroupID"}}}),this._map.set(E.RENAME_CONV_GRP,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.RECENT_CONTACT,".").concat(E.RENAME_CONV_GRP)}),body:{fromAccount:"",updateType:void 0,updateGroup:void 0},keyMap:{req:{oldName:"OldGroupName",newName:"NewGroupName",groupID:"ToGroupId",operationType:"ContactOptType",groupName:"OldGroupName",updateItem:"ContactUpdateItem"},res:{ContactOptType:"operationType",ToGroupId:"groupID",GroupId:"convGroupID"}}}),this._map.set(E.ADD_CONV_TO_GRP,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.RECENT_CONTACT,".").concat(E.RENAME_CONV_GRP)}),body:{fromAccount:"",updateType:void 0,updateGroup:{groupName:void 0,updateGroupType:void 0,updateItem:void 0}}}),this._map.set(E.DEL_CONV_FROM_GRP,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.RECENT_CONTACT,".").concat(E.RENAME_CONV_GRP)}),body:{fromAccount:"",updateType:void 0,updateGroup:void 0}}),this._map.set(E.GET_CONV_GRP_LIST,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.RECENT_CONTACT,".").concat(E.GET_CONV_GRP_LIST)}),body:{fromAccount:"",startIndex:void 0},keyMap:{res:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType",CustomMark:"customData",ContactGroupId:"convGroupIDList"}}}),this._map.set(E.SEARCH_CONV_GRP_MARK,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.RECENT_CONTACT,".").concat(E.SEARCH_CONV_GRP_MARK)}),body:{fromAccount:"",contactItem:void 0},keyMap:{req:{groupID:"ToGroupId"},res:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType",CustomMark:"customData",ContactGroupId:"convGroupIDList",ContactResultItem:"contactItem"}}}),this._map.set(E.GET_USER_PROFILE,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.PROFILE,".").concat(E.GET_USER_PROFILE)}),body:{fromAccount:"",userItem:[]},keyMap:{req:{toAccount:"To_Account",standardSequence:"StandardSequence",customSequence:"CustomSequence"}}}),this._map.set(E.UPDATE_MY_PROFILE,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.PROFILE,".").concat(E.UPDATE_MY_PROFILE)}),body:{fromAccount:"",profileItem:[{tag:Ve.NICK,value:""},{tag:Ve.GENDER,value:""},{tag:Ve.ALLOWTYPE,value:""},{tag:Ve.AVATAR,value:""}]},keyMap:{req:{toAccount:"To_Account",standardSequence:"StandardSequence",customSequence:"CustomSequence"}}}),this._map.set(E.GET_BL,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FD,".").concat(E.GET_BL)}),body:{fromAccount:"",startIndex:0,maxLimited:30}}),this._map.set(E.ADD_TO_BL,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FD,".").concat(E.ADD_TO_BL)}),body:{fromAccount:"",toAccount:[]}}),this._map.set(E.RM_FROM_BL,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FD,".").concat(E.RM_FROM_BL)}),body:{fromAccount:"",toAccount:[]}}),this._map.set(E.SET_SELF_STATUS,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_OPEN_STATUS,".").concat(E.SET_SELF_STATUS)}),body:{customStatus:""}}),this._map.set(E.GET_USER_STATUS,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_OPEN_STATUS,".").concat(E.GET_USER_STATUS)}),body:{userIDList:void 0},keyMap:{res:{UserStatusList:"successUserList",ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID",Status:"statusType"}}}),this._map.set(E.SUB_USER_STATUS,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_OPEN_STATUS,".").concat(E.SUB_USER_STATUS)}),body:{userIDList:void 0},keyMap:{res:{ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID"}}}),this._map.set(E.UNSUB_USER_STATUS,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_OPEN_STATUS,".").concat(E.UNSUB_USER_STATUS)}),body:{userIDList:void 0,unsubscribeAll:void 0},keyMap:{res:{ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID"}}}),this._map.set(E.GET_FD_LIST,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FD,".").concat(E.GET_FD_LIST)}),body:{fromAccount:"",startIndex:0,standardSequence:0,customSequence:0},keyMap:{res:{FriendNum:"friendCount",UserDataItem:"resultList",ValueItem:"tagValueList"}}}),this._map.set(E.ADD_FD,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FD,".").concat(E.ADD_FD)}),body:{fromAccount:"",addFriendItem:[],type:""},keyMap:{req:{source:"AddSource",wording:"AddWording",type:"AddType"},res:{ResultItem:"resultList"}}}),this._map.set(E.UPDATE_FD,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FD,".").concat(E.UPDATE_FD)}),body:{fromAccount:"",updateItem:void 0},keyMap:{req:{snsItem:"SnsItem"},res:{ResultItem:"resultList"}}}),this._map.set(E.DEL_FD,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FD,".").concat(E.DEL_FD)}),body:{fromAccount:"",userIDList:[],type:""},keyMap:{req:{type:"DeleteType"},res:{ResultItem:"resultList"}}}),this._map.set(E.GET_FD_PROFILE,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FD,".").concat(E.GET_FD_PROFILE)}),body:{fromAccount:"",userIDList:void 0},keyMap:{res:{InfoItem:"resultList",SnsProfileItem:"tagValueList"}}}),this._map.set(E.CHECK_FD,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FD,".").concat(E.CHECK_FD)}),body:{fromAccount:"",userIDList:[],type:""},keyMap:{req:{type:"CheckType"},res:{InfoItem:"resultList"}}}),this._map.set(E.GET_FD_APPLICATION_LIST,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FD,".").concat(E.GET_FD_APPLICATION_LIST)}),body:{fromAccount:"",applicationType:"",startTime:0,maxLimited:0,lastSequence:0},keyMap:{res:{PendencyItem:"resultList",AddSource:"source",AddTime:"time",AddWording:"wording",Image:"avatar",UnreadPendencyCount:"unreadCount",To_Account:"userID",PendencyType:"type"}}}),this._map.set(E.RESPOND_FD_APPLICATION,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FD,".").concat(E.RESPOND_FD_APPLICATION)}),body:{fromAccount:"",responseFriendItem:[]},keyMap:{req:{tag:"TagName",action:"ResponseAction"},res:{ResultItem:"resultList"}}}),this._map.set(E.DEL_FD_APPLICATION,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FD,".").concat(E.DEL_FD_APPLICATION)}),body:{fromAccount:"",type:"",userIDList:void 0},keyMap:{req:{type:"PendencyType",userIDList:"To_Account"},res:{ResultItem:"resultList"}}}),this._map.set(E.REPORT_FD_APPLICATION,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FD,".").concat(E.REPORT_FD_APPLICATION)}),body:{fromAccount:"",latestTimeStamp:""},keyMap:{req:{latestTimeStamp:"LatestPendencyTimeStamp"}}}),this._map.set(E.CREATE_FD_GRP,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FD,".").concat(E.CREATE_FD_GRP)}),body:{fromAccount:"",groupName:void 0,userIDList:void 0},keyMap:{req:{groupName:"GroupName",userIDList:"To_Account"},res:{ResultItem:"resultList"}}}),this._map.set(E.DEL_FD_GRP,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FD,".").concat(E.DEL_FD_GRP)}),body:{fromAccount:"",nameList:void 0},keyMap:{req:{nameList:"GroupName"}}}),this._map.set(E.GET_FD_GRP_LIST,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FD,".").concat(E.GET_FD_GRP_LIST)}),body:{fromAccount:"",lastSequence:0,needFriend:"Need_Friend_Type_Yes"},keyMap:{res:{ResultItem:"resultList",GroupName:"name",FriendNumber:"friendCount",To_Account:"userIDList"}}}),this._map.set(E.UPDATE_FD_GRP,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FD,".").concat(E.UPDATE_FD_GRP)}),body:{fromAccount:"",oldName:"",newName:void 0,updateGroupItem:void 0},keyMap:{req:{oldName:"GroupOldName",newName:"GroupNewName"},res:{UpdateType:"type",ResultItem:"resultList"}}}),this._map.set(E.GET_GRP_LIST,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.GET_GRP_LIST)}),body:{memberAccount:"",limit:void 0,offset:void 0,groupType:void 0,responseFilter:{groupBaseInfoFilter:void 0,selfInfoFilter:void 0},isSupportTopic:0,needAppDefineData:1},keyMap:{req:{memberAccount:"Member_Account"},res:{GroupIdList:"groups",MsgSeq:"readedSequence",LastRecallTime:"_lastRevokedTime",AppDefinedData:"groupCustomField"}}}),this._map.set(E.GET_GRP_PROFILE,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.GET_GRP_PROFILE)}),body:{groupIDList:void 0,responseFilter:{groupBaseInfoFilter:void 0,groupCustomFieldFilter:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0}},keyMap:{req:{groupIDList:"GroupIdList",groupCustomField:"AppDefinedData",memberCustomField:"AppMemberDefinedData",groupCustomFieldFilter:"AppDefinedDataFilter_Group",memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},res:{GroupIdList:"groups",AppDefinedData:"groupCustomField",AppMemberDefinedData:"memberCustomField",AppDefinedDataFilter_Group:"groupCustomFieldFilter",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",InfoSeq:"infoSequence",MemberList:"members",GroupInfo:"groups",ShutUpUntil:"muteUntil",ShutUpAllMember:"muteAllMembers"}}}),this._map.set(E.CREATE_GRP,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.CREATE_GRP)}),body:{type:void 0,name:void 0,groupID:void 0,ownerID:void 0,introduction:void 0,notification:void 0,maxMemberNum:void 0,joinOption:void 0,memberList:void 0,groupCustomField:void 0,memberCustomField:void 0,webPushFlag:1,avatar:"",isSupportTopic:void 0,inviteOption:void 0},keyMap:{req:{ownerID:"Owner_Account",userID:"Member_Account",avatar:"FaceUrl",maxMemberNum:"MaxMemberCount",joinOption:"ApplyJoinOption",groupCustomField:"AppDefinedData",memberCustomField:"AppMemberDefinedData",inviteOption:"InviteJoinOption"},res:{HugeGroupFlag:"avChatRoomFlag",OverJoinedGroupLimit_Account:"overLimitUserIDList"}}}),this._map.set(E.DISMISS_GRP,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.DISMISS_GRP)}),body:{groupID:void 0}}),this._map.set(E.UPDATE_GRP_PROFILE,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.UPDATE_GRP_PROFILE)}),body:{groupID:void 0,name:void 0,introduction:void 0,notification:void 0,avatar:void 0,joinOption:void 0,groupCustomField:void 0,muteAllMembers:void 0,inviteOption:void 0},keyMap:{req:{groupCustomField:"AppDefinedData",muteAllMembers:"ShutUpAllMember",joinOption:"ApplyJoinOption",avatar:"FaceUrl",inviteOption:"InviteJoinOption"},res:{AppDefinedData:"groupCustomField",ShutUpAllMember:"muteAllMembers"}}}),this._map.set(E.APPLY_JOIN_GRP,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.APPLY_JOIN_GRP)}),body:{groupID:void 0,applyMessage:void 0,userDefinedField:void 0,webPushFlag:1,historyMessageFlag:void 0},keyMap:{req:{applyMessage:"ApplyMsg",historyMessageFlag:"HugeGroupHistoryMsgFlag"},res:{HugeGroupFlag:"avChatRoomFlag",AVChatRoomKey:"avChatRoomKey",RspMsgList:"messageList",ToGroupId:"to"}}}),this._map.set(E.APPLY_JOIN_GRP_NOAUTH,(e.a2,e.tinyid,{head:c(c({},G(e,kI)),{},{servcmd:"".concat(P.NAME.BIG_GRP_NO_AUTH,".").concat(E.APPLY_JOIN_GRP)}),body:{groupID:void 0,applyMessage:void 0,userDefinedField:void 0,webPushFlag:1},keyMap:{req:{applyMessage:"ApplyMsg"},res:{HugeGroupFlag:"avChatRoomFlag"}}})),this._map.set(E.QUIT_GRP,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.QUIT_GRP)}),body:{groupID:void 0}}),this._map.set(E.SEARCH_GRP,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.SEARCH_GRP)}),body:{groupIDList:void 0,responseFilter:{groupBasePublicInfoFilter:["Type","Name","Introduction","Notification","FaceUrl","CreateTime","Owner_Account","LastInfoTime","LastMsgTime","NextMsgSeq","MemberNum","MaxMemberNum","ApplyJoinOption","InviteJoinOption"]}}}),this._map.set(E.CHANGE_GRP_OWNER,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.CHANGE_GRP_OWNER)}),body:{groupID:void 0,newOwnerID:void 0},keyMap:{req:{newOwnerID:"NewOwner_Account"}}}),this._map.set(E.HANDLE_GRP_APPLICATION,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.HANDLE_GRP_APPLICATION)}),body:{groupID:void 0,applicant:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,messageKey:void 0,userDefinedField:void 0},keyMap:{req:{applicant:"Applicant_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg",messageKey:"MsgKey"}}}),this._map.set(E.HANDLE_INVITE_JOIN_GRP,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.HANDLE_INVITE_JOIN_GRP)}),body:{groupID:void 0,applicant:void 0,invitee:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,userDefinedField:void 0},keyMap:{req:{applicant:"Applicant_Account",invitee:"Invited_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg"}}}),this._map.set(E.HANDLE_GRP_INVITATION,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.HANDLE_GRP_INVITATION)}),body:{groupID:void 0,inviter:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,messageKey:void 0,userDefinedField:void 0},keyMap:{req:{inviter:"Inviter_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg",messageKey:"MsgKey"}}}),this._map.set(E.GET_GRP_PENDENCY,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.GET_GRP_PENDENCY)}),body:{startTime:void 0,limit:void 0,handleAccount:void 0},keyMap:{req:{handleAccount:"Handle_Account"},res:{To_Account:"userID",ApplyInviteMsg:"note"}}}),this._map.set(E.DEL_GRP_SYSTEM_NOTICE,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM,".").concat(E.DEL_GRP_SYSTEM_NOTICE)}),body:{messageListToDelete:void 0},keyMap:{req:{messageListToDelete:"DelMsgList",messageSeq:"MsgSeq",messageRandom:"MsgRandom"}}}),this._map.set(E.AV_POLLING,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.BIG_GRP_POLLING,".").concat(E.AV_POLLING)}),body:{USP:1,startSeq:1,startBroadcastSeq:void 0,holdTime:90,key:void 0,simplifiedMessage:void 0},keyMap:{req:{USP:"USP"},res:{ToGroupId:"groupID",RspBroadcastMsgList:"broadcastMessageList",IsSystemMsg:"isSystemMessage"}}}),this._map.set(E.AV_NOAUTH_POLLING,(e.a2,e.tinyid,{head:c(c({},G(e,AI)),{},{servcmd:"".concat(P.NAME.BIG_GRP_POLLING_NO_AUTH,".").concat(E.AV_POLLING)}),body:{USP:1,startSeq:1,holdTime:90,key:void 0,simplifiedMessage:void 0},keyMap:{req:{USP:"USP"},res:{ToGroupId:"groupID",RspBroadcastMsgList:"broadcastMessageList",IsSystemMsg:"isSystemMessage"}}})),this._map.set(E.GET_ONLINE_MBR_NUM,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.GET_ONLINE_MBR_NUM)}),body:{groupID:void 0},keyMap:{res:{OnlineMemberNum:"memberCount"}}}),this._map.set(E.SET_GRP_ATTR,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.SET_GRP_ATTR)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{req:{key:"key",value:"value"}}}),this._map.set(E.MODIFY_GRP_ATTR,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.MODIFY_GRP_ATTR)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{req:{key:"key",value:"value"}}}),this._map.set(E.DEL_GRP_ATTR,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.DEL_GRP_ATTR)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{req:{key:"key"}}}),this._map.set(E.CLEAR_GRP_ATTR,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.CLEAR_GRP_ATTR)}),body:{groupID:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]}}),this._map.set(E.GET_GRP_ATTR,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP_ATTR,".").concat(E.GET_GRP_ATTR)}),body:{groupID:void 0,avChatRoomKey:void 0,groupType:1},keyMap:{req:{avChatRoomKey:"Key",groupType:"GroupType"}}}),this._map.set(E.GET_GRP_NOTIFY,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.GET_GRP_NOTIFY)}),body:{notifyReqList:[]},keyMap:{req:{notifyReqList:"NotifyReqList"},res:{NextMsgTime:"nextRevokedTime",NotifyMsgList:"notifyList",NotifyRspList:"notifyRspList"}}}),this._map.set(E.UPDATE_GRP_COUNTER,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.UPDATE_GRP_COUNTER)}),body:{groupID:void 0,counterList:void 0,avChatRoomKey:void 0,mode:void 0},keyMap:{req:{counterList:"GroupCounter"}}}),this._map.set(E.GET_GRP_COUNTER,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.GET_GRP_COUNTER)}),body:{groupID:void 0,keyList:[],avChatRoomKey:void 0},keyMap:{req:{keyList:"GroupCounterKeys"}}}),this._map.set(E.CREATE_TOPIC,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP_COMMUNITY,".").concat(E.CREATE_TOPIC)}),body:{groupID:void 0,topicName:void 0,avatar:void 0,customData:void 0,topicID:void 0,notification:void 0,introduction:void 0},keyMap:{req:{avatar:"FaceUrl"}}}),this._map.set(E.DEL_TOPIC,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP_COMMUNITY,".").concat(E.DEL_TOPIC)}),body:{groupID:void 0,topicIDList:void 0},keyMap:{req:{topicIDList:"TopicIdList"},res:{DestroyResultItem:"resultList"}}}),this._map.set(E.UPDATE_TOPIC_PROFILE,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP_COMMUNITY,".").concat(E.UPDATE_TOPIC_PROFILE)}),body:{groupID:void 0,topicID:void 0,avatar:void 0,customData:void 0,notification:void 0,introduction:void 0,muteAllMembers:void 0,topicName:void 0},keyMap:{req:{avatar:"FaceUrl",muteAllMembers:"ShutUpAllMember"}}}),this._map.set(E.GET_TOPIC_LIST,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP_COMMUNITY,".").concat(E.GET_TOPIC_LIST)}),body:{groupID:void 0,topicIDList:void 0,MemberInfoFilter:["NoUnreadSeqList"]},keyMap:{req:{topicIDList:"TopicIdList"},res:{TopicAndSelfInfo:"topicInfoList",TopicInfo:"topic",GroupID:"groupID",ShutUpTime:"muteTime",ShutUpAllFlag:"muteAllMembers",LastMsgTime:"lastMessageTime",MsgSeq:"readedSequence",LastMsgSeq:"sequence"}}}),this._map.set(E.GET_GRP_MBR_LIST,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.GET_GRP_MBR_LIST)}),body:{groupID:void 0,limit:0,offset:void 0,next:void 0,memberRoleFilter:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0},keyMap:{req:{memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},res:{AppMemberDefinedData:"memberCustomField",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",MemberList:"members",ShutUpUntil:"muteUntil"}}}),this._map.set(E.GET_AV_MBR_LIST,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP_AV,".").concat(E.GET_AV_MBR_LIST)}),body:{groupID:void 0,offset:void 0,filter:void 0},keyMap:{req:{offset:"Timestamp",filter:"Mark"},res:{NextTimestamp:"offset"}}}),this._map.set(E.GET_GRP_MBR_PROFILE,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.GET_GRP_MBR_PROFILE)}),body:{groupID:void 0,userIDList:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0},keyMap:{req:{userIDList:"Member_List_Account",memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},res:{MemberList:"members",ShutUpUntil:"muteUntil",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",AppMemberDefinedData:"memberCustomField"}}}),this._map.set(E.ADD_GRP_MBR,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.ADD_GRP_MBR)}),body:{groupID:void 0,silence:void 0,userIDList:void 0},keyMap:{req:{userID:"Member_Account",userIDList:"MemberList"},res:{MemberList:"members"}}}),this._map.set(E.DEL_GRP_MBR,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.DEL_GRP_MBR)}),body:{groupID:void 0,userIDList:void 0,reason:void 0},keyMap:{req:{userIDList:"MemberToDel_Account"}}}),this._map.set(E.BAN_AV_MBR,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.BAN_AV_MBR)}),body:{groupID:void 0,userIDList:void 0,duration:void 0,reason:""},keyMap:{req:{userIDList:"Members_Account",duration:"Duration",reason:"Description"}}}),this._map.set(E.MODIFY_GRP_MBR_INFO,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP,".").concat(E.MODIFY_GRP_MBR_INFO)}),body:{groupID:void 0,topicID:void 0,userID:void 0,messageRemindType:void 0,nameCard:void 0,role:void 0,memberCustomField:void 0,muteTime:void 0},keyMap:{req:{userID:"Member_Account",memberCustomField:"AppMemberDefinedData",muteTime:"ShutUpTime",messageRemindType:"MsgFlag"}}}),this._map.set(E.MARK_AV_MBR_INFO,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP_AV,".").concat(E.MARK_AV_MBR_INFO)}),body:{groupID:void 0,operationType:1,memberList:[]},keyMap:{req:{operationType:"CommandType",memberList:"MemberList",markType:"Marks",userID:"Member_Account"},res:{CommandType:"operationType",Marks:"markType",Member_Account:"userID"}}}),this._map.set(E.CS,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.MSG_SEARCH,".").concat(E.CS)}),body:{keywordList:void 0,keywordListMatchType:"or",account:void 0,groupID:void 0,count:100,cursor:void 0,messageTypeList:void 0,senderUserIDList:void 0,startTime:void 0,endTime:void 0},keyMap:{req:{keywordListMatchType:"MatchType",account:"PeerAccount",groupID:"GroupID",messageTypeList:"MsgTypeList",senderUserIDList:"SendUserIDList",keywords:"Keywords",keywordMatchType:"KeywordMatchType",count:"Count",miniBirthday:"UserBirthStart",maxBirthday:"UserBirthEnd",gender:"UserGenderType",groupTypeList:"GroupType",groupIDList:"GroupIdList"},res:{GroupID:"groupID",UserID:"userID",ErrorCode:"code",ErrorInfo:"message",TotalCount:"totalCount",Count:"messageCount",LastMsgTime:"lastMessageTime",ConversationMsgs:"searchResult",IsNeedReadReceipt:"needReadReceipt",IsPeerRead:"readReceiptSentByPeer",MsgSeq:"sequence",ReqMsgSeq:"sequence",IsSystemMsg:"isSystemMessage",ToGroupId:"to",EnumFrom_AccountType:"fromAccountType",EnumTo_AccountType:"toAccountType",GroupCode:"groupCode",MsgContent:"content",ClientSeq:"clientSequence",ToTopicId:"topicID",InvisibleMsgSeq:"invisibleSequenceList",Users:"userList",ProfileItems:"profileItems",StrValue:"value",IntValue:"value",Groups:"groupList",GroupFaceUrl:"avatar",GroupIntroduction:"introduction",GroupOwnerUserID:"ownerID",GroupOwnerUserName:"ownerNick",GroupOwnerTinyID:"ownerTinyID",GroupMemberNum:"memberNum",GroupName:"name",GroupType:"type",GroupMembers:"groupMemberList",GroupMemberUserID:"userID",GroupMemberTinyID:"userTinyID",GroupMemberUserName:"nick",GroupMemberNameCard:"nameCard"}}}),this._map.set(E.USER_CS,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.USER_SEARCH,".").concat(E.CS)}),body:{keywords:void 0,keywordMatchType:0,miniBirthday:void 0,maxBirthday:void 0,gender:void 0,count:20,cursor:void 0}}),this._map.set(E.GRP_CS,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP_SEARCH,".").concat(E.CS)}),body:{keywords:void 0,keywordMatchType:0,groupType:void 0,count:20,cursor:void 0}}),this._map.set(E.MBR_CS,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.GRP_MEMBER_SEARCH,".").concat(E.CS)}),body:{keywords:void 0,keywordMatchType:0,groupType:void 0,groupIDList:void 0,count:20,cursor:void 0}}),this._map.set(E.SSO_STAT,{head:c(c({},n),{},{servcmd:"".concat(P.NAME.IM_OPEN_STAT,".").concat(E.SSO_STAT)}),body:{header:{},event:[],quality:[]},keyMap:{req:{SDKType:"sdk_type",SDKVersion:"sdk_version",deviceType:"device_type",platform:"platform",instanceID:"instance_id",traceID:"trace_id",SDKAppID:"sdk_app_id",userID:"user_id",tinyID:"tiny_id",extension:"extension",timestamp:"timestamp",networkType:"network_type",eventType:"event_type",code:"error_code",message:"error_message",moreMessage:"more_message",duplicate:"duplicate",costTime:"cost_time",level:"level",qualityType:"quality_type",reportIndex:"report_index",wholePeriod:"whole_period",totalCount:"total_count",rttCount:"success_count_business",successRateOfRequest:"percent_business",countLessThan1Second:"success_count_business",percentOfCountLessThan1Second:"percent_business",countLessThan3Second:"success_count_platform",percentOfCountLessThan3Second:"percent_platform",successCountOfBusiness:"success_count_business",successRateOfBusiness:"percent_business",successCountOfPlatform:"success_count_platform",successRateOfPlatform:"percent_platform",successCountOfMessageReceived:"success_count_business",successRateOfMessageReceived:"percent_business",avgRTT:"average_value",avgDelay:"average_value",avgValue:"average_value",uiPlatform:"ui_platform"}}}),this._map.set(E.PING,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.HEARTBEAT,".").concat(E.PING)}),body:{}}),this._map.set(E.MSG_PUSH,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_OPEN_PUSH,".").concat(E.MSG_PUSH)}),body:{},keyMap:{res:{C2cMsgArray:"C2CMessageArray",GroupMsgArray:"groupMessageArray",GroupTips:"groupTips",C2cNotifyMsgArray:"C2CNotifyMessageArray",C2cMsgInfo:"C2CReadReceiptArray",ClientSeq:"clientSequence",MsgPriority:"priority",NoticeSeq:"noticeSequence",MsgContent:"content",MsgType:"type",MsgBody:"elements",ToGroupId:"to",Desc:"description",Ext:"extension",IsSyncMsg:"isSyncMessage",Flag:"needSync",NeedAck:"needAck",PendencyAdd_Account:"userID",ProfileImNick:"nick",PendencyType:"applicationType",C2CReadAllMsg:"readAllC2CMessage",IsNeedReadReceipt:"needReadReceipt",Status:"statusType"}}}),this._map.set(E.MULTI_MSG_PUSH,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_OPEN_PUSH,".").concat(E.MULTI_MSG_PUSH)}),body:{},keyMap:{res:{GroupMsgArray:"groupMessageArray",GroupTips:"groupTips",ClientSeq:"clientSequence",MsgPriority:"priority",NoticeSeq:"noticeSequence",MsgContent:"content",MsgType:"type",MsgBody:"elements",ToGroupId:"to",Desc:"description",Ext:"extension",IsSyncMsg:"isSyncMessage",Flag:"needSync",NeedAck:"needAck",PendencyType:"applicationType"}}}),this._map.set(E.MSG_PUSH_ACK,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OPEN_IM,".").concat(E.MSG_PUSH_ACK)}),body:{sessionData:void 0},keyMap:{req:{sessionData:"SessionData"}}}),this._map.set(E.STATUS_FORCE_OFFLINE,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_OPEN_STATUS,".").concat(E.STATUS_FORCE_OFFLINE)}),body:{},keyMap:{res:{C2cNotifyMsgArray:"C2CNotifyMessageArray",NoticeSeq:"noticeSequence",KickoutMsgNotify:"kickoutMsgNotify",NewInstInfo:"newInstanceInfo"}}}),this._map.set(E.DOWNLOAD_MERGER_MSG,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_LONG_MSG,".").concat(E.DOWNLOAD_MERGER_MSG)}),body:{downloadKey:""},keyMap:{res:{Data:"data",Desc:"description",Ext:"extension",Download_Flag:"downloadFlag",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID"}}}),this._map.set(E.UPLOAD_MERGER_MSG,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_LONG_MSG,".").concat(E.UPLOAD_MERGER_MSG)}),body:{messageList:[]},keyMap:{req:{fromAccount:"From_Account",toAccount:"To_Account",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom",msgBody:"MsgBody",type:"MsgType",content:"MsgContent",data:"Data",description:"Desc",extension:"Ext",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",elements:"MsgBody",clientSequence:"ClientSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody"}}}),this._map.set(E.FOLLOW,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FOLLOW,".").concat(E.FOLLOW)}),body:{fromAccount:"",userIDList:[]},keyMap:{req:{userIDList:"FollowItem"},res:{ResultItem:"resultList",To_Account:"userID"}}}),this._map.set(E.UNFOLLOW,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FOLLOW,".").concat(E.UNFOLLOW)}),body:{fromAccount:"",userIDList:[]},keyMap:{req:{userIDList:"To_Account"},res:{ResultItem:"resultList",To_Account:"userID"}}}),this._map.set(E.GET_FOLLOW_INFO,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FOLLOW,".").concat(E.GET_FOLLOW_INFO)}),body:{fromAccount:"",userIDList:[]},keyMap:{req:{userIDList:"To_Account"},res:{FollowInfo:"followInfoList",To_Account:"userID",FollowerCount:"followersCount",FollowingCount:"followingCount",MutualFollowingCount:"mutualFollowersCount"}}}),this._map.set(E.GET_FOLLOW,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FOLLOW,".").concat(E.GET_FOLLOW)}),body:{fromAccount:"",type:1,nextCursor:"",count:500},keyMap:{req:{type:"FollowType",nextCursor:"StartCursor",count:"WantNum"},res:{FollowItem:"resultList",To_Account:"userID",ProfileItem:"profileList"}}}),this._map.set(E.CHECK_FOLLOW_TYPE,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.FOLLOW,".").concat(E.CHECK_FOLLOW_TYPE)}),body:{fromAccount:"",userIDList:[]},keyMap:{req:{userIDList:"To_Account"},res:{ResultItem:"resultList",To_Account:"userID"}}}),this._map.set(E.SET_TOKEN,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_OPEN_STATUS,".").concat(E.SET_TOKEN)}),body:{tokenID:"",pushMsg:0,sdkAppID:0,businessID:"",deviceBrand:"",deviceToken:"",isTpns:0,isWebUniapp:0,notificationStatus:0,deviceModel:"",systemVersion:"",pushVersion:""},keyMap:{req:{tokenID:"TokenID",pushMsg:"PushMsg",sdkAppID:"EnterVersion",businessID:"BusiID",deviceBrand:"InstType",deviceToken:"VarToken",isTpns:"IsTpns",notificationStatus:"NotificationStatus",deviceModel:"DeviceModel",systemVersion:"SystemVersion",pushVersion:"PushPluginVersion"}}}),this._map.set(E.STAT_FOREGROUND,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_OPEN_STATUS,".").concat(E.STAT_FOREGROUND)}),body:{isWebUniapp:0}}),this._map.set(E.STAT_BACKGROUND,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_OPEN_STATUS,".").concat(E.STAT_BACKGROUND)}),body:{C2CUnread:0,GroupUnread:0,isWebUniapp:0},keyMap:{req:{c2cUnreadCount:"C2cUnread",groupUnreadCount:"GrpUnread"}}}),this._map.set(E.PUSH_REPORT,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.OFFLINE_PUSH_REPORT,".").concat(E.PUSH_REPORT)}),body:{eventList:[]},keyMap:{req:{eventList:"UinappPushEvents",type:"EventType",time:"EventTime",pushId:"ClickExt"}}}),this._map.set(E.SET_ALL_RECEIVE_MSG_OPT,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_MSG_LOGIC,".").concat(E.SET_ALL_RECEIVE_MSG_OPT)}),body:{startTime:0,endTime:0,isRepeated:0,messageRemindType:0},keyMap:{req:{messageRemindType:"Level"}}}),this._map.set(E.GET_ALL_RECEIVE_MSG_OPT,{head:c(c({},e),{},{servcmd:"".concat(P.NAME.IM_MSG_LOGIC,".").concat(E.GET_ALL_RECEIVE_MSG_OPT)}),body:{toAccount:void 0}})}},{key:"has",value:function(e){return this._map.has(e)}},{key:"get",value:function(e){return this._map.get(e)}},{key:"update",value:function(){this._fillMap()}},{key:"getKeyMap",value:function(e){return this.has(e)?this.get(e).keyMap||{}:(m.w("".concat(this._n,".getKeyMap unknown P:").concat(e)),{})}},{key:"getProtocolData",value:function(n){var s=n.P,t=n.data,n=this.get(s),s=null;if(t){var r,a=this._simpleDeepCopy(n),a=this._updateService(t,a),l=a.body,d=Object.create(null);for(r in l)if(Object.prototype.hasOwnProperty.call(l,r)){if(d[r]=l[r],t[r]===void 0)continue;d[r]=t[r]}a.body=d,s=this._getUplinkData(a)}else s=this._getUplinkData(n);return s}},{key:"_getUplinkData",value:function(t){var t=this._dataCleaner(t),n=Kc(t.head),n=CI(t.body,this._getReqKeyMap(n));return t.body=n,t}},{key:"_updateService",value:function(e,t){var n,s,r=Kc(t.head);return this._isFromGroupRequest(t)&&(n=e.type,s=e.groupID,e=(e=e.groupIDList)===void 0?[]:e,H(s=s===void 0?void 0:s)&&(s=e[0]||""),rn({type:n,groupID:s})&&(t.head.servcmd="".concat(P.NAME.GRP_COMMUNITY,".").concat(r))),t}},{key:"_isFromGroupRequest",value:function(e){return e.head.servcmd.includes(P.NAME.GRP)||e.head.servcmd.includes(P.NAME.GRP_ATTR)}},{key:"_getReqKeyMap",value:function(e){return e=this.getKeyMap(e),c(c({},ma.req),e.req)}},{key:"_dataCleaner",value:function(e){var t,n=Array.isArray(e)?[]:Object.create(null);for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&qp(t)&&e[t]!==null&&e[t]!==void 0&&(p(e[t])!=="object"?n[t]=e[t]:n[t]=this._dataCleaner.bind(this)(e[t]));return n}},{key:"_simpleDeepCopy",value:function(e){for(var t,n=Object.keys(e),s={},r=0,a=n.length;r<a;r++)t=n[r],_e(e[t])?s[t]=Array.from(e[t]):ao(e[t])?s[t]=this._simpleDeepCopy(e[t]):s[t]=e[t];return s}}]),ol),NI=[E.MSG_PUSH_ACK],PI=(y(nl,[{key:"_onC2CMsgArray",value:function(e){var t=this._sessionM.get(6);e.dataList.forEach(function(n){var s;n.isSyncMessage===1&&(s=n.from,n.from=n.to,n.to=s)}),e.needSync===1&&this._sessionM.get(19).syncOnNeed(),t.onNewMessage({dataList:e.dataList,isInstantMessage:!0})}},{key:"_onC2CMsgModified",value:function(e){this._sessionM.get(6).onMsgModified(e)}},{key:"_onGroupMsgArray",value:function(e){var t=this._sessionM.get(7);t&&t.onNewMessage({event:e.event,dataList:e.dataList,isInstantMessage:!0})}},{key:"_onGroupMsgModified",value:function(e){var t=this._sessionM.get(7);t&&t.onMsgModified(e)}},{key:"_onGroupTips",value:function(e){var t=this._sessionM.get(7);if(t){var n=e.event,s=e.dataList,r=e.isInstantMessage,a=r===void 0||r,l=e.isSyncingEnded;switch(n){case 4:case 6:t.onNewGroupTips({event:n,dataList:s});break;case 5:for(var d=0;d<s.length;d++)if(_e(s[d].elements.revokedInfos))t.onMsgRevoked({dataList:s});else if(_e(s[d].elements.groupMessageReadNotice))t.onMsgReadNotice({dataList:s});else{if(!_e(s[d].elements.readReceiptList)){t.onNewGroupSystemNotice({dataList:s,isInstantMessage:a,isSyncingEnded:l});break}t.onReadReceiptList({dataList:s})}break;case 12:this._sessionM.get(11).onNewGroupAtTips({dataList:s});break;default:m.l("".concat(this._n,"._onGroupTips unknown event:").concat(n," dataList:"),s)}}}},{key:"_onC2CNotifyMsgArray",value:function(e){var t,n=this,s=e.dataList;_e(s)&&(t=this._sessionM.get(6),s.forEach(function(r){var a,l;dt(r)&&(r.hasOwnProperty("kickoutMsgNotify")?(a=(l=r.kickoutMsgNotify).kickType,l=(l=l.newInstanceInfo)===void 0?{}:l,a===1?n._sessionM.onMultipleAccountKickedOut(l):a===2?n._sessionM.onMultipleDeviceKickedOut(l):a===3&&n._sessionM.onRestApiKickedOut(l)):r.hasOwnProperty("c2cMessageRevokedNotify")?t&&t.onMsgRevoked({dataList:s},!0):r.hasOwnProperty("c2cMessageReadReceipt")?t&&t.onMsgReadReceipt({dataList:s}):r.hasOwnProperty("c2cMessageReadNotice")?t&&t.onMsgReadNotice({dataList:s}):r.hasOwnProperty("muteNotificationsSync")&&n._sessionM.get(11).onC2CMsgRemindTypeSynced({dataList:s}))}))}},{key:"_onC2CReadReceiptArray",value:function(e){this._sessionM.get(6).onReadReceiptList(e)}},{key:"_onProfileModified",value:function(e){this._sessionM.get(4).onProfileModified({dataList:e.dataList});var t=this._sessionM.get(8);t&&t.onFriendProfileModified({dataList:e.dataList})}},{key:"_onRelationChainModified",value:function(e){this._sessionM.get(4).onRelationChainModified({dataList:e.dataList});var t=this._sessionM.get(8);t&&t.onRelationChainModified({dataList:e.dataList})}},{key:"_onRecentContact",value:function(n){var t,n=n.dataList;!_e(n)||(t=this._sessionM.get(11))&&n.forEach(function(s){var r,a,l=s.pushType;l===1?(r=s.recentContactDeleteItem,t.onConvDeleted(r.recentContactList)):l===2?(r=s.recentContactTopItem,t.onConvPinnedStatus(r.recentContactList,!0)):l===3?(r=s.recentContactTopItem,t.onConvPinnedStatus(r.recentContactList,!1)):l===4?(r=s.recentContactMarkContact,t.onConvMarkUpdated(r.recentContactMarkContactItem)):l===5?(r=s.recentContactCreateContactGroup,t.onConvGroupCreated(r.msgContactGroupContactItem)):l===6?(r=s.recentContactDelContactGroup,t.onConvGroupDeleted(r.msgGroupItem)):l===7&&(l=(r=s.recentContactUpdateContactGroup).updateType,s=r.msgUpdateGroup,r=r.msgUpdateContact,l===1?(a=s.updateGroupType)===1?t.onConvGroupNameUpdated(s):a===2&&t.onConvInGroupUpdated(s):l===2&&t.onConvAddedToOrDeletedFromGroup(r))})}},{key:"_onAllMsgRead",value:function(t){var t=t.dataList,n=this._sessionM.get(11);n&&n.onPushedAllMessageRead(t)}},{key:"_onUserStatusList",value:function(e){this._sessionM.get(4).onUserStatusUpdated(e)}},{key:"_onMsgExtNotify",value:function(e){this._sessionM.get(3).onMsgExtNotify(e)}},{key:"_onMsgReactionNotifyList",value:function(e){this._sessionM.get(34).onReactionNotifyList(e)}},{key:"_onMsgReactionNotify",value:function(e){this._sessionM.get(34).onReactionNotify(e)}},{key:"_onFollowNotify",value:function(e){this._sessionM.get(35).onFollowNotify(e)}},{key:"_onTopicLatestMsg",value:function(e){this._sessionM.get(10).onTopicLatestMsg(e)}},{key:"onMessage",value:function(e){var t=this,n=e.body;if(this._filterMsgFromIMOpenPush(e)){var s,r=n.eventArray,a=n.isInstantMessage,l=n.isSyncingEnded,d=n.needSync;if(_e(r))for(var h,g,_,M=0,S=r.length;M<S;M++)(_=(h=r[M]).event)!==100?_!==24?_!==26?(s=Object.keys(h).find(function(D){return t._keys.indexOf(D)!==-1}))?(g=_===14?{readAllC2CMessage:h[s],groupMessageReadInfoList:h.groupMessageReadNotice||[]}:_===16?{userID:h.userID,timestamp:h.timestamp,readReceiptList:h[s]}:h[s],this._eventHandlerMap.get(s)({event:_,dataList:g,isInstantMessage:a,isSyncingEnded:l,needSync:d})):m.l("".concat(this._n,".onMessage unknown eventItem:"),h):this._onTopicLatestMsg(h):this._onAllRcvMsgOptNotify(h):this._onRoomCustomData(h.content)}}},{key:"_onRoomCustomData",value:function(e){this._sessionM.get(30).onRoomCustomDataReceived(e),m.l("".concat(this._n,"._onRoomCustomData data:").concat(e))}},{key:"_onAllRcvMsgOptNotify",value:function(e){this._sessionM.get(11).onAllRcvMsgOptNotify(e)}},{key:"_filterMsgFromIMOpenPush",value:function(t){var n=t.head,t=t.body,n=n.servcmd,s=!1;return!(s=H(n)?s:n.includes(P.NAME.IM_CONFIG_MANAGER)||n.includes(P.NAME.OVERLOAD_PUSH)||n.includes(P.NAME.STAT_SERVICE))||(n.includes(E.PUSHED_CLOUD_CTRL_CONFIG)?this._sessionM.get(23).onPushedConfig(t):n.includes(E.PUSHED_COMMERCIAL_CONFIG)?this._sessionM.get(27).onPushedConfig(t):n.includes(E.OVERLOAD_NOTIFY)?this._sessionM.onPushedServerOverload(t):n.includes(E.KICK_OTHER)&&(s=Date.now(),this._sessionM.reLoginOnKickOther(),t=new K("kickOther"),s=s-(n=this._sessionM.get(1).getLastWsHelloTs()),t.setMessage("last wshello time:".concat(n," diff:").concat(s,"ms")).end()),!1)}}]),nl),xf=[{cmd:E.GET_GRP_PROFILE,interval:1,count:8},{cmd:E.UPDATE_GRP_PROFILE,interval:1,count:8},{cmd:E.GET_AV_MBR_LIST,interval:3,count:1},{cmd:E.GET_GRP_PENDENCY,interval:1,count:15},{cmd:E.GET_TOPIC_LIST,interval:1,count:10},{cmd:E.SET_GRP_ATTR,interval:5,count:10},{cmd:E.MODIFY_GRP_ATTR,interval:5,count:10},{cmd:E.DEL_GRP_ATTR,interval:5,count:10},{cmd:E.CLEAR_GRP_ATTR,interval:5,count:10},{cmd:E.GET_GRP_ATTR,interval:5,count:20},{cmd:E.UPDATE_GRP_COUNTER,interval:5,count:20},{cmd:E.GET_GRP_COUNTER,interval:5,count:20},{cmd:E.SET_ALL_MSG_READ,interval:1,count:1},{cmd:E.GET_USER_STATUS,interval:5,count:20},{cmd:E.SUB_USER_STATUS,interval:5,count:20},{cmd:E.UNSUB_USER_STATUS,interval:5,count:20},{cmd:E.CS,interval:5,count:20},{cmd:E.GRP_CS,interval:5,count:20},{cmd:E.MBR_CS,interval:5,count:20},{cmd:E.USER_CS,interval:5,count:20},{cmd:E.CHECK_FOLLOW_TYPE,interval:5,count:20},{cmd:E.GET_GRP_ROAMING_MSG,interval:1,count:20},{cmd:E.GET_C2C_ROAMING_MSG,interval:1,count:20}],tl=new Map,qf=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],ya=0,bI=qf.length;ya<bI;ya++)tl.set(ya,qf[ya]);function nl(e){f(this,nl),this._sessionM=e,this._n="MsgDispatcher",this._eventHandlerMap=new Map,this._eventHandlerMap.set("C2CMessageArray",this._onC2CMsgArray.bind(this)),this._eventHandlerMap.set("groupMessageArray",this._onGroupMsgArray.bind(this)),this._eventHandlerMap.set("groupTips",this._onGroupTips.bind(this)),this._eventHandlerMap.set("C2CNotifyMessageArray",this._onC2CNotifyMsgArray.bind(this)),this._eventHandlerMap.set("C2CReadReceiptArray",this._onC2CReadReceiptArray.bind(this)),this._eventHandlerMap.set("profileModify",this._onProfileModified.bind(this)),this._eventHandlerMap.set("friendListMod",this._onRelationChainModified.bind(this)),this._eventHandlerMap.set("recentContactMod",this._onRecentContact.bind(this)),this._eventHandlerMap.set("readAllC2CMessage",this._onAllMsgRead.bind(this)),this._eventHandlerMap.set("c2cMessageModified",this._onC2CMsgModified.bind(this)),this._eventHandlerMap.set("groupMessageModified",this._onGroupMsgModified.bind(this)),this._eventHandlerMap.set("userStatusList",this._onUserStatusList.bind(this)),this._eventHandlerMap.set("messageExtensionNotify",this._onMsgExtNotify.bind(this)),this._eventHandlerMap.set("messageReactionNotifyList",this._onMsgReactionNotifyList.bind(this)),this._eventHandlerMap.set("messageReactionNotify",this._onMsgReactionNotify.bind(this)),this._eventHandlerMap.set("followChangeList",this._onFollowNotify.bind(this)),this._keys=q(this._eventHandlerMap.keys())}function ol(e){f(this,ol),this._n="PHandler",this._sessionM=e,this._map=new Map,this._fillMap()}function Xr(e){return f(this,Xr),(e=Ff.call(this,e))._n="ChannelModule",e._socketHandler=new LI(V(e)),e._probing=!1,e._isAppShowing=!0,e._previousState=I.NET_STATE_CONNECTED,e._timerForNotLoggedIn=-1,e._timerForNotLoggedIn=setInterval(e.onCheckTimer.bind(V(e)),1e3),e._fatalErrorFlag=!1,e._disconnectedTS=0,e._lastDiagnoseTS=0,e}function sl(e){f(this,sl),this._chM=e,this._n="SocketHandler",this._promiseMap=new Map,this._readyState=Js,this._simpleRequestMap=new Map,this.MAX_SIZE=100,this._startSequence=wn(),this._startTs=0,this._reConnectFlag=!1,this._nextPingTs=0,this._reConnectCount=0,this.MAX_RECONNECT_COUNT=3,this._socketID=-1,this._random=0,this._socket=null,this._url="",this._onOpenTs=0,this._canIUseBinaryFrame=!0,this._isWorkerEnabled=!0,this._currentSite=Ee,this._setWebsocketHost(),this._initConnection()}function rl(e){f(this,rl);var t,n,s=(this._handler=e).getURL();this._socket=null,this._workerSocket=null,this._id=wn(),this._handler.getIsWorkerEnabled()?(t=URL.createObjectURL(new Blob([';let _socket = null;onmessage = function(event) {  if (event.data.cmd === "start") {    const url = event.data.url;    _socket = new WebSocket(url);    _socket.binaryType = "arraybuffer";    _socket.onopen = function() {      postMessage({ callback: "onOpen", extensions: _socket.extensions });    };    _socket.onclose = function(e) {      postMessage({ callback: "onOpen", e: { code: e.code, reason: e.reason } });    };    _socket.onmessage = function(e) {      postMessage({ callback: "onMessage", data: e.data });    };    _socket.onerror = function(e) {      postMessage({ callback: "onError", e: { isTrusted: "true" } });    };  } else if (event.data.cmd === "sendMessage") {    if (_socket !== null) {      _socket.send(event.data.data);    }  } else if (event.data.cmd === "stop") {    if (_socket !== null) {      _socket.close(event.data.code);      _socket = null;    }  }};'],{type:"application/javascript; charset=utf-8"})),this._workerSocket=new Worker(t),(n=this)._workerSocket.onmessage=function(r){var d=r.data,a=d.callback,l=d.e,d=d.extensions;a==="onOpen"?n._onOpen(d):a==="onClose"?n._onClose(l):a==="onError"?n._onError(l):a==="onMessage"&&n._onMessage(r.data)},this._workerSocket.postMessage({cmd:"start",id:this._id,url:s})):ee?w?(le.connectSocket({url:s,header:{"content-type":"application/json"}}),le.onSocketClose(this._onClose.bind(this)),le.onSocketOpen(this._onOpen.bind(this)),le.onSocketMessage(this._onMessage.bind(this)),le.onSocketError(this._onError.bind(this))):(this._socket=le.connectSocket({url:s,header:{"content-type":"application/json"},complete:function(){}}),this._socket.onClose(this._onClose.bind(this)),this._socket.onOpen(this._onOpen.bind(this)),this._socket.onMessage(this._onMessage.bind(this)),this._socket.onError(this._onError.bind(this))):(this._socket=new WebSocket(s),this._socket.binaryType="arraybuffer",this._socket.onopen=this._onOpen.bind(this,this._socket.extensions),this._socket.onmessage=this._onMessage.bind(this),this._socket.onclose=this._onClose.bind(this),this._socket.onerror=this._onError.bind(this)),this._canIUseBinaryFrame=e.canIUseBinaryFrame()}function il(e){for(var t,n,s=e,r="",a=0,l=(s=e.length%8!=0?"0".repeat(8-e.length%8)+e:s).length;a<l;a+=8)t=parseInt(s.slice(a,a+4),2),n=parseInt(s.slice(a+4,a+8),2),r+=tl.get(t)+tl.get(n);return r}function GI(e){if(e<0||53<e)return NaN;var t=0|1073741824*Math.random();return 30<e?t+1073741824*(0|Math.random()*(1<<e-30)):t>>>30-e}function wI(e,t){for(var n=e.toString(16),s=t-n.length,r="0";0<s;s>>>=1,r+=r)1&s&&(n=r+n);return n}T(ci,St),Xf=z(ci),y(ci,[{key:"_init",value:function(){this._updateCmdFreqLimitMap(xf)}},{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("cmd_frequency_limit");H(e)||(e=JSON.parse(e),this._updateCmdFreqLimitMap(e))}},{key:"_updateCmdFreqLimitMap",value:function(e){var t=this;e.forEach(function(n){t._cmdFreqLimitMap.set(n.cmd,{interval:n.interval,count:n.count})})}},{key:"updateProtocolConfig",value:function(){this._pHandler.update()}},{key:"req",value:function(n){m.d("".concat(this._n,".req options:"),n);var t=n.P;if(!this._pHandler.has(t))return m.w("".concat(this._n,".req unknown P:").concat(t)),A({code:F.NO_PROTOCOL});var n=this.getProtocolData(n),s=n.head.servcmd;if(this._isFreqOverLimit(s))return A({code:r=F.OVER_FREQUENCY_LIMIT,message:this.getErrMsg(r,this._getCmd(s))});if(this._isServerOverload(s))return A({code:r=F.OPEN_SERVICE_OVERLOAD_ERROR,message:this.getErrMsg(r,this._getCmd(s))});var r=this.get(21);return NI.includes(t)?r.simplySend(n):r.send(n)}},{key:"getKeyMap",value:function(e){return this._pHandler.getKeyMap(e)}},{key:"genCommonHead",value:function(){var e=this.get(12);return{ver:"v4",platform:this._platform,websdkappid:re,websdkversion:ue,a2:e.getA2Key()||void 0,tinyid:e.getTinyID()||void 0,status_instid:e.getStatusInstanceID(),sdkappid:e.getSDKAppID(),contenttype:e.getContentType(),reqtime:0,identifier:e.getA2Key()?void 0:e.getUserID(),usersig:e.getA2Key()?void 0:e.getUserSig(),sdkability:12775283,sdkability_ext:il(""),cappid:e.getApplicationID(),cs:0}}},{key:"genCosSpecifiedHead",value:function(){var e=this.get(12);return{ver:"v4",platform:this._platform,websdkappid:re,websdkversion:ue,sdkappid:e.getSDKAppID(),contenttype:e.getContentType(),reqtime:0,identifier:e.getUserID(),usersig:e.getUserSig(),status_instid:e.getStatusInstanceID(),sdkability:12775283,sdkability_ext:il(""),cappid:e.getApplicationID(),cs:0}}},{key:"genSSOReportHead",value:function(){var e=this.get(12);return{ver:"v4",platform:this._platform,websdkappid:re,websdkversion:ue,sdkappid:e.getSDKAppID(),contenttype:"",reqtime:0,identifier:"",usersig:"",status_instid:e.getStatusInstanceID(),sdkability:12775283,sdkability_ext:il(""),cappid:e.getApplicationID(),cs:0}}},{key:"getProtocolData",value:function(e){return this._pHandler.getProtocolData(e)}},{key:"trans",value:function(t){var n=t.servcmd,t=t.data,n={head:c(c({},this.genCommonHead()),{},{servcmd:n}),body:t};return this.get(21).send(n)}},{key:"sendComboMessage",value:function(t){var n=t.servcmd,t=t.data,n={head:c(c({},this.genCommonHead()),{},{servcmd:n}),body:t};return this.get(21).send(n)}},{key:"onErrorCodeNotZero",value:function(e){var t,n=e.errorCode;n===F.HELLO_ANSWER_KICKED_OUT&&(t=e.kickType,e=(e=e.newInstanceInfo)===void 0?{}:e,t===1?this.onMultipleAccountKickedOut(e):t===2?this.onMultipleDeviceKickedOut(e):t===3&&this.onRestApiKickedOut(e)),n!==F.MSG_A2KEY_EXPIRED&&n!==F.ACCOUNT_A2KEY_EXPIRED||(this._onUserSigExpired(),this.get(21).reConnect())}},{key:"onMessage",value:function(e){var n=e.body,t=n.needAck,n=n.sessionData;(t===void 0?0:t)===1&&this._sendACK(n),this._msgDispatcher.onMessage(e)}},{key:"onReconnected",value:function(e){this._incrementalPullContactFlag=e<=300,this._reLoginOnReconnected()}},{key:"reLoginOnKickOther",value:function(){m.l("".concat(this._n,".reLoginOnKickOther")),this._reLogin()}},{key:"_reLoginOnReconnected",value:function(){m.l("".concat(this._n,"._reLoginOnReconnected")),this._reLogin()}},{key:"_reLogin",value:function(){var e,t,n,s=this,r="".concat(this._n,"._reLogin");this.isLoggedIn()&&(e=0,(t=this.get(1).getPushModule())&&(e=t.getUniAppPlatform()),n=new K("reLogin"),this.req({P:E.LOGIN,data:{isWebUniapp:e,customInfo:this.get(12).getCustomLoginInfo()}}).then(function(l){var l=l.data,g=l.instanceID,l=l.customStatus,M=s.get(12),d=ga(l),h=(M.setStatusInstanceID(g),s.get(21)),_=h.getSocketID(),_="socketID:".concat(_," instanceID:").concat(g," customStatus:").concat(d),g=(n.setMessage(_).end(!0),m.l("".concat(r," ok. ").concat(_)),M.getCustomStatus()!==d&&s.get(4).onUserStatusUpdated({dataList:[{to:s.getMyUserID(),statusType:I.USER_STATUS_ONLINE,customStatus:l}]}),h.diagnose(),s.get(11).syncConvList(s._incrementalPullContactFlag).then(function(){m.l("".concat(r,", sync conv list ok.")),s.get(25).start()}),s.get(7)),_=(g&&g.updateLocalMainSequenceOnReconnected(),s.get(10)),M=(_.resetGetTopicTime(),_.getTopicListOnReconnected(),s.get(35));M&&M.clearCacheOnReconnected()}))}},{key:"onMultipleAccountKickedOut",value:function(e){this.get(1).onMultipleAccountKickedOut(e)}},{key:"onMultipleDeviceKickedOut",value:function(e){this.get(1).onMultipleDeviceKickedOut(e)}},{key:"_onUserSigExpired",value:function(){this.get(1).onUserSigExpired()}},{key:"onRestApiKickedOut",value:function(e){this.get(1).onRestApiKickedOut(e)}},{key:"_sendACK",value:function(e){this.req({P:E.MSG_PUSH_ACK,data:{sessionData:e}})}},{key:"_isFreqOverLimit",value:function(e){if(e=e.split(".")[1],!this._cmdFreqLimitMap.has(e))return!1;if(!this._cmdReqInfoMap.has(e))return this._cmdReqInfoMap.set(e,{startTime:Date.now(),requestCount:1}),!1;var n=this._cmdFreqLimitMap.get(e),t=n.count,n=n.interval,r=this._cmdReqInfoMap.get(e),s=r.startTime,r=r.requestCount;return Date.now()-s>1e3*n?(this._cmdReqInfoMap.set(e,{startTime:Date.now(),requestCount:1}),!1):(this._cmdReqInfoMap.set(e,{startTime:s,requestCount:r+=1}),t<r)}},{key:"_isServerOverload",value:function(e){if(!this._serverOverloadInfoMap.has(e))return!1;var n=this._serverOverloadInfoMap.get(e),t=n.overloadTime,n=n.waitingTime;return Date.now()-t<=1e3*n||(this._serverOverloadInfoMap.delete(e),!1)}},{key:"_getCmd",value:function(e){var t="";if(!e.includes("."))return t;var n,s=e.split(".")[1];for(n in E)if(E[n]===s){t=n;break}return t}},{key:"onPushedServerOverload",value:function(n){var t=n.overloadCommand,n=n.waitingTime;this._serverOverloadInfoMap.set(t,{overloadTime:Date.now(),waitingTime:n}),m.w("".concat(this._n,".onPushedServerOverload waitingTime:").concat(n,"s cmd:").concat(this._getCmd(t)))}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._updateCmdFreqLimitMap(xf),this._cmdReqInfoMap.clear(),this._serverOverloadInfoMap.clear(),this._incrementalPullContactFlag=!0}}]);var Vf,Bf,Hf,Kf,jf,Wf,Yf,zf,$f,Jf,Xf,UI=ci,FI=(T(ai,St),Jf=z(ai),y(ai,[{key:"getCloudConfig",value:function(e){return H(e)?this._cloudConfig:this._cloudConfig.has(e)?this._cloudConfig.get(e):void 0}},{key:"getServerConfig",value:function(e){var t={code:0,data:""};return!H(e)&&this._cloudConfig.has(e)&&(t.data=this._cloudConfig.get(e)),Promise.resolve(t)}},{key:"_canFetch",value:function(){return this.isLoggedIn()&&!this._isFetching&&Date.now()>=this._expiredTime}},{key:"fetchConfig",value:function(){var e,t=this,n="".concat(this._n,".fetchConfig"),s=this._canFetch();m.l("".concat(n," canFetch:").concat(s)),s&&(e=new K("fetchCloudCtrlConfig"),s=this.get(12).getSDKAppID(),this._isFetching=!0,this.req({P:E.FETCH_CLOUD_CTRL_CONFIG,data:{SDKAppID:s,version:this._version}}).then(function(r){t._isFetching=!1;var l=r.data,a=l.version,l=l.cloudControlConfig;e.setMessage("version:".concat(t._version," newVersion:").concat(a," config:").concat(l)).end(),m.l("".concat(n," ok")),t._parse(r.data)}).catch(function(r){t._isFetching=!1,e.setError(r).end(),m.l("".concat(n," failed. error:"),r),t._setExpiredTime(12e4)}))}},{key:"onPushedConfig",value:function(e){m.l("".concat(this._n,".onPushedConfig config:"),e),new K("pushedCloudCtrlConfig").setMessage("newVersion:".concat(e.version," config:").concat(e.cloudControlConfig)).end(),this._parse(e)}},{key:"onCheckTimer",value:function(e){this._canFetch()&&this.fetchConfig()}},{key:"_parse",value:function(e){var t=this,n="".concat(this._n,"._parse"),s=e.errorCode,r=e.errorMessage,a=e.cloudControlConfig,l=e.version,d=e.expiredTime;if(s===0){if(this._version!==l){var h=null;try{h=JSON.parse(a)}catch{this.isPrivateNetWork()||m.e("".concat(n," failed. config:"),a)}h&&(this._cloudConfig.clear(),Object.keys(h).forEach(function(g){t._cloudConfig.set(g,h[g])}),this._version=l,this.emitIEvt(mt.CLOUD_CONFIG))}this._setExpiredTime(1e3*d)}else H(s)?(m.l("".concat(n," failed. Invalid message format:"),e),this._setExpiredTime(36e5)):(m.e("".concat(n," errorCode:").concat(s," errorMessage:").concat(r)),this._setExpiredTime(12e4))}},{key:"_setExpiredTime",value:function(e){this._expiredTime=Date.now()+e}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._cloudConfig.clear(),this._expiredTime=0,this._version=0,this._isFetching=!1}}]),ai),xI=(T(ii,St),$f=z(ii),y(ii,[{key:"start",value:function(){this._recoverGroupChat(),this._recoverC2CChat()}},{key:"_recoverGroupChat",value:function(){var e,t,n,s,r=this,a=this._getLocalConvList().filter(function(h){return h.type===I.CONV_GROUP&&h.groupProfile.type!==I.GRP_AVCHATROOM}),l=this.get(11),d=[];a.forEach(function(_){var g=_.conversationID,_=_.lastMessage;e=g.replace(I.CONV_GROUP,""),t=l.getLocalLastMessage(g),_&&_.lastSequence!==0&&t?(n=_.lastSequence,t=t.sequence,s=n-t,0<t&&1<=s&&s<300?r._recoverGroupMsg({groupID:e,localLastMessageSequence:t,remoteLastMessageSequence:n}):d.push(e)):d.push(e)}),this._getGroupNotice(d)}},{key:"_recoverC2CChat",value:function(){var e,t,n,s=this,r=this._getLocalConvList().filter(function(d){return d.type===I.CONV_C2C}),a=this.get(11),l=[Promise.resolve()];r.forEach(function(g){var h=g.conversationID,g=g.lastMessage;e=a.getLocalLastMessage(h),g&&g.lastTime!==0&&e&&(t=g.lastTime,e=e.time,n=t-e,0<e&&1<=n&&n<=600&&l.push(s._recoverC2CMsg({conversationID:h,localLastMessageTime:e,remoteLastMessageTime:t})))}),Promise.all(l).then(function(){m.l("".concat(s._n,"._recoverC2CChat all done")),s.get(19).syncOnReconnected()})}},{key:"_getLocalConvList",value:function(){return this.get(11).getLocalConvList()}},{key:"_recoverGroupMsg",value:function(e){var t=this,n="".concat(this._n,".").concat("_recoverGroupMsg"),s=(m.l("".concat(n," options:"),e),e.groupID),r=e.localLastMessageSequence,a=e.remoteLastMessageSequence,l=JSON.stringify(e),d=new K("_recoverGroupMsg");d.setMessage(l),this._getGroupRoamingMsg({groupID:s,sequence:r}).then(function(g){var g=g.data,_=g.complete,M=g.messageList;if(!H(M)){var g=M[0].sequence,S=M.map(function(Be){return Be.sequence}),S="".concat(l," complete:").concat(_," sequenceList:").concat(S),D=(m.l("".concat(n," ").concat(S)),g!==r&&g<a&&_!==2&&t._recoverGroupMsg({groupID:s,localLastMessageSequence:g,remoteLastMessageSequence:a}),d.setMessage(S).end(),t.get(7));1<M.length&&M.sort(function(Be,We){return Be.sequence-We.sequence});for(var O=!1,B=0,U=M.length;B<U;B++)if(M[B].from===I.CONV_SYSTEM){O=!0;break}if(O)for(var de=0,J=M.length;de<J;de++){var ke=M[de];ke.from!==I.CONV_SYSTEM?D.onNewMessage({dataList:[ke],isInstantMessage:!1,updateUnreadCount:!1}):D.onNewGroupTips({event:ke.event,dataList:[ke]})}else D.onNewMessage({dataList:M,isInstantMessage:!1,updateUnreadCount:!1})}}).catch(function(h){d.setError(h).end(),m.w("".concat(n," failed. error:"),h)})}},{key:"_getGroupNotice",value:function(e){var t=e.length;if(m.l("".concat(this._n,"._getGroupNotice length:").concat(t)),t!==0){var n=this.get(7);if(t<=10)n.getNotice(e);else{var s=Math.floor(t/10);5<=s&&(s=5);for(var r=0;r<=s;r++)n.getNotice(e.slice(10*r,10*(r+1)))}}}},{key:"_getGroupRoamingMsg",value:function(n){var t=n.groupID,n=n.sequence;return this.req({P:E.GET_GRP_ROAMING_MSG,data:{groupID:t,count:this.PULL_LIMIT_COUNT,sequence:n+this.PULL_LIMIT_COUNT-1}})}},{key:"_recoverC2CMsg",value:function(e){var t=this,n="".concat(this._n,".").concat("_recoverC2CMsg"),s=(m.l("".concat(n," options:"),e),e.conversationID),r=e.localLastMessageTime,a=e.remoteLastMessageTime,l=JSON.stringify(e),d=new K("_recoverC2CMsg");return d.setMessage(l),this._getC2CRoamingMsg({conversationID:s,time:r}).then(function(_){var _=_.data,g=_.complete,_=_.messageList;if(!H(_)){var M=_.length,M=(t.get(6).onNewMessage({dataList:_,isInstantMessage:!0}),_[M-1].time),_=_.map(function(D){return D.random}),_="".concat(l," complete:").concat(g," randomList:").concat(_);if(m.l("".concat(n," ").concat(_)),d.setMessage(_).end(),M<a&&g!==1)return t._recoverC2CMsg({conversationID:s,localLastMessageTime:M,remoteLastMessageTime:a})}}).catch(function(h){d.setError(h).end(),m.w("".concat(n," failed. error:"),h)})}},{key:"_getC2CRoamingMsg",value:function(n){var t=n.conversationID,n=n.time;return this.req({P:E.GET_C2C_ROAMING_MSG,data:{peerAccount:t.replace(I.CONV_C2C,""),count:this.PULL_LIMIT_COUNT+1,lastMessageTime:n,direction:1}})}},{key:"reset",value:function(){m.l("".concat(this._n,".reset"))}}]),ii),qI=(y(Tl,[{key:"addMessageDelay",value:function(e){e=Mr()-e,0<=e&&this._e2eDelayArray.push(e)}},{key:"_calcAvg",value:function(e,t){if(t===0)return 0;var n=0;return e.forEach(function(s){n+=s}),$n(n/t,1)}},{key:"_calcCountWithLimit",value:function(e){var t=e.e2eDelayArray,n=e.min,s=e.max;return t.filter(function(r){return n<=r&&r<s}).length}},{key:"_calcPercent",value:function(e,t){return e=$n(e/t*100,2),e=100<e?100:e}},{key:"_checkE2EDelayException",value:function(e,t){var n,s,r,a=e.filter(function(l){return t<l});0<a.length&&(n=a.length,s=Math.min.apply(Math,q(a)),r=Math.max.apply(Math,q(a)),a=this._calcAvg(a,n),50<(e=$n(n/e.length*100,2))&&new K("messageE2EDelayException").setMessage("count:".concat(n," min:").concat(s," max:").concat(r," avg:").concat(a," percent:").concat(e)).setLevel("warning").end())}},{key:"getStatResult",value:function(){var e=this._e2eDelayArray.length;if(e===0)return null;var t=q(this._e2eDelayArray),n=this._calcCountWithLimit({e2eDelayArray:t,min:0,max:1}),s=this._calcCountWithLimit({e2eDelayArray:t,min:1,max:3}),r=this._calcPercent(n,e),a=this._calcPercent(s,e),l=this._calcAvg(t,e);return this._checkE2EDelayException(t,3),t.length=0,this.reset(),{totalCount:e,countLessThan1Second:n,percentOfCountLessThan1Second:r,countLessThan3Second:s,percentOfCountLessThan3Second:a,avgDelay:l}}},{key:"reset",value:function(){this._e2eDelayArray.length=0}}]),Tl),VI=(y(Cl,[{key:"addRequestCount",value:function(){this._requestCount+=1}},{key:"addRTT",value:function(e){this._rttArray.push(e)}},{key:"_calcTotalCount",value:function(){return this._requestCount}},{key:"_calcRTTCount",value:function(e){return e.length}},{key:"_calcSuccessRateOfRequest",value:function(e,t){return t===0?0:(e=$n(e/t*100,2),e=100<e?100:e)}},{key:"_calcAvg",value:function(e,t){if(t===0)return 0;var n=0;return e.forEach(function(s){n+=s}),parseInt(n/t)}},{key:"_calcMax",value:function(){return Math.max.apply(Math,q(this._rttArray))}},{key:"_calcMin",value:function(){return Math.min.apply(Math,q(this._rttArray))}},{key:"getStatResult",value:function(){var e=this._calcTotalCount(),s=q(this._rttArray);if(e===0)return null;var t=this._calcRTTCount(s),n=this._calcSuccessRateOfRequest(t,e),s=this._calcAvg(s,t);return m.l("".concat(this._n,".getStatResult max:").concat(this._calcMax()," min:").concat(this._calcMin()," avg:").concat(s)),this.reset(),{totalCount:e,rttCount:t,successRateOfRequest:n,avgRTT:s}}},{key:"reset",value:function(){this._requestCount=0,this._rttArray.length=0}}]),Cl),BI=(y(Ml,[{key:"initMap",value:function(e){var t=this;e.forEach(function(n){t._map.set(n,{totalCount:0,successCount:0,failedCountOfUserSide:0,costArray:[],fileSizeArray:[]})})}},{key:"addTotalCount",value:function(e){return!(H(e)||!this._map.has(e)||(this._map.get(e).totalCount+=1,0))}},{key:"addSuccessCount",value:function(e){return!(H(e)||!this._map.has(e)||(this._map.get(e).successCount+=1,0))}},{key:"addFailedCountOfUserSide",value:function(e){return!(H(e)||!this._map.has(e)||(this._map.get(e).failedCountOfUserSide+=1,0))}},{key:"addCost",value:function(e,t){return!(H(e)||!this._map.has(e)||(this._map.get(e).costArray.push(t),0))}},{key:"addFileSize",value:function(e,t){return!(H(e)||!this._map.has(e)||(this._map.get(e).fileSizeArray.push(t),0))}},{key:"_calcSuccessRateOfBusiness",value:function(e){return H(e)||!this._map.has(e)?-1:(e=this._map.get(e),e=$n(e.successCount/e.totalCount*100,2),e=100<e?100:e)}},{key:"_calcSuccessRateOfPlatform",value:function(n){if(H(n)||!this._map.has(n))return-1;var t=this._map.get(n),n=this._calcSuccessCountOfPlatform(n)/t.totalCount*100;return n=100<(n=$n(n,2))?100:n}},{key:"_calcTotalCount",value:function(e){return H(e)||!this._map.has(e)?-1:this._map.get(e).totalCount}},{key:"_calcSuccessCountOfBusiness",value:function(e){return H(e)||!this._map.has(e)?-1:this._map.get(e).successCount}},{key:"_calcSuccessCountOfPlatform",value:function(e){return H(e)||!this._map.has(e)?-1:(e=this._map.get(e),e.successCount+e.failedCountOfUserSide)}},{key:"_calcAvg",value:function(e){return H(e)||!this._map.has(e)?-1:e===yn?this._calcAvgSpeed(e):this._calcAvgCost(e)}},{key:"_calcAvgCost",value:function(e){var t=this._map.get(e).costArray.length;if(t===0)return 0;var n=0;return this._map.get(e).costArray.forEach(function(s){n+=s}),parseInt(n/t)}},{key:"_calcAvgSpeed",value:function(e){var t=0,n=0;return this._map.get(e).costArray.forEach(function(s){t+=s}),this._map.get(e).fileSizeArray.forEach(function(s){n+=s}),parseInt(1e3*n/t)}},{key:"getStatResult",value:function(e){var t=this._calcTotalCount(e);if(t===0)return null;var n=this._calcSuccessCountOfBusiness(e),s=this._calcSuccessRateOfBusiness(e),r=this._calcSuccessCountOfPlatform(e),a=this._calcSuccessRateOfPlatform(e),l=this._calcAvg(e);return this.reset(e),{totalCount:t,successCountOfBusiness:n,successRateOfBusiness:s,successCountOfPlatform:r,successRateOfPlatform:a,avgValue:l}}},{key:"reset",value:function(e){H(e)?this._map.clear():this._map.set(e,{totalCount:0,successCount:0,failedCountOfUserSide:0,costArray:[],fileSizeArray:[]})}}]),Ml),HI=(y(Il,[{key:"initMap",value:function(e){var t=this;e.forEach(function(n){t._lastMap.set(n,new Map),t._currentMap.set(n,new Map)})}},{key:"addMessageSequence",value:function(e){var t=e.key,r=e.message;if(H(t)||!this._lastMap.has(t)||!this._currentMap.has(t))return!1;var n,s,a=r.conversationID,r=r.sequence,a=a.replace(I.CONV_GROUP,"");return this._lastMap.get(t).size!==0&&this._lastMap.get(t).has(a)?(s=(n=this._lastMap.get(t).get(a)).length-1,r>n[0]&&r<n[s]?(n.push(r),n.sort(),this._lastMap.get(t).set(a,n)):this._addCurrentMap(e)):this._addCurrentMap(e),!0}},{key:"_addCurrentMap",value:function(n){var t=n.key,n=n.message,s=n.conversationID,n=n.sequence,s=s.replace(I.CONV_GROUP,"");this._currentMap.get(t).has(s)||this._currentMap.get(t).set(s,[]),this._currentMap.get(t).get(s).push(n)}},{key:"_copyData",value:function(e){if(!H(e)){this._lastMap.set(e,new Map);var t,n=this._lastMap.get(e),s=ye(this._currentMap.get(e));try{for(s.s();!(t=s.n()).done;){var r=te(t.value,2),a=r[0],l=r[1];n.set(a,l)}}catch(d){s.e(d)}finally{s.f()}n=null,this._currentMap.set(e,new Map)}}},{key:"getStatResult",value:function(e){if(H(this._currentMap.get(e))||H(this._lastMap.get(e)))return null;if(this._lastMap.get(e).size===0)return this._copyData(e),null;var t=0,n=0;if(this._lastMap.get(e).forEach(function(d,a){var d=q(d.values()),l=d.length,d=d[l-1]-d[0]+1;t+=d,n+=l}),t===0)return null;var s=$n(n/t*100,2);return 100<s&&(s=100),this._copyData(e),{totalCount:t,successCountOfMessageReceived:n,successRateOfMessageReceived:s}}},{key:"reset",value:function(){this._currentMap.clear(),this._lastMap.clear()}}]),Il),KI=(T(ri,St),zf=z(ri),y(ri,[{key:"_onLoginSuccess",value:function(){var e=this,t=(this._rateMessageSent.initMap(this._messageSentItems),this._rateMessageReceived.initMap(this._messageReceivedItems),this.get(13)),n=t.getItem(this.TAG,!1);!se(n)&&Yt(n.forEach)&&(m.l("".concat(this._n,"._onLoginSuccess. logs count:").concat(n.length)),n.forEach(function(s){e._statInfoArr.push(s)}),t.removeItem(this.TAG,!1))}},{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("q_rpt_interval"),t=this.getCloudConfig("q_rpt_sdkappid_bl"),n=this.getCloudConfig("q_rpt_tinyid_wl");H(e)||(this.REPORT_INTERVAL=Number(e)),H(t)||(this.REPORT_SDKAPPID_BLACKLIST=t.split(",").map(function(s){return Number(s)})),H(n)||(this.REPORT_TINYID_WHITELIST=n.split(","))}},{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&e%this.REPORT_INTERVAL==0&&(this.wholePeriod=!0,this._report())}},{key:"addRequestCount",value:function(){this._avgRTT.addRequestCount()}},{key:"addRTT",value:function(e){this._avgRTT.addRTT(e)}},{key:"addMessageDelay",value:function(e){this._avgE2EDelay.addMessageDelay(e)}},{key:"addTotalCount",value:function(e){this._rateMessageSent.addTotalCount(e)||m.w("".concat(this._n,".addTotalCount invalid key:"),e)}},{key:"addSuccessCount",value:function(e){this._rateMessageSent.addSuccessCount(e)||m.w("".concat(this._n,".addSuccessCount invalid key:"),e)}},{key:"addFailedCountOfUserSide",value:function(e){this._rateMessageSent.addFailedCountOfUserSide(e)||m.w("".concat(this._n,".addFailedCountOfUserSide invalid key:"),e)}},{key:"addCost",value:function(e,t){this._rateMessageSent.addCost(e,t)||m.w("".concat(this._n,".addCost invalid key or cost:"),e,t)}},{key:"addFileSize",value:function(e,t){this._rateMessageSent.addFileSize(e,t)||m.w("".concat(this._n,".addFileSize invalid key or size:"),e,t)}},{key:"addMessageSequence",value:function(e){this._rateMessageReceived.addMessageSequence(e)||m.w("".concat(this._n,".addMessageSequence invalid key:"),e.key)}},{key:"_getQualityItem",value:function(e){var t={},n=df[this.get(15).getNetworkType()],n=(H(n)&&(n=8),{qualityType:Cy[e],timestamp:Wn(),networkType:n,extension:""});switch(e){case Jc:t=this._avgRTT.getStatResult();break;case Xc:t=this._avgE2EDelay.getStatResult();break;case Ks:case js:case Ws:case is:case yn:t=this._rateMessageSent.getStatResult(e);break;case Ys:case Nr:case Pr:t=this._rateMessageReceived.getStatResult(e)}return t===null?null:c(c({},n),t)}},{key:"_report",value:function(a){var t=this,n=[],s=null,a=(H(a)?this._qualityItems.forEach(function(l){(s=t._getQualityItem(l))!==null&&(s.reportIndex=t.reportIndex,s.wholePeriod=t.wholePeriod,n.push(s))}):(s=this._getQualityItem(a))!==null&&(s.reportIndex=this.reportIndex,s.wholePeriod=this.wholePeriod,n.push(s)),m.d("".concat(this._n,"._report"),n),0<this._statInfoArr.length&&(n=n.concat(this._statInfoArr),this._statInfoArr=[]),this.get(12)),r=a.getSDKAppID(),a=a.getTinyID();0<(n=$p(this.REPORT_SDKAPPID_BLACKLIST,r)&&!Jp(this.REPORT_TINYID_WHITELIST,a)?[]:n).length&&this._doReport(n)}},{key:"_doReport",value:function(e){var t=this,n={header:Sf(this),quality:e};this.req({P:E.SSO_STAT,data:c({},n)}).then(function(){t.reportIndex++,t.wholePeriod=!1}).catch(function(s){m.w("".concat(t._n,"._doReport failed. error:"),s),t._statInfoArr=t._statInfoArr.concat(e),t._flushAtOnce()})}},{key:"_flushAtOnce",value:function(){var e=this.get(13),t=e.getItem(this.TAG,!1),n=this._statInfoArr,s="".concat(this._n,"._flushAtOnce");se(t)?(m.l("".concat(s," count:").concat(n.length)),e.setItem(this.TAG,n,!0,!1)):(10<(n=n.concat(t)).length&&(n=n.slice(0,10)),m.l("".concat(s," count:").concat(n.length)),e.setItem(this.TAG,n,!0,!1)),this._statInfoArr=[]}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._report(),this.reportIndex=0,this.wholePeriod=!1,this.REPORT_SDKAPPID_BLACKLIST=[],this.REPORT_TINYID_WHITELIST=[],this._avgRTT.reset(),this._avgE2EDelay.reset(),this._rateMessageSent.reset(),this._rateMessageReceived.reset()}}]),ri),Zf=y(function e(t){f(this,e),se(t)||(this.userID=t.userID||"",this.nick=t.nick||"",this.avatar=t.avatar||"",this.time=t.time||0,this.source=t.source||"",this.wording=t.wording||"",this.type=t.type||"")}),jI=(y(yl,[{key:"getLocalApplicationList",value:function(){return{friendApplicationList:q(this._map.values()),unreadCount:this._unreadCount}}},{key:"_onApplicationListUpdated",value:function(){this._snsM.emitOEvt($.FRIEND_APPLICATION_LIST_UPDATED,{friendApplicationList:q(this._map.values()),unreadCount:this._unreadCount})}},{key:"onApplicationRead",value:function(){this._unreadCount=0,this._onApplicationListUpdated()}},{key:"onApplicationAdded",value:function(e,t){var n,s,r=this;se(e)||(n="",n=t===this._snsM.getMyUserID()?I.SNS_APPLICATION_SENT_BY_ME:I.SNS_APPLICATION_SENT_TO_ME,s=!1,e.forEach(function(a){var l="".concat(a.userID,"_").concat(n);n!==I.SNS_APPLICATION_SENT_TO_ME||r._map.has(l)||(r._unreadCount+=1),r._map.set(l,new Zf(c(c({},a),{},{type:n}))),s=!0}),s&&this._onApplicationListUpdated())}},{key:"onApplicationDeleted",value:function(e){se(e)||(this._startTime=0,this._currentSeq=0,this.getApplicationList())}},{key:"getApplicationList",value:function(){var e=this,t="".concat(this._n,".").concat("getApplicationList"),n=new K("getApplicationList");return this._snsM.req({P:E.GET_FD_APPLICATION_LIST,data:{applicationType:I.SNS_APPLICATION_TYPE_BOTH,fromAccount:this._snsM.getMyUserID(),maxLimited:this._maxLimited,startTime:this._startTime,lastSequence:this._currentSeq}}).then(function(d){var d=d.data,r=d.resultList,a=d.unreadCount,l=d.startTime,d=d.currentSequence,h=(e._startTime=l,e._currentSeq=d,e._unreadCount=a,_e(r)?r.length:0),h="applicationCount:".concat(h," unreadCount:").concat(a," startTime:").concat(l," currentSequence:").concat(d);n.setMessage(h).end(),m.i("".concat(t," ok. ").concat(h)),e._map.clear(),_e(r)&&r.forEach(function(S){var _=S.userID,M=S.type,S=new Zf(S);e._map.set("".concat(_,"_").concat(M),S)}),e._onApplicationListUpdated()}).catch(function(s){return n.setError(s).end(),m.w("".concat(t," failed. error:"),s),A(s)})}},{key:"deleteApplication",value:function(e){var t="".concat(this._n,".").concat("deleteApplication"),n=e.userID,s=e.type;if(s&&(s===I.SNS_APPLICATION_SENT_BY_ME||s===I.SNS_APPLICATION_SENT_TO_ME)||(s=I.SNS_APPLICATION_SENT_TO_ME),!this._map.has("".concat(n,"_").concat(s)))return A({code:F.FRIEND_APPLICATION_NOT_EXIST});var r=new K("deleteApplication");return r.setMessage("userID:".concat(n," type:").concat(s)),this._snsM.req({P:E.DEL_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),userIDList:[n],type:s}}).then(function(l){var l=l.data.resultList,g=l[0],d=g.to,h=g.resultCode,g=g.resultInfo;return r.setMoreMessage("resultList:".concat(JSON.stringify(l))).end(),m.i("".concat(t," ok. userID:").concat(n," type:").concat(s)),h===0?me():A({userID:d,code:h,message:g})}).catch(function(a){return r.setError(a).end(),m.w("".concat(t," failed. error:"),a),A(a)})}},{key:"acceptApplication",value:function(e){var t="".concat(this._n,".").concat("acceptApplication"),n=e.userID,s=e.remark,r=e.tag,a=e.type,l=(a&&(a===I.SNS_APPLICATION_AGREE||a===I.SNS_APPLICATION_AGREE_AND_ADD)||(a=I.SNS_APPLICATION_AGREE_AND_ADD),new K("acceptApplication"));return l.setMessage("userID:".concat(n," type:").concat(a)),this._snsM.req({P:E.RESPOND_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),responseFriendItem:[{userID:n,remark:s,tag:r,action:a}]}}).then(function(g){l.end();var g=g.data.resultList[0],h=g.resultCode,g=g.resultInfo;if(h!==0)return A({code:h,message:g});m.i("".concat(t," ok. userID:").concat(n," type:").concat(a))}).catch(function(d){return l.setError(d).end(),m.w("".concat(t," failed. error:"),d),A(d)})}},{key:"refuseApplication",value:function(e){var t="".concat(this._n,".").concat("refuseApplication"),n=e.userID,s=new K("refuseApplication");return s.setMessage("userID:".concat(n)),this._snsM.req({P:E.RESPOND_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),responseFriendItem:[{userID:n,action:"Response_Action_Reject"}]}}).then(function(l){s.end();var l=l.data.resultList[0],a=l.resultCode,l=l.resultInfo;if(a!==0)return A({code:a,message:l});m.i("".concat(t," ok. userID:").concat(n))}).catch(function(r){return s.setError(r).end(),m.w("".concat(t," failed. error:"),r),A(r)})}},{key:"setApplicationRead",value:function(){var e=this,t="".concat(this._n,".").concat("setApplicationRead"),n=new K("setApplicationRead");return this._snsM.req({P:E.REPORT_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),latestTimeStamp:$n(Wn()/1e3,0)}}).then(function(s){n.end(),m.i("".concat(t," ok")),e._unreadCount=0}).catch(function(s){return n.setError(s).end(),m.w("".concat(t," failed. error:"),s),A(s)})}},{key:"reset",value:function(){this._maxLimited=100,this._currentSeq=0,this._unreadCount=0,this._map.clear()}}]),yl),al=(y(vl,[{key:"validate",value:function(e){var t,n=!0,s="";if(se(e))return{valid:!1,tips:"empty options"};if(e.profileCustomField)for(var r=e.profileCustomField.length,a=null,l=0;l<r;l++){if(a=e.profileCustomField[l],!xe(a.key)||a.key.indexOf("Tag_Profile_Custom")===-1)return{valid:!1,tips:"The prefix of keys of the custom profile key-value pairs (which is profileCustomField) must be Tag_Profile_Custom"};if(!xe(a.value))return{valid:!1,tips:"The type of values of the custom profile key-value pairs (which is profileCustomField) must be String"}}for(t in e)if(Object.prototype.hasOwnProperty.call(e,t)){if(t==="profileCustomField")continue;if(se(e[t])&&!xe(e[t])&&!Qe(e[t])){s="key:"+t+", invalid value:"+e[t],n=!1;continue}switch(t){case"nick":xe(e[t])||(n=!(s="nick must be a string")),500<sa(e[t])&&(s="nick name limited: must less than or equal to ".concat(500," bytes, current size: ").concat(sa(e[t])," bytes"),n=!1);break;case"gender":ws(bp,e.gender)||(s="key:gender, invalid value:"+e.gender,n=!1);break;case"birthday":Qe(e.birthday)||(n=!(s="birthday must be a number"));break;case"location":xe(e.location)||(n=!(s="location must be a string"));break;case"selfSignature":xe(e.selfSignature)||(n=!(s="selfSignature must be a string"));break;case"allowType":ws(wp,e.allowType)||(s="key:allowType, invalid value:"+e.allowType,n=!1);break;case"language":Qe(e.language)||(n=!(s="language must be a number"));break;case"avatar":xe(e.avatar)||(n=!(s="avatar must be a string"));break;case"messageSettings":e.messageSettings!==0&&e.messageSettings!==1&&(n=!(s="messageSettings must be 0 or 1"));break;case"adminForbidType":ws(Gp,e.adminForbidType)||(s="key:adminForbidType, invalid value:"+e.adminForbidType,n=!1);break;case"level":Qe(e.level)||(n=!(s="level must be a number"));break;case"role":Qe(e.role)||(n=!(s="role must be a number"));break;default:s="unknown key:"+t+"  "+e[t],n=!1}}return{valid:n,tips:s}}},{key:"update",value:function(e){var t,n="",s=[];this.friendCustomField.forEach(function(d){s.push(d.key)});for(var r=0,a=e.length;r<a;r++)if(n=e[r].tag,t=e[r].value,-1<n.indexOf("Tag_SNS_Custom"))-1<s.indexOf(n)?this.friendCustomField.forEach(function(d){d.key===n&&(d.value=t)}):this.friendCustomField.push({key:n,value:t});else if(-1<n.indexOf("Tag_Profile_Custom")){var l=!1;this.profile.profileCustomField.forEach(function(d){d.key===n&&(d.value=t,l=!0)}),l||this.profile.profileCustomField.push({key:n,value:t})}else switch(n){case Ve.NICK:this.profile.nick=t;break;case Ve.GENDER:this.profile.gender=t;break;case Ve.BIRTHDAY:this.profile.birthday=t;break;case Ve.LOCATION:this.profile.location=t;break;case Ve.SELFSIGNATURE:this.profile.selfSignature=t;break;case Ve.ALLOWTYPE:this.profile.allowType=t;break;case Ve.LANGUAGE:this.profile.language=t;break;case Ve.AVATAR:this.profile.avatar=t;break;case Ve.MESSAGESETTINGS:this.profile.messageSettings=t;break;case Ve.ADMINFORBIDTYPE:this.profile.adminForbidType=t;break;case Ve.LEVEL:this.profile.level=t;break;case Ve.ROLE:this.profile.role=t;break;case Yn.REMARK:this.remark=t;break;case Yn.ADDTIME:this.addTime=t;break;case Yn.GROUP:this.groupList=JSON.parse(JSON.stringify(t));break;case Yn.ADDSOURCE:this.source=t;break;case Yn.ADDWORDING:break;default:m.d("snsProfileItem unkown tag->",e[r].tag)}this.timestamp=Date.now(),s.length=0}},{key:"updateProfile",value:function(e){this.profile=JSON.parse(JSON.stringify(e)),this.timestamp=Date.now()}},{key:"addToGroupList",value:function(e){this.groupList.indexOf(e)===-1&&(this.groupList.push(e),this.count=this.groupList.length)}},{key:"removeFromGroupList",value:function(e){e=this.groupList.indexOf(e),-1<e&&(this.groupList.splice(e,1),this.count=this.groupList.length)}}]),vl),WI=(y(ml,[{key:"getLocalFriendList",value:function(){return q(this._map.values())}},{key:"getFriendRemark",value:function(e){return this._map.has(e)?this._map.get(e).remark:""}},{key:"onFriendProfileModified",value:function(s){var t,n=this,s=s.dataList;se(s)||(t=this._snsM.get(11),s.forEach(function(d){var a,l=d.userID,d=d.profileList;n.isMyFriend(l)&&(m.l("".concat(n._n,".onFriendProfileModified. friend account:").concat(l,", profileList:").concat(JSON.stringify(d))),(a=n._map.get(l)).update(d),t.modifyMessageSentByPeer({conversationID:"".concat(I.CONV_C2C).concat(l),latestNick:a.profile.nick,latestAvatar:a.profile.avatar}))}),this._onFriendListUpdated())}},{key:"onFriendAdded",value:function(e){var t=this;e.length!==0&&(m.l("".concat(this._n,".onFriendAdded userIDList:").concat(e)),e.forEach(function(n){t._map.set(n,new al(n))}),this.getFriendProfile({userIDList:e}).then(function(n){e.forEach(function(s){var r=t._map.get(s);0<r.groupList.length&&t._snsM.updateWhenFriendAdded({nameList:r.groupList,userID:s})}),t._onFriendListUpdated()}))}},{key:"onFriendDeleted",value:function(e){var t=this;e.length!==0&&(m.l("".concat(this._n,".onFriendDeleted userIDList:").concat(e)),e.forEach(function(n){var s=t._map.get(n);0<s.groupList.length&&t._snsM.updateWhenFriendDeleted({nameList:s.groupList,userID:n}),t._map.delete(n)}),this._onFriendListUpdated())}},{key:"_onFriendListUpdated",value:function(){this._snsM.emitOEvt($.FRIEND_LIST_UPDATED),this._snsM.get(11).checkAndPatchRemark()}},{key:"getFriendProfile",value:function(s){var t=this,n="".concat(this._n,".").concat("getFriendProfile"),s=s.userIDList,r=[],a=[],l=[];if(s.forEach(function(h){var g;t._map.has(h)?(g=t._map.get(h),Date.now()-g.timestamp<t._expirationTime?a.push(g):l.push(h)):r.push({userID:h,code:F.NOT_MY_FRIEND,message:t._snsM.getErrMsg(F.NOT_MY_FRIEND)})}),l.length===0)return m.i("".concat(n," newUserIDList is empty")),Pe({friendList:a,failureUserIDList:r});var d=new K("getFriendProfile");return d.setMessage("userIDList:".concat(l)),m.i("".concat(n," userIDList:").concat(l)),this._snsM.req({P:E.GET_FD_PROFILE,data:{fromAccount:this._snsM.getMyUserID(),userIDList:l}}).then(function(h){return d.end(),m.i("".concat(n," ok")),h.data.resultList.forEach(function(O){var _,M=O.to,S=O.resultCode,D=O.resultInfo,O=O.tagValueList;H(S)||S===0?(t._map.has(M)?(_=t._map.get(M)).update(O):(_=new al(M,O),t._map.set(M,_)),a.push(_)):r.push({userID:M,code:S,message:D})}),me({friendList:a,failureUserIDList:r})}).catch(function(h){return d.setError(h).end(),m.w("".concat(n," failed. error:"),h),A(h)})}},{key:"isMyFriend",value:function(e){return this._map.has(e)}},{key:"pagingGetFriendList",value:function(){var e=this,t="".concat(this._n,".").concat("getFriendList"),n=new K("getFriendList"),s=Date.now();this._snsM.req({P:E.GET_FD_LIST,data:{fromAccount:this._snsM.getMyUserID(),startIndex:this._startIdx,standardSequence:this._standardSeq,customSequence:this._customSeq}}).then(function(g){var g=g.data,_=g.friendCount,a=g.resultList,l=g.nextStartIndex,d=g.standardSequence,h=g.customSequence,g=g.completeFlag,_=(e._startIdx=l,e._standardSeq=d,e._customSeq=h,"friendCount:".concat(_," nextStartIndex:").concat(l," standardSequence:").concat(d," ")+"customSequence:".concat(h," completeFlag:").concat(g," cost:").concat(Kt(s)));n.setMessage(_).end(),m.i("".concat(t," ok."),_),se(a)||a.forEach(function(D){var S=D.to,D=D.tagValueList;e._map.set(S,new al(S,D))}),g===0?e.pagingGetFriendList():(e._snsM.emitOEvt($.FRIEND_LIST_UPDATED),e._pagingGetFriendProfile())}).catch(function(r){return n.setError(r).end(),m.w("".concat(t," failed. error:"),r),A(r)})}},{key:"_pagingGetFriendProfile",value:function(){var e=this,t=q(this._map.keys()),n=this._snsM.get(4),s=t.length,r=s<=100?1:Math.ceil(s/100);m.l("".concat(this._n,"._pagingGetFriendProfile friendCount:").concat(s," pageCount:").concat(r));for(var a=0;a<r;a++)n.getUserProfile({userIDList:t.slice(100*a,100*(a+1))}).then(function(l){l.data.forEach(function(d){var h=e._map.get(d.userID);h&&h.updateProfile(d)}),e._onFriendListUpdated()})}},{key:"addFriend",value:function(h){var t=this,n="".concat(this._n,".").concat("addFriend");if(this._map.has(h.to))return A({code:F.ALREADY_MY_FRIEND});if(h.wording&&this._snsM.filterProfanity("wording",h)===!1)return A({code:F.PROFANITY_FOUND});var s=h.to,r=h.source,a=h.type,l=h.wording,d=h.remark,h=h.groupName,g=a,_=(g&&(g===I.SNS_ADD_TYPE_SINGLE||g===I.SNS_ADD_TYPE_BOTH)||(g=I.SNS_ADD_TYPE_BOTH),new K("addFriend"));return _.setMessage("to:".concat(s," source:").concat(r," type:").concat(g)),this._snsM.req({P:E.ADD_FD,data:{fromAccount:this._snsM.getMyUserID(),addFriendItem:[{to:s,source:r,wording:l,remark:d,groupName:h}],type:g}}).then(function(O){var O=O.data.resultList,O=(_.setMoreMessage("resultList:".concat(JSON.stringify(O))).end(),O[0]),S=O.to,D=O.resultCode,O=O.resultInfo;return m.i("".concat(n," ok. to:").concat(S," type:").concat(g," code:").concat(D)),H(D)||D===0?me({userID:S,code:0}):D===30539?me({userID:S,code:D,message:t._snsM.getErrMsg(D)}):A({userID:S,code:D,message:t._snsM.getErrMsg(D)||O})}).catch(function(M){return _.setError(M).end(),m.w("".concat(n," failed. error:"),M),A(M)})}},{key:"deleteFriend",value:function(s){var t=this,n="".concat(this._n,".").concat("deleteFriend"),d=s.userIDList,s=s.type,r=(1e3<d.length&&(m.w("".concat(n," ").concat(os(1e3))),d.length=1e3),[]),a=[],l=[];if(d.forEach(function(g){t._map.has(g)?l.push(g):r.push({userID:g,code:F.NOT_MY_FRIEND,message:t._snsM.getErrMsg(F.NOT_MY_FRIEND)})}),l.length===0)return Pe({successUserIDList:a,failureUserIDList:r});var d=s,h=(d&&(d===I.SNS_DELETE_TYPE_SINGLE||d===I.SNS_DELETE_TYPE_BOTH)||(d=I.SNS_DELETE_TYPE_BOTH),new K("deleteFriend"));return h.setMessage("userIDList:".concat(l," type:").concat(d)),this._snsM.req({P:E.DEL_FD,data:{fromAccount:this._snsM.getMyUserID(),userIDList:l,type:d}}).then(function(g){return h.end(),m.i("".concat(n," ok")),g=g.data.resultList,se(g)||g.forEach(function(D){var M=D.to,S=D.resultCode,D=D.resultInfo;H(S)||S===0?a.push({userID:M}):r.push({userID:M,code:S,message:D})}),me({successUserIDList:a,failureUserIDList:r})}).catch(function(g){return h.setError(g).end(),m.w("".concat(n," error:"),g),A(g)})}},{key:"updateFriend",value:function(e){var t=this,n=e.userID,s=e.remark,r=e.friendCustomField;if(!this._map.has(n))return A({code:F.NOT_MY_FRIEND});var a="".concat(this._n,".").concat("updateFriend"),l=new K("updateFriend"),d=(l.setMessage("userID:".concat(n," remark:").concat(s," friendCustomField:").concat(r)),[]);return H(s)||d.push({tag:Yn.REMARK,value:s}),_e(r)&&0<r.length&&r.forEach(function(h){d.push({tag:h.key,value:h.value})}),this._snsM.req({P:E.UPDATE_FD,data:{fromAccount:this._snsM.getMyUserID(),updateItem:[{to:n,snsItem:d}]}}).then(function(M){l.end(),m.i("".concat(a," ok"));var M=M.data.resultList[0],g=M.to,_=M.resultCode,M=M.resultInfo;return H(_)||_===0?((g=t._map.get(g))&&(H(s)||(g.remark=s),_e(r)&&0<r.length&&Dr(g.friendCustomField,r),t._onFriendListUpdated()),me(g)):A({code:_,message:M})}).catch(function(h){return l.setError(h).end(),m.w("".concat(a," failed. error:"),h),A(h)})}},{key:"checkFriend",value:function(e){var t="".concat(this._n,".").concat("checkFriend"),n=e.userIDList,s=e.type,r=(s&&(s===I.SNS_CHECK_TYPE_SINGLE||s===I.SNS_CHECK_TYPE_BOTH)||(s=I.SNS_CHECK_TYPE_BOTH),new K("checkFriend"));return r.setMessage("userIDList:".concat(n," type:").concat(s)),this._snsM.req({P:E.CHECK_FD,data:{fromAccount:this._snsM.getMyUserID(),userIDList:n,type:s}}).then(function(h){r.end(),m.i("".concat(t," ok. userIDList:").concat(n," type:").concat(s));var l=[],d=[],h=h.data.resultList;return _e(h)&&h.forEach(function(D){var _=D.to,M=D.relation,S=D.resultCode,D=D.resultInfo;H(S)||S===0?l.push({userID:_,code:0,relation:M}):d.push({userID:_,code:S,message:D})}),me({successUserIDList:l,failureUserIDList:d})}).catch(function(a){return r.setError(a).end(),m.w("".concat(t," failed. error:"),a),A(a)})}},{key:"onAddedToFriendGroup",value:function(s){var t=this,n=s.name,s=s.userIDList;m.l("".concat(this._n,".onAddedToFriendGroup groupName:").concat(n," userIDList:").concat(s)),n&&!se(s)&&s.forEach(function(r){t._map.has(r)&&t._map.get(r).addToGroupList(n)})}},{key:"onRemovedFromFriendGroup",value:function(s){var t=this,n=s.name,s=s.userIDList;m.l("".concat(this._n,".onRemovedFromFriendGroup groupName:").concat(n," userIDList:").concat(s)),n&&!se(s)&&s.forEach(function(r){t._map.has(r)&&t._map.get(r).removeFromGroupList(n)})}},{key:"reset",value:function(){this._map.clear(),this._startIdx=0,this._standardSeq=0,this._customSeq=0}}]),ml),Qf=(y(_l,[{key:"addToUserIDList",value:function(e){this.userIDList.indexOf(e)===-1&&(this.userIDList.push(e),this.count=this.userIDList.length)}},{key:"removeFromUserIDList",value:function(e){e=this.userIDList.indexOf(e),-1<e&&(this.userIDList.splice(e,1),this.count=this.userIDList.length)}}]),_l),YI=(y(gl,[{key:"getLocalGroupList",value:function(){return q(this._map.values())}},{key:"_onGroupListUpdated",value:function(){var e=q(this._map.values());this._snsM.emitOEvt($.FRIEND_GROUP_LIST_UPDATED,e)}},{key:"getGroupList",value:function(){var e=this,t="".concat(this._n,".").concat("getGroupList"),n=new K("getGroupList");return this._snsM.req({P:E.GET_FD_GRP_LIST,data:{fromAccount:this._snsM.getMyUserID()}}).then(function(s){n.end(),s=s.data.resultList,se(s)?m.i("".concat(t," ok. count:0")):(m.i("".concat(t," ok. count:").concat(s.length)),e._map.clear(),s.forEach(function(r){var a=new Qf(r);e._map.set(r.name,a)}),e._onGroupListUpdated())}).catch(function(s){return n.setError(s).end(),m.w("".concat(t," error:"),s),A(s)})}},{key:"createGroup",value:function(r){var t=this,n="".concat(this._n,".").concat("createGroup"),s=r.name,r=r.userIDList;if(this._map.has(s))return A({code:F.FRIEND_GRP_EXISTED});var a="name:".concat(s," userIDList:").concat(r),l=new K("createGroup");return l.setMessage(a),this._snsM.req({P:E.CREATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),groupName:[s],userIDList:_e(r)?r:void 0}}).then(function(_){l.end(),m.l("".concat(n," ok. ").concat(a));var _=_.data.resultList,h=[],g=[],_=(_&&_.forEach(function(M){var S=M.to,D=M.resultCode,O=M.resultInfo;H(D)||D===0?h.push(S):(S={userID:M.to,code:D,message:O},g.push(S))}),new Qf({name:s,userIDList:h}));return t._map.set(s,_),t._snsM.onAddedToFriendGroup({name:s,userIDList:h}),t._onGroupListUpdated(),me({friendGroup:_,failureUserIDList:g})}).catch(function(d){return l.setError(d).end(),m.w("".concat(n," failed. error:"),d),A(d)})}},{key:"deleteGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteGroup"),s=e.name;if(!this._map.has(s))return this._onGroupNotExist();var r="name:".concat(s),a=new K("deleteGroup");return a.setMessage(r),this._snsM.req({P:E.DEL_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),nameList:[s]}}).then(function(l){a.end(),m.l("".concat(n," ok. ").concat(r));var d=t._map.get(s);return d&&(t._snsM.onRemovedFromFriendGroup({name:s,userIDList:d.userIDList}),t._map.delete(s),d.userIDList.length=0),t._onGroupListUpdated(),me(d)}).catch(function(l){return a.setError(l).end(),m.w("".concat(n," failed. error:"),l),A(l)})}},{key:"renameGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("renameGroup"),s=e.oldName,r=e.newName;if(!this._map.has(s))return this._onGroupNotExist();var a="oldName:".concat(s," newName:").concat(r),l=new K("renameGroup");return l.setMessage(a),this._snsM.req({P:E.UPDATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),oldName:s,newName:r}}).then(function(){var d;return l.end(),m.l("".concat(n," ok. ").concat(a)),t._map.has(s)?((d=t._map.get(s)).name=r,t._map.delete(s),t._map.set(r,d),t._snsM.onRemovedFromFriendGroup({name:s,userIDList:d.userIDList}),t._snsM.onAddedToFriendGroup({name:r,userIDList:d.userIDList}),t._onGroupListUpdated(),me(d)):me()}).catch(function(d){return l.setError(d).end(),m.w("".concat(n," failed. error:"),d),A(d)})}},{key:"addToGroup",value:function(r){var t=this,n="".concat(this._n,".").concat("addToGroup"),s=r.name,r=r.userIDList;if(!this._map.has(s))return this._onGroupNotExist();var a="name:".concat(s," userIDList:").concat(r),l=new K("addToGroup");return l.setMessage(a),this._snsM.req({P:E.UPDATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),oldName:s,updateGroupItem:r.filter(function(d){return t._snsM.isMyFriend(d)}).map(function(d){return{to:d,updateType:"Update_Type_Add"}})}}).then(function(d){return l.end(),m.l("".concat(n," ok. ").concat(a)),t._onGroupUpdated(s,d)}).catch(function(d){return l.setError(d).end(),m.w("".concat(n," failed. error:"),d),A(d)})}},{key:"removeFromGroup",value:function(r){var t=this,n="".concat(this._n,".").concat("removeFromGroup"),s=r.name,r=r.userIDList;if(!this._map.has(s))return this._onGroupNotExist();var a="name:".concat(s," userIDList:").concat(r),l=new K("removeFromGroup");return l.setMessage(a),this._snsM.req({P:E.UPDATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),oldName:s,updateGroupItem:r.filter(function(d){return t._snsM.isMyFriend(d)}).map(function(d){return{to:d,updateType:"Update_Type_Delete"}})}}).then(function(d){return l.end(),m.l("".concat(n," ok. ").concat(a)),t._onGroupUpdated(s,d)}).catch(function(d){return l.setError(d).end(),m.w("".concat(n," failed. error:"),d),A(d)})}},{key:"_onGroupUpdated",value:function(e,n){var n=n.data.resultList,s=this._map.get(e),r=[],a=[],l=[];return _e(n)&&n.forEach(function(d){var h=d.to,g=d.resultCode,_=d.resultInfo,M=d.type;g===0?M==="Update_Type_Add"?s&&(s.addToUserIDList(h),a.push(h)):M==="Update_Type_Delete"&&s&&(s.removeFromUserIDList(h),l.push(h)):r.push({to:d.to,code:g,message:_})}),m.l("".concat(this._n,"._onGroupUpdated name:").concat(e," userIDList:").concat(s.userIDList)),0<a.length&&this._snsM.onAddedToFriendGroup({name:e,userIDList:a}),0<l.length&&this._snsM.onRemovedFromFriendGroup({name:e,userIDList:l}),me({friendGroup:s,failureUserIDList:r})}},{key:"updateWhenFriendAdded",value:function(e){var t=this,n=e.nameList,s=e.userID;m.l("".concat(this._n,".updateWhenFriendAdded userID:").concat(s," nameList:").concat(n)),se(n)||n.forEach(function(r){t._map.has(r)&&t._map.get(r).addToUserIDList(s)})}},{key:"updateWhenFriendDeleted",value:function(e){var t=this,n=e.nameList,s=e.userID;m.l("".concat(this._n,".updateWhenFriendDeleted userID:").concat(s," nameList:").concat(n)),se(n)||n.forEach(function(r){t._map.has(r)&&t._map.get(r).removeFromUserIDList(s)})}},{key:"_onGroupNotExist",value:function(e){return A({code:F.FRIEND_GRP_NOT_EXIST})}},{key:"reset",value:function(){this._map.clear()}}]),gl),zI=(T(si,St),Yf=z(si),y(si,[{key:"onContextUpdated",value:function(e){this._friendHandler.pagingGetFriendList(),this._friendGroupHandler.getGroupList(),this._friendApplicationHandler.getApplicationList()}},{key:"onRelationChainModified",value:function(h){var t,n,s,r,a,l,d=this,h=h.dataList;se(h)||(t=[],n=[],s=[],a=!(r=[]),l="",h.forEach(function(g){var _;g.pushType!==3&&g.pushType!==4||!g.from||(l=g.from),g.friendAddAccount&&(t.push.apply(t,q(g.friendAddAccount)),r.push.apply(r,q(g.friendAddAccount))),g.friendDelAccount&&n.push.apply(n,q(g.friendDelAccount)),g.friendApplicationAdded&&s.push.apply(s,q(g.friendApplicationAdded)),g.friendApplicationDeletedUserIDList&&r.push.apply(r,q(g.friendApplicationDeletedUserIDList)),g.reportTime&&g.pushType===7&&(a=!0),g.friendUpInfo&&(_={dataList:[]},g.friendUpInfo.forEach(function(M){_.dataList.push({userID:M.friendAccount,profileList:q(M.sns)})}),d.onFriendProfileModified(_))}),a&&this._friendApplicationHandler.onApplicationRead(),this._friendApplicationHandler.onApplicationAdded(s,l),this._friendApplicationHandler.onApplicationDeleted(r),this._friendHandler.onFriendAdded(t),this._friendHandler.onFriendDeleted(n))}},{key:"isMyFriend",value:function(e){return this._friendHandler.isMyFriend(e)}},{key:"filterProfanity",value:function(e,t){var s=this.get(29);if(!s)return!0;var s=s.filterText(t[e],"sns"),n=s.isAllowedToSend,s=s.modifiedText;return n===!0&&(t[e]=s,!0)}},{key:"onFriendProfileModified",value:function(e){this._friendHandler.onFriendProfileModified(e)}},{key:"getLocalFriendList",value:function(){var e=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],t=this._friendHandler.getLocalFriendList();return e?Pe(t):t}},{key:"getFriendRemark",value:function(e){return this._friendHandler.getFriendRemark(e)}},{key:"getFriendList",value:function(){return this._friendHandler.pagingGetFriendList()}},{key:"addFriend",value:function(e){return this._friendHandler.addFriend(e)}},{key:"deleteFriend",value:function(e){return this._friendHandler.deleteFriend(e)}},{key:"checkFriend",value:function(e){return this._friendHandler.checkFriend(e)}},{key:"getFriendProfile",value:function(e){return this._friendHandler.getFriendProfile(e)}},{key:"updateFriend",value:function(e){return this._friendHandler.updateFriend(e)}},{key:"onAddedToFriendGroup",value:function(e){this._friendHandler.onAddedToFriendGroup(e)}},{key:"onRemovedFromFriendGroup",value:function(e){this._friendHandler.onRemovedFromFriendGroup(e)}},{key:"getLocalFriendApplicationList",value:function(){var e=this._friendApplicationHandler.getLocalApplicationList();return Pe(e)}},{key:"deleteFriendApplication",value:function(e){return this._friendApplicationHandler.deleteApplication(e)}},{key:"refuseFriendApplication",value:function(e){return this._friendApplicationHandler.refuseApplication(e)}},{key:"acceptFriendApplication",value:function(e){return this._friendApplicationHandler.acceptApplication(e)}},{key:"setFriendApplicationRead",value:function(e){return this._friendApplicationHandler.setApplicationRead(e)}},{key:"getLocalFriendGroupList",value:function(){var e=this._friendGroupHandler.getLocalGroupList();return Pe(e)}},{key:"createFriendGroup",value:function(e){return this._friendGroupHandler.createGroup(e)}},{key:"deleteFriendGroup",value:function(e){return this._friendGroupHandler.deleteGroup(e)}},{key:"addToFriendGroup",value:function(e){return this._friendGroupHandler.addToGroup(e)}},{key:"removeFromFriendGroup",value:function(e){return this._friendGroupHandler.removeFromGroup(e)}},{key:"renameFriendGroup",value:function(e){return this._friendGroupHandler.renameGroup(e)}},{key:"updateWhenFriendAdded",value:function(e){this._friendGroupHandler.updateWhenFriendAdded(e)}},{key:"updateWhenFriendDeleted",value:function(e){this._friendGroupHandler.updateWhenFriendDeleted(e)}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._friendHandler.reset(),this._friendGroupHandler.reset(),this._friendApplicationHandler.reset()}}]),si),$I=(T(oi,St),Wf=z(oi),y(oi,[{key:"isWorkerEnabled",value:function(){return this._isWorkerEnabled&&Gn}},{key:"startWorkerTimer",value:function(){m.l("".concat(this._n,".startWorkerTimer")),this._workerTimer&&this._workerTimer.postMessage("start")}},{key:"stopWorkerTimer",value:function(){m.l("".concat(this._n,".stopWorkerTimer")),this._workerTimer&&this._workerTimer.postMessage("stop")}},{key:"_init",value:function(){var e,t;Gn&&(e=URL.createObjectURL(new Blob(['let interval = -1;onmessage = function(event) {  if (event.data === "start") {    if (interval > 0) {      clearInterval(interval);    }    interval = setInterval(() => {      postMessage("");    }, 1000);    postMessage(interval);  } else if (event.data === "stop") {    clearInterval(interval);    interval = -1;  }};'],{type:"application/javascript; charset=utf-8"})),this._workerTimer=new Worker(e),(t=this)._workerTimer.onmessage=function(n){n.data?(t._timerID=n.data,m.l("".concat(t._n,"._init seed:").concat(t._timerID))):t._m.onCheckTimer()})}},{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("enable_worker");m.l("".concat(this._n,"._onCloudConfig enableWorker:").concat(e)),H(e)||e==="1"?!this._isWorkerEnabled&&Gn&&(this._isWorkerEnabled=!0,this.startWorkerTimer(),this._m.onWorkerTimerEnabled()):this._isWorkerEnabled&&Gn&&(this._isWorkerEnabled=!1,this.stopWorkerTimer(),this._m.onWorkerTimerDisabled())}},{key:"terminate",value:function(){m.l("".concat(this._n,".terminate")),this._workerTimer&&(this._workerTimer.terminate(),this._workerTimer=null,this._timerID=-1)}},{key:"getTimerID",value:function(){return this._timerID}},{key:"reset",value:function(){m.l("".concat(this._n,".reset"))}}]),oi),JI=(y(hl,[{key:"isValidPurchaseBits",value:function(e){return e&&typeof e=="string"&&1<=e.length&&e.length<=64&&/[01]{1,64}/.test(e)}},{key:"parsePurchaseBits",value:function(e){if(this.isValidPurchaseBits(e)){this._featureMap.clear();for(var t,n=e.length-1,s=0;0<=n;n--,s++)t=(s<32?new X(0,Math.pow(2,s)):new X(Math.pow(2,s-32),0)).toString(),e[n]==="1"?this._featureMap.set(t,!0):this._featureMap.set(t,!1)}else m.w("".concat(this._n,".parsePurchaseBits invalid purchasebits:").concat(e))}},{key:"hasPurchasedFeature",value:function(e){return!!this._featureMap.get(e)}},{key:"isFeatureEnabled",value:function(e){for(var t=parseInt(e).toString(2),n=void 0,s=!0,r=t.length-1,a=0;0<=r;r--,a++)if(t.charAt(r)==="1"&&(n=(a<32?new X(0,Math.pow(2,a)):new X(Math.pow(2,a-32),0)).toString(),!this._featureMap.get(n))){s=!1;break}return m.l("".concat(this._n,".isFeatureEnabled decimalNumber:").concat(e," key:").concat(n," ret:").concat(s)),Pe({enabled:s})}},{key:"isFeatureEnabledForStat",value:function(e){for(var t=parseInt(e).toString(2),n=t.length-1,s=0;0<=n;n--,s++)if(t.charAt(n)==="1"){if(r=(s<32?new X(0,Math.pow(2,s)):new X(Math.pow(2,s-32),0)).toString(),!this._featureMap.get(r))break;var r,a="",l=0;r===he.PLUGIN_TRANSLATE?(a="plugin_translate",l=16):r===he.PLUGIN_VOICE_TO_TEXT?(a="plugin_voice_to_text",l=17):r===he.PLUGIN_CS?(a="plugin_cs",l=14):r===he.PLUGIN_PUSH?(a="plugin_push",l=13):r===he.PLUGIN_BOT?(a="plugin_bot",l=15):r===he.MSG_REACTION&&(a="plugin_emoji_reaction",l=18),a!==""&&(r=this._commercialConfigM.get(12).getUIPlatform(),new K(a).setCode(l).setUIPlatform(r).end(),m.l("".concat(this._n,".isFeatureEnabledForStat ").concat(a," code:").concat(l," uiPlatform:").concat(r)))}}},{key:"isCSPluginEnabled",value:function(){var e;this._isCSPluginReported||(e=this._commercialConfigM.get(12).getUIPlatform(),new K("plugin_search").setCode(6).setUIPlatform(e).end(),this._isCSPluginReported=!0)}},{key:"clear",value:function(){this._featureMap.clear(),this._isCSPluginReported=!1}}]),hl),XI=(y(fl,[{key:"_canFetch",value:function(){return this.get(12).isLoggedIn()?!this._isFetching&&Date.now()>=this._expiredTime:(this._expiredTime=Date.now()+2e3,!1)}},{key:"onCheckTimer",value:function(e){this._canFetch()&&this.fetchConfig()}},{key:"fetchConfig",value:function(){var e,t,n=this,s=this._canFetch(),r="".concat(this._n,".fetchConfig");m.l("".concat(r," canFetch:").concat(s)),s&&(e=new K("fetchCommercialConfig"),s=this.get(12).getSDKAppID(),t=this.get(20),this._isFetching=!0,t.req({P:E.FETCH_COMMERCIAL_CONFIG,data:{SDKAppID:s}}).then(function(a){e.setMessage("purchaseBits:".concat(a.data.purchaseBits)).end(),m.l("".concat(r," ok.")),n._parseConfig(a.data),n._isFetching=!1}).catch(function(a){e.setError(a).end(),n._isFetching=!1}))}},{key:"onPushedConfig",value:function(e){var t="".concat(this._n,".onPushedConfig data:").concat(JSON.stringify(e));m.l("".concat(t)),new K("pushedCommercialConfig").setMessage("purchaseBits:".concat(e.purchaseBits)).end(),this._parseConfig(e)}},{key:"_parseConfig",value:function(e){var t="".concat(this._n,"._parseConfig"),n=e.errorCode,s=e.errorMessage,r=e.purchaseBits,a=e.expiredTime;n===0?(this._purchasedFeatureHandler.parsePurchaseBits(r),this._expiredTime=Date.now()+1e3*a):H(n)?(m.l("".concat(t," failed. Invalid message format:"),e),this._setExpiredTimeOnResponseError(36e5)):(m.e("".concat(t," errorCode:").concat(n," errorMessage:").concat(s)),this._setExpiredTimeOnResponseError(12e4))}},{key:"_setExpiredTimeOnResponseError",value:function(e){this._expiredTime=Date.now()+e}},{key:"canIUse",value:function(e){return this._purchasedFeatureHandler.hasPurchasedFeature(e)}},{key:"isFeatureEnabled",value:function(e){return this._purchasedFeatureHandler.isFeatureEnabled(e)}},{key:"isFeatureEnabledForStat",value:function(e){this._purchasedFeatureHandler.isFeatureEnabledForStat(e)}},{key:"isCSPluginEnabled",value:function(){this._purchasedFeatureHandler.isCSPluginEnabled()}},{key:"get",value:function(e){return this._m.get(e)}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._expiredTime=0,this._isFetching=!1,this._purchasedFeatureHandler.clear()}}]),fl),ZI=(T(ni,St),jf=z(ni),y(ni,[{key:"registerPlugin",value:function(e){var t,n,s,r,a,l,d,h,g,_,M,S,D;j?(this._offlinePushPlugin=e["tim-offline-push-plugin"],t=(D=e.offlinePushConfig||{}).huaweiBusinessID,n=D.xiaomiBusinessID,s=D.xiaomiAppID,r=D.xiaomiAppKey,a=D.meizuBusinessID,l=D.meizuAppID,d=D.meizuAppKey,h=D.vivoBusinessID,g=D.oppoBusinessID,_=D.oppoAppKey,M=D.oppoAppSecret,S=D.honorBusinessID,D=D.iosBusinessID,this._androidPushConfig.huaweiPushBussinessId=t,this._androidPushConfig.xiaomiPushBussinessId=n,this._androidPushConfig.xiaomiPushAppId=s,this._androidPushConfig.xiaomiPushAppKey=r,this._androidPushConfig.meizuPushBussinessId=a,this._androidPushConfig.meizuPushAppId=l,this._androidPushConfig.meizuPushAppKey=d,this._androidPushConfig.vivoPushBussinessId=h,this._androidPushConfig.oppoPushBussinessId=g,this._androidPushConfig.oppoPushAppKey=_,this._androidPushConfig.oppoPushAppSecret=M,this._androidPushConfig.honorPushBussinessId=S,new K("registerPlugin").setMessage("tim-offline-push-plugin").setMoreMessage("isExist:".concat(!H(this._offlinePushPlugin))).end(!0),m.l("".concat(this._n,".").concat("registerPlugin"," ok. offlinePushConfig:").concat(JSON.stringify(e.offlinePushConfig))),this._iosBusinessID=D,this._setAppShowListener()):this.warn("OfflinePushInUniapp")}},{key:"init",value:function(){this._isWebUniapp=this.getUniAppPlatform(),this._getDeviceToken()}},{key:"_getDeviceToken",value:function(){var e,t=this,n="".concat(this._n,".").concat("_getDeviceToken");Yt(this._offlinePushPlugin.getDeviceToken)?(e="androidPushConfig:".concat(JSON.stringify(this._androidPushConfig),", iosBusinessID:").concat(this._iosBusinessID),m.l("".concat(n," start. ").concat(e)),new K("_getDeviceToken").setMessage("".concat(e)).end(!0),this._offlinePushPlugin.getDeviceToken(this._androidPushConfig,function(s){var r,a,l,d,h=new K("getDeviceTokenRes"),g=s.code,_=s.msg;g===0?(r=(d=s.data).deviceToken,a=d.deviceBrand,l=d.deviceType,d=d.bussinessId,t._deviceToken=r,t._businessID=d||t._iosBusinessID,e="deviceToken:".concat(r,", deviceBrand:").concat(a||l,", businessID:").concat(t._businessID),m.l("".concat(n," ok. ").concat(e)),h.setMessage(e).end(!0),t._setToken()):(h.setMessage("code:".concat(g,", msg:").concat(_)).end(!0),m.e("".concat(n," failed. error:"),s))})):m.e("".concat(n," getDeviceToken is not a function"))}},{key:"canIUseOfflinePush",value:function(){return j&&!H(this._offlinePushPlugin)}},{key:"_setAppShowListener",value:function(){var e=this,t="".concat(this._n,".").concat("_setAppShowListener");H(this._offlinePushPlugin)?m.e("".concat(t," offlinePushPlugin is undefined")):Yt(this._offlinePushPlugin.setAppShowListener)?(new K("_setAppShowListener").end(!0),m.l("".concat(t," start")),this._offlinePushPlugin.setAppShowListener(function(n){n=(n||{}).appShow,new K("setAppShowListenerRes").setMessage("appShow:".concat(n)).end(!0),m.l("".concat(t," ok. appShow:").concat(n)),e._m.isReady()&&(n===0?(e._getConvUnreadCount(),e._onBackground()):n===1&&e._onForeground())})):m.e("".concat(t," setAppShowListener is not a function"))}},{key:"getDeviceBrand",value:function(){var e;if(!H(this._offlinePushPlugin)&&Yt(this._offlinePushPlugin.getDeviceType))return e=(this._offlinePushPlugin.getDeviceType()||{}).deviceType,m.l("".concat(this._n,".getDeviceBrand ok. deviceType:").concat(e)),e}},{key:"_setToken",value:function(){var e="".concat(this._n,"._setToken"),t=this.get(12),n=1,s="",r="",d=(se(this._deviceToken)&&(n=0),this.getUniAppPlatform()),a=this.getDeviceBrand(),l=(d===Y.IOS||d===Y.IPAD||d===Y.MAC?r=this._deviceToken:d===Y.ANDROID&&(s=this._deviceToken),new K("offlinePushSetToken")),d="deviceToken:".concat(r||s,", businessID:").concat(this._businessID,", ")+"deviceBrand:".concat(a,", isWebUniapp:").concat(this._isWebUniapp,", pushMsg:").concat(n,", platform:").concat(d);return l.setMessage("".concat(d)),m.l("".concat(e," ").concat(d)),this.req({P:E.SET_TOKEN,data:{tokenID:s,pushMsg:n,sdkAppID:t.getSDKAppID(),businessID:parseInt(this._businessID),deviceBrand:a,deviceToken:r,isWebUniapp:this._isWebUniapp}}).then(function(h){return l.end(),m.l("".concat(e," ok")),h}).catch(function(h){return l.setError(h).end(),m.e("".concat(e," failed. error:"),h),A(h)})}},{key:"_getConvUnreadCount",value:function(){var e=this;this._c2cUnreadCount=0,this._groupUnreadCount=0,this.get(11).getLocalConvList().forEach(function(t){t.type===I.CONV_C2C&&(e._c2cUnreadCount+=t.unreadCount),t.type===I.CONV_GROUP&&(e._groupUnreadCount+=t.unreadCount)})}},{key:"_onBackground",value:function(){var e=this,t="".concat(this._n,".").concat("_onBackground"),n=new K("_onBackground");this.req({P:E.STAT_BACKGROUND,data:{c2cUnreadCount:this._c2cUnreadCount,groupUnreadCount:this._groupUnreadCount,isWebUniapp:this._isWebUniapp}}).then(function(s){return n.setMessage("c2cUnreadCount: ".concat(e._c2cUnreadCount,", groupUnreadCount: ").concat(e._groupUnreadCount)).end(),m.l("".concat(t," ok")),s}).catch(function(s){n.setError(s).end(),m.e("".concat(t," failed. error:"),s)})}},{key:"_onForeground",value:function(){var e="".concat(this._n,".").concat("_onForeground"),t=new K("_onForeground");this.req({P:E.STAT_FOREGROUND,data:{isWebUniapp:this._isWebUniapp}}).then(function(n){return t.end(),m.l("".concat(e," ok")),n}).catch(function(n){t.setError(n).end(),m.e("".concat(e," failed. error:"),n)})}},{key:"getUniAppPlatform",value:function(){var e=uni.getSystemInfoSync().platform,t=this.getDeviceBrand();return e==="ios"?Y.IOS:e==="android"?Y.ANDROID:t===1002?Y.IPAD:t===1001?Y.MAC:void 0}},{key:"reset",value:function(){this._deviceToken="",this._businessID=0,this._c2cUnreadCount=0,this._groupUnreadCount=0,this._isWebUniapp=0,m.l("".concat(this._n,".reset"))}}]),ni),QI=(T(ti,St),Kf=z(ti),y(ti,[{key:"registerPlugin",value:function(e){var t,n,s;j?(t="".concat(this._n,".").concat("registerPlugin"),this._pushPlugin=e["tim-push"],this._getDeviceInfo(),n=(s=e.pushConfig||{}).androidConfig,s=s.iOSConfig,ao(n)&&(this._androidPushConfig=n[this._deviceInfo.packageName]),n=(s||{}).iOSBusinessID,this._iOSBusinessID=n,s=!H(this._pushPlugin),new K("registerPlugin").setMessage(this._pluginName).setMoreMessage("isExisted:".concat(s)).end(!0),m.l("".concat(t," ok. pushConfig:").concat(JSON.stringify(e.pushConfig))),s?(this._setAppShowListener(),this._setPushEventReportListener()):m.e("".concat(t," ").concat(this._pluginName," is undefined"))):this.warn("TIMPushInUniapp")}},{key:"init",value:function(){this._isWebUniapp=this.getUniAppPlatform(),this._reportEventCacheList(),this._getDeviceToken(),this.get(27).isFeatureEnabledForStat(Math.pow(2,41))}},{key:"_reportEventCacheList",value:function(){var e=this,t="".concat(this._n,".").concat("_reportEventCacheList");Yt(this._pushPlugin.getPushEventCacheList)?(new K("_reportEventCacheList").end(!0),this._pushPlugin.getPushEventCacheList(function(n){var s=n.code,r=n.data.eventList,a=new K("getPushEventCacheListRes");if(a.setCode(s),s!==0)a.setMessage("res:".concat(JSON.stringify(n))).end(!0),m.e("".concat(t," failed. error:").concat(JSON.stringify(n)));else{s=r.length<10?"eventList:".concat(JSON.stringify(r)):"eventList.length:".concat(r.length),m.l("".concat(t," ok. ").concat(s)),a.setMessage(s).end(!0);for(var l=c(c({},n.data),{},{eventList:[]});0<r.length;)l.eventList=r.splice(0,40),e._pushReport(l)}})):m.e("".concat(this._pluginName,".getPushEventCacheList is not a function"))}},{key:"_getDeviceToken",value:function(){var e,t=this,n="".concat(this._n,".").concat("_getDeviceToken");Yt(this._pushPlugin.getDeviceToken)?(e="androidPushConfig:".concat(JSON.stringify(this._androidPushConfig)," iOSBusinessID:").concat(this._iOSBusinessID),m.l("".concat(n," start. ").concat(e)),new K("_getDeviceToken").setMessage("".concat(e)).end(!0),this._pushPlugin.getDeviceToken(this._androidPushConfig,function(s){var r,a,l,d=s.code,h=s.msg,g=new K("getDeviceTokenRes");if(g.setCode(d),d===0)return r=(d=s.data).deviceToken,a=d.deviceBrand,l=d.deviceType,d=d.bussinessId,t._deviceToken=r,t._businessID=d||t._iOSBusinessID,e="deviceToken:".concat(r," deviceBrand:").concat(a||l," businessID:").concat(t._businessID),m.l("".concat(n," ok. ").concat(e)),g.setMessage(e).end(!0),void t._setToken();g.setMessage(h).end(!0),m.e("".concat(n," failed. error:").concat(JSON.stringify(s)))})):m.e("".concat(this._pluginName,".getDeviceToken is not a function"))}},{key:"_getDeviceInfo",value:function(){var e="".concat(this._n,".").concat("_getDeviceInfo");if(Yt(this._pushPlugin.getDeviceInfo)){var t=this._pushPlugin.getDeviceInfo(),n=t.code,s=t.data,r=new K("_getDeviceInfo");if(r.setCode(n),n===0)return this._deviceInfo=c(c({},this._deviceInfo),s),this._deviceInfo.pushVersion||(this._deviceInfo.pushVersion="1.0.1"),n="deviceInfo:".concat(JSON.stringify(this._deviceInfo)),m.l("".concat(e," ok. ").concat(n)),void r.setMessage(n).end(!0);r.setMessage("deviceInfoRes:".concat(JSON.stringify(t))).end(!0),m.e("".concat(e," failed. error:").concat(JSON.stringify(t)))}else m.e("".concat(this._pluginName,".getDeviceInfo is not a function"))}},{key:"canIUseTIMPush",value:function(){return j&&!H(this._pushPlugin)}},{key:"_setAppShowListener",value:function(){var e=this,t="".concat(this._n,".").concat("_setAppShowListener");Yt(this._pushPlugin.setAppShowListener)?(new K("_setAppShowListener").end(!0),m.l("".concat(t," start")),this._pushPlugin.setAppShowListener(function(n){n=(n||{}).appShow,new K("setAppShowListenerRes").setMessage("appShow:".concat(n)).end(!0),m.l("".concat(t," ok. appShow:").concat(n)),e._m.isReady()&&(n===0?(e._getConvUnreadCount(),e._onBackground()):n===1&&e._onForeground())})):m.e("".concat(this._pluginName,".setAppShowListener is not a function"))}},{key:"_setPushEventReportListener",value:function(){var e=this,t="".concat(this._n,".").concat("_setPushEventReportListener");Yt(this._pushPlugin.setPushEventReportListener)?(new K("_setPushEventReportListener").end(!0),this._pushPlugin.setPushEventReportListener(function(n){var s=n.code,r=n.data,a=r.eventList,l=new K("setPushEventReportListenerRes");if(l.setCode(s),s===0)return s="eventList:".concat(JSON.stringify(a)),m.l("".concat(t," ok. ").concat(s)),l.setMessage(s).end(!0),void(e._m.isReady()&&_e(a)&&0<a.length&&e._pushReport(r));l.setMessage("res:".concat(JSON.stringify(n))).end(!0),m.e("".concat(t," failed. error:").concat(JSON.stringify(n)))})):m.e("".concat(this._pluginName,".setPushEventReportListener is not a function"))}},{key:"getDeviceBrand",value:function(){var e;if(!H(this._pushPlugin)&&Yt(this._pushPlugin.getDeviceType))return e=(this._pushPlugin.getDeviceType()||{}).deviceType,m.l("".concat(this._n,".getDeviceBrand ok. deviceType:").concat(e)),e}},{key:"_setToken",value:function(){var e="".concat(this._n,".").concat("_setToken"),t=this.get(12),n=1,d="",s="",a=(se(this._deviceToken)&&(n=0),this.getUniAppPlatform()),r=this.getDeviceBrand(),a=(a===Y.IOS||a===Y.IPAD||a===Y.MAC?s=this._deviceToken:a===Y.ANDROID&&(d=this._deviceToken),c({tokenID:d,pushMsg:n,sdkAppID:t.getSDKAppID(),businessID:parseInt(this._businessID),deviceBrand:r,deviceToken:s,isWebUniapp:this._isWebUniapp},this._deviceInfo)),l=new K("_setToken"),d="data:".concat(JSON.stringify(a));l.setMessage("".concat(d)),m.l("".concat(e," ").concat(d)),this.req({P:E.SET_TOKEN,data:a}).then(function(){l.end(),m.w("".concat(e," ok"))}).catch(function(h){l.setError(h).end(),m.e("".concat(e," failed. error:"),h),A(h)})}},{key:"_getConvUnreadCount",value:function(){var e=this;this._c2cUnreadCount=0,this._groupUnreadCount=0,this.get(11).getLocalConvList().forEach(function(t){t.type===I.CONV_C2C&&(e._c2cUnreadCount+=t.unreadCount),t.type===I.CONV_GROUP&&(e._groupUnreadCount+=t.unreadCount)})}},{key:"_onBackground",value:function(){var e=this,t="".concat(this._n,".").concat("_onBackground"),n=new K("_onBackground");this.req({P:E.STAT_BACKGROUND,data:{c2cUnreadCount:this._c2cUnreadCount,groupUnreadCount:this._groupUnreadCount,isWebUniapp:this._isWebUniapp}}).then(function(){n.setMessage("c2cUnreadCount:".concat(e._c2cUnreadCount," groupUnreadCount:").concat(e._groupUnreadCount)).end(),m.l("".concat(t," ok"))}).catch(function(s){n.setError(s).end(),m.e("".concat(t," failed. error:"),s)})}},{key:"_onForeground",value:function(){var e="".concat(this._n,".").concat("_onForeground"),t=new K("_onForeground");this.req({P:E.STAT_FOREGROUND,data:{isWebUniapp:this._isWebUniapp}}).then(function(){t.end(),m.l("".concat(e," ok"))}).catch(function(n){t.setError(n).end(),m.e("".concat(e," failed. error:"),n)})}},{key:"_pushReport",value:function(e){var t=this,n="".concat(this._n,".").concat("_pushReport"),s=new K("_pushReport");this.req({P:E.PUSH_REPORT,data:{eventList:e.eventList}}).then(function(){s.end(),t._notifyReportSuccess(e)}).catch(function(r){s.setError(r).end(),m.e("".concat(n," failed. error:"),r)})}},{key:"_notifyReportSuccess",value:function(e){!H(this._pushPlugin)&&Yt(this._pushPlugin.notifyReportSuccess)&&(this._pushPlugin.notifyReportSuccess(e),m.l("".concat(this._n,"._notifyReportSuccess ok")))}},{key:"getUniAppPlatform",value:function(){var e=uni.getSystemInfoSync().platform,t=this.getDeviceBrand();return e==="ios"?Y.IOS:e==="android"?Y.ANDROID:t===1002?Y.IPAD:t===1001?Y.MAC:void 0}},{key:"reset",value:function(){this._deviceToken="",this._businessID=0,this._c2cUnreadCount=0,this._groupUnreadCount=0,this._isWebUniapp=0,m.l("".concat(this._n,".reset"))}}]),ti),eM=(T(ei,St),Hf=z(ei),y(ei,[{key:"init",value:function(){var e=this.get(18).getPlugin("tim-profanity-filter-plugin");e&&(this._plugin=new e({logger:m,isArray:_e,isMap:Fp,isDevMode:this.isDevMode()}),this._getLexicon())}},{key:"onCheckTimer",value:function(){this._plugin&&this._canIUseLexicon&&this.isLoggedIn()&&!this._isFetching&&Date.now()>=this._expiredTime&&this._getLexicon()}},{key:"filterMessage",value:function(e,s){var n=!0;if(!this._plugin||!this._canIUseLexicon||s&&s.messageControlInfo&&s.messageControlInfo.excludedFromContentModeration===!0)return n;var s=e.type,r=e.conversationType;if(s!==I.MSG_TEXT&&s!==I.MSG_CUSTOM)return n;var a,l="".concat(this._n,".filterMessage");if(m.l("".concat(l)),s===I.MSG_TEXT){if(r===I.CONV_C2C?a="c2c_text_message":r===I.CONV_GROUP&&(a="group_text_message"),!this._isConfigOn(a))return n;var h=this._plugin.filter(e.payload.text),d=h.type,h=h.modifiedText;d===1?n=!1:d===2&&(e.payload.text=h)}else if(s===I.MSG_CUSTOM){if(r===I.CONV_C2C?a="c2c_custom_message":r===I.CONV_GROUP&&(a="group_custom_message"),!this._isConfigOn(a))return n;d=this._plugin.filter(e.payload.data),h=this._plugin.filter(e.payload.description),s=this._plugin.filter(e.payload.extension),d.type===1||h.type===1||s.type===1?n=!1:(d.type===2&&(e.payload.data=d.modifiedText),h.type===2&&(e.payload.description=h.modifiedText),s.type===2&&(e.payload.extension=s.modifiedText))}return m.l("".concat(l," done. isAllowedToSend:").concat(n)),n}},{key:"filterText",value:function(e,t){var n="".concat(this._n,".filterText"),s={isAllowedToSend:!0,modifiedText:e};return!this._plugin||!this._canIUseLexicon||!this._isConfigOn(t)?s:(m.l("".concat(n)),t=this._plugin.filter(e),e=t.type,t=t.modifiedText,e===1?s.isAllowedToSend=!1:e===2&&(s.modifiedText=t),m.l("".concat(n," done. ret:"),s),s)}},{key:"_getLexicon",value:function(){var e=this,t=new K("profanityFilter"),n="".concat(this._n,"._getLexicon");this._isFetching=!0,this.req({P:E.GET_PROFANITY_LIST,data:{startIndex:this._startIndex,version:this._version}}).then(function(M){var M=M.data,r=M.errorInfo,a=M.filterConfig,l=M.lexicon,d=M.strToken,h=M.completeFlag,g=M.nextStartIndex,_=M.version,M=M.expiredTime,S=r.errorCode,D=r.errorMessage;return S!==0?(e._isFetching=!1,m.w("".concat(n," failed. error:"),r),void t.setCode(S).setMessage(D).end()):(e._onFilterConfig(a),e._getToken(d),h===1?(m.l("".concat(n," done. version:").concat(_," expiredTime:").concat(M)),e._version=_,e._canIUseLexicon=!0,e._isFetching=!1,e._expiredTime=Date.now()+1e3*M,void e._plugin.onLexiconCompleted(l)):(e._startIndex=g,e._plugin.onLexiconSliced(l),void e._getLexicon()))}).catch(function(s){t.setError(s).end(),e._isFetching=!1,m.l("".concat(n," failed. error:"),s)})}},{key:"_onFilterConfig",value:function(e){var t=this;se(e)||(this._filterConfigMap.clear(),Object.keys(e).forEach(function(n){t._filterConfigMap.set(n,e[n])}),m.l("".concat(this._n,"._onFilterConfig. keys:").concat(Array.from(this._filterConfigMap.keys())," values:").concat(Array.from(this._filterConfigMap.values()))))}},{key:"_isConfigOn",value:function(e){return this._filterConfigMap.get(e)===1}},{key:"_getToken",value:function(e){if(xe(e)){var t=e.length,n="";if(t%2==0)for(var s=0;s<=t-1;s+=2)n=(n+=e[s+1])+e[s];else{for(var r=0;r<t-1;r+=2)n=(n+=e[r+1])+e[r];n+=e[t-1]}this._plugin.onToken(n)}}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._plugin&&(this._plugin.reset(),this._plugin=null),this._filterConfigMap.clear(),this._startIndex=0,this._version=0,this._canIUseLexicon=!1,this._isFetching=!1,this._expiredTime=0}}]),ei),tM=(y(pl,[{key:"_onCloudConfig",value:function(){var e=this,t=this._m.get(23).getCloudConfig("rtc_cmd");H(t)||((t=JSON.parse(t)).forEach(function(n){e._TRTCCommandList.includes(n)||e._TRTCCommandList.push(n)}),this._setTRTCCommandMap())}},{key:"_setTRTCCommandMap",value:function(){for(var e,t=0,n=this._TRTCCommandList.length;t<n;t++)e=this._TRTCCommandList[t].split(".")[0],this._TRTCCommandMap.set(e,1)}},{key:"onRoomCustomDataReceived",value:function(e){this._m.getOEmitInst().emit($.ROOM_CUSTOM_DATA_RECEIVED,e)}},{key:"sendTRTCCustomData",value:function(n){var t=n.serviceCommand,n=n.data,s="".concat(P.NAME.TUIROOM_SVR,".*");return H(t)||(s=t),this._isValidServiceCommand(s)?this._trans({servcmd:s,data:n}):A({code:F.INVALID_TRTC_CMD})}},{key:"_trans",value:function(n){m.d("".concat(this._n,"._trans. options:").concat(JSON.stringify(n)));var t=n.servcmd,n=n.data;return this._m.get(20).trans({servcmd:t,data:xe(n)?JSON.parse(n):n})}},{key:"_isValidServiceCommand",value:function(e){return e.endsWith(".*")?this._TRTCCommandList.includes(e):(e=e.split(".")[0],this._TRTCCommandMap.has(e))}},{key:"isTRTCCommand",value:function(e){return e=e.split(".")[0],this._TRTCCommandMap.has(e)}},{key:"reset",value:function(){m.l("".concat(this._n,".reset"))}}]),pl),nM=(y(dl,[{key:"_init",value:function(){var e,t=this._getStorageModule().getItem(this.TIM_ERROR_ASSISTANCE,!1);if(t){try{e=JSON.parse(t)}catch(n){this._getStorageModule().removeItem(this.TIM_ERROR_ASSISTANCE,!1),m.w("".concat(this._n,"._init error:"),n)}e&&(this._needToUpdate(e)?this._fetch():this._fillMap(e.message))}else this._fetch()}},{key:"_needToUpdate",value:function(n){var t=n.localSavedTime,n=n.localSavedVersion,t=t&&new Date().getTime()-t>=this.STORAGE_EXPIRES_TIME,n=!n||n!=="3.5.2";return m.l("".concat(this._n,"._needToUpdate isTimeout:").concat(t," isDifferentVersion:").concat(n)),t||n}},{key:"_fetch",value:function(){var e,t,n,s,r,a;this._m.get(12).isPrivateNetWork()||(e="https://web.sdk.qcloud.com/im/download/error-message/v3/0.0.7/tim-error-message.txt",t="application/x-www-form-urlencoded;charset=UTF-8",n="".concat(this._n,"._fetch ok in"),s=this,ee?le.request({url:e,method:"GET",timeout:3e3,header:{"content-type":t},dataType:"text",success:function(l){s._fillAndSave(l.data),m.l("".concat(n," mini program"))},fail:function(){}}):(r=new XMLHttpRequest,a=setTimeout(function(){r.abort()},3e3),r.onreadystatechange=function(){r.readyState===4&&(a&&clearTimeout(a),r.status!==200&&r.status!==304||(m.l("".concat(n," browser")),s._fillAndSave(r.responseText)))},r.open("GET",e,!0),r.setRequestHeader("Content-type",t),r.send()))}},{key:"_fillAndSave",value:function(e){this._fillMap(e),this._getStorageModule().setItem(this.TIM_ERROR_ASSISTANCE,JSON.stringify({message:e,localSavedTime:new Date().getTime(),localSavedVersion:"3.5.2"}),!0,!1)}},{key:"_getStorageModule",value:function(){return this._m.get(13)}},{key:"_fillMap",value:function(e){this._map.clear();for(var t,n,s=e.split(`;
`),r=s.length,a=new RegExp(/'/g),l=0;l<r;l++)if(n=s[l].indexOf(":"),t=s[l].slice(0,n),n=s[l].slice(n+1,s[l].length),!t.startsWith("//")){if(H(n))continue;this._map.set(t,n.replace(a,""))}}},{key:"get",value:function(n){var s=n.isIntl,r=n.key,t=n.replacement1,n=n.replacement2,s="".concat(r,s?"_en":"_cn"),r=(!this._map.has(s)&&this._map.has(r)&&(s=r),"");return this._map.has(s)&&(r=this._map.get(s),H(t)||(r=r.replace("$replacement1",t)),H(n)||(r=r.replace("$replacement2",n))),r}},{key:"reset",value:function(){m.l("".concat(this._n,".reset"))}}]),dl),oM=(y(ll,[{key:"onNewMessageList",value:function(e){var t=this;e.forEach(function(n){var s=t.getPayloadData(n);s&&t._handleActionType(s,n)})}},{key:"onMessageModified",value:function(e){var t=this;e.forEach(function(n){var s=t.getPayloadData(n);s&&t._onInvitationModified(s,n)})}},{key:"getPayloadData",value:function(n){var t="".concat(this._n,".getPayloadData"),n=n.payload.data;try{return JSON.parse(n)}catch{return m.e("".concat(t," JSON parse error. signalingData:").concat(n)),null}}},{key:"_handleActionType",value:function(e,t){switch(e.actionType){case W.ACTION_TYPE_INVITE:this._onNewInvitationReceived(e,t);break;case W.ACTION_TYPE_REJECT_INVITE:this._onInviteeRejected(e);break;case W.ACTION_TYPE_ACCEPT_INVITE:this._onInviteeAccepted(e);break;case W.ACTION_TYPE_CANCEL_INVITE:this._onInvitationCancelled(e);break;case W.ACTION_TYPE_INVITE_TIMEOUT:this._onInvitationTimeout(e)}}},{key:"_genBaseEmitData",value:function(e){return{inviteID:e.inviteID,inviter:e.inviter,groupID:e.groupID,data:e.data||""}}},{key:"_onNewInvitationReceived",value:function(e,t){var _="".concat(this._n,"._onNewInvitationReceived"),n=e.inviteID,s=e.inviteeList,r=e.groupID,a=e.inviter,l=this._sigM.getMyUserID(),d=s.includes(l),h=e.timeout,g=(kp().getTime()-1e3*t.time)/1e3,_=(0<h&&0<g&&g<h&&(h-=g),"".concat(_," myselfIncluded:").concat(d," groupID:").concat(r," signalObj:").concat(JSON.stringify(e)));m.l("".concat(_," timeout:").concat(h,"s delta:").concat(g,"s")),(r&&d||!r)&&((_=this._sigM.getInviteInfo(n))&&_===e||(_||this._sigM.setInviteInfo(n,c(c({},e),{},{message:t})),this._sigM.emitEvent(W.NEW_INVITATION_RECEIVED,c(c({},this._genBaseEmitData(e)),{},{inviteeList:s})),a!==l&&this._sigM.startTimer(c(c({},e),{},{timeout:h}))))}},{key:"_onInviteeRejected",value:function(e){var t="".concat(this._n,"._onInviteeRejected"),n=e.inviteID,s=e.inviter,r=e.groupID,a=this._sigM.hasInviteInfo(n);m.l("".concat(t," inviteID:").concat(n," hasInviteID:").concat(a," inviter:").concat(s," groupID:").concat(r)),a&&(this._sigM.updateInviteInfo(e),this._sigM.emitEvent(W.INVITEE_REJECTED,c(c({},this._genBaseEmitData(e)),{},{invitee:e.inviteeList[0]})))}},{key:"_onInviteeAccepted",value:function(e){var t="".concat(this._n,"._onInviteeAccepted"),n=e.inviteID,s=e.inviter,r=e.groupID,a=this._sigM.hasInviteInfo(n);m.l("".concat(t," inviteID:").concat(n," hasInviteID:").concat(a," inviter:").concat(s," groupID:").concat(r)),a&&(this._sigM.updateInviteInfo(e),this._sigM.emitEvent(W.INVITEE_ACCEPTED,c(c({},this._genBaseEmitData(e)),{},{invitee:e.inviteeList[0]})))}},{key:"_onInvitationCancelled",value:function(e){var t="".concat(this._n,"._onInvitationCancelled"),n=e.inviteID,s=e.inviter,r=e.groupID,a=this._sigM.hasInviteInfo(n);m.l("".concat(t," inviteID:").concat(n," hasInviteID:").concat(a," inviter:").concat(s," groupID:").concat(r)),a&&(this._sigM.deleteInviteInfo(n),this._sigM.emitEvent(W.INVITATION_CANCELLED,this._genBaseEmitData(e)))}},{key:"_onInvitationTimeout",value:function(e){var t="".concat(this._n,"._onInvitationTimeout"),n=e.inviteID,s=e.inviter,r=e.groupID,a=e.inviteeList,l=this._sigM.hasInviteInfo(n);m.l("".concat(t," inviteID:").concat(n," hasInviteID:").concat(l," inviter:").concat(s," groupID:").concat(r,"  data:").concat(e.data)),l&&(this._sigM.updateInviteInfo(e),this._sigM.emitEvent(W.INVITATION_TIMEOUT,c(c({},this._genBaseEmitData(e)),{},{inviteeList:a,isSelfTimeout:!1})))}},{key:"_onInvitationModified",value:function(e,t){var n="".concat(this._n,"._onInvitationModified"),s=e.inviteID,r=e.data,a=this._sigM.hasInviteInfo(s);m.l("".concat(n," inviteID:").concat(s," hasInviteID:").concat(a," data:").concat(r)),a&&(this._sigM.setInviteInfo(s,c(c({},e),{},{message:t})),this._sigM.emitEvent(W.INVITATION_MODIFIED,{inviteID:s,data:r}))}}]),ll),sM=(y(ul,[{key:"generateInviteID",value:function(){var e,t=(t=wI)((e=GI)(32),8)+"-"+t(e(16),4)+"-"+t(16384|e(12),4)+"-"+t(32768|e(14),4)+"-"+t(e(48),12);return m.l("".concat(this._n,".generateInviteID inviteID:").concat(t)),t}},{key:"createInviteInfo",value:function(n){var t=this.generateInviteID(),n=this.createInviteCustomData(c(c({},n),{},{inviteID:t})),r=n.groupID,s=n.inviteeList,r=r||s[0];return{customData:n,message:this._sigM.createSignaling(n,r),inviteID:t}}},{key:"_genBaseCustomData",value:function(s){var t=s.data,n=s.inviteID,s=s.groupID;return{businessID:1,timeout:0,data:t===void 0?"":t,inviteID:n===void 0?"":n,groupID:s===void 0?"":s}}},{key:"createInviteCustomData",value:function(e){var t=e.userID,n=e.timeout,n=n===void 0?0:n,s=e.groupID,s=s===void 0?"":s,r=this._sigM.getMyUserID(),r=c(c({},this._genBaseCustomData(e)),{},{actionType:W.ACTION_TYPE_INVITE,inviter:r,inviteeList:s?e.inviteeList:[t],timeout:n});return m.l("".concat(this._n,".createInviteCustomData customData:"),r),r}},{key:"createCancelCustomData",value:function(e){var t,n="".concat(this._n,".createCancelCustomData"),l=e.inviteID,s=this._sigM.getMyUserID(),l=this._sigM.getInviteInfo(l),r=l.inviteeList,a=l.groupID,l=l.inviter;return l===s?t=c(c({},this._genBaseCustomData(e)),{},{actionType:W.ACTION_TYPE_CANCEL_INVITE,groupID:a,inviter:s,inviteeList:r}):m.e("".concat(n," unmatched inviter:").concat(l," and my userID:").concat(s)),m.l("".concat(n," customData:"),t),t}},{key:"createAcceptCustomData",value:function(e){var t,n="".concat(this._n,".createAcceptCustomData"),s=e.inviteID,r=this._sigM.getMyUserID(),a=this._sigM.getInviteInfo(s),l=a.inviter,d=a.groupID;return a.inviteeList.includes(r)?t=c(c({},this._genBaseCustomData(e)),{},{actionType:W.ACTION_TYPE_ACCEPT_INVITE,groupID:d,inviter:l,inviteeList:[r]}):m.e("".concat(n," userID:").concat(r," not in inviteeList. inviteID:").concat(s," groupID:").concat(d)),m.l("".concat(n," customData:"),t),t}},{key:"createRejectCustomData",value:function(e){var t,n="".concat(this._n,".createRejectCustomData"),s=e.inviteID,r=this._sigM.getMyUserID(),a=this._sigM.getInviteInfo(s),l=a.inviter,d=a.groupID;return a.inviteeList.includes(r)?t=c(c({},this._genBaseCustomData(e)),{},{actionType:W.ACTION_TYPE_REJECT_INVITE,groupID:d,inviter:l,inviteeList:[r]}):m.e("".concat(n," userID:").concat(r," not in inviteeList. inviteID:").concat(s," groupID:").concat(d)),m.l("".concat(n," customData:"),t),t}},{key:"createTimeoutCustomData",value:function(l){var t="".concat(this._n,".createTimeoutCustomData"),n=l.inviteeList,s=l.inviter,r=l.isInviter,r=r!==void 0&&r,a=this._sigM.getMyUserID(),l=c(c({},this._genBaseCustomData(l)),{},{actionType:W.ACTION_TYPE_INVITE_TIMEOUT,inviter:s,inviteeList:r?n:[a]});return m.l("".concat(t," customData:"),l),l}}]),ul),rM=(y(cl,[{key:"setCloudConfig",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:20,t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:300;this.COUNT=e,this.EXPIRED_TIME=t,m.l("".concat(this._n,".setCloudConfig count:").concat(e,", time:").concat(t))}},{key:"getHistorySignaling",value:function(){var e=this,t=this._sigM.get(11).getLocalConvList();se(t)||(this._getC2CSignalingList(),t=this._getValidGroupConvList(t),this._getGroupSignalingList(t).then(function(n){e._handleSignalingList(n)}))}},{key:"_getC2CSignalingList",value:function(){var e=this._sigM.get(6).getMessageListFromUnreadDB(),e=this._sigM.filterMessageList(e);this._getRelatedToMeMap(e)}},{key:"_getGroupSignalingList",value:function(n){var t=this,n=this._createPromiseList(n);return n.length===0?Promise.resolve(this._sortSignaling(this._relatedToMeMap)):this._concurrentGetMessageList(n).then(function(s){var r=new Map;return s.forEach(function(a){a=a.list,a=t._getRelatedToMeMap(a),r=new Map([].concat(q(r),q(a)))}),t._sortSignaling(r)})}},{key:"_handleSignalingList",value:function(e){se(e)||this._sigM.onNewMessageList(e)}},{key:"_getValidGroupConvList",value:function(e){for(var t=[],n=0,s=e.length;n<s;n++){var l=e[n],a=l.type,r=l.unreadCount,l=l.lastMessage,a=a===I.CONV_GROUP,l=this._isNotExpired(l);a&&r&&l&&t.push(e[n])}return t}},{key:"_isNotExpired",value:function(e){return!(!e||!e.lastTime)&&e.lastTime>Mr()-this.EXPIRED_TIME}},{key:"_createPromiseList",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],s=r.conversationID,r=r.unreadCount,r=r<this.COUNT?r:this.COUNT,r=(this._map.set(s,{msgCount:r,list:[]}),this._sigM.get(11).getMessageList({conversationID:s}));t.push(r)}return t}},{key:"_concurrentGetMessageList",value:function(e){var t=this,n=[];return Promise.all(e).then(function(s){for(var r=0;r<s.length;r++){var l=s[r],a=l.code,l=l.data;a===0&&l.messageList.length!==0&&(t._handleMessageList(l.messageList),(a=t._relayGetMessageList(l))&&n.push(a))}return 0<n.length?t._concurrentGetMessageList(n):t._map})}},{key:"_relayGetMessageList",value:function(n){var s=n.messageList,t=n.nextReqMessageID,n=n.isCompleted;if(s.length===0)return null;var s=s[0].conversationID,r=this._map.get(s).msgCount;return r===0||n?null:this._sigM.get(11).getMessageList({conversationID:s,nextReqMessageID:t,count:r})}},{key:"_handleMessageList",value:function(e){var t=e.length,n=e[0].conversationID,r=this._map.get(n),s=r.msgCount,r=r.list;this._map.set(n,{msgCount:0<s-t?s-t:0,list:r.concat(this._sigM.filterMessageList(e))})}},{key:"_getRelatedToMeMap",value:function(e){for(var t=0;t<e.length;t++){var n=e[t];this._saveRelatedToMe(n)}return this._relatedToMeMap}},{key:"_saveRelatedToMe",value:function(e){var n=this._sigM.getPayloadData(e)||{},t=n.actionType,n=n.inviteID,s=n===void 0?"":n;switch(t===void 0?"":t){case W.ACTION_TYPE_INVITE:this._setHistoryInvite(e);break;case W.ACTION_TYPE_REJECT_INVITE:case W.ACTION_TYPE_ACCEPT_INVITE:this._updateHistoryInvite(e);break;case W.ACTION_TYPE_CANCEL_INVITE:this._delHistoryInvite(s);break;case W.ACTION_TYPE_INVITE_TIMEOUT:this._updateHistoryInvite(e)}}},{key:"_setHistoryInvite",value:function(e){var t=this._sigM.getPayloadData(e)||{},n=t.inviteID,n=n===void 0?"":n,s=t.inviteeList,s=s===void 0?[]:s,r=t.timeout,r=r===void 0?0:r,a=this._sigM.getMyUserID();s.includes(a)&&(s=Mr()-e.time,0<r&&r<s&&r!==0||this._relatedToMeMap.set(n,c(c({},t),{},{messageList:[e]})))}},{key:"_delHistoryInvite",value:function(e){this._relatedToMeMap.has(e)&&this._relatedToMeMap.delete(e)}},{key:"_updateHistoryInvite",value:function(e){var n=this._sigM.getPayloadData(e)||{},t=n.inviteID,t=t===void 0?"":t,n=n.inviteeList,s=n===void 0?[]:n;if(this._relatedToMeMap.has(t)){for(var n=this._relatedToMeMap.get(t),r=n.inviteeList,n=n.messageList,a=0;a<s.length;a++){var l=s[a];r.includes(l)&&r.splice(r.indexOf(l),1)}r.length===0?this._delHistoryInvite(t):n.push(e)}else this._delHistoryInvite(t)}},{key:"_sortSignaling",value:function(e){var t=[];return e.forEach(function(n){t=[].concat(q(t),q(n.messageList))}),t.sort(function(n,s){return n.time-s.time})}},{key:"reset",value:function(){this._map.clear(),this._relatedToMeMap.clear()}}]),cl),iM=y(function e(t,n){f(this,e),this.businessID=t.businessID||1,this.inviteID=t.inviteID,this.groupID=t.groupID||"",this.inviter=t.inviter||"",this.inviteeList=t.inviteeList||[],this.data=t.data||"",this.actionType=t.actionType||W.ACTION_TYPE_INVITE,this.timeout=t.timeout||0}),aM=["message"],cM=["message"],uM=(T(Qr,St),Bf=z(Qr),y(Qr,[{key:"onC2CUnreadHandleCompleted",value:function(){this._isC2CUnreadHandleCompleted=!0,this._isCloudConfigCompleted&&this._isConvSyncCompleted&&!this._isSyncCompleted&&this.onReady()}},{key:"onConvSyncCompleted",value:function(){this._isConvSyncCompleted=!0,this._isC2CUnreadHandleCompleted&&this._isCloudConfigCompleted&&!this._isSyncCompleted&&this.onReady()}},{key:"onCloudConfig",value:function(){this._isCloudConfigCompleted=!0;var e=this.getCloudConfig("history_s_count"),t=this.getCloudConfig("history_s_time");H(e)||(e=Number(e)),H(t)||(t=Number(t)),this._historySignalingHandler.setCloudConfig(e,t),this._isC2CUnreadHandleCompleted&&this._isConvSyncCompleted&&!this._isSyncCompleted&&this.onReady()}},{key:"_isListenerExisted",value:function(){return-1<this._m.getOEmitInst().eventNames().indexOf(W.NEW_INVITATION_RECEIVED)}},{key:"onReady",value:function(){this._isSyncCompleted=!0;var e=this._isListenerExisted();m.l("".concat(this._n,".onReady. isListenerExisted: ").concat(e)),e&&this._historySignalingHandler.getHistorySignaling()}},{key:"onNewMessageList",value:function(e){if(e=this.filterMessageList(e),0<e.length)return this._remoteSignalingHandler.onNewMessageList(e)}},{key:"onMessageModified",value:function(e){if(e=this.filterMessageList(e),0<e.length)return this._remoteSignalingHandler.onMessageModified(e)}},{key:"hasInviteInfo",value:function(e){return this._inviteInfoMap.has(e)}},{key:"getInviteInfo",value:function(e){return this._inviteInfoMap.get(e)}},{key:"setInviteInfo",value:function(e,s){var n=s.message,s=G(s,aM);m.l("".concat(this._n,".setInviteInfo inviteID:").concat(e," data:"),s),this._inviteInfoMap.set(e,c(c({},s),{},{message:n}))}},{key:"deleteInviteInfo",value:function(e){this.hasInviteInfo(e)&&(m.l("".concat(this._n,".deleteInviteInfo inviteID:").concat(e,".")),this._inviteInfoMap.delete(e))}},{key:"updateInviteInfo",value:function(a){var t="".concat(this._n,".updateInviteInfo"),n=a.inviteID,s=a.inviter,r=a.inviteeList,a=a.groupID;m.l("".concat(t," inviteID:").concat(n," inviter:").concat(s," groupID:").concat(a)),a&&this.hasInviteInfo(n)?(s=r[0],(a=this.getInviteInfo(n).inviteeList).includes(s)&&(a.splice(a.indexOf(s),1),m.l("".concat(t," remove ").concat(s,". localInviteeList.length:").concat(a.length))),a.length===0&&this.deleteInviteInfo(n)):this.deleteInviteInfo(n)}},{key:"canIUseSignaling",value:function(){return this._canIUseSignaling}},{key:"emitEvent",value:function(e,t){this.emitOEvt(e,t)}},{key:"addSignalingListener",value:function(e,t,n){this._canIUseSignaling||(this._canIUseSignaling=!0),this._m.getOEmitInst().on(e,t,n)}},{key:"removeSignalingListener",value:function(e,t,n){this._m.getOEmitInst().off(e,t,n),this._isListenerExisted()||(this._canIUseSignaling=!1)}},{key:"invite",value:function(e){var t=this,n="".concat(this._n,".").concat("invite"),s=this._localSignalingHandler.createInviteInfo(e),r=s.message,a=s.customData,l=s.inviteID;return m.l("".concat(n," options:").concat(JSON.stringify(e)," inviteID:").concat(l)),this.sendSignaling(r,e).then(function(d){return d&&d.code===0?(t.setInviteInfo(l,c(c({},a),{},{message:r})),t.startTimer(c(c({},a),{},{inviteID:l})),c(c({},d),{},{inviteID:l})):d}).catch(function(d){return A(d)})}},{key:"inviteSync",value:function(e,t,n){var s=this,r="".concat(this._n,".").concat("inviteSync"),a=this._localSignalingHandler.createInviteInfo(e),l=a.message,d=a.customData,h=a.inviteID;return m.l("".concat(r," options:").concat(JSON.stringify(e)," inviteID:").concat(h)),this.sendSignaling(l,e).then(function(g){if(g&&g.code===0)return s.setInviteInfo(h,c(c({},d),{},{message:l})),s.startTimer(c(c({},d),{},{inviteID:h})),t&&t({inviteID:h}),{inviteID:h};n&&n(g.code===0,g.message||"")}).catch(function(g){return n&&n(g.code,g.message),A(g)}),h}},{key:"_handleImResponse",value:function(e,t,n){t&&t.code===0&&(this._isHandling=!1,n?this.deleteInviteInfo(e.inviteID):this.updateInviteInfo(e))}},{key:"cancel",value:function(e){var t=this,s="".concat(this._n,".").concat("cancel");if(m.l("".concat(s," options:").concat(JSON.stringify(e))),!this.hasInviteInfo(e.inviteID)||this._isHandling)return A({code:F.INVALID_CANCEL_MESSAGE});this._isHandling=!0;var n=this._localSignalingHandler.createCancelCustomData(e);if(!n)return this._isHandling=!1,A({code:F.SIGNALING_NO_PERMISSION});var s=n.groupID,r=n.inviteeList,s=s||r[0],r=this.createSignaling(n,s);return this.sendSignaling(r,e).then(function(a){return t._handleImResponse(n,a,!0),a.code===0?c(c({},a),{},{inviteID:e.inviteID}):a}).catch(function(a){return A(a)})}},{key:"accept",value:function(e){var t=this,n="".concat(this._n,".").concat("accept");if(m.l("".concat(n," options:").concat(JSON.stringify(e))),!this.hasInviteInfo(e.inviteID)||this._isHandling)return A({code:F.SIGNALING_INVALID_INVITE_ID});this._isHandling=!0;var s=this._localSignalingHandler.createAcceptCustomData(e);return s?(n=this.createSignaling(s),this.sendSignaling(n,e).then(function(r){return t._handleImResponse(s,r),r.code===0?c(c({},r),{},{inviteID:e.inviteID}):r}).catch(function(r){return A(r)})):(this._isHandling=!1,A({code:F.SIGNALING_NO_PERMISSION}))}},{key:"reject",value:function(e){var t=this,n="".concat(this._n,".").concat("reject");if(m.l("".concat(n," options:").concat(JSON.stringify(e))),!this.hasInviteInfo(e.inviteID)||this._isHandling)return A({code:F.SIGNALING_INVALID_INVITE_ID});this._isHandling=!0;var s=this._localSignalingHandler.createRejectCustomData(e);return s?(n=this.createSignaling(s),this.sendSignaling(n,e).then(function(r){return t._handleImResponse(s,r,!0),r.code===0?c(c({},r),{},{inviteID:e.inviteID}):r}).catch(function(r){return A(r)})):(this._isHandling=!1,A({code:F.SIGNALING_NO_PERMISSION}))}},{key:"getSignalingInfo",value:function(d){var t="".concat(this._n,".getSignalingInfo"),n=d.ID,s=d.from,r=d.to,a=this._filterSignaling(d),l=null,d=(a&&(d=this.getPayloadData(d),l=new iM(d)),a?"actionType:".concat(l.actionType):"");return m.l("".concat(t," messageID:").concat(n," from:").concat(s," to:").concat(r," ")+"".concat(d," isSignaling:").concat(a)),l}},{key:"modifyInvitation",value:function(s){var t=this,n=s.inviteID,s=s.data;if(!this.hasInviteInfo(n))return A({code:F.SIGNALING_INVALID_INVITE_ID});var r=this.getInviteInfo(n),a=r.message,l=G(r,cM),d=a.payload.data;return l.data=s,a.payload.data=JSON.stringify(l),this.get(2).modifyRemoteMessage(a).then(function(h){return t.hasInviteInfo(n)&&t.setInviteInfo(n,c(c({},l),{},{message:a})),h}).catch(function(h){return a.payload.data=d,A(h)})}},{key:"_genMsgCtrlInfo",value:function(){var s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},e=s.data,e=e===void 0?"":e,t=s.onlineUserOnly,a=s.inviteID,a=a===void 0?"":a,n=s.offlinePushInfo,s=s.actionType,r={_onlineOnlyFlag:!1},a={onlineUserOnly:(r=a&&this.getInviteInfo(a)?this.getInviteInfo(a).message:r)._onlineOnlyFlag||t||!1,offlinePushInfo:n,messageControlInfo:{excludedFromContentModeration:!0,excludedFromUnreadCount:!1,excludedFromLastMessage:!1}};return s===W.ACTION_TYPE_INVITE_TIMEOUT?(r=!!e.match(/excludeTimeoutSignalingFromHistoryMessage/),a.messageControlInfo.excludedFromUnreadCount=r,a.messageControlInfo.excludedFromLastMessage=r,a):(t=!!e.match(/excludeFromHistoryMessage/),n=!!e.match(/excludeOriginalSignalingFromHistoryMessage/),a.messageControlInfo.excludedFromUnreadCount=t||n,a.messageControlInfo.excludedFromLastMessage=t||n,a)}},{key:"sendSignaling",value:function(e,t){var n=this;return this.get(2).sendMessageInstance(e,this._genMsgCtrlInfo(t)).catch(function(s){return n._isHandling=!1,A(s)})}},{key:"filterMessageList",value:function(e){var t=this;return e.filter(function(n){return t._filterSignaling(n)})}},{key:"getPayloadData",value:function(e){return this._remoteSignalingHandler.getPayloadData(e)}},{key:"createSignaling",value:function(e,s){var n=e.groupID,r=e.inviter,s={to:s||n||r,conversationType:n?I.CONV_GROUP:I.CONV_C2C,priority:I.MSG_PRIORITY_HIGH,payload:{data:JSON.stringify(e)}},r=this.get(2).createCustomMessage(s);return m.l("".concat(this._n,".createSignaling. message:"),r),r}},{key:"_filterSignaling",value:function(e){var t,n,s=!1;return e.type&&e.type===I.MSG_CUSTOM&&(t=e.cloudCustomData,e=(e=e.payload.data)===void 0?"":e,t=(t===void 0?"":t).match(/"type":"tsignaling"/),n=e.match(/inviteID/),e=e.match(/actionType/),s=t||n&&e),!!s}},{key:"startTimer",value:function(e){var t,n,s,r=this,a="".concat(this._n,".startTimer"),l=e.timeout,d=e.inviteID,h=e.inviter,g=e.groupID,_=h===this.getMyUserID();m.l("".concat(a," timeout:").concat(l," isInviter:").concat(_," groupID:").concat(g)),l<=0||(t=_?l+5:l,n=1,s=setInterval(function(){var M=r._hasLocalInviteInfo(e,_);n<t&&M?++n:(M&&r._sendTimeoutNotice(d,_),m.l("".concat(a," end.")),clearInterval(s))},1e3))}},{key:"_hasLocalInviteInfo",value:function(s,t){var n=s.inviteID,s=s.groupID;if(!this.hasInviteInfo(n))return!1;var r="".concat(this._n,"._hasLocalInviteInfo"),a=this.getInviteInfo(n).inviteeList;return m.l("".concat(r," inviteID:").concat(n," inviteeList:").concat(a," groupID:").concat(s)),!s||(t?0<a.length:0<a.length&&a.includes(this.getMyUserID()))}},{key:"_getReceiver",value:function(e,r){var n=r.groupID,s=r.inviteeList,r=r.inviter;return e?n||s[0]:n||r}},{key:"_sendTimeoutNotice",value:function(e,t){var n=this,s=this.getInviteInfo(e),r=this._getReceiver(t,s),a=(m.l("".concat(this._n,"._sendTimeoutNotice inviteID:").concat(e," to:").concat(r," isInviter:").concat(t)),this._localSignalingHandler.createTimeoutCustomData(c(c({},s),{},{isInviter:t}))),l=this.createSignaling(a,r);return this.sendSignaling(l,a).then(function(d){var h,g,_;d&&d.code===0&&(d=a.data,h=a.groupID,g=a.inviteeList,_=a.inviter,n.emitEvent(W.INVITATION_TIMEOUT,{data:d,groupID:h,inviteID:e,inviteeList:g,inviter:_,isSelfTimeout:!0,message:l}),t?n.deleteInviteInfo(e):n.updateInviteInfo(a))})}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._inviteInfoMap.clear(),this._canIUseSignaling=!1,this._isHandling=!1,this._historySignalingHandler.reset(),this._isC2CUnreadHandleCompleted=!1,this._isConvSyncCompleted=!1,this._isSyncCompleted=!1,this._isCloudConfigCompleted=!1}}]),Qr),lM=["followDiffList"],dM=["from"],Sn={NONE:0,FOLLOWERS:1,FOLLOWING:2,MUTUAL:3},pM=(T(Zr,St),Vf=z(Zr),y(Zr,[{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("follow_req_count");H(e)||(e=Number(e),this.DEFAULT_COUNT=e>this.MAX_COUNT?this.MAX_COUNT:e,this._clearFollowList())}},{key:"clearCacheOnReconnected",value:function(){this._clearFollowList()}},{key:"onFollowNotify",value:function(n){var t=this,n=n.dataList||[];m.l("".concat(this._n,".onFollowNotify followChangeList:").concat(n.length)),n.forEach(function(a){var r=a.followDiffList,r=r===void 0?[]:r,a=G(a,lM),l=a.from,d=G(a,dM);r.forEach(function(_){var g=_.isAdd,_=_.followType,_=_===void 0?0:_,M=t._initFollowInfo();g===1?(d.userID=l,M[_].userInfoList.push(d),M[_].isAdd=!0):(M[_].userInfoList.push(l),M[_].isAdd=!1),t._emitEvent(M)})})}},{key:"_initFollowInfo",value:function(){var e={};return Object.values(Sn).forEach(function(t){t!==Sn.NONE&&(e[t]={userInfoList:[],isAdd:!1})}),e}},{key:"_emitEvent",value:function(e){var t=this;Object.keys(e).forEach(function(s){var s=Number(s),r=e[s];0<r.userInfoList.length&&(s===Sn.FOLLOWERS&&(t._clearFollowList(Sn.FOLLOWERS),t.emitOEvt($.MY_FOLLOWERS_LIST_UPDATED,r)),s===Sn.FOLLOWING&&(t._clearFollowList(Sn.FOLLOWING),t.emitOEvt($.MY_FOLLOWING_LIST_UPDATED,r)),s===Sn.MUTUAL&&(t._clearFollowList(Sn.MUTUAL),t.emitOEvt($.MUTUAL_FOLLOWERS_LIST_UPDATED,r)))})}},{key:"followUser",value:function(e){if(!this.canIUse(he.FOLLOW))return this.noUse("followUser");var t="".concat(this._n,".").concat("followUser"),n="userIDList:".concat(e.length),s=new K("followUser");return s.setMessage(n),m.l("".concat(t," ").concat(n)),this.req({P:E.FOLLOW,data:{fromAccount:this.getMyUserID(),userIDList:e.map(function(r){return{userID:r}})}}).then(function(r){return s.end(),m.l("".concat(t," ok.")),me(r.data.resultList)}).catch(function(r){return s.setError(r).end(),m.e("".concat(t," failed. error:"),r),A(r)})}},{key:"unfollowUser",value:function(e){if(!this.canIUse(he.FOLLOW))return this.noUse("unfollowUser");var t="".concat(this._n,".").concat("unfollowUser"),n="userIDList:".concat(e.length),s=new K("unfollowUser");return s.setMessage(n),m.l("".concat(t," ").concat(n)),this.req({P:E.UNFOLLOW,data:{fromAccount:this.getMyUserID(),userIDList:e}}).then(function(r){return s.end(),m.l("".concat(t," ok.")),me(r.data.resultList)}).catch(function(r){return s.setError(r).end(),m.e("".concat(t," failed. error:"),r),A(r)})}},{key:"getMyFollowersList",value:function(){var e=this,t=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",n="getMyFollowersList";if(!this.canIUse(he.FOLLOW))return this.noUse(n);var s=t||this.FIRST_PAGE_INDEX;if(this._myFollowersList.has(s)){var l=this._myFollowersList.get(s),r=l.resultList,a=l.nextCursor,l=l.lastUpdateTime;if(Date.now()-l<this.MAX_CATCH_TIME&&0<r.length)return m.l("".concat(this._n,".").concat(n," nextCursor:").concat(t," from local.")),Pe({resultList:r,nextCursor:a})}return this._getFollowList(t,Sn.FOLLOWERS).then(function(d){return e._myFollowersList.set(s,c(c({},d),{},{lastUpdateTime:Date.now()})),m.l("".concat(e._n,".").concat(n," nextCursor:").concat(t," from remote.")),me(d)})}},{key:"getMyFollowingList",value:function(){var e=this,t=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",n="getMyFollowingList";if(!this.canIUse(he.FOLLOW))return this.noUse(n);var s=t||this.FIRST_PAGE_INDEX;if(this._myFollowingList.has(s)){var l=this._myFollowingList.get(s),r=l.resultList,a=l.nextCursor,l=l.lastUpdateTime;if(Date.now()-l<this.MAX_CATCH_TIME&&0<r.length)return m.l("".concat(this._n,".").concat(n," nextCursor:").concat(t," from local.")),Pe({resultList:r,nextCursor:a})}return this._getFollowList(t,Sn.FOLLOWING).then(function(d){return e._myFollowingList.set(s,c(c({},d),{},{lastUpdateTime:Date.now()})),m.l("".concat(e._n,".").concat(n," nextCursor:").concat(t," from remote.")),me(d)})}},{key:"getMutualFollowersList",value:function(){var e=this,t=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",n="getMutualFollowersList";if(!this.canIUse(he.FOLLOW))return this.noUse(n);var s=t||this.FIRST_PAGE_INDEX;if(this._myMutualFollowersList.has(s)){var l=this._myMutualFollowersList.get(s),r=l.resultList,a=l.nextCursor,l=l.lastUpdateTime;if(Date.now()-l<this.MAX_CATCH_TIME&&0<r.length)return m.l("".concat(this._n,".").concat(n," nextCursor:").concat(t," from local.")),Pe({resultList:r,nextCursor:a})}return this._getFollowList(t,Sn.MUTUAL).then(function(d){return e._myMutualFollowersList.set(s,c(c({},d),{},{lastUpdateTime:Date.now()})),m.l("".concat(e._n,".").concat(n," nextCursor:").concat(t," from remote.")),me(d)})}},{key:"_getFollowList",value:function(e,t){var n=this,s=new K("_getFollowList");return s.setMessage("nextCursor:".concat(e," type:").concat(t)),this.req({P:E.GET_FOLLOW,data:{fromAccount:this.getMyUserID(),count:this.DEFAULT_COUNT,nextCursor:e,type:t}}).then(function(l){s.end();var l=l.data,a=l.resultList,a=a===void 0?[]:a,l=l.nextCursor,l=l===void 0?"":l,d=[];return a.forEach(function(M){var g=M.userID,_=M.followTime,M=M.profileList;d.push(c({userID:g,followTime:_},n._handleProfileItem(M===void 0?[]:M)))}),{resultList:d,nextCursor:l}}).catch(function(r){return s.setError(r).end(),m.e("".concat(n._n,"._getFollowList failed. error:"),r),A(r)})}},{key:"_handleProfileItem",value:function(e){var t={};return e.forEach(function(n){switch(n.tag){case Ve.NICK:t.nick=n.value;break;case Ve.GENDER:t.gender=n.value;break;case Ve.BIRTHDAY:t.birthday=n.value;break;case Ve.LOCATION:t.location=n.value;break;case Ve.SELFSIGNATURE:t.selfSignature=n.value;break;case Ve.ALLOWTYPE:t.allowType=n.value;break;case Ve.LANGUAGE:t.language=n.value;break;case Ve.AVATAR:t.avatar=n.value;break;case Ve.MESSAGESETTINGS:t.messageSettings=n.value;break;case Ve.ADMINFORBIDTYPE:t.adminForbidType=n.value;break;case Ve.LEVEL:t.level=n.value;break;case Ve.ROLE:t.role=n.value;break;default:t[n.tag]=n.value}}),t}},{key:"getUserFollowInfo",value:function(r){if(!this.canIUse(he.FOLLOW))return this.noUse("getUserFollowInfo");var t=r,n=!1,s=(H(r)&&(t=[this.getMyUserID()],n=!0),"".concat(this._n,".").concat("getUserFollowInfo")),r="userIDList:".concat(t.length," isGetMyFollowInfo:").concat(n),a=new K("getUserFollowInfo");return a.setMessage(r),m.l("".concat(s," ").concat(r)),this.req({P:E.GET_FOLLOW_INFO,data:{fromAccount:this.getMyUserID(),userIDList:t}}).then(function(d){a.end(),m.l("".concat(s," ok."));var d=d.data.followInfoList,h=[];return(d===void 0?[]:d).forEach(function(S){var _=S.followersCount,M=S.followingCount,S=S.mutualFollowersCount;h.push({followersCount:_,followingCount:M,mutualFollowersCount:S})}),me(h)}).catch(function(l){return a.setError(l).end(),m.e("".concat(s," failed. error:"),l),A(l)})}},{key:"checkFollowType",value:function(e){if(!this.canIUse(he.FOLLOW))return this.noUse("checkFollowType");100<e.length&&(e=e.slice(0,100),m.w("".concat(t," ").concat(os(100))));var t="".concat(this._n,".").concat("checkFollowType"),n="userIDList length:".concat(e.length," "),s=new K("checkFollowType");return s.setMessage(n),m.l("".concat(t," ").concat(n)),this.req({P:E.CHECK_FOLLOW_TYPE,data:{fromAccount:this.getMyUserID(),userIDList:e}}).then(function(a){s.end(),m.l("".concat(t," ok."));var a=a.data.resultList,l=[];return(a===void 0?[]:a).forEach(function(g){var h=g.userID,g=g.followType;l.push({userID:h,followType:g})}),me(l)}).catch(function(r){return s.setError(r).end(),m.e("".concat(t," failed. error:"),r),A(r)})}},{key:"_clearFollowList",value:function(e){if(H(e))return this._myFollowersList.clear(),this._myFollowingList.clear(),void this._myMutualFollowersList.clear();e!==Sn.FOLLOWERS?e!==Sn.FOLLOWING?e!==Sn.MUTUAL||this._myMutualFollowersList.clear():this._myFollowingList.clear():this._myFollowersList.clear()}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._clearFollowList()}}]),Zr),Et=Rf(function(e,t){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";t.assign=function(a){for(var l,d,h=Array.prototype.slice.call(arguments,1);h.length;){var g=h.shift();if(g){if(p(g)!=="object")throw new TypeError(g+"must be non-object");for(var _ in g)l=g,d=_,Object.prototype.hasOwnProperty.call(l,d)&&(a[_]=g[_])}}return a},t.shrinkBuf=function(a,l){return a.length===l?a:a.subarray?a.subarray(0,l):(a.length=l,a)};var s={arraySet:function(a,l,d,h,g){if(l.subarray&&a.subarray)a.set(l.subarray(d,d+h),g);else for(var _=0;_<h;_++)a[g+_]=l[d+_]},flattenChunks:function(a){for(var l,d,h,g=0,_=0,M=a.length;_<M;_++)g+=a[_].length;for(h=new Uint8Array(g),_=l=0,M=a.length;_<M;_++)d=a[_],h.set(d,l),l+=d.length;return h}},r={arraySet:function(a,l,d,h,g){for(var _=0;_<h;_++)a[g+_]=l[d+_]},flattenChunks:function(a){return[].concat.apply([],a)}};t.setTyped=function(a){a?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,s)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,r))},t.setTyped(n)});function Zr(e){return f(this,Zr),(e=Vf.call(this,e))._n="FollowModule",e._myFollowersList=new Map,e._myFollowingList=new Map,e._myMutualFollowersList=new Map,e.MAX_CATCH_TIME=6e5,e.FIRST_PAGE_INDEX=Vp(),e.DEFAULT_COUNT=500,e.MAX_COUNT=1e3,e.getIEmitInst().on(mt.CLOUD_CONFIG,e._onCloudConfig,V(e)),e}function Qr(e){f(this,Qr),(e=Bf.call(this,e))._n="SignalingModule",e._inviteInfoMap=new Map,e._canIUseSignaling=!1,e._isHandling=!1,e._remoteSignalingHandler=new oM(V(e)),e._localSignalingHandler=new sM(V(e)),e._historySignalingHandler=new rM(V(e)),e._isC2CUnreadHandleCompleted=!1,e._isConvSyncCompleted=!1,e._isSyncCompleted=!1,e._isCloudConfigCompleted=!1;var t=e.getIEmitInst();return t.on(mt.C2C_UNREAD_HANDLE_COMPLETED,e.onC2CUnreadHandleCompleted,V(e)),t.on(mt.CONV_SYNC_COMPLETED,e.onConvSyncCompleted,V(e)),t.on(mt.CLOUD_CONFIG,e.onCloudConfig,V(e)),e}function cl(e){f(this,cl),this._n="HistorySignalingHandler",this._sigM=e,this.COUNT=20,this.EXPIRED_TIME=300,this._map=new Map,this._relatedToMeMap=new Map}function ul(e){f(this,ul),this._n="LocalSignalingHandler",this._sigM=e}function ll(e){f(this,ll),this._n="RemoteSignalingHandler",this._sigM=e}function dl(e){f(this,dl),this._m=e,this._n="ErrMsgModule",this.TIM_ERROR_ASSISTANCE="tim_error_assistance",this.STORAGE_EXPIRES_TIME=6048e5,this._map=new Map,this._init()}function pl(e){f(this,pl),this._m=e,this._n="TransCmdModule",this._TRTCCommandList=["tui_room_svr.*","callkit_records_svr.*","room_engine_srv.*","room_engine_http_srv.*","room_engine_mic.*","live_engine_srv.*","live_engine_http_srv.*","live_engine_pk.*","trtc_ai_service.*","call_engine_srv.*"],this._TRTCCommandMap=new Map,this._setTRTCCommandMap(),this._m.getIEmitInst().on(mt.CLOUD_CONFIG,this._onCloudConfig,this)}function ei(e){return f(this,ei),(e=Hf.call(this,e))._n="ProfanityFilterModule",e._plugin=null,e._filterConfigMap=new Map,e._startIndex=0,e._version=0,e._canIUseLexicon=!1,e._isFetching=!1,e._expiredTime=0,e}function ti(e){var t;return f(this,ti),(t=Kf.call(this,e))._m=e,t._n="TIMPushModule",t._pluginName="TIMPush",t._pushPlugin=void 0,t._androidPushConfig={},t._deviceToken="",t._businessID=0,t._iOSBusinessID=0,t._c2cUnreadCount=0,t._groupUnreadCount=0,t._isWebUniapp=0,t._deviceInfo={notificationStatus:0,deviceModel:"",systemVersion:"",pushVersion:"1.0.1",packageName:""},t}function ni(e){var t;return f(this,ni),(t=jf.call(this,e))._m=e,t._n="OfflinePushModule",t._offlinePushPlugin=void 0,t._androidPushConfig={huaweiPushBussinessId:"",xiaomiPushBussinessId:"",xiaomiPushAppId:"",xiaomiPushAppKey:"",meizuPushBussinessId:"",meizuPushAppId:"",meizuPushAppKey:"",vivoPushBussinessId:"",fcmPushBussinessId:"",oppoPushBussinessId:"",oppoPushAppKey:"",oppoPushAppSecret:"",honorPushBussinessId:""},t._deviceToken="",t._businessID=0,t._iosBusinessID=0,t._c2cUnreadCount=0,t._groupUnreadCount=0,t._isWebUniapp=0,t}function fl(e){f(this,fl),this._m=e,this._n="CommercialConfigModule",this._expiredTime=0,this._isFetching=!1,this._purchasedFeatureHandler=new JI(this)}function hl(e){f(this,hl),this._commercialConfigM=e,this._n="PurchasedFeatureHandler",this._isCSPluginReported=!1,this._featureMap=new Map}function oi(e){return f(this,oi),(e=Wf.call(this,e))._n="WorkerTimerModule",e._isWorkerEnabled=!0,e._workerTimer=null,e._timerID=-1,e._init(),e.getIEmitInst().on(mt.CLOUD_CONFIG,e._onCloudConfig,V(e)),e}function si(e){return f(this,si),(e=Yf.call(this,e))._n="SnsModule",e._friendHandler=new WI(V(e)),e._friendApplicationHandler=new jI(V(e)),e._friendGroupHandler=new YI(V(e)),e.getIEmitInst().on(mt.A2KEY_AND_TINYID_UPDATED,e.onContextUpdated,V(e)),e}function gl(e){f(this,gl),this._snsM=e,this._n="FriendGroupHandler",this._map=new Map}function _l(e){f(this,_l),se(e)||(this.name=e.name||"",this.userIDList=e.userIDList||[],this.count=this.userIDList.length||0)}function ml(e){f(this,ml),this._snsM=e,this._n="FriendHandler",this._map=new Map,this._startIdx=0,this._standardSeq=0,this._customSeq=0,this._expirationTime=18e4}function vl(e,t){f(this,vl),this.userID=e,this.remark="",this.groupList=[],this.source="",this.addTime=0,this.friendCustomField=[],this.timestamp=0;var n={},s=[];if(n.userID=e,!se(t))for(var r,a="",l=0,d=t.length;l<d;l++)if(a=t[l].tag,r=t[l].value,-1<a.indexOf("Tag_SNS_Custom"))this.friendCustomField.push({key:a,value:r});else if(-1<a.indexOf("Tag_Profile_Custom"))s.push({key:a,value:r});else switch(a){case Ve.NICK:n.nick=r;break;case Ve.GENDER:n.gender=r;break;case Ve.BIRTHDAY:n.birthday=r;break;case Ve.LOCATION:n.location=r;break;case Ve.SELFSIGNATURE:n.selfSignature=r;break;case Ve.ALLOWTYPE:n.allowType=r;break;case Ve.LANGUAGE:n.language=r;break;case Ve.AVATAR:n.avatar=r;break;case Ve.MESSAGESETTINGS:n.messageSettings=r;break;case Ve.ADMINFORBIDTYPE:n.adminForbidType=r;break;case Ve.LEVEL:n.level=r;break;case Ve.ROLE:n.role=r;break;case Yn.REMARK:this.remark=r;break;case Yn.ADDTIME:this.addTime=r;break;case Yn.GROUP:this.groupList=JSON.parse(JSON.stringify(r));break;case Yn.ADDSOURCE:this.source=r;break;case Yn.ADDWORDING:break;default:m.l("snsProfileItem unknown tag->",t[l].tag)}this.profile=new wr(c(c({},n),{},{profileCustomField:s}))}function yl(e){f(this,yl),this._snsM=e,this._n="FriendApplicationHandler",this._startTime=0,this._maxLimited=100,this._currentSeq=0,this._map=new Map,this._unreadCount=0}function ri(e){f(this,ri),(e=zf.call(this,e))._n="QualityStatModule",e.TAG="im-ssolog-quality-stat",e.reportIndex=0,e.wholePeriod=!1,e._qualityItems=[Jc,Xc,Ks,js,Ws,is,yn,Ys,Nr,Pr],e._messageSentItems=[Ks,js,Ws,is,yn],e._messageReceivedItems=[Ys,Nr,Pr],e.REPORT_INTERVAL=120,e.REPORT_SDKAPPID_BLACKLIST=[],e.REPORT_TINYID_WHITELIST=[],e._statInfoArr=[],e._avgRTT=new VI,e._avgE2EDelay=new qI,e._rateMessageSent=new BI,e._rateMessageReceived=new HI;var t=e.getIEmitInst();return t.on(mt.A2KEY_AND_TINYID_UPDATED,e._onLoginSuccess,V(e)),t.on(mt.CLOUD_CONFIG,e._onCloudConfig,V(e)),e}function Il(){f(this,Il),this._lastMap=new Map,this._currentMap=new Map}function Ml(){f(this,Ml),this._map=new Map}function Cl(){f(this,Cl),this._n="AvgRTT",this._requestCount=0,this._rttArray=[]}function Tl(){f(this,Tl),this._n="AvgE2EDelay",this._e2eDelayArray=[]}function ii(e){return f(this,ii),(e=$f.call(this,e))._n="RecoverMsgModule",e.PULL_LIMIT_COUNT=15,e}function ai(e){return f(this,ai),(e=Jf.call(this,e))._n="CloudControlModule",e._cloudConfig=new Map,e._expiredTime=0,e._version=0,e._isFetching=!1,e}function ci(e){return f(this,ci),(e=Xf.call(this,e))._n="SessionModule",e._platform=e.getPlatform(),e._pHandler=new OI(V(e)),e._msgDispatcher=new PI(V(e)),e._cmdFreqLimitMap=new Map,e._cmdReqInfoMap=new Map,e._serverOverloadInfoMap=new Map,e._incrementalPullContactFlag=!0,e._init(),e.getIEmitInst().on(mt.CLOUD_CONFIG,e._onCloudConfig,V(e)),e}Et.assign,Et.shrinkBuf,Et.setTyped,Et.Buf8,Et.Buf16,Et.Buf32;function El(e,t,n,s){for(var r=65535&e|0,a=e>>>16&65535|0,l=0;n!==0;){for(n-=l=2e3<n?2e3:n;a=a+(r=r+t[s++]|0)|0,--l;);r%=65521,a%=65521}return r|a<<16|0}function uo(e,t,n,s){var r=fM,a=s+n;e^=-1;for(var l=s;l<a;l++)e=e>>>8^r[255&(e^t[l])];return-1^e}function ui(e,t,n,s,r,a,l,d){for(var h,g,_,M,S,D,O,B,U,de=d.bits,rt=0,J=0,ke=0,Ae=0,Be=0,We=0,ot=0,Lt=0,vt=0,gt=0,Ot=null,cs=0,It=new Et.Buf16(16),Ut=new Et.Buf16(16),$t=null,st=0,rt=0;rt<=15;rt++)It[rt]=0;for(J=0;J<s;J++)It[t[n+J]]++;for(Be=de,Ae=15;1<=Ae&&It[Ae]===0;Ae--);if(Ae<Be&&(Be=Ae),Ae===0)return r[a++]=20971520,r[a++]=20971520,d.bits=1,0;for(ke=1;ke<Ae&&It[ke]===0;ke++);for(Be<ke&&(Be=ke),rt=Lt=1;rt<=15;rt++)if((Lt=(Lt<<1)-It[rt])<0)return-1;if(0<Lt&&(e===0||Ae!==1))return-1;for(Ut[1]=0,rt=1;rt<15;rt++)Ut[rt+1]=Ut[rt]+It[rt];for(J=0;J<s;J++)t[n+J]!==0&&(l[Ut[t[n+J]]++]=J);if(D=e===0?(Ot=$t=l,19):e===1?(Ot=hM,cs-=257,$t=gM,st-=257,256):(Ot=_M,$t=mM,-1),rt=ke,S=a,ot=J=gt=0,_=-1,M=(vt=1<<(We=Be))-1,e===1&&852<vt||e===2&&592<vt)return 1;for(;;){for(U=l[J]<D?(B=0,l[J]):l[J]>D?(B=$t[st+l[J]],Ot[cs+l[J]]):(B=96,0),h=1<<(O=rt-ot),ke=g=1<<We;r[S+(gt>>ot)+(g-=h)]=O<<24|B<<16|U|0,g!==0;);for(h=1<<rt-1;gt&h;)h>>=1;if(h!==0?gt=(gt&h-1)+h:gt=0,J++,--It[rt]==0){if(rt===Ae)break;rt=t[n+l[J]]}if(Be<rt&&(gt&M)!==_){for(S+=ke,Lt=1<<(We=rt-(ot=ot===0?Be:ot));We+ot<Ae&&!((Lt-=It[We+ot])<=0);)We++,Lt<<=1;if(vt+=1<<We,e===1&&852<vt||e===2&&592<vt)return 1;r[_=gt&M]=Be<<24|We<<16|S-a|0}}return gt!==0&&(r[S+gt]=rt-ot<<24|64<<16|0),d.bits=Be,0}var fM=function(){for(var e=[],t=0;t<256;t++){for(var n=t,s=0;s<8;s++)n=1&n?3988292384^n>>>1:n>>>1;e[t]=n}return e}(),hM=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],gM=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],_M=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],mM=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function eh(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function vM(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Et.Buf16(320),this.work=new Et.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function th(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Et.Buf32(852),t.distcode=t.distdyn=new Et.Buf32(592),t.sane=1,t.back=-1,0):-2}function nh(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,th(e)):-2}function oh(e,t){var n,s;return e&&e.state?(s=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?-2:(s.window!==null&&s.wbits!==t&&(s.window=null),s.wrap=n,s.wbits=t,nh(e))):-2}function sh(e,t){var n;return e?(n=new vM,(e.state=n).window=null,(n=oh(e,t))!==0&&(e.state=null),n):-2}var Dl,Sl,rh=!0;function ih(a,t,n,s){var r,a=a.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Et.Buf8(a.wsize)),s>=a.wsize?(Et.arraySet(a.window,t,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((r=a.wsize-a.wnext)>s&&(r=s),Et.arraySet(a.window,t,n-s,r,a.wnext),(s-=r)?(Et.arraySet(a.window,t,n-s,s,0),a.wnext=s,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0}var Xs={inflateReset:nh,inflateReset2:oh,inflateResetKeep:th,inflateInit:function(e){return sh(e,15)},inflateInit2:sh,inflate:function(e,t){var n,s,r,a,l,d,h,g,_,M,S,D,O,B,U,de,J,ke,Ae,Be,We,ot,Lt,vt,gt=0,Ot=new Et.Buf8(4),cs=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return-2;(n=e.state).mode===12&&(n.mode=13),l=e.next_out,r=e.output,h=e.avail_out,a=e.next_in,s=e.input,d=e.avail_in,g=n.hold,_=n.bits,M=d,S=h,ot=0;e:for(;;)switch(n.mode){case 1:if(n.wrap===0){n.mode=13;break}for(;_<16;){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}if(2&n.wrap&&g===35615){Ot[n.check=0]=255&g,Ot[1]=g>>>8&255,n.check=uo(n.check,Ot,2,0),_=g=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&g)<<8)+(g>>8))%31){e.msg="incorrect header check",n.mode=30;break}if((15&g)!=8){e.msg="unknown compression method",n.mode=30;break}if(_-=4,We=8+(15&(g>>>=4)),n.wbits===0)n.wbits=We;else if(We>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<We,e.adler=n.check=1,n.mode=512&g?10:12,_=g=0;break;case 2:for(;_<16;){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}if(n.flags=g,(255&n.flags)!=8){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=g>>8&1),512&n.flags&&(Ot[0]=255&g,Ot[1]=g>>>8&255,n.check=uo(n.check,Ot,2,0)),_=g=0,n.mode=3;case 3:for(;_<32;){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}n.head&&(n.head.time=g),512&n.flags&&(Ot[0]=255&g,Ot[1]=g>>>8&255,Ot[2]=g>>>16&255,Ot[3]=g>>>24&255,n.check=uo(n.check,Ot,4,0)),_=g=0,n.mode=4;case 4:for(;_<16;){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}n.head&&(n.head.xflags=255&g,n.head.os=g>>8),512&n.flags&&(Ot[0]=255&g,Ot[1]=g>>>8&255,n.check=uo(n.check,Ot,2,0)),_=g=0,n.mode=5;case 5:if(1024&n.flags){for(;_<16;){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}n.length=g,n.head&&(n.head.extra_len=g),512&n.flags&&(Ot[0]=255&g,Ot[1]=g>>>8&255,n.check=uo(n.check,Ot,2,0)),_=g=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((D=(D=n.length)>d?d:D)&&(n.head&&(We=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),Et.arraySet(n.head.extra,s,a,D,We)),512&n.flags&&(n.check=uo(n.check,s,D,a)),d-=D,a+=D,n.length-=D),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(d===0)break e;for(D=0;We=s[a+D++],n.head&&We&&n.length<65536&&(n.head.name+=String.fromCharCode(We)),We&&D<d;);if(512&n.flags&&(n.check=uo(n.check,s,D,a)),d-=D,a+=D,We)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(d===0)break e;for(D=0;We=s[a+D++],n.head&&We&&n.length<65536&&(n.head.comment+=String.fromCharCode(We)),We&&D<d;);if(512&n.flags&&(n.check=uo(n.check,s,D,a)),d-=D,a+=D,We)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;_<16;){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}if(g!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}_=g=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;_<32;){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}e.adler=n.check=eh(g),_=g=0,n.mode=11;case 11:if(n.havedict===0)return e.next_out=l,e.avail_out=h,e.next_in=a,e.avail_in=d,n.hold=g,n.bits=_,2;e.adler=n.check=1,n.mode=12;case 12:if(t===5||t===6)break e;case 13:if(n.last){g>>>=7&_,_-=7&_,n.mode=27;break}for(;_<3;){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}switch(n.last=1&g,--_,3&(g>>>=1)){case 0:n.mode=14;break;case 1:It=Ut=void 0;var It,Ut=n;if(rh){for(Dl=new Et.Buf32(512),Sl=new Et.Buf32(32),It=0;It<144;)Ut.lens[It++]=8;for(;It<256;)Ut.lens[It++]=9;for(;It<280;)Ut.lens[It++]=7;for(;It<288;)Ut.lens[It++]=8;for(ui(1,Ut.lens,0,288,Dl,0,Ut.work,{bits:9}),It=0;It<32;)Ut.lens[It++]=5;ui(2,Ut.lens,0,32,Sl,0,Ut.work,{bits:5}),rh=!1}if(Ut.lencode=Dl,Ut.lenbits=9,Ut.distcode=Sl,Ut.distbits=5,n.mode=20,t!==6)break;g>>>=2,_-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}g>>>=2,_-=2;break;case 14:for(g>>>=7&_,_-=7&_;_<32;){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}if((65535&g)!=(g>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&g,_=g=0,n.mode=15,t===6)break e;case 15:n.mode=16;case 16:if(D=n.length){if((D=h<(D=d<D?d:D)?h:D)===0)break e;Et.arraySet(r,s,a,D,l),d-=D,a+=D,h-=D,l+=D,n.length-=D;break}n.mode=12;break;case 17:for(;_<14;){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}if(n.nlen=257+(31&g),g>>>=5,_-=5,n.ndist=1+(31&g),g>>>=5,_-=5,n.ncode=4+(15&g),g>>>=4,_-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;_<3;){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}n.lens[cs[n.have++]]=7&g,g>>>=3,_-=3}for(;n.have<19;)n.lens[cs[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,Lt={bits:n.lenbits},ot=ui(0,n.lens,0,19,n.lencode,0,n.work,Lt),n.lenbits=Lt.bits,ot){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;de=(gt=n.lencode[g&(1<<n.lenbits)-1])>>>16&255,J=65535&gt,!((U=gt>>>24)<=_);){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}if(J<16)g>>>=U,_-=U,n.lens[n.have++]=J;else{if(J===16){for(vt=U+2;_<vt;){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}if(g>>>=U,_-=U,n.have===0){e.msg="invalid bit length repeat",n.mode=30;break}We=n.lens[n.have-1],D=3+(3&g),g>>>=2,_-=2}else if(J===17){for(vt=U+3;_<vt;){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}We=0,D=3+(7&(g>>>=U)),g>>>=3,_=_-U-3}else{for(vt=U+7;_<vt;){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}We=0,D=11+(127&(g>>>=U)),g>>>=7,_=_-U-7}if(n.have+D>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;D--;)n.lens[n.have++]=We}}if(n.mode===30)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,Lt={bits:n.lenbits},ot=ui(1,n.lens,0,n.nlen,n.lencode,0,n.work,Lt),n.lenbits=Lt.bits,ot){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,Lt={bits:n.distbits},ot=ui(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,Lt),n.distbits=Lt.bits,ot){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,t===6)break e;case 20:n.mode=21;case 21:if(6<=d&&258<=h){e.next_out=l,e.avail_out=h,e.next_in=a,e.avail_in=d,n.hold=g,n.bits=_,xt=bo=lo=Ft=Io=rt=st=$t=gh=hh=Ul=wl=Pt=en=Zs=Go=fh=Gl=ph=hi=dh=Nt=fi=In=Qt=void 0;var $t,st,rt,Io,Ft,lo,gn=e,PM=S,Qt=gn.state,In=gn.next_in,bo=gn.input,fi=In+(gn.avail_in-5),Nt=gn.next_out,xt=gn.output,dh=Nt-(PM-gn.avail_out),hi=Nt+(gn.avail_out-257),ph=Qt.dmax,Gl=Qt.wsize,fh=Qt.whave,Go=Qt.wnext,Zs=Qt.window,en=Qt.hold,Pt=Qt.bits,wl=Qt.lencode,Ul=Qt.distcode,hh=(1<<Qt.lenbits)-1,gh=(1<<Qt.distbits)-1;t:do for(Pt<15&&(en+=bo[In++]<<Pt,Pt+=8,en+=bo[In++]<<Pt,Pt+=8),$t=wl[en&hh];;){if(en>>>=st=$t>>>24,Pt-=st,(st=$t>>>16&255)==0)xt[Nt++]=65535&$t;else{if(!(16&st)){if(!(64&st)){$t=wl[(65535&$t)+(en&(1<<st)-1)];continue}if(32&st){Qt.mode=12;break t}gn.msg="invalid literal/length code",Qt.mode=30;break t}for(rt=65535&$t,(st&=15)&&(Pt<st&&(en+=bo[In++]<<Pt,Pt+=8),rt+=en&(1<<st)-1,en>>>=st,Pt-=st),Pt<15&&(en+=bo[In++]<<Pt,Pt+=8,en+=bo[In++]<<Pt,Pt+=8),$t=Ul[en&gh];;){if(en>>>=st=$t>>>24,Pt-=st,!(16&(st=$t>>>16&255))){if(!(64&st)){$t=Ul[(65535&$t)+(en&(1<<st)-1)];continue}gn.msg="invalid distance code",Qt.mode=30;break t}if(Io=65535&$t,Pt<(st&=15)&&(en+=bo[In++]<<Pt,(Pt+=8)<st&&(en+=bo[In++]<<Pt,Pt+=8)),(Io+=en&(1<<st)-1)>ph){gn.msg="invalid distance too far back",Qt.mode=30;break t}if(en>>>=st,Pt-=st,Io>(st=Nt-dh)){if((st=Io-st)>fh&&Qt.sane){gn.msg="invalid distance too far back",Qt.mode=30;break t}if(lo=Zs,(Ft=0)===Go){if(Ft+=Gl-st,st<rt){for(rt-=st;xt[Nt++]=Zs[Ft++],--st;);Ft=Nt-Io,lo=xt}}else if(Go<st){if(Ft+=Gl+Go-st,(st-=Go)<rt){for(rt-=st;xt[Nt++]=Zs[Ft++],--st;);if(Ft=0,Go<rt){for(rt-=st=Go;xt[Nt++]=Zs[Ft++],--st;);Ft=Nt-Io,lo=xt}}}else if(Ft+=Go-st,st<rt){for(rt-=st;xt[Nt++]=Zs[Ft++],--st;);Ft=Nt-Io,lo=xt}for(;2<rt;)xt[Nt++]=lo[Ft++],xt[Nt++]=lo[Ft++],xt[Nt++]=lo[Ft++],rt-=3;rt&&(xt[Nt++]=lo[Ft++],1<rt&&(xt[Nt++]=lo[Ft++]))}else{for(Ft=Nt-Io;xt[Nt++]=xt[Ft++],xt[Nt++]=xt[Ft++],xt[Nt++]=xt[Ft++],2<(rt-=3););rt&&(xt[Nt++]=xt[Ft++],1<rt&&(xt[Nt++]=xt[Ft++]))}break}}break}while(In<fi&&Nt<hi);In-=rt=Pt>>3,en&=(1<<(Pt-=rt<<3))-1,gn.next_in=In,gn.next_out=Nt,gn.avail_in=In<fi?fi-In+5:5-(In-fi),gn.avail_out=Nt<hi?hi-Nt+257:257-(Nt-hi),Qt.hold=en,Qt.bits=Pt,l=e.next_out,r=e.output,h=e.avail_out,a=e.next_in,s=e.input,d=e.avail_in,g=n.hold,_=n.bits,n.mode===12&&(n.back=-1);break}for(n.back=0;de=(gt=n.lencode[g&(1<<n.lenbits)-1])>>>16&255,J=65535&gt,!((U=gt>>>24)<=_);){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}if(de&&!(240&de)){for(ke=U,Ae=de,Be=J;de=(gt=n.lencode[Be+((g&(1<<ke+Ae)-1)>>ke)])>>>16&255,J=65535&gt,!(ke+(U=gt>>>24)<=_);){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}g>>>=ke,_-=ke,n.back+=ke}if(g>>>=U,_-=U,n.back+=U,n.length=J,de===0){n.mode=26;break}if(32&de){n.back=-1,n.mode=12;break}if(64&de){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&de,n.mode=22;case 22:if(n.extra){for(vt=n.extra;_<vt;){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}n.length+=g&(1<<n.extra)-1,g>>>=n.extra,_-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;de=(gt=n.distcode[g&(1<<n.distbits)-1])>>>16&255,J=65535&gt,!((U=gt>>>24)<=_);){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}if(!(240&de)){for(ke=U,Ae=de,Be=J;de=(gt=n.distcode[Be+((g&(1<<ke+Ae)-1)>>ke)])>>>16&255,J=65535&gt,!(ke+(U=gt>>>24)<=_);){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}g>>>=ke,_-=ke,n.back+=ke}if(g>>>=U,_-=U,n.back+=U,64&de){e.msg="invalid distance code",n.mode=30;break}n.offset=J,n.extra=15&de,n.mode=24;case 24:if(n.extra){for(vt=n.extra;_<vt;){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}n.offset+=g&(1<<n.extra)-1,g>>>=n.extra,_-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(h===0)break e;if(n.offset>(D=S-h)){if((D=n.offset-D)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}O=D>n.wnext?(D-=n.wnext,n.wsize-D):n.wnext-D,D>n.length&&(D=n.length),B=n.window}else B=r,O=l-n.offset,D=n.length;for(h-=D=h<D?h:D,n.length-=D;r[l++]=B[O++],--D;);n.length===0&&(n.mode=21);break;case 26:if(h===0)break e;r[l++]=n.length,h--,n.mode=21;break;case 27:if(n.wrap){for(;_<32;){if(d===0)break e;d--,g|=s[a++]<<_,_+=8}if(S-=h,e.total_out+=S,n.total+=S,S&&(e.adler=n.check=(n.flags?uo:El)(n.check,r,S,l-S)),S=h,(n.flags?g:eh(g))!==n.check){e.msg="incorrect data check",n.mode=30;break}_=g=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;_<32;){if(d===0)break e;d--,g+=s[a++]<<_,_+=8}if(g!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}_=g=0}n.mode=29;case 29:ot=1;break e;case 30:ot=-3;break e;case 31:return-4;default:return-2}return e.next_out=l,e.avail_out=h,e.next_in=a,e.avail_in=d,n.hold=g,n.bits=_,(n.wsize||S!==e.avail_out&&n.mode<30&&(n.mode<27||t!==4))&&ih(e,e.output,e.next_out,S-e.avail_out),M-=e.avail_in,S-=e.avail_out,e.total_in+=M,e.total_out+=S,n.total+=S,n.wrap&&S&&(e.adler=n.check=(n.flags?uo:El)(n.check,r,S,e.next_out-S)),e.data_type=n.bits+(n.last?64:0)+(n.mode===12?128:0)+(n.mode===20||n.mode===15?256:0),ot=(M==0&&S===0||t===4)&&ot===0?-5:ot},inflateEnd:function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},inflateGetHeader:function(e,t){var n;return!e||!e.state||!(2&(n=e.state).wrap)?-2:((n.head=t).done=!1,0)},inflateSetDictionary:function(e,t){var n,s=t.length;return!e||!e.state||(n=e.state).wrap!==0&&n.mode!==11?-2:n.mode===11&&El(1,t,s,0)!==n.check?-3:ih(e,t,s,s)?(n.mode=31,-4):(n.havedict=1,0)},inflateInfo:"pako inflate (from Nodeca project)"},ah=!0,ch=!0;try{String.fromCharCode.apply(null,[0])}catch{ah=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{ch=!1}for(var li=new Et.Buf8(256),No=0;No<256;No++)li[No]=252<=No?6:248<=No?5:240<=No?4:224<=No?3:192<=No?2:1;li[254]=li[254]=1;function yM(e,t){for(var n,s,r=t||e.length,a=new Array(2*r),l=0,d=0;d<r;)if((n=e[d++])<128)a[l++]=n;else if(4<(s=li[n]))a[l++]=65533,d+=s-1;else{for(n&=s===2?31:s===3?15:7;1<s&&d<r;)n=n<<6|63&e[d++],s--;1<s?a[l++]=65533:n<65536?a[l++]=n:(n-=65536,a[l++]=55296|n>>10&1023,a[l++]=56320|1023&n)}var h=a,g=l;if(g<65534&&(h.subarray&&ch||!h.subarray&&ah))return String.fromCharCode.apply(null,Et.shrinkBuf(h,g));for(var _="",M=0;M<g;M++)_+=String.fromCharCode(h[M]);return _}function IM(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}function MM(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var jt={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},Ll={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},uh=Object.prototype.toString;function as(n){if(!(this instanceof as))return new as(n);this.options=Et.assign({chunkSize:16384,windowBits:0,to:""},n||{});var t=this.options,n=(t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||n&&n.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new IM,this.strm.avail_out=0,Xs.inflateInit2(this.strm,t.windowBits));if(n!==jt.Z_OK)throw new Error(Ll[n]);if(this.header=new MM,Xs.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=function(s){for(var r,a,l,d,h=s.length,g=0,_=0;_<h;_++)(64512&(a=s.charCodeAt(_)))==55296&&_+1<h&&(64512&(l=s.charCodeAt(_+1)))==56320&&(a=65536+(a-55296<<10)+(l-56320),_++),g+=a<128?1:a<2048?2:a<65536?3:4;for(r=new Et.Buf8(g),_=d=0;d<g;_++)(64512&(a=s.charCodeAt(_)))==55296&&_+1<h&&(64512&(l=s.charCodeAt(_+1)))==56320&&(a=65536+(a-55296<<10)+(l-56320),_++),a<128?r[d++]=a:(a<2048?r[d++]=192|a>>>6:(a<65536?r[d++]=224|a>>>12:(r[d++]=240|a>>>18,r[d++]=128|a>>>12&63),r[d++]=128|a>>>6&63),r[d++]=128|63&a);return r}(t.dictionary):uh.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Xs.inflateSetDictionary(this.strm,t.dictionary))!==jt.Z_OK))throw new Error(Ll[n])}function Rl(e,t){if(t=new as(t),t.push(e,!0),t.err)throw t.msg||Ll[t.err];return t.result}as.prototype.push=function(e,t){var n,s,r,a,l,d=this.strm,h=this.options.chunkSize,g=this.options.dictionary,_=!1;if(this.ended)return!1;s=t===~~t?t:t===!0?jt.Z_FINISH:jt.Z_NO_FLUSH,typeof e=="string"?d.input=function(M){for(var S=new Et.Buf8(M.length),D=0,O=S.length;D<O;D++)S[D]=M.charCodeAt(D);return S}(e):uh.call(e)==="[object ArrayBuffer]"?d.input=new Uint8Array(e):d.input=e,d.next_in=0,d.avail_in=d.input.length;do{if(d.avail_out===0&&(d.output=new Et.Buf8(h),d.next_out=0,d.avail_out=h),(n=(n=Xs.inflate(d,jt.Z_NO_FLUSH))===jt.Z_NEED_DICT&&g?Xs.inflateSetDictionary(this.strm,g):n)===jt.Z_BUF_ERROR&&_===!0&&(n=jt.Z_OK,_=!1),n!==jt.Z_STREAM_END&&n!==jt.Z_OK)return this.onEnd(n),!(this.ended=!0);d.next_out&&(d.avail_out!==0&&n!==jt.Z_STREAM_END&&(d.avail_in!==0||s!==jt.Z_FINISH&&s!==jt.Z_SYNC_FLUSH)||(this.options.to==="string"?(r=function(M,S){for(var D=(S=(S=S||M.length)>M.length?M.length:S)-1;0<=D&&(192&M[D])==128;)D--;return!(D<0||D===0)&&D+li[M[D]]>S?D:S}(d.output,d.next_out),a=d.next_out-r,l=yM(d.output,r),d.next_out=a,d.avail_out=h-a,a&&Et.arraySet(d.output,d.output,r,a,0),this.onData(l)):this.onData(Et.shrinkBuf(d.output,d.next_out)))),d.avail_in===0&&d.avail_out===0&&(_=!0)}while((0<d.avail_in||d.avail_out===0)&&n!==jt.Z_STREAM_END);return(s=n===jt.Z_STREAM_END?jt.Z_FINISH:s)===jt.Z_FINISH?(n=Xs.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===jt.Z_OK):s!==jt.Z_SYNC_FLUSH||(this.onEnd(jt.Z_OK),!(d.avail_out=0))},as.prototype.onData=function(e){this.chunks.push(e)},as.prototype.onEnd=function(e){e===jt.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Et.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},Ke={},(0,Et.assign)(Ke,{Inflate:as,inflate:Rl,inflateRaw:function(e,t){return(t=t||{}).raw=!0,Rl(e,t)},ungzip:Rl},jt);var lh,CM=Ke,TM=(y(bl,[{key:"inflate",value:function(s){var t,s=new Uint8Array(s).slice(4),n=Date.now();try{t=CM.inflate(s,{to:"string"}),this._bLogForInflateOK||(this._bLogForInflateOK=!0,new K("inflateOK").end())}catch(a){return this._bLogForInflateError?void 0:(this._bLogForInflateError=!0,void new K("inflateError").setMessage(a).end())}var s=s.length+4,r=t.length;return m.d("inflate ok. zipped:".concat(s," unzipped:").concat(r)+" compression ratio:".concat(Math.round(100*(r-s)/r),"% cost:").concat(Date.now()-n)),t}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._bLogForInflateOK=!1,this._bLogForInflateError=!1}}]),bl),Po="Message",Ia="User",kl="Group",Al="GroupMember",EM=["count"],DM=["conversationID","timePosition","timePeriod"],SM=["miniBirthday","maxBirthday"],LM=(C(je={},Po,E.CS),C(je,Ia,E.USER_CS),C(je,kl,E.GRP_CS),C(je,Al,E.MBR_CS),je),RM=(T(di,St),lh=z(di),y(di,[{key:"searchCloudMessages",value:function(e){return this.search(Po,e)}},{key:"searchCloudUsers",value:function(e){return this.search(Ia,e)}},{key:"searchCloudGroups",value:function(e){return this.search(kl,e)}},{key:"searchCloudGroupMembers",value:function(e){return this.search(Al,e)}},{key:"search",value:function(e,t){var n=this,s="searchCloud".concat(e,"s"),r="".concat(this._n,".").concat(s);if(!t)return A({code:F.OPTIONS_IS_EMPTY,message:this.getErrMsg(F.OPTIONS_IS_EMPTY,s)});var a=t.keywordList,l=Fc(a),d=t.count;if(t.count&&(d=parseInt(d)),e===Po&&!l&&!Fc(t.senderUserIDList)&&!Fc(t.messageTypeList)||e!==Po&&!l)throw m.e("[".concat(s,'] Missing required params: "keywordList".')),new Error("Params validate failed.");var h=Date.now(),g=new K(s),_="keywordList:".concat(a," keywordListMatchType:").concat(t.keywordListMatchType," cursor:").concat(t.cursor," count:").concat(d);return m.l("".concat(r," ").concat(_)),this.req({P:LM[e],data:this._genParams(e,t)}).then(function(M){var S=M.data,O=S.code,S=S.message;if(O!==0)return(D=O)===60020?D="SearchUnable":e!==Po&&O===27003?D="SearchParamsError":e!==Po&&O===60018&&(D="SearchOverLimit"),D=n.getErrMsg(D)||S,S=new yt({code:O,message:D}),g.setMessage(_).setError(S).end(),A(S);n.get(27).isCSPluginEnabled();var O=M.data,D=O.cursor,S=D===void 0?"":D,D=O.totalCount,O="totalCount:".concat(D," cost:").concat(Kt(h)),O=(m.l("".concat(r," ok. cursor:").concat(S," ").concat(O)),g.setMessage("".concat(_," ").concat(O)).end(),n._genRes(e,t,M.data));return me({searchResultList:O,cursor:S,totalCount:D})}).catch(function(M){return g.setMessage(_).setError(M).end(),A(M)})}},{key:"_genParams",value:function(e,t){var n=t.count,s=G(t,EM);return n&&(s.count=parseInt(n)),e===Po?this._genMsgParams(s):(n=t.keywordList,t=t.keywordListMatchType,s.keywords=n,s.keywordMatchType=t==="and"?1:0,e===Ia?this._genUserParams(s):s)}},{key:"_genMsgParams",value:function(r){var t=r.conversationID,n=r.timePosition,s=r.timePeriod,r=G(r,DM);return H(t)||(Zt(t)&&(r.account=t.replace(I.CONV_C2C,"")),ln(t)&&(r.groupID=t.replace(I.CONV_GROUP,""))),Qe(s)&&0<s&&(Qe(n)&&0<n?r.startTime=n-s:r.startTime=Mr()-s),r.startTime&&r.startTime<0&&(r.startTime=void 0),Qe(n)&&0<n&&(r.endTime=n),r}},{key:"_genUserParams",value:function(s){var t=s.miniBirthday,n=s.maxBirthday,s=G(s,SM);return Qe(t)&&(s.miniBirthday=parseInt(t),Qe(n)||(s.maxBirthday=4294967295)),Qe(n)&&(s.maxBirthday=parseInt(n)),s}},{key:"_genRes",value:function(e,t,n){switch(e){case Po:return this._genMsgRes(n.searchResult,!t.conversationID);case Ia:return this._genUserRes(n.userList);case kl:return this._genGrpRes(n.groupList);case Al:return this._genMemberRes(n.groupMemberList);default:return[]}}},{key:"_genMsgRes",value:function(e,t){var n=this.get(11);return _e(e)&&e.length!==0?e.map(function(l){var r=l.groupID,d=l.userID,a=l.messageCount,l=l.messageList,l=l===void 0?[]:l,d=r?"".concat(I.CONV_GROUP).concat(r):"".concat(I.CONV_C2C).concat(d),h={conversationID:d,messageCount:a,messageList:[]};return t&&1<a?h:(a=l.filter(function(g){return!!g}),0<a.length&&(l=n.onRoamingMessage(a,d,!1),r&&l.reverse(),h.messageList=l,h.messageCount=l.length),h)}):[]}},{key:"_genUserRes",value:function(e){var t=this.get(4)._profileHandler;if(!_e(e))return[];for(var n=[],s=0,r=e.length;s<r;s++){var l=e[s],a=l.userID,l=l.profileItems;a!=="@TLS#NOT_FOUND"&&a!==""&&(a=t._update(a,t._getLatestProfileFromResponse(a,l)).latestProfile,n.push(a))}return n}},{key:"_genGrpRes",value:function(e){if(!_e(e))return[];for(var t=[],n=0,s=e.length;n<s;n++)e[n]&&e[n].groupID&&t.push(new co(e[n]));return t}},{key:"_genMemberRes",value:function(e){if(!_e(e))return[];for(var t,n,s,r,a,l,d=new Map,h=0,g=e.length;h<g;h++)e[h]&&e[h].userID&&e[h].groupID&&(n=(t=e[h]).groupID,r=t.name,a=t.type,l=t.avatar,s=t.nick,r={groupID:n,name:r,type:a,avatar:l},a={userID:t.userID,nick:s,nameCard:t.nameCard},d.has(n)?((l=d.get(n)).memberList.push(a),d.set(n,l)):d.set(n,{groupInfo:r,memberList:[a]}));return q(d.values())}}]),di),kM=(y(Pl,[{key:"_startTimer",value:function(){var e=this._map.get(24),t=e.isWorkerEnabled();m.l("".concat(this._n,".startTimer isWorkerEnabled:").concat(t," seed:").concat(this._checkTimer)),t?e.startWorkerTimer():this._startMainThreadTimer()}},{key:"_startMainThreadTimer",value:function(){this._checkTimer<0&&(this._checkTimer=setInterval(this.onCheckTimer.bind(this),1e3)),m.l("".concat(this._n,"._startMainThreadTimer seed:").concat(this._checkTimer))}},{key:"stopTimer",value:function(){var e=this._map.get(24),t=e.isWorkerEnabled();m.l("".concat(this._n,".stopTimer isWorkerEnabled:").concat(t," seed:").concat(this._checkTimer)),t?e.stopWorkerTimer():this._stopMainThreadTimer()}},{key:"_stopMainThreadTimer",value:function(){m.l("".concat(this._n,"._stopMainThreadTimer")),0<this._checkTimer&&(clearInterval(this._checkTimer),this._checkTimer=-1,this._checkCount=0)}},{key:"_stopMainThreadSocket",value:function(){m.l("".concat(this._n,"._stopMainThreadSocket"));var e=this._map.get(21);e.setIsWorkerEnabled(!0),e.reConnect()}},{key:"_startMainThreadSocket",value:function(){m.l("".concat(this._n,"._startMainThreadSocket"));var e=this._map.get(21);e.setIsWorkerEnabled(!1),e.reConnect()}},{key:"onWorkerTimerEnabled",value:function(){m.l("".concat(this._n,".onWorkerTimerEnabled, disable main thread timer and socket")),this._stopMainThreadTimer(),this._stopMainThreadSocket()}},{key:"onWorkerTimerDisabled",value:function(){m.l("".concat(this._n,".onWorkerTimerDisabled, enable main thread timer and socket")),this._startMainThreadTimer(),this._startMainThreadSocket()}},{key:"onCheckTimer",value:function(){this._checkCount+=1;var e,t=ye(this._map);try{for(t.s();!(e=t.n()).done;){var n=te(e.value,2)[1];n.onCheckTimer&&n.onCheckTimer(this._checkCount)}}catch(s){t.e(s)}finally{t.f()}}},{key:"_initReadyList",value:function(){var e=this;this._readyList=[this._map.get(1)],this._readyList.forEach(function(t){t.ready(function(){return e._onModuleReady()})})}},{key:"_onModuleReady",value:function(){var e,t,n=!0;this._readyList.forEach(function(s){s.isReady()||(n=!1)}),n&&!this._isReady&&(this._isReady=!0,this._oEmitter.emit($.SDK_READY),e=Date.now()-this._startLoginTs,m.w("SDK is ready. cost ".concat(e," ms")),this._startLoginTs=Date.now(),t=this._ssoLogForReady.getStartTs()+Cr,this._ssoLogForReady.setMessage(e).start(t).end())}},{key:"login",value:function(){this._startLoginTs===0&&(Ap(),this._startLoginTs=Date.now(),this._startTimer(),this._map.get(15).start(),this._ssoLogForReady=new K("sdkReady"),this._reason=F.LOGGING_IN)}},{key:"onLoginFailed",value:function(){this._startLoginTs=0}},{key:"getOEmitInst",value:function(){return this._oEmitter===null&&(this._oEmitter=new Af,e=this._oEmitter,rs=e,this._oEmitter._emit=this._oEmitter.emit,this._oEmitter.emit=(function(t,n){var s,r,a=this;this._canIUseSignaling()&&(t===$.MESSAGE_RECEIVED&&this.get(33).onNewMessageList(n),t===$.MESSAGE_MODIFIED&&this.get(33).onMessageModified(n)),t===$.CONVERSATION_LIST_UPDATED||t===$.FRIEND_LIST_UPDATED||t===$.GROUP_LIST_UPDATED||t===$.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED?this._eventThrottling!==!1?this._eventThrottleMap.has(t)?(s=Date.now())-(r=this._eventThrottleMap.get(t)).last<=1e3?(-1<r.timeoutID&&clearTimeout(r.timeoutID),r.timeoutID=setTimeout(function(){r.last=Date.now(),a._oEmitter._emit.apply(a._oEmitter,[t,{name:t,data:a._getEventData(t)}])},1e3)):(r.last=s,this._oEmitter._emit.apply(this._oEmitter,[t,{name:t,data:this._getEventData(t)}])):(this._eventThrottleMap.set(t,{last:Date.now(),timeoutID:-1}),this._oEmitter._emit.apply(this._oEmitter,[t,{name:t,data:this._getEventData(t)}])):this._oEmitter._emit.apply(this._oEmitter,[t,{name:t,data:this._getEventData(t)}]):this._oEmitter._emit.apply(this._oEmitter,[t,{name:t,data:n}])}).bind(this)),this._oEmitter;var e}},{key:"_canIUseSignaling",value:function(){var e=this.get(33);return!!e&&e.canIUseSignaling()}},{key:"_getEventData",value:function(e){return e===$.CONVERSATION_LIST_UPDATED?this._map.get(12).isPartialUpdatedConvs()?this._map.get(11).getPartialUpdatedConvs():this._map.get(11).getLocalConvList():e===$.FRIEND_LIST_UPDATED?this._map.get(8).getLocalFriendList(!1):e===$.GROUP_LIST_UPDATED?this._map.get(7).getLocalGroupList():e===$.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED?this._map.get(11).getTotalUnreadCount():e===$.CONVERSATION_ID_LIST_UPDATED?this._map.get(11).getUpdatedConvIDList():void 0}},{key:"getIEmitInst",value:function(){return this._iEmitter===null&&(this._iEmitter=new Af,this._iEmitter._emit=this._iEmitter.emit,this._iEmitter.emit=(function(e,t){e=dt(t)&&t.data?[e,{name:e,data:t.data}]:[e,{name:e,data:t}],this._iEmitter._emit.apply(this._iEmitter,e)}).bind(this)),this._iEmitter}},{key:"hasModule",value:function(e){return this._map.has(e)}},{key:"get",value:function(e){return this._map.get(e)}},{key:"canIUseModule",value:function(e){return!this._map.get(12).isUsingChatCore()||this._optionalModuleMap.has(e)}},{key:"canIUseInflate",value:function(){return!!this._map.get(37)}},{key:"isReady",value:function(){return this._isReady}},{key:"isIntl",value:function(){return this.get(12).isIntl()}},{key:"getNotReadyReason",value:function(){return this._reason}},{key:"setNotReadyReason",value:function(e){this._reason=e}},{key:"getErrMsg",value:function(e,t,n){return this._map.get(32).get({key:e,replacement1:t,replacement2:n,isIntl:this.isIntl()})}},{key:"warn",value:function(e,t,n){e=this.getErrMsg(e,t,n),e&&m.w(e)}},{key:"onError",value:function(e){var t="code:".concat(e.code," message:").concat(e.message);m.w("Oops! ".concat(t)),new K("error").setMessage(t).setLevel("error").end(),this.getOEmitInst().emit($.ERROR,e)}},{key:"restartTimer",value:function(){m.l("".concat(this._n,".restartTimer")),this.stopTimer(),this._startTimer();var e=this.get(7);e&&e.restartPolling()}},{key:"getTimerID",value:function(){var e=this._map.get(24);return e.isWorkerEnabled()?e.getTimerID():this._checkTimer}},{key:"getPollingTimerID",value:function(e){return this._map.get(7).getPollingTimerID(e)}},{key:"statTUIKeyFeatures",value:function(n){var t=n.code,n=n.msg,n=n===void 0?"":n,s=t+n;this._codeMsgForTUIMap.has(s)||(this._codeMsgForTUIMap.set(s,1),s=this.get(12).getUIPlatform(),new K("tui_key_features").setCode(t).setMessage(n).setUIPlatform(s).end())}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),Ap();var e,t=ye(this._map);try{for(t.s();!(e=t.n()).done;){var n=te(e.value,2)[1];n.reset&&n.reset()}}catch(l){t.e(l)}finally{t.f()}this._startLoginTs=0,this._initReadyList(),this._isReady=!1,this.stopTimer(),this._oEmitter.emit($.SDK_NOT_READY);var s,r=ye(this._eventThrottleMap);try{for(r.s();!(s=r.n()).done;){var a=te(s.value,2)[1];-1<a.timeoutID&&clearTimeout(a.timeoutID)}}catch(l){r.e(l)}finally{r.f()}this._eventThrottleMap.clear(),this._codeMsgForTUIMap.clear()}}]),Pl),AM=(y(Nl,[{key:"defense",value:function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:void 0;if(typeof e!="string"||e.length===0||typeof t!="function")return null;if(this._funcMap.has(e)&&this._funcMap.get(e).has(t))return this._funcMap.get(e).get(t);this._funcMap.has(e)||this._funcMap.set(e,new Map);var s=null;return this._funcMap.get(e).has(t)?s=this._funcMap.get(e).get(t):(s=this._pack(e,t,n),this._funcMap.get(e).set(t,s)),s}},{key:"defenseOnce",value:function(e,t){return typeof t!="function"?null:this._pack(e,t,2<arguments.length&&arguments[2]!==void 0?arguments[2]:void 0)}},{key:"find",value:function(e,t){return typeof e!="string"||e.length===0||typeof t!="function"?null:this._funcMap.has(e)&&this._funcMap.get(e).has(t)?this._funcMap.get(e).get(t):(this._m.warn("ListenerFnNotFound",e),null)}},{key:"delete",value:function(e,t){return typeof t=="function"&&!!this._funcMap.has(e)&&!!this._funcMap.get(e).has(t)&&(this._funcMap.get(e).delete(t),this._funcMap.get(e).size===0&&this._funcMap.delete(e),!0)}},{key:"_pack",value:function(e,t,n){var s=this;return function(){try{t.apply(n,Array.from(arguments))}catch(l){var r=Object.values($).indexOf(e),a="CallbackError";r!==-1&&(r=Object.keys($)[r],s._m.warn(a,r,l)),s._reportCount<5&&(new K(a).setMessage("eventName:".concat(e)).setMoreMessage(l.message).end(),s._reportCount+=1)}}}},{key:"destroy",value:function(){this._funcMap.clear()}},{key:"reset",value:function(){m.l("".concat(this._n,".reset")),this._reportCount=0}}]),Nl),OM=(y(Ol,[{key:"onError",value:function(e){this._m.onError(e)}},{key:"login",value:function(e){return this._m.login(),this._get(1).login(e)}},{key:"logout",value:function(){var e=this;return this._get(1).logout().then(function(t){return e._safetyCallbackFactory.reset(),e._m.reset(),t})}},{key:"getLoginUser",value:function(){return this._get(1).getLoginUser()}},{key:"getServerTime",value:function(){return Wn()}},{key:"isReady",value:function(){return this._m.isReady()}},{key:"isIntl",value:function(){return this._m.isIntl()}},{key:"getNotReadyReason",value:function(){return this._m.getNotReadyReason()}},{key:"getErrMsg",value:function(e,t,n){return this._m.getErrMsg(e,t,n)}},{key:"_get",value:function(e){return this._m.get(e)}},{key:"destroy",value:function(){var e=this,t=this._get(12),n=t.getSDKAppID();return m.w("destroy ".concat(n," ").concat(t.getInstanceID())),this.logout().finally(function(){e._safetyCallbackFactory.destroy(),e._m.stopTimer(),e._get(24).terminate(),e._get(21).dealloc(),e._m.getOEmitInst().emit($.SDK_DESTROY,{SDKAppID:n})})}},{key:"on",value:function(e,t,n){m.d("on","eventName:".concat(e)),this._m.getOEmitInst().on(e,this._safetyCallbackFactory.defense(e,t,n),n)}},{key:"once",value:function(e,t,n){m.d("once","eventName:".concat(e)),this._m.getOEmitInst().once(e,this._safetyCallbackFactory.defenseOnce(e,t,n),n||this)}},{key:"off",value:function(e,t,n,s){m.d("off","eventName:".concat(e));var r=this._safetyCallbackFactory.find(e,t);r!==null&&(this._m.getOEmitInst().off(e,r,n,s),this._safetyCallbackFactory.delete(e,t))}},{key:"registerPlugin",value:function(e){(H(e["tim-push"])?H(e["tim-offline-push-plugin"])?this._get(18):this._get(28):this._get(36)).registerPlugin(e)}},{key:"setLogLevel",value:function(e){var t;e<=0&&((t=this.getErrMsg("TIM_ASCII_ART"))&&console.log(t),(t=this.getErrMsg("API_REFER"))&&(jc()?console.log("%c ".concat("IM SDK API ->"," %c"),"background:#ff9d00; padding:1px; border-radius:3px; color: #fff","background:transparent",t):console.log("IM SDK API ->",t)),(t=this.getErrMsg("DOCS_GUIDE"))&&console.log(t),t=this.getErrMsg("IOS_WEBVIEW_WARNING"),yr&&t&&console.warn(t)),m.setLevel(e)}},{key:"createTextMessage",value:function(e){return this._get(2).createTextMessage(e)}},{key:"createTextAtMessage",value:function(e){return this._get(2).createTextMessage(e)}},{key:"createImageMessage",value:function(e){return this._get(2).createImageMessage(e)}},{key:"createAudioMessage",value:function(e){return this._get(2).createAudioMessage(e)}},{key:"createVideoMessage",value:function(e){return this._get(2).createVideoMessage(e)}},{key:"createCustomMessage",value:function(e){return this._get(2).createCustomMessage(e)}},{key:"createFaceMessage",value:function(e){return this._get(2).createFaceMessage(e)}},{key:"createFileMessage",value:function(e){return this._get(2).createFileMessage(e)}},{key:"createLocationMessage",value:function(e){return this._get(2).createLocationMessage(e)}},{key:"createMergerMessage",value:function(e){return this._get(2).createMergerMessage(e)}},{key:"downloadMergerMessage",value:function(e){return e.type!==I.MSG_MERGER?A({code:F.MSG_MERGER_TYPE_INVALID}):se(e.payload.downloadKey)?A({code:F.MSG_MERGER_KEY_INVALID}):this._get(2).downloadMergerMessage(e).catch(function(t){return A({code:F.MSG_MERGER_DOWNLOAD_FAIL})})}},{key:"createForwardMessage",value:function(e){return this._get(2).createForwardMessage(e)}},{key:"sendMessage",value:function(e,t){return e instanceof Bt?this._get(2).sendMessageInstance(e,t):A({code:F.MSG_INSTANCE_REQUIRED})}},{key:"callExperimentalAPI",value:function(e,t){return e==="sendComboMessage"?this._get(31).sendMessage(t):e==="handleGroupInvitation"?this._get(7).handleGroupInvitation(t):e==="isCommercialAbilityEnabled"?this._get(27).isFeatureEnabled(t):e==="isFeatureEnabledForStat"?this._get(27).isFeatureEnabledForStat(t):e==="isIntl"?this.isIntl():e==="sendTRTCCustomData"||e==="sendRoomCustomData"?this._get(30).sendTRTCCustomData(t):e==="getTimerID"?this._m.getTimerID():e==="getPollingTimerID"?this._m.getPollingTimerID(t):e==="setApplicationID"?(this._get(12).setApplicationID(t),void this._get(20).updateProtocolConfig()):e==="getServerConfig"?this._get(23).getServerConfig(t):e==="canIUseModule"?this._m.canIUseModule(t):e==="startMessageLongPolling"?this._get(7).startMessageLongPolling(t):e==="stopMessageLongPolling"?this._get(7).stopMessageLongPolling(t):e==="disableMessagePullOnInvite"?this._get(11).disableMsgPullOnInvite(t):e==="clearLocalMessage"?this._get(11).clearMemMsg(t,!1):e==="setCustomLoginInfo"?this._get(12).setCustomLoginInfo(t):e==="statTUIKeyFeatures"?this._m.statTUIKeyFeatures(t):A({code:F.INVALID_OPERATION})}},{key:"revokeMessage",value:function(e){return this._get(2).revokeMessage(e)}},{key:"resendMessage",value:function(e,t){return e instanceof Bt?this._get(2).resendMessage(e,t):A({code:F.MSG_INSTANCE_REQUIRED})}},{key:"deleteMessage",value:function(e){return this._get(2).deleteMessage(e)}},{key:"translateText",value:function(e){return this._get(2).translateText(e)}},{key:"convertVoiceToText",value:function(e){return this._get(2).convertVoiceToText(e)}},{key:"setMessageExtensions",value:function(e,t){return this._get(3).setMessageExtensions(e,t)}},{key:"getMessageExtensions",value:function(e){return this._get(3).getMessageExtensions(e)}},{key:"deleteMessageExtensions",value:function(e,t){return this._get(3).deleteMessageExtensions(e,t)}},{key:"addMessageReaction",value:function(e,t){return this._get(34).addMessageReaction(e,t)}},{key:"removeMessageReaction",value:function(e,t){return this._get(34).removeMessageReaction(e,t)}},{key:"getMessageReactions",value:function(e){return this._get(34).getMessageReactions(e)}},{key:"getAllUserListOfMessageReaction",value:function(e){return this._get(34).getAllUserListOfMessageReaction(e)}},{key:"modifyMessage",value:function(e){return this._get(2).modifyRemoteMessage(e)}},{key:"getMessageList",value:function(e){return this._get(11).getMessageList(e)}},{key:"getMessageListHopping",value:function(e){return this._get(11).getMessageListHopping(e)}},{key:"sendMessageReadReceipt",value:function(e){return this._get(11).sendReadReceipt(e)}},{key:"getMessageReadReceiptList",value:function(e){return this._get(11).getReadReceiptList(e)}},{key:"getGroupMessageReadMemberList",value:function(e){var t=this._get(7);return t?t.getReadReceiptDetail(e):A({code:F.NO_MODULE})}},{key:"findMessage",value:function(e){return this._get(11).findMessage(e)}},{key:"setMessageRead",value:function(e){return this._get(11).setMessageRead(e)}},{key:"getConversationList",value:function(e){return this._get(11).getConvList(e)}},{key:"getConversationProfile",value:function(e){return this._get(11).getConversationProfile(e)}},{key:"deleteConversation",value:function(e){return this._get(11).deleteConversation(e)}},{key:"setConversationDraft",value:function(e){return this._get(11).setConvDraft(e)}},{key:"clearHistoryMessage",value:function(e){return this._get(11).clearHistoryMessage(e)}},{key:"pinConversation",value:function(e){return this._get(11).pinConversation(e)}},{key:"setAllMessageRead",value:function(e){return this._get(11).setAllMessageRead(e)}},{key:"setMessageRemindType",value:function(e){return this._get(11).setMessageRemindType(e)}},{key:"setAllReceiveMessageOpt",value:function(e){return this._get(11).setAllRcvMsgOpt(e)}},{key:"getAllReceiveMessageOpt",value:function(){return this._get(11).getAllRcvMsgOpt()}},{key:"getTotalUnreadMessageCount",value:function(){return this._get(11).getTotalUnreadCount()}},{key:"setConversationCustomData",value:function(e){return this._get(11).setConvCustomData(e)}},{key:"markConversation",value:function(e){return this._get(11).markConv(e)}},{key:"getConversationGroupList",value:function(){return this._get(11).getConvGroupList()}},{key:"createConversationGroup",value:function(e){return this._get(11).createConvGroup(e)}},{key:"deleteConversationGroup",value:function(e){return this._get(11).deleteConvGroup(e)}},{key:"renameConversationGroup",value:function(e){return this._get(11).renameConvGroup(e)}},{key:"addConversationsToGroup",value:function(e){return this._get(11).addConvsToGroup(e)}},{key:"deleteConversationsFromGroup",value:function(e){return this._get(11).deleteConvsFromGroup(e)}},{key:"searchCloudMessages",value:function(e){var t=this._get(38);return t?t.searchCloudMessages(e):A({code:F.NO_MODULE})}},{key:"searchCloudUsers",value:function(e){var t=this._get(38);return t?t.searchCloudUsers(e):A({code:F.NO_MODULE})}},{key:"searchCloudGroups",value:function(e){var t=this._get(38);return t?t.searchCloudGroups(e):A({code:F.NO_MODULE})}},{key:"searchCloudGroupMembers",value:function(e){var t=this._get(38);return t?t.searchCloudGroupMembers(e):A({code:F.NO_MODULE})}},{key:"getMyProfile",value:function(){return this._get(4).getMyProfile()}},{key:"getUserProfile",value:function(e){return this._get(4).getUserProfile(e)}},{key:"updateMyProfile",value:function(e){return this._get(4).updateMyProfile(e)}},{key:"getBlacklist",value:function(){return this._get(4).getLocalBlacklist()}},{key:"addToBlacklist",value:function(e){return this._get(4).addBlacklist(e)}},{key:"removeFromBlacklist",value:function(e){return this._get(4).deleteBlacklist(e)}},{key:"setSelfStatus",value:function(e){return this._get(4).setSelfStatus(e)}},{key:"getUserStatus",value:function(e){return this._get(4).getUserStatus(e)}},{key:"subscribeUserStatus",value:function(e){return this._get(4).subscribeUserStatus(e)}},{key:"unsubscribeUserStatus",value:function(e){return this._get(4).unsubscribeUserStatus(e)}},{key:"getFriendList",value:function(){var e=this._get(8);return e?e.getLocalFriendList():A({code:F.NO_MODULE})}},{key:"addFriend",value:function(e){var t=this._get(8);return t?t.addFriend(e):A({code:F.NO_MODULE})}},{key:"deleteFriend",value:function(e){var t=this._get(8);return t?t.deleteFriend(e):A({code:F.NO_MODULE})}},{key:"checkFriend",value:function(e){var t=this._get(8);return t?t.checkFriend(e):A({code:F.NO_MODULE})}},{key:"getFriendProfile",value:function(e){var t=this._get(8);return t?t.getFriendProfile(e):A({code:F.NO_MODULE})}},{key:"updateFriend",value:function(e){var t=this._get(8);return t?t.updateFriend(e):A({code:F.NO_MODULE})}},{key:"getFriendApplicationList",value:function(){var e=this._get(8);return e?e.getLocalFriendApplicationList():A({code:F.NO_MODULE})}},{key:"acceptFriendApplication",value:function(e){var t=this._get(8);return t?t.acceptFriendApplication(e):A({code:F.NO_MODULE})}},{key:"refuseFriendApplication",value:function(e){var t=this._get(8);return t?t.refuseFriendApplication(e):A({code:F.NO_MODULE})}},{key:"deleteFriendApplication",value:function(e){var t=this._get(8);return t?t.deleteFriendApplication(e):A({code:F.NO_MODULE})}},{key:"setFriendApplicationRead",value:function(){var e=this._get(8);return e?e.setFriendApplicationRead():A({code:F.NO_MODULE})}},{key:"getFriendGroupList",value:function(){var e=this._get(8);return e?e.getLocalFriendGroupList():A({code:F.NO_MODULE})}},{key:"createFriendGroup",value:function(e){var t=this._get(8);return t?t.createFriendGroup(e):A({code:F.NO_MODULE})}},{key:"deleteFriendGroup",value:function(e){var t=this._get(8);return t?t.deleteFriendGroup(e):A({code:F.NO_MODULE})}},{key:"addToFriendGroup",value:function(e){var t=this._get(8);return t?t.addToFriendGroup(e):A({code:F.NO_MODULE})}},{key:"removeFromFriendGroup",value:function(e){var t=this._get(8);return t?t.removeFromFriendGroup(e):A({code:F.NO_MODULE})}},{key:"renameFriendGroup",value:function(e){var t=this._get(8);return t?t.renameFriendGroup(e):A({code:F.NO_MODULE})}},{key:"followUser",value:function(e){var t=this._get(35);return t?t.followUser(e):A({code:F.NO_MODULE})}},{key:"unfollowUser",value:function(e){var t=this._get(35);return t?t.unfollowUser(e):A({code:F.NO_MODULE})}},{key:"getMyFollowersList",value:function(e){var t=this._get(35);return t?t.getMyFollowersList(e):A({code:F.NO_MODULE})}},{key:"getMyFollowingList",value:function(e){var t=this._get(35);return t?t.getMyFollowingList(e):A({code:F.NO_MODULE})}},{key:"getMutualFollowersList",value:function(e){var t=this._get(35);return t?t.getMutualFollowersList(e):A({code:F.NO_MODULE})}},{key:"getUserFollowInfo",value:function(e){var t=this._get(35);return t?t.getUserFollowInfo(e):A({code:F.NO_MODULE})}},{key:"checkFollowType",value:function(e){var t=this._get(35);return t?t.checkFollowType(e):A({code:F.NO_MODULE})}},{key:"getGroupList",value:function(){var e=this._get(7);return e?e.getGroupList():A({code:F.NO_MODULE})}},{key:"getGroupProfile",value:function(e){var t=this._get(7);return t?t.getGroupProfile(e):A({code:F.NO_MODULE})}},{key:"createGroup",value:function(e){var t=this._get(7);return t?t.createGroup(e):A({code:F.NO_MODULE})}},{key:"dismissGroup",value:function(e){var t=this._get(7);return t?t.dismissGroup(e):A({code:F.NO_MODULE})}},{key:"updateGroupProfile",value:function(e){var t=this._get(7);return t?t.updateGroupProfile(e):A({code:F.NO_MODULE})}},{key:"joinGroup",value:function(e){var t=this._get(7);return t?t.joinGroup(e):A({code:F.NO_MODULE})}},{key:"quitGroup",value:function(e){var t=this._get(7);return t?t.quitGroup(e):A({code:F.NO_MODULE})}},{key:"searchGroupByID",value:function(e){var t=this._get(7);return t?t.searchGroupByID(e):A({code:F.NO_MODULE})}},{key:"getGroupOnlineMemberCount",value:function(e){var t=this._get(7);return t?t.getGroupOnlineMemberCount(e):A({code:F.NO_MODULE})}},{key:"changeGroupOwner",value:function(e){var t=this._get(7);return t?t.changeGroupOwner(e):A({code:F.NO_MODULE})}},{key:"getGroupApplicationList",value:function(){var e=this._get(7);return e?e.getGroupApplicationList():A({code:F.NO_MODULE})}},{key:"handleGroupApplication",value:function(e){var t=this._get(7);return t?t.handleGroupApplication(e):A({code:F.NO_MODULE})}},{key:"initGroupAttributes",value:function(e){var t=this._get(7);return t?t.initGroupAttributes(e):A({code:F.NO_MODULE})}},{key:"setGroupAttributes",value:function(e){var t=this._get(7);return t?t.setGroupAttributes(e):A({code:F.NO_MODULE})}},{key:"deleteGroupAttributes",value:function(e){var t=this._get(7);return t?t.deleteGroupAttributes(e):A({code:F.NO_MODULE})}},{key:"getGroupAttributes",value:function(e){var t=this._get(7);return t?t.getGroupAttributes(e):A({code:F.NO_MODULE})}},{key:"setGroupCounters",value:function(e){var t=this._get(7);return t?t.setGroupCounters(e):A({code:F.NO_MODULE})}},{key:"increaseGroupCounter",value:function(e){var t=this._get(7);return t?t.increaseGroupCounter(e):A({code:F.NO_MODULE})}},{key:"decreaseGroupCounter",value:function(e){var t=this._get(7);return t?t.decreaseGroupCounter(e):A({code:F.NO_MODULE})}},{key:"getGroupCounters",value:function(e){var t=this._get(7);return t?t.getGroupCounters(e):A({code:F.NO_MODULE})}},{key:"getGroupMemberList",value:function(e){var t=this._get(7);return t?t.getGroupMemberList(e):A({code:F.NO_MODULE})}},{key:"getGroupMemberProfile",value:function(e){var t=this._get(7);return t?t.getGroupMemberProfile(e):A({code:F.NO_MODULE})}},{key:"addGroupMember",value:function(e){var t=this._get(7);return t?t.addGroupMember(e):A({code:F.NO_MODULE})}},{key:"deleteGroupMember",value:function(e){var t=this._get(7);return t?t.deleteGroupMember(e):A({code:F.NO_MODULE})}},{key:"setGroupMemberMuteTime",value:function(e){var t=this._get(7);return t?t.setGroupMemberMuteTime(e):A({code:F.NO_MODULE})}},{key:"setGroupMemberRole",value:function(e){var t=this._get(7);return t?t.setGroupMemberRole(e):A({code:F.NO_MODULE})}},{key:"setGroupMemberNameCard",value:function(e){var t=this._get(7);return t?t.setGroupMemberNameCard(e):A({code:F.NO_MODULE})}},{key:"setGroupMemberCustomField",value:function(e){var t=this._get(7);return t?t.setGroupMemberCustomField(e):A({code:F.NO_MODULE})}},{key:"markGroupMemberList",value:function(e){var t=this._get(7);return t?t.markGroupMemberList(e):A({code:F.NO_MODULE})}},{key:"getJoinedCommunityList",value:function(){return this._get(10).getJoinedCommunityList()}},{key:"createTopicInCommunity",value:function(e){return this._get(10).createTopicInCommunity(e)}},{key:"deleteTopicFromCommunity",value:function(e){return this._get(10).deleteTopicFromCommunity(e)}},{key:"updateTopicProfile",value:function(e){return this._get(10).updateTopicProfile(e)}},{key:"getTopicList",value:function(e){return this._get(10).getTopicList(e)}},{key:"addSignalingListener",value:function(e,t,n){var s=this._get(33);s&&s.addSignalingListener(e,this._safetyCallbackFactory.defense(e,t,n),n)}},{key:"removeSignalingListener",value:function(e,t,n){var s,r=this._safetyCallbackFactory.find(e,t);r===null||(s=this._get(33))&&(s.removeSignalingListener(e,r,n),this._safetyCallbackFactory.delete(e,t))}},{key:"invite",value:function(e){var t=this._get(33);return t?t.invite(e):A({code:F.NO_MODULE})}},{key:"inviteSync",value:function(e,t,n){var s=this._get(33);return s?s.inviteSync(e,t,n):""}},{key:"inviteInGroup",value:function(e){var t=this._get(33);return t?t.invite(e):A({code:F.NO_MODULE})}},{key:"inviteInGroupSync",value:function(e,t,n){var s=this._get(33);return s?s.inviteSync(e,t,n):""}},{key:"cancel",value:function(e){var t=this._get(33);return t?t.cancel(e):A({code:F.NO_MODULE})}},{key:"accept",value:function(e){var t=this._get(33);return t?t.accept(e):A({code:F.NO_MODULE})}},{key:"reject",value:function(e){var t=this._get(33);return t?t.reject(e):A({code:F.NO_MODULE})}},{key:"getSignalingInfo",value:function(e){var t=this._get(33);return t?t.getSignalingInfo(e):null}},{key:"modifyInvitation",value:function(e){var t=this._get(33);return t?t.modifyInvitation(e):A({code:F.NO_MODULE})}}]),Ol),NM={login:1,logout:1,getLoginUser:1,destroy:1,on:1,off:1,ready:1,setLogLevel:1,joinGroup:1,quitGroup:1,registerPlugin:1,getGroupOnlineMemberCount:1,isReady:1,addSignalingListener:1,removeSignalingListener:1,callExperimentalAPI:1};function Ol(e){f(this,Ol),e={SDKAppID:e.SDKAppID,unlimitedAVChatRoom:e.unlimitedAVChatRoom||!1,scene:e.scene||"",oversea:e.oversea||!1,instanceID:jp(),devMode:e.devMode||!1,testEnv:e.testEnv||!1,proxyServer:e.proxyServer||void 0,fileUploadProxy:e.fileUploadProxy||void 0,fileDownloadProxy:e.fileDownloadProxy||e.fileUploadProxy||void 0,eventThrottling:e.eventThrottling!==!1,partialUpdatedConversations:e.partialUpdatedConversations===!0,disableIndependentDomain:e.disableIndependentDomain===!0,modules:e.modules||void 0},this._m=new kM(e),this._safetyCallbackFactory=new AM(this._m)}function Nl(e){f(this,Nl),this._funcMap=new Map,this._m=e,this._n="SafetyCallback",this._reportCount=0}function Pl(e){var t=this;f(this,Pl);var n,s=new K("sdkConstruct"),d=(this._n="ModuleManager",this._isReady=!1,this._reason=F.USER_NOT_LOGGED_IN,this._startLoginTs=0,this._map=new Map,this._optionalModuleMap=new Map,this._codeMsgForTUIMap=new Map,this._iEmitter=null,this._oEmitter=null,this._checkCount=0,this._checkTimer=-1,this._map.set(12,new tI(this,e)),this._map.set(37,new TM(this)),this._map.set(15,new aI(this)),this._map.set(27,new XI(this)),this._map.set(23,new FI(this)),this._map.set(24,new $I(this)),this._map.set(26,new KI(this)),this._map.set(21,new RI(this)),this._map.set(20,new UI(this)),this._map.set(1,new oI(this)),this._map.set(2,new gI(this)),this._map.set(3,new _I(this)),this._map.set(34,new mI(this)),this._map.set(31,new vI(this)),this._map.set(4,new eI(this)),this._map.set(6,new Ry(this)),this._map.set(11,new Gy(this)),this._map.set(7,new Yy(this)),this._map.set(10,new Jy(this)),this._map.set(13,new sI(this)),this._map.set(32,new nM(this)),this._map.set(14,new iI(this)),this._map.set(17,new lI(this)),this._map.set(18,new yI(this)),this._map.set(19,new II(this)),this._map.set(25,new xI(this)),this._map.set(8,new zI(this)),this._map.set(28,new ZI(this)),this._map.set(36,new QI(this)),this._map.set(29,new eM(this)),this._map.set(30,new tM(this)),this._map.set(33,new uM(this)),this._map.set(35,new pM(this)),this._map.set(38,new RM(this)),this._eventThrottleMap=new Map,this._eventThrottling=e.eventThrottling,this._map.get(12).isPartialUpdatedConvs()&&(this._eventThrottling=!1),dt(e.modules)?(Object.keys(e.modules).forEach(function(h){n=e.modules[h],h==="group-module"?t._map.set(7,new n(t)):h==="relationship-module"?t._map.set(8,new n(t)):h==="signaling-module"?t._map.set(33,new n(t)):h==="follow-module"?t._map.set(35,new n(t)):h==="cloud-search-module"&&t._map.set(38,new n(t)),t._optionalModuleMap.set(h,1)}),this._map.get(12).setUsingChatCore(!0)):this._map.has(7)||this._map.get(12).setUsingChatCore(!0),e.instanceID),r=e.SDKAppID,a=this._map.get(12).isIntl(),l=this._map.get(12).isUsingChatCore(),d="instanceID:".concat(d," SDKAppID:").concat(r," isIntl:").concat(a," isUsingChatCore:").concat(l," host:").concat(Wp())+" isIOSWebView:".concat(yr," platform:").concat(Me," canIUseInflate:").concat(this.canIUseInflate())+" workerAvailable:".concat(Gn," eventThrottling:").concat(this._eventThrottling," UserAgent:").concat(Ie);K.bindEventStatModule(this._map.get(14)),K.bindNetMonitorModule(this._map.get(15)),s.setMessage("".concat(d," ").concat(function(){var h="";if(ee)try{var g=le.getSystemInfoSync(),_=g.model,M=g.version,S=g.system,D=g.platform,O=g.SDKVersion,h="model:".concat(_," version:").concat(M," system:").concat(S," platform:").concat(D," SDKVersion:").concat(O)}catch{h=""}return h}())).end(),m.i("SDK ".concat(d)),yt.prototype._getErrMsg=this.getErrMsg.bind(this),this._readyList=void 0,this._ssoLogForReady=null,this._initReadyList()}function di(e){return f(this,di),(e=lh.call(this,e))._n="CSModule",e}function bl(e){f(this,bl),this._m=e,this._n="InflateModule",this._bLogForInflateOK=!1,this._bLogForInflateError=!1}var pi={},fe={};return fe.create=function(l){var t="TencentCloudChat.create",n=0,a=l.SDKAppID;if(Qe(a))n=a;else if(n=parseInt(a),isNaN(a))return m.e("".concat(t," failed. Failed to parse the SDKAppID, please check the arguments")),null;if(n&&pi[n])return pi[n];m.l("".concat(t));var s,r,a=new OM(c(c({},l),{},{SDKAppID:n})),l=(a.on($.SDK_DESTROY,function(d){pi[d.data.SDKAppID]=null,delete pi[d.data.SDKAppID]}),s=a,r=Object.create(null),Object.keys(My).forEach(function(d){var h;s[d]&&(h=new Z,r[d]=function(){var g=Array.from(arguments);return h.use(function(_,M){var S=function(D,O){if(D.isReady()||NM[O]===1)return!0;var B={code:B=D.getNotReadyReason(),message:"".concat(D.getErrMsg(B)," | ").concat(O," | ").concat(D.getErrMsg(F.SDK_IS_NOT_READY))};return D.onError(B),B}(s,d);return S===!0?M():A(S)}).use(function(_,M){if(function(S,D,O){if(D===void 0)return!0;var B=!0;if(dt(D))Object.keys(D).forEach(function(de){var J=S.length===1?S[0][de]:void 0;B=!!tf(J,D[de],O,de)&&B});else if(_e(D))for(var U=0;U<D.length;U++)B=!!tf(S[U],D[U],O,D[U].name)&&B;if(B)return B;throw new Error("Params validate failed.")}(_,lf[d],d)===!0)return M()}).use(function(_,M){return s[d].apply(s,_)}),h.run(g)})}),r);return pi[n]=l,lf.hookGetAPITips(a.getErrMsg.bind(a)),m.l("".concat(t," ok")),l},fe.TYPES=I,fe.EVENT=$,fe.TSignaling=W,fe.VERSION="3.5.2",m.l("TencentCloudChat.VERSION:".concat(fe.VERSION)),fe})})(qv);var gk=qv.exports;const Vv=Mp(gk);var Bv={exports:{}};(function(o,i){(function(u,c){o.exports=c()})(Vn,function(){function u(W,Z){var X=Object.keys(W);if(Object.getOwnPropertySymbols){var Q=Object.getOwnPropertySymbols(W);Z&&(Q=Q.filter(function(Y){return Object.getOwnPropertyDescriptor(W,Y).enumerable})),X.push.apply(X,Q)}return X}function c(W){for(var Z=1;Z<arguments.length;Z++){var X=arguments[Z]!=null?arguments[Z]:{};Z%2?u(Object(X),!0).forEach(function(Q){C(W,Q,X[Q])}):Object.getOwnPropertyDescriptors?Object.defineProperties(W,Object.getOwnPropertyDescriptors(X)):u(Object(X)).forEach(function(Q){Object.defineProperty(W,Q,Object.getOwnPropertyDescriptor(X,Q))})}return W}function p(W){return(p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Z){return typeof Z}:function(Z){return Z&&typeof Symbol=="function"&&Z.constructor===Symbol&&Z!==Symbol.prototype?"symbol":typeof Z})(W)}function f(W,Z){if(!(W instanceof Z))throw new TypeError("Cannot call a class as a function")}function v(W,Z){for(var X=0;X<Z.length;X++){var Q=Z[X];Q.enumerable=Q.enumerable||!1,Q.configurable=!0,"value"in Q&&(Q.writable=!0),Object.defineProperty(W,Q.key,Q)}}function y(W,Z,X){return Z&&v(W.prototype,Z),X&&v(W,X),Object.defineProperty(W,"prototype",{writable:!1}),W}function C(W,Z,X){return Z in W?Object.defineProperty(W,Z,{value:X,enumerable:!0,configurable:!0,writable:!0}):W[Z]=X,W}function T(W,Z){if(W==null)return{};var X,Q,Y=function(re,Ee){if(re==null)return{};var P,he,Fe={},$e=Object.keys(re);for(he=0;he<$e.length;he++)P=$e[he],Ee.indexOf(P)>=0||(Fe[P]=re[P]);return Fe}(W,Z);if(Object.getOwnPropertySymbols){var ue=Object.getOwnPropertySymbols(W);for(Q=0;Q<ue.length;Q++)X=ue[Q],Z.indexOf(X)>=0||Object.prototype.propertyIsEnumerable.call(W,X)&&(Y[X]=W[X])}return Y}var L=typeof Vn<"u"?Vn:typeof self<"u"?self:typeof window<"u"?window:{},R=typeof wx<"u"&&typeof wx.getSystemInfoSync=="function"&&!!wx.getSystemInfoSync().fontSizeSetting,k=typeof qq<"u"&&typeof qq.getSystemInfoSync=="function"&&!!qq.getSystemInfoSync().fontSizeSetting,x=typeof tt<"u"&&typeof tt.getSystemInfoSync=="function"&&!!tt.getSystemInfoSync().fontSizeSetting,N=typeof swan<"u"&&typeof swan.getSystemInfoSync=="function"&&!!swan.getSystemInfoSync().fontSizeSetting,G=typeof my<"u"&&typeof my.getSystemInfoSync=="function"&&!!my.getSystemInfoSync().fontSizeSetting,V=typeof uni<"u"&&typeof window>"u"&&typeof uni.requireNativePlugin=="function",z=V&&uni.getDeviceInfo().platform.toLocaleLowerCase()==="ios",te=(V&&uni.getDeviceInfo().platform.toLocaleLowerCase(),R||k||x||N||G||V),q=L!==void 0&&(L.nativeModuleProxy!==void 0||L.ReactNative!==void 0),Ne=k?qq:x?tt:N?swan:G?my:R?wx:V?uni:{},Le=function(W){if(p(W)!=="object"||W===null)return!1;var Z=Object.getPrototypeOf(W);if(Z===null)return!0;for(var X=Z;Object.getPrototypeOf(X)!==null;)X=Object.getPrototypeOf(X);return Z===X};function Se(W){if(W==null)return!0;if(typeof W=="boolean")return!1;if(typeof W=="number")return W===0;if(typeof W=="string"||typeof W=="function"||Array.isArray(W))return W.length===0;if(W instanceof Error)return W.message==="";if(Le(W)){for(var Z in W)if(Object.prototype.hasOwnProperty.call(W,Z))return!1;return!0}return!1}var Ue=function(){function W(){f(this,W),this._n="WebRequest"}return y(W,[{key:"request",value:function(Z,X){var Q=this,Y="".concat(this._n,".request"),ue=Z.downloadUrl||"",re=(Z.method||"PUT").toUpperCase(),Ee=Z.url;if(console.log("%c tim-upload-plugin %c","background:#0abf5b; padding:1px; border-radius:3px; color: #fff","background:transparent","".concat(Y," URL:").concat(Ee)),Z.qs){var P=function(Xe){var ht=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"&",at=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"=";return Se(Xe)?"":Le(Xe)?Object.keys(Xe).map(function(ie){var Ce=encodeURIComponent(ie)+at;return Array.isArray(Xe[ie])?Xe[ie].map(function(De){return Ce+encodeURIComponent(De)}).join(ht):Ce+encodeURIComponent(Xe[ie])}).filter(Boolean).join(ht):void 0}(Z.qs);P&&(Ee+="".concat(Ee.indexOf("?")===-1?"?":"&").concat(P))}var he=new XMLHttpRequest;he.open(re,Ee,!0),he.responseType=Z.dataType||"text";var Fe=Z.headers||{};if(Z.uploadByIP&&(Fe=c(c({},Fe),{},{host:Z.uploadIP})),!Se(Fe))for(var $e in Fe)Fe.hasOwnProperty($e)&&$e.toLowerCase()!=="content-length"&&$e.toLowerCase()!=="user-agent"&&$e.toLowerCase()!=="origin"&&$e.toLowerCase()!=="host"&&he.setRequestHeader($e,Fe[$e]);return he.onload=function(){if(he.status===200)X(null,Q._xhrRes(he,Q._xhrBody(he,ue,Z.uploadByIP&&Z.uploadIP),Fe));else{if(Z.uploadIP&&Z.url.indexOf(Z.uploadIP)===-1)return Z.url=function(ht,at){return ht.replace(/^http(s)?:\/\/(.*?)\//,"https://".concat(at,"/"))}(Z.url,Z.uploadIP),Z.uploadByIP=!0,Q.request(Z,X);var Xe={code:he.status,message:JSON.stringify(he.responseText)};X(Xe,Q._xhrRes(he,Q._xhrBody(he,ue,Z.uploadByIP&&Z.uploadIP),Fe))}},he.onerror=function(Xe){var ht=Q._xhrBody(he,ue,Z.uploadByIP&&Z.uploadIP),at={code:he.status,message:JSON.stringify(he.responseText)};ht||he.statusText||he.status!==0||(Xe.message="CORS blocked or network error"),X(at,Q._xhrRes(he,ht)),at=null},Z.onProgress&&he.upload&&(he.upload.onprogress=function(Xe){var ht=Xe.total,at=Xe.loaded,ie=Math.floor(100*at/ht);Z.onProgress({total:ht,loaded:at,percent:(ie>=100?100:ie)/100})}),he.send(Z.resources),he}},{key:"_xhrRes",value:function(Z,X){var Q={};return Z.getAllResponseHeaders().trim().split(`
`).forEach(function(Y){if(Y){var ue=Y.indexOf(":"),re=Y.substr(0,ue).trim().toLowerCase(),Ee=Y.substr(ue+1).trim();Q[re]=Ee}}),{statusCode:Z.status,statusMessage:Z.statusText,headers:Q,data:X}}},{key:"_xhrBody",value:function(Z,X,Q){return Z.status===200&&X?{location:X,uploadIP:Q}:{response:Z.responseText,uploadIP:Q}}}]),W}(),ve=["unknown","image","video","audio","log"],ye=["name"],$=function(){function W(){f(this,W)}return y(W,[{key:"request",value:function(Z,X){var Q=this,Y=Z.resources,ue=Y===void 0?"":Y,re=Z.headers,Ee=re===void 0?{}:re,P=Z.url,he=Z.downloadUrl,Fe=he===void 0?"":he,$e=P,Xe=null,ht=Fe.match(/^(https?:\/\/[^/]+\/)([^/]*\/?)(.*)$/),at=decodeURIComponent(ht[3]),ie=at.indexOf("?")>-1?at.split("?")[0]:at,Ce={key:Z.fileKey?Z.fileKey:ie,success_action_status:200,"Content-Type":""},De={};if(z){var Re=P.split("?sign=");if(Re.length>1){var Je=Re[1];$e="".concat(Re[0],"?sign=").concat(encodeURIComponent("".concat(Je))),De.sign=decodeURIComponent(Je),De.signature=decodeURIComponent(Je)}}var b={url:$e,header:Ee,name:"file",filePath:ue,formData:c(c({},Ce),De),timeout:Z.timeout||3e5};if(G){var w=b;w.name,b=c(c({},T(w,ye)),{},{fileName:"file",fileType:ve[Z.fileType]})}return(Xe=Ne.uploadFile(c(c({},b),{},{success:function(j){Q._handleResponse({response:j,downloadUrl:Fe,callback:X})},fail:function(j){Q._handleResponse({response:j,downloadUrl:Fe,callback:X})}}))).onProgressUpdate&&Xe.onProgressUpdate(function(j){Z.onProgress&&Z.onProgress({total:j.totalBytesExpectedToSend,loaded:j.totalBytesSent,percent:Math.floor(j.progress)/100})}),Xe}},{key:"_handleResponse",value:function(Z){var X=Z.downloadUrl,Q=Z.response,Y=Z.callback,ue=Q.header,re={};if(ue)for(var Ee in ue)ue.hasOwnProperty(Ee)&&(re[Ee.toLowerCase()]=ue[Ee]);var P=+Q.statusCode;P===200?Y(null,{statusCode:P,headers:re,data:c(c({},Q.data),{},{location:X})}):Y({code:P,message:JSON.stringify(Q.data)},{statusCode:P,headers:re,data:void 0})}}]),W}(),I=function(){function W(){f(this,W)}return y(W,[{key:"request",value:function(Z,X){var Q=this,Y=Z.resources,ue=Y===void 0?"":Y,re=Z.fileKey,Ee=re===void 0?"":re,P=Z.url,he=Z.downloadUrl,Fe=he===void 0?"":he,$e=new FormData;$e.append("key",Ee),$e.append("success_action_status",200),$e.append("file",{uri:ue,type:"application/octet-stream",name:"uploaded_file"}),fetch(P,{method:"POST",headers:{"Content-Type":"multipart/form-data"},body:$e}).then(function(Xe){Q._handleResponse({response:Xe,downloadUrl:Fe,callback:X})}).catch(function(Xe){Q._handleResponse({response:Xe,downloadUrl:Fe,callback:X})})}},{key:"_handleResponse",value:function(Z){var X=Z.downloadUrl,Q=Z.response,Y=Z.callback,ue=Q.headers,re=Q.status,Ee=ue&&ue.map||{};re===200?Y(null,{statusCode:200,headers:Ee,data:{location:X}}):Y({code:re,message:JSON.stringify(Q)},{statusCode:re,headers:Ee,data:void 0})}}]),W}();return function(){function W(){f(this,W),this.retry=1,this.tryCount=0,this.systemClockOffset=0,this.httpRequest=te?new $:q?new I:new Ue,console.log("TIMUploadPlugin.VERSION: ".concat("1.4.2"))}return y(W,[{key:"uploadFile",value:function(Z,X){var Q=this;return this.httpRequest.request(Z,function(Y,ue){Y&&Q.tryCount<Q.retry&&Q.allowRetry(Y)?(Q.tryCount++,Q.uploadFile(Z,X)):(Q.tryCount=0,X(Y,ue))})}},{key:"allowRetry",value:function(Z){var X=!1,Q=!1;if(Z){var Y=Z.headers&&(Z.headers.date||Z.headers.Date)||Z.error&&Z.error.ServerTime;try{var ue=Z.error&&Z.error.Code,re=Z.error&&Z.error.Message;(ue==="RequestTimeTooSkewed"||ue==="AccessDenied"&&re==="Request has expired")&&(Q=!0)}catch{}if(Q&&Y){var Ee=Date.now(),P=Date.parse(Y);Math.abs(Ee+this.systemClockOffset-P)>=3e4&&(this.systemClockOffset=P-Ee,X=!0)}else Math.floor(Z.statusCode/100)===5&&(X=!0)}return X}}],[{key:"getVersion",value:function(){return"1.4.2"}}]),W}()})})(Bv);var _k=Bv.exports;const mk=Mp(_k);function Hv(o,i){return function(){return o.apply(i,arguments)}}const{toString:vk}=Object.prototype,{getPrototypeOf:Dp}=Object,{iterator:Ac,toStringTag:Kv}=Symbol,Oc=(o=>i=>{const u=vk.call(i);return o[u]||(o[u]=u.slice(8,-1).toLowerCase())})(Object.create(null)),ro=o=>(o=o.toLowerCase(),i=>Oc(i)===o),Nc=o=>i=>typeof i===o,{isArray:mr}=Array,Yi=Nc("undefined");function yk(o){return o!==null&&!Yi(o)&&o.constructor!==null&&!Yi(o.constructor)&&kn(o.constructor.isBuffer)&&o.constructor.isBuffer(o)}const jv=ro("ArrayBuffer");function Ik(o){let i;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?i=ArrayBuffer.isView(o):i=o&&o.buffer&&jv(o.buffer),i}const Mk=Nc("string"),kn=Nc("function"),Wv=Nc("number"),Pc=o=>o!==null&&typeof o=="object",Ck=o=>o===!0||o===!1,Ha=o=>{if(Oc(o)!=="object")return!1;const i=Dp(o);return(i===null||i===Object.prototype||Object.getPrototypeOf(i)===null)&&!(Kv in o)&&!(Ac in o)},Tk=ro("Date"),Ek=ro("File"),Dk=ro("Blob"),Sk=ro("FileList"),Lk=o=>Pc(o)&&kn(o.pipe),Rk=o=>{let i;return o&&(typeof FormData=="function"&&o instanceof FormData||kn(o.append)&&((i=Oc(o))==="formdata"||i==="object"&&kn(o.toString)&&o.toString()==="[object FormData]"))},kk=ro("URLSearchParams"),[Ak,Ok,Nk,Pk]=["ReadableStream","Request","Response","Headers"].map(ro),bk=o=>o.trim?o.trim():o.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ea(o,i,{allOwnKeys:u=!1}={}){if(o===null||typeof o>"u")return;let c,p;if(typeof o!="object"&&(o=[o]),mr(o))for(c=0,p=o.length;c<p;c++)i.call(null,o[c],c,o);else{const f=u?Object.getOwnPropertyNames(o):Object.keys(o),v=f.length;let y;for(c=0;c<v;c++)y=f[c],i.call(null,o[y],y,o)}}function Yv(o,i){i=i.toLowerCase();const u=Object.keys(o);let c=u.length,p;for(;c-- >0;)if(p=u[c],i===p.toLowerCase())return p;return null}const Is=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,zv=o=>!Yi(o)&&o!==Is;function Gd(){const{caseless:o}=zv(this)&&this||{},i={},u=(c,p)=>{const f=o&&Yv(i,p)||p;Ha(i[f])&&Ha(c)?i[f]=Gd(i[f],c):Ha(c)?i[f]=Gd({},c):mr(c)?i[f]=c.slice():i[f]=c};for(let c=0,p=arguments.length;c<p;c++)arguments[c]&&ea(arguments[c],u);return i}const Gk=(o,i,u,{allOwnKeys:c}={})=>(ea(i,(p,f)=>{u&&kn(p)?o[f]=Hv(p,u):o[f]=p},{allOwnKeys:c}),o),wk=o=>(o.charCodeAt(0)===65279&&(o=o.slice(1)),o),Uk=(o,i,u,c)=>{o.prototype=Object.create(i.prototype,c),o.prototype.constructor=o,Object.defineProperty(o,"super",{value:i.prototype}),u&&Object.assign(o.prototype,u)},Fk=(o,i,u,c)=>{let p,f,v;const y={};if(i=i||{},o==null)return i;do{for(p=Object.getOwnPropertyNames(o),f=p.length;f-- >0;)v=p[f],(!c||c(v,o,i))&&!y[v]&&(i[v]=o[v],y[v]=!0);o=u!==!1&&Dp(o)}while(o&&(!u||u(o,i))&&o!==Object.prototype);return i},xk=(o,i,u)=>{o=String(o),(u===void 0||u>o.length)&&(u=o.length),u-=i.length;const c=o.indexOf(i,u);return c!==-1&&c===u},qk=o=>{if(!o)return null;if(mr(o))return o;let i=o.length;if(!Wv(i))return null;const u=new Array(i);for(;i-- >0;)u[i]=o[i];return u},Vk=(o=>i=>o&&i instanceof o)(typeof Uint8Array<"u"&&Dp(Uint8Array)),Bk=(o,i)=>{const c=(o&&o[Ac]).call(o);let p;for(;(p=c.next())&&!p.done;){const f=p.value;i.call(o,f[0],f[1])}},Hk=(o,i)=>{let u;const c=[];for(;(u=o.exec(i))!==null;)c.push(u);return c},Kk=ro("HTMLFormElement"),jk=o=>o.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(u,c,p){return c.toUpperCase()+p}),i_=(({hasOwnProperty:o})=>(i,u)=>o.call(i,u))(Object.prototype),Wk=ro("RegExp"),$v=(o,i)=>{const u=Object.getOwnPropertyDescriptors(o),c={};ea(u,(p,f)=>{let v;(v=i(p,f,o))!==!1&&(c[f]=v||p)}),Object.defineProperties(o,c)},Yk=o=>{$v(o,(i,u)=>{if(kn(o)&&["arguments","caller","callee"].indexOf(u)!==-1)return!1;const c=o[u];if(kn(c)){if(i.enumerable=!1,"writable"in i){i.writable=!1;return}i.set||(i.set=()=>{throw Error("Can not rewrite read-only method '"+u+"'")})}})},zk=(o,i)=>{const u={},c=p=>{p.forEach(f=>{u[f]=!0})};return mr(o)?c(o):c(String(o).split(i)),u},$k=()=>{},Jk=(o,i)=>o!=null&&Number.isFinite(o=+o)?o:i;function Xk(o){return!!(o&&kn(o.append)&&o[Kv]==="FormData"&&o[Ac])}const Zk=o=>{const i=new Array(10),u=(c,p)=>{if(Pc(c)){if(i.indexOf(c)>=0)return;if(!("toJSON"in c)){i[p]=c;const f=mr(c)?[]:{};return ea(c,(v,y)=>{const C=u(v,p+1);!Yi(C)&&(f[y]=C)}),i[p]=void 0,f}}return c};return u(o,0)},Qk=ro("AsyncFunction"),eA=o=>o&&(Pc(o)||kn(o))&&kn(o.then)&&kn(o.catch),Jv=((o,i)=>o?setImmediate:i?((u,c)=>(Is.addEventListener("message",({source:p,data:f})=>{p===Is&&f===u&&c.length&&c.shift()()},!1),p=>{c.push(p),Is.postMessage(u,"*")}))(`axios@${Math.random()}`,[]):u=>setTimeout(u))(typeof setImmediate=="function",kn(Is.postMessage)),tA=typeof queueMicrotask<"u"?queueMicrotask.bind(Is):typeof process<"u"&&process.nextTick||Jv,nA=o=>o!=null&&kn(o[Ac]),oe={isArray:mr,isArrayBuffer:jv,isBuffer:yk,isFormData:Rk,isArrayBufferView:Ik,isString:Mk,isNumber:Wv,isBoolean:Ck,isObject:Pc,isPlainObject:Ha,isReadableStream:Ak,isRequest:Ok,isResponse:Nk,isHeaders:Pk,isUndefined:Yi,isDate:Tk,isFile:Ek,isBlob:Dk,isRegExp:Wk,isFunction:kn,isStream:Lk,isURLSearchParams:kk,isTypedArray:Vk,isFileList:Sk,forEach:ea,merge:Gd,extend:Gk,trim:bk,stripBOM:wk,inherits:Uk,toFlatObject:Fk,kindOf:Oc,kindOfTest:ro,endsWith:xk,toArray:qk,forEachEntry:Bk,matchAll:Hk,isHTMLForm:Kk,hasOwnProperty:i_,hasOwnProp:i_,reduceDescriptors:$v,freezeMethods:Yk,toObjectSet:zk,toCamelCase:jk,noop:$k,toFiniteNumber:Jk,findKey:Yv,global:Is,isContextDefined:zv,isSpecCompliantForm:Xk,toJSONObject:Zk,isAsyncFn:Qk,isThenable:eA,setImmediate:Jv,asap:tA,isIterable:nA};function ct(o,i,u,c,p){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=o,this.name="AxiosError",i&&(this.code=i),u&&(this.config=u),c&&(this.request=c),p&&(this.response=p,this.status=p.status?p.status:null)}oe.inherits(ct,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:oe.toJSONObject(this.config),code:this.code,status:this.status}}});const Xv=ct.prototype,Zv={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(o=>{Zv[o]={value:o}});Object.defineProperties(ct,Zv);Object.defineProperty(Xv,"isAxiosError",{value:!0});ct.from=(o,i,u,c,p,f)=>{const v=Object.create(Xv);return oe.toFlatObject(o,v,function(C){return C!==Error.prototype},y=>y!=="isAxiosError"),ct.call(v,o.message,i,u,c,p),v.cause=o,v.name=o.name,f&&Object.assign(v,f),v};const oA=null;function wd(o){return oe.isPlainObject(o)||oe.isArray(o)}function Qv(o){return oe.endsWith(o,"[]")?o.slice(0,-2):o}function a_(o,i,u){return o?o.concat(i).map(function(p,f){return p=Qv(p),!u&&f?"["+p+"]":p}).join(u?".":""):i}function sA(o){return oe.isArray(o)&&!o.some(wd)}const rA=oe.toFlatObject(oe,{},null,function(i){return/^is[A-Z]/.test(i)});function bc(o,i,u){if(!oe.isObject(o))throw new TypeError("target must be an object");i=i||new FormData,u=oe.toFlatObject(u,{metaTokens:!0,dots:!1,indexes:!1},!1,function(G,V){return!oe.isUndefined(V[G])});const c=u.metaTokens,p=u.visitor||L,f=u.dots,v=u.indexes,C=(u.Blob||typeof Blob<"u"&&Blob)&&oe.isSpecCompliantForm(i);if(!oe.isFunction(p))throw new TypeError("visitor must be a function");function T(N){if(N===null)return"";if(oe.isDate(N))return N.toISOString();if(oe.isBoolean(N))return N.toString();if(!C&&oe.isBlob(N))throw new ct("Blob is not supported. Use a Buffer instead.");return oe.isArrayBuffer(N)||oe.isTypedArray(N)?C&&typeof Blob=="function"?new Blob([N]):Buffer.from(N):N}function L(N,G,V){let z=N;if(N&&!V&&typeof N=="object"){if(oe.endsWith(G,"{}"))G=c?G:G.slice(0,-2),N=JSON.stringify(N);else if(oe.isArray(N)&&sA(N)||(oe.isFileList(N)||oe.endsWith(G,"[]"))&&(z=oe.toArray(N)))return G=Qv(G),z.forEach(function(q,Ne){!(oe.isUndefined(q)||q===null)&&i.append(v===!0?a_([G],Ne,f):v===null?G:G+"[]",T(q))}),!1}return wd(N)?!0:(i.append(a_(V,G,f),T(N)),!1)}const R=[],k=Object.assign(rA,{defaultVisitor:L,convertValue:T,isVisitable:wd});function x(N,G){if(!oe.isUndefined(N)){if(R.indexOf(N)!==-1)throw Error("Circular reference detected in "+G.join("."));R.push(N),oe.forEach(N,function(z,te){(!(oe.isUndefined(z)||z===null)&&p.call(i,z,oe.isString(te)?te.trim():te,G,k))===!0&&x(z,G?G.concat(te):[te])}),R.pop()}}if(!oe.isObject(o))throw new TypeError("data must be an object");return x(o),i}function c_(o){const i={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(o).replace(/[!'()~]|%20|%00/g,function(c){return i[c]})}function Sp(o,i){this._pairs=[],o&&bc(o,this,i)}const ey=Sp.prototype;ey.append=function(i,u){this._pairs.push([i,u])};ey.toString=function(i){const u=i?function(c){return i.call(this,c,c_)}:c_;return this._pairs.map(function(p){return u(p[0])+"="+u(p[1])},"").join("&")};function iA(o){return encodeURIComponent(o).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ty(o,i,u){if(!i)return o;const c=u&&u.encode||iA;oe.isFunction(u)&&(u={serialize:u});const p=u&&u.serialize;let f;if(p?f=p(i,u):f=oe.isURLSearchParams(i)?i.toString():new Sp(i,u).toString(c),f){const v=o.indexOf("#");v!==-1&&(o=o.slice(0,v)),o+=(o.indexOf("?")===-1?"?":"&")+f}return o}class u_{constructor(){this.handlers=[]}use(i,u,c){return this.handlers.push({fulfilled:i,rejected:u,synchronous:c?c.synchronous:!1,runWhen:c?c.runWhen:null}),this.handlers.length-1}eject(i){this.handlers[i]&&(this.handlers[i]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(i){oe.forEach(this.handlers,function(c){c!==null&&i(c)})}}const ny={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},aA=typeof URLSearchParams<"u"?URLSearchParams:Sp,cA=typeof FormData<"u"?FormData:null,uA=typeof Blob<"u"?Blob:null,lA={isBrowser:!0,classes:{URLSearchParams:aA,FormData:cA,Blob:uA},protocols:["http","https","file","blob","url","data"]},Lp=typeof window<"u"&&typeof document<"u",Ud=typeof navigator=="object"&&navigator||void 0,dA=Lp&&(!Ud||["ReactNative","NativeScript","NS"].indexOf(Ud.product)<0),pA=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",fA=Lp&&window.location.href||"http://localhost",hA=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Lp,hasStandardBrowserEnv:dA,hasStandardBrowserWebWorkerEnv:pA,navigator:Ud,origin:fA},Symbol.toStringTag,{value:"Module"})),mn={...hA,...lA};function gA(o,i){return bc(o,new mn.classes.URLSearchParams,Object.assign({visitor:function(u,c,p,f){return mn.isNode&&oe.isBuffer(u)?(this.append(c,u.toString("base64")),!1):f.defaultVisitor.apply(this,arguments)}},i))}function _A(o){return oe.matchAll(/\w+|\[(\w*)]/g,o).map(i=>i[0]==="[]"?"":i[1]||i[0])}function mA(o){const i={},u=Object.keys(o);let c;const p=u.length;let f;for(c=0;c<p;c++)f=u[c],i[f]=o[f];return i}function oy(o){function i(u,c,p,f){let v=u[f++];if(v==="__proto__")return!0;const y=Number.isFinite(+v),C=f>=u.length;return v=!v&&oe.isArray(p)?p.length:v,C?(oe.hasOwnProp(p,v)?p[v]=[p[v],c]:p[v]=c,!y):((!p[v]||!oe.isObject(p[v]))&&(p[v]=[]),i(u,c,p[v],f)&&oe.isArray(p[v])&&(p[v]=mA(p[v])),!y)}if(oe.isFormData(o)&&oe.isFunction(o.entries)){const u={};return oe.forEachEntry(o,(c,p)=>{i(_A(c),p,u,0)}),u}return null}function vA(o,i,u){if(oe.isString(o))try{return(i||JSON.parse)(o),oe.trim(o)}catch(c){if(c.name!=="SyntaxError")throw c}return(u||JSON.stringify)(o)}const ta={transitional:ny,adapter:["xhr","http","fetch"],transformRequest:[function(i,u){const c=u.getContentType()||"",p=c.indexOf("application/json")>-1,f=oe.isObject(i);if(f&&oe.isHTMLForm(i)&&(i=new FormData(i)),oe.isFormData(i))return p?JSON.stringify(oy(i)):i;if(oe.isArrayBuffer(i)||oe.isBuffer(i)||oe.isStream(i)||oe.isFile(i)||oe.isBlob(i)||oe.isReadableStream(i))return i;if(oe.isArrayBufferView(i))return i.buffer;if(oe.isURLSearchParams(i))return u.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),i.toString();let y;if(f){if(c.indexOf("application/x-www-form-urlencoded")>-1)return gA(i,this.formSerializer).toString();if((y=oe.isFileList(i))||c.indexOf("multipart/form-data")>-1){const C=this.env&&this.env.FormData;return bc(y?{"files[]":i}:i,C&&new C,this.formSerializer)}}return f||p?(u.setContentType("application/json",!1),vA(i)):i}],transformResponse:[function(i){const u=this.transitional||ta.transitional,c=u&&u.forcedJSONParsing,p=this.responseType==="json";if(oe.isResponse(i)||oe.isReadableStream(i))return i;if(i&&oe.isString(i)&&(c&&!this.responseType||p)){const v=!(u&&u.silentJSONParsing)&&p;try{return JSON.parse(i)}catch(y){if(v)throw y.name==="SyntaxError"?ct.from(y,ct.ERR_BAD_RESPONSE,this,null,this.response):y}}return i}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:mn.classes.FormData,Blob:mn.classes.Blob},validateStatus:function(i){return i>=200&&i<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};oe.forEach(["delete","get","head","post","put","patch"],o=>{ta.headers[o]={}});const yA=oe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),IA=o=>{const i={};let u,c,p;return o&&o.split(`
`).forEach(function(v){p=v.indexOf(":"),u=v.substring(0,p).trim().toLowerCase(),c=v.substring(p+1).trim(),!(!u||i[u]&&yA[u])&&(u==="set-cookie"?i[u]?i[u].push(c):i[u]=[c]:i[u]=i[u]?i[u]+", "+c:c)}),i},l_=Symbol("internals");function yi(o){return o&&String(o).trim().toLowerCase()}function Ka(o){return o===!1||o==null?o:oe.isArray(o)?o.map(Ka):String(o)}function MA(o){const i=Object.create(null),u=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let c;for(;c=u.exec(o);)i[c[1]]=c[2];return i}const CA=o=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(o.trim());function rd(o,i,u,c,p){if(oe.isFunction(c))return c.call(this,i,u);if(p&&(i=u),!!oe.isString(i)){if(oe.isString(c))return i.indexOf(c)!==-1;if(oe.isRegExp(c))return c.test(i)}}function TA(o){return o.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(i,u,c)=>u.toUpperCase()+c)}function EA(o,i){const u=oe.toCamelCase(" "+i);["get","set","has"].forEach(c=>{Object.defineProperty(o,c+u,{value:function(p,f,v){return this[c].call(this,i,p,f,v)},configurable:!0})})}let An=class{constructor(i){i&&this.set(i)}set(i,u,c){const p=this;function f(y,C,T){const L=yi(C);if(!L)throw new Error("header name must be a non-empty string");const R=oe.findKey(p,L);(!R||p[R]===void 0||T===!0||T===void 0&&p[R]!==!1)&&(p[R||C]=Ka(y))}const v=(y,C)=>oe.forEach(y,(T,L)=>f(T,L,C));if(oe.isPlainObject(i)||i instanceof this.constructor)v(i,u);else if(oe.isString(i)&&(i=i.trim())&&!CA(i))v(IA(i),u);else if(oe.isObject(i)&&oe.isIterable(i)){let y={},C,T;for(const L of i){if(!oe.isArray(L))throw TypeError("Object iterator must return a key-value pair");y[T=L[0]]=(C=y[T])?oe.isArray(C)?[...C,L[1]]:[C,L[1]]:L[1]}v(y,u)}else i!=null&&f(u,i,c);return this}get(i,u){if(i=yi(i),i){const c=oe.findKey(this,i);if(c){const p=this[c];if(!u)return p;if(u===!0)return MA(p);if(oe.isFunction(u))return u.call(this,p,c);if(oe.isRegExp(u))return u.exec(p);throw new TypeError("parser must be boolean|regexp|function")}}}has(i,u){if(i=yi(i),i){const c=oe.findKey(this,i);return!!(c&&this[c]!==void 0&&(!u||rd(this,this[c],c,u)))}return!1}delete(i,u){const c=this;let p=!1;function f(v){if(v=yi(v),v){const y=oe.findKey(c,v);y&&(!u||rd(c,c[y],y,u))&&(delete c[y],p=!0)}}return oe.isArray(i)?i.forEach(f):f(i),p}clear(i){const u=Object.keys(this);let c=u.length,p=!1;for(;c--;){const f=u[c];(!i||rd(this,this[f],f,i,!0))&&(delete this[f],p=!0)}return p}normalize(i){const u=this,c={};return oe.forEach(this,(p,f)=>{const v=oe.findKey(c,f);if(v){u[v]=Ka(p),delete u[f];return}const y=i?TA(f):String(f).trim();y!==f&&delete u[f],u[y]=Ka(p),c[y]=!0}),this}concat(...i){return this.constructor.concat(this,...i)}toJSON(i){const u=Object.create(null);return oe.forEach(this,(c,p)=>{c!=null&&c!==!1&&(u[p]=i&&oe.isArray(c)?c.join(", "):c)}),u}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([i,u])=>i+": "+u).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(i){return i instanceof this?i:new this(i)}static concat(i,...u){const c=new this(i);return u.forEach(p=>c.set(p)),c}static accessor(i){const c=(this[l_]=this[l_]={accessors:{}}).accessors,p=this.prototype;function f(v){const y=yi(v);c[y]||(EA(p,v),c[y]=!0)}return oe.isArray(i)?i.forEach(f):f(i),this}};An.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);oe.reduceDescriptors(An.prototype,({value:o},i)=>{let u=i[0].toUpperCase()+i.slice(1);return{get:()=>o,set(c){this[u]=c}}});oe.freezeMethods(An);function id(o,i){const u=this||ta,c=i||u,p=An.from(c.headers);let f=c.data;return oe.forEach(o,function(y){f=y.call(u,f,p.normalize(),i?i.status:void 0)}),p.normalize(),f}function sy(o){return!!(o&&o.__CANCEL__)}function vr(o,i,u){ct.call(this,o??"canceled",ct.ERR_CANCELED,i,u),this.name="CanceledError"}oe.inherits(vr,ct,{__CANCEL__:!0});function ry(o,i,u){const c=u.config.validateStatus;!u.status||!c||c(u.status)?o(u):i(new ct("Request failed with status code "+u.status,[ct.ERR_BAD_REQUEST,ct.ERR_BAD_RESPONSE][Math.floor(u.status/100)-4],u.config,u.request,u))}function DA(o){const i=/^([-+\w]{1,25})(:?\/\/|:)/.exec(o);return i&&i[1]||""}function SA(o,i){o=o||10;const u=new Array(o),c=new Array(o);let p=0,f=0,v;return i=i!==void 0?i:1e3,function(C){const T=Date.now(),L=c[f];v||(v=T),u[p]=C,c[p]=T;let R=f,k=0;for(;R!==p;)k+=u[R++],R=R%o;if(p=(p+1)%o,p===f&&(f=(f+1)%o),T-v<i)return;const x=L&&T-L;return x?Math.round(k*1e3/x):void 0}}function LA(o,i){let u=0,c=1e3/i,p,f;const v=(T,L=Date.now())=>{u=L,p=null,f&&(clearTimeout(f),f=null),o.apply(null,T)};return[(...T)=>{const L=Date.now(),R=L-u;R>=c?v(T,L):(p=T,f||(f=setTimeout(()=>{f=null,v(p)},c-R)))},()=>p&&v(p)]}const ic=(o,i,u=3)=>{let c=0;const p=SA(50,250);return LA(f=>{const v=f.loaded,y=f.lengthComputable?f.total:void 0,C=v-c,T=p(C),L=v<=y;c=v;const R={loaded:v,total:y,progress:y?v/y:void 0,bytes:C,rate:T||void 0,estimated:T&&y&&L?(y-v)/T:void 0,event:f,lengthComputable:y!=null,[i?"download":"upload"]:!0};o(R)},u)},d_=(o,i)=>{const u=o!=null;return[c=>i[0]({lengthComputable:u,total:o,loaded:c}),i[1]]},p_=o=>(...i)=>oe.asap(()=>o(...i)),RA=mn.hasStandardBrowserEnv?((o,i)=>u=>(u=new URL(u,mn.origin),o.protocol===u.protocol&&o.host===u.host&&(i||o.port===u.port)))(new URL(mn.origin),mn.navigator&&/(msie|trident)/i.test(mn.navigator.userAgent)):()=>!0,kA=mn.hasStandardBrowserEnv?{write(o,i,u,c,p,f){const v=[o+"="+encodeURIComponent(i)];oe.isNumber(u)&&v.push("expires="+new Date(u).toGMTString()),oe.isString(c)&&v.push("path="+c),oe.isString(p)&&v.push("domain="+p),f===!0&&v.push("secure"),document.cookie=v.join("; ")},read(o){const i=document.cookie.match(new RegExp("(^|;\\s*)("+o+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove(o){this.write(o,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function AA(o){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(o)}function OA(o,i){return i?o.replace(/\/?\/$/,"")+"/"+i.replace(/^\/+/,""):o}function iy(o,i,u){let c=!AA(i);return o&&(c||u==!1)?OA(o,i):i}const f_=o=>o instanceof An?{...o}:o;function Ss(o,i){i=i||{};const u={};function c(T,L,R,k){return oe.isPlainObject(T)&&oe.isPlainObject(L)?oe.merge.call({caseless:k},T,L):oe.isPlainObject(L)?oe.merge({},L):oe.isArray(L)?L.slice():L}function p(T,L,R,k){if(oe.isUndefined(L)){if(!oe.isUndefined(T))return c(void 0,T,R,k)}else return c(T,L,R,k)}function f(T,L){if(!oe.isUndefined(L))return c(void 0,L)}function v(T,L){if(oe.isUndefined(L)){if(!oe.isUndefined(T))return c(void 0,T)}else return c(void 0,L)}function y(T,L,R){if(R in i)return c(T,L);if(R in o)return c(void 0,T)}const C={url:f,method:f,data:f,baseURL:v,transformRequest:v,transformResponse:v,paramsSerializer:v,timeout:v,timeoutMessage:v,withCredentials:v,withXSRFToken:v,adapter:v,responseType:v,xsrfCookieName:v,xsrfHeaderName:v,onUploadProgress:v,onDownloadProgress:v,decompress:v,maxContentLength:v,maxBodyLength:v,beforeRedirect:v,transport:v,httpAgent:v,httpsAgent:v,cancelToken:v,socketPath:v,responseEncoding:v,validateStatus:y,headers:(T,L,R)=>p(f_(T),f_(L),R,!0)};return oe.forEach(Object.keys(Object.assign({},o,i)),function(L){const R=C[L]||p,k=R(o[L],i[L],L);oe.isUndefined(k)&&R!==y||(u[L]=k)}),u}const ay=o=>{const i=Ss({},o);let{data:u,withXSRFToken:c,xsrfHeaderName:p,xsrfCookieName:f,headers:v,auth:y}=i;i.headers=v=An.from(v),i.url=ty(iy(i.baseURL,i.url,i.allowAbsoluteUrls),o.params,o.paramsSerializer),y&&v.set("Authorization","Basic "+btoa((y.username||"")+":"+(y.password?unescape(encodeURIComponent(y.password)):"")));let C;if(oe.isFormData(u)){if(mn.hasStandardBrowserEnv||mn.hasStandardBrowserWebWorkerEnv)v.setContentType(void 0);else if((C=v.getContentType())!==!1){const[T,...L]=C?C.split(";").map(R=>R.trim()).filter(Boolean):[];v.setContentType([T||"multipart/form-data",...L].join("; "))}}if(mn.hasStandardBrowserEnv&&(c&&oe.isFunction(c)&&(c=c(i)),c||c!==!1&&RA(i.url))){const T=p&&f&&kA.read(f);T&&v.set(p,T)}return i},NA=typeof XMLHttpRequest<"u",PA=NA&&function(o){return new Promise(function(u,c){const p=ay(o);let f=p.data;const v=An.from(p.headers).normalize();let{responseType:y,onUploadProgress:C,onDownloadProgress:T}=p,L,R,k,x,N;function G(){x&&x(),N&&N(),p.cancelToken&&p.cancelToken.unsubscribe(L),p.signal&&p.signal.removeEventListener("abort",L)}let V=new XMLHttpRequest;V.open(p.method.toUpperCase(),p.url,!0),V.timeout=p.timeout;function z(){if(!V)return;const q=An.from("getAllResponseHeaders"in V&&V.getAllResponseHeaders()),Le={data:!y||y==="text"||y==="json"?V.responseText:V.response,status:V.status,statusText:V.statusText,headers:q,config:o,request:V};ry(function(Ue){u(Ue),G()},function(Ue){c(Ue),G()},Le),V=null}"onloadend"in V?V.onloadend=z:V.onreadystatechange=function(){!V||V.readyState!==4||V.status===0&&!(V.responseURL&&V.responseURL.indexOf("file:")===0)||setTimeout(z)},V.onabort=function(){V&&(c(new ct("Request aborted",ct.ECONNABORTED,o,V)),V=null)},V.onerror=function(){c(new ct("Network Error",ct.ERR_NETWORK,o,V)),V=null},V.ontimeout=function(){let Ne=p.timeout?"timeout of "+p.timeout+"ms exceeded":"timeout exceeded";const Le=p.transitional||ny;p.timeoutErrorMessage&&(Ne=p.timeoutErrorMessage),c(new ct(Ne,Le.clarifyTimeoutError?ct.ETIMEDOUT:ct.ECONNABORTED,o,V)),V=null},f===void 0&&v.setContentType(null),"setRequestHeader"in V&&oe.forEach(v.toJSON(),function(Ne,Le){V.setRequestHeader(Le,Ne)}),oe.isUndefined(p.withCredentials)||(V.withCredentials=!!p.withCredentials),y&&y!=="json"&&(V.responseType=p.responseType),T&&([k,N]=ic(T,!0),V.addEventListener("progress",k)),C&&V.upload&&([R,x]=ic(C),V.upload.addEventListener("progress",R),V.upload.addEventListener("loadend",x)),(p.cancelToken||p.signal)&&(L=q=>{V&&(c(!q||q.type?new vr(null,o,V):q),V.abort(),V=null)},p.cancelToken&&p.cancelToken.subscribe(L),p.signal&&(p.signal.aborted?L():p.signal.addEventListener("abort",L)));const te=DA(p.url);if(te&&mn.protocols.indexOf(te)===-1){c(new ct("Unsupported protocol "+te+":",ct.ERR_BAD_REQUEST,o));return}V.send(f||null)})},bA=(o,i)=>{const{length:u}=o=o?o.filter(Boolean):[];if(i||u){let c=new AbortController,p;const f=function(T){if(!p){p=!0,y();const L=T instanceof Error?T:this.reason;c.abort(L instanceof ct?L:new vr(L instanceof Error?L.message:L))}};let v=i&&setTimeout(()=>{v=null,f(new ct(`timeout ${i} of ms exceeded`,ct.ETIMEDOUT))},i);const y=()=>{o&&(v&&clearTimeout(v),v=null,o.forEach(T=>{T.unsubscribe?T.unsubscribe(f):T.removeEventListener("abort",f)}),o=null)};o.forEach(T=>T.addEventListener("abort",f));const{signal:C}=c;return C.unsubscribe=()=>oe.asap(y),C}},GA=function*(o,i){let u=o.byteLength;if(u<i){yield o;return}let c=0,p;for(;c<u;)p=c+i,yield o.slice(c,p),c=p},wA=async function*(o,i){for await(const u of UA(o))yield*GA(u,i)},UA=async function*(o){if(o[Symbol.asyncIterator]){yield*o;return}const i=o.getReader();try{for(;;){const{done:u,value:c}=await i.read();if(u)break;yield c}}finally{await i.cancel()}},h_=(o,i,u,c)=>{const p=wA(o,i);let f=0,v,y=C=>{v||(v=!0,c&&c(C))};return new ReadableStream({async pull(C){try{const{done:T,value:L}=await p.next();if(T){y(),C.close();return}let R=L.byteLength;if(u){let k=f+=R;u(k)}C.enqueue(new Uint8Array(L))}catch(T){throw y(T),T}},cancel(C){return y(C),p.return()}},{highWaterMark:2})},Gc=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",cy=Gc&&typeof ReadableStream=="function",FA=Gc&&(typeof TextEncoder=="function"?(o=>i=>o.encode(i))(new TextEncoder):async o=>new Uint8Array(await new Response(o).arrayBuffer())),uy=(o,...i)=>{try{return!!o(...i)}catch{return!1}},xA=cy&&uy(()=>{let o=!1;const i=new Request(mn.origin,{body:new ReadableStream,method:"POST",get duplex(){return o=!0,"half"}}).headers.has("Content-Type");return o&&!i}),g_=64*1024,Fd=cy&&uy(()=>oe.isReadableStream(new Response("").body)),ac={stream:Fd&&(o=>o.body)};Gc&&(o=>{["text","arrayBuffer","blob","formData","stream"].forEach(i=>{!ac[i]&&(ac[i]=oe.isFunction(o[i])?u=>u[i]():(u,c)=>{throw new ct(`Response type '${i}' is not supported`,ct.ERR_NOT_SUPPORT,c)})})})(new Response);const qA=async o=>{if(o==null)return 0;if(oe.isBlob(o))return o.size;if(oe.isSpecCompliantForm(o))return(await new Request(mn.origin,{method:"POST",body:o}).arrayBuffer()).byteLength;if(oe.isArrayBufferView(o)||oe.isArrayBuffer(o))return o.byteLength;if(oe.isURLSearchParams(o)&&(o=o+""),oe.isString(o))return(await FA(o)).byteLength},VA=async(o,i)=>{const u=oe.toFiniteNumber(o.getContentLength());return u??qA(i)},BA=Gc&&(async o=>{let{url:i,method:u,data:c,signal:p,cancelToken:f,timeout:v,onDownloadProgress:y,onUploadProgress:C,responseType:T,headers:L,withCredentials:R="same-origin",fetchOptions:k}=ay(o);T=T?(T+"").toLowerCase():"text";let x=bA([p,f&&f.toAbortSignal()],v),N;const G=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let V;try{if(C&&xA&&u!=="get"&&u!=="head"&&(V=await VA(L,c))!==0){let Le=new Request(i,{method:"POST",body:c,duplex:"half"}),Se;if(oe.isFormData(c)&&(Se=Le.headers.get("content-type"))&&L.setContentType(Se),Le.body){const[Ue,ve]=d_(V,ic(p_(C)));c=h_(Le.body,g_,Ue,ve)}}oe.isString(R)||(R=R?"include":"omit");const z="credentials"in Request.prototype;N=new Request(i,{...k,signal:x,method:u.toUpperCase(),headers:L.normalize().toJSON(),body:c,duplex:"half",credentials:z?R:void 0});let te=await fetch(N,k);const q=Fd&&(T==="stream"||T==="response");if(Fd&&(y||q&&G)){const Le={};["status","statusText","headers"].forEach(ye=>{Le[ye]=te[ye]});const Se=oe.toFiniteNumber(te.headers.get("content-length")),[Ue,ve]=y&&d_(Se,ic(p_(y),!0))||[];te=new Response(h_(te.body,g_,Ue,()=>{ve&&ve(),G&&G()}),Le)}T=T||"text";let Ne=await ac[oe.findKey(ac,T)||"text"](te,o);return!q&&G&&G(),await new Promise((Le,Se)=>{ry(Le,Se,{data:Ne,headers:An.from(te.headers),status:te.status,statusText:te.statusText,config:o,request:N})})}catch(z){throw G&&G(),z&&z.name==="TypeError"&&/Load failed|fetch/i.test(z.message)?Object.assign(new ct("Network Error",ct.ERR_NETWORK,o,N),{cause:z.cause||z}):ct.from(z,z&&z.code,o,N)}}),xd={http:oA,xhr:PA,fetch:BA};oe.forEach(xd,(o,i)=>{if(o){try{Object.defineProperty(o,"name",{value:i})}catch{}Object.defineProperty(o,"adapterName",{value:i})}});const __=o=>`- ${o}`,HA=o=>oe.isFunction(o)||o===null||o===!1,ly={getAdapter:o=>{o=oe.isArray(o)?o:[o];const{length:i}=o;let u,c;const p={};for(let f=0;f<i;f++){u=o[f];let v;if(c=u,!HA(u)&&(c=xd[(v=String(u)).toLowerCase()],c===void 0))throw new ct(`Unknown adapter '${v}'`);if(c)break;p[v||"#"+f]=c}if(!c){const f=Object.entries(p).map(([y,C])=>`adapter ${y} `+(C===!1?"is not supported by the environment":"is not available in the build"));let v=i?f.length>1?`since :
`+f.map(__).join(`
`):" "+__(f[0]):"as no adapter specified";throw new ct("There is no suitable adapter to dispatch the request "+v,"ERR_NOT_SUPPORT")}return c},adapters:xd};function ad(o){if(o.cancelToken&&o.cancelToken.throwIfRequested(),o.signal&&o.signal.aborted)throw new vr(null,o)}function m_(o){return ad(o),o.headers=An.from(o.headers),o.data=id.call(o,o.transformRequest),["post","put","patch"].indexOf(o.method)!==-1&&o.headers.setContentType("application/x-www-form-urlencoded",!1),ly.getAdapter(o.adapter||ta.adapter)(o).then(function(c){return ad(o),c.data=id.call(o,o.transformResponse,c),c.headers=An.from(c.headers),c},function(c){return sy(c)||(ad(o),c&&c.response&&(c.response.data=id.call(o,o.transformResponse,c.response),c.response.headers=An.from(c.response.headers))),Promise.reject(c)})}const dy="1.10.0",wc={};["object","boolean","number","function","string","symbol"].forEach((o,i)=>{wc[o]=function(c){return typeof c===o||"a"+(i<1?"n ":" ")+o}});const v_={};wc.transitional=function(i,u,c){function p(f,v){return"[Axios v"+dy+"] Transitional option '"+f+"'"+v+(c?". "+c:"")}return(f,v,y)=>{if(i===!1)throw new ct(p(v," has been removed"+(u?" in "+u:"")),ct.ERR_DEPRECATED);return u&&!v_[v]&&(v_[v]=!0,console.warn(p(v," has been deprecated since v"+u+" and will be removed in the near future"))),i?i(f,v,y):!0}};wc.spelling=function(i){return(u,c)=>(console.warn(`${c} is likely a misspelling of ${i}`),!0)};function KA(o,i,u){if(typeof o!="object")throw new ct("options must be an object",ct.ERR_BAD_OPTION_VALUE);const c=Object.keys(o);let p=c.length;for(;p-- >0;){const f=c[p],v=i[f];if(v){const y=o[f],C=y===void 0||v(y,f,o);if(C!==!0)throw new ct("option "+f+" must be "+C,ct.ERR_BAD_OPTION_VALUE);continue}if(u!==!0)throw new ct("Unknown option "+f,ct.ERR_BAD_OPTION)}}const ja={assertOptions:KA,validators:wc},fo=ja.validators;let Es=class{constructor(i){this.defaults=i||{},this.interceptors={request:new u_,response:new u_}}async request(i,u){try{return await this._request(i,u)}catch(c){if(c instanceof Error){let p={};Error.captureStackTrace?Error.captureStackTrace(p):p=new Error;const f=p.stack?p.stack.replace(/^.+\n/,""):"";try{c.stack?f&&!String(c.stack).endsWith(f.replace(/^.+\n.+\n/,""))&&(c.stack+=`
`+f):c.stack=f}catch{}}throw c}}_request(i,u){typeof i=="string"?(u=u||{},u.url=i):u=i||{},u=Ss(this.defaults,u);const{transitional:c,paramsSerializer:p,headers:f}=u;c!==void 0&&ja.assertOptions(c,{silentJSONParsing:fo.transitional(fo.boolean),forcedJSONParsing:fo.transitional(fo.boolean),clarifyTimeoutError:fo.transitional(fo.boolean)},!1),p!=null&&(oe.isFunction(p)?u.paramsSerializer={serialize:p}:ja.assertOptions(p,{encode:fo.function,serialize:fo.function},!0)),u.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?u.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:u.allowAbsoluteUrls=!0),ja.assertOptions(u,{baseUrl:fo.spelling("baseURL"),withXsrfToken:fo.spelling("withXSRFToken")},!0),u.method=(u.method||this.defaults.method||"get").toLowerCase();let v=f&&oe.merge(f.common,f[u.method]);f&&oe.forEach(["delete","get","head","post","put","patch","common"],N=>{delete f[N]}),u.headers=An.concat(v,f);const y=[];let C=!0;this.interceptors.request.forEach(function(G){typeof G.runWhen=="function"&&G.runWhen(u)===!1||(C=C&&G.synchronous,y.unshift(G.fulfilled,G.rejected))});const T=[];this.interceptors.response.forEach(function(G){T.push(G.fulfilled,G.rejected)});let L,R=0,k;if(!C){const N=[m_.bind(this),void 0];for(N.unshift.apply(N,y),N.push.apply(N,T),k=N.length,L=Promise.resolve(u);R<k;)L=L.then(N[R++],N[R++]);return L}k=y.length;let x=u;for(R=0;R<k;){const N=y[R++],G=y[R++];try{x=N(x)}catch(V){G.call(this,V);break}}try{L=m_.call(this,x)}catch(N){return Promise.reject(N)}for(R=0,k=T.length;R<k;)L=L.then(T[R++],T[R++]);return L}getUri(i){i=Ss(this.defaults,i);const u=iy(i.baseURL,i.url,i.allowAbsoluteUrls);return ty(u,i.params,i.paramsSerializer)}};oe.forEach(["delete","get","head","options"],function(i){Es.prototype[i]=function(u,c){return this.request(Ss(c||{},{method:i,url:u,data:(c||{}).data}))}});oe.forEach(["post","put","patch"],function(i){function u(c){return function(f,v,y){return this.request(Ss(y||{},{method:i,headers:c?{"Content-Type":"multipart/form-data"}:{},url:f,data:v}))}}Es.prototype[i]=u(),Es.prototype[i+"Form"]=u(!0)});let jA=class py{constructor(i){if(typeof i!="function")throw new TypeError("executor must be a function.");let u;this.promise=new Promise(function(f){u=f});const c=this;this.promise.then(p=>{if(!c._listeners)return;let f=c._listeners.length;for(;f-- >0;)c._listeners[f](p);c._listeners=null}),this.promise.then=p=>{let f;const v=new Promise(y=>{c.subscribe(y),f=y}).then(p);return v.cancel=function(){c.unsubscribe(f)},v},i(function(f,v,y){c.reason||(c.reason=new vr(f,v,y),u(c.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(i){if(this.reason){i(this.reason);return}this._listeners?this._listeners.push(i):this._listeners=[i]}unsubscribe(i){if(!this._listeners)return;const u=this._listeners.indexOf(i);u!==-1&&this._listeners.splice(u,1)}toAbortSignal(){const i=new AbortController,u=c=>{i.abort(c)};return this.subscribe(u),i.signal.unsubscribe=()=>this.unsubscribe(u),i.signal}static source(){let i;return{token:new py(function(p){i=p}),cancel:i}}};function WA(o){return function(u){return o.apply(null,u)}}function YA(o){return oe.isObject(o)&&o.isAxiosError===!0}const qd={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(qd).forEach(([o,i])=>{qd[i]=o});function fy(o){const i=new Es(o),u=Hv(Es.prototype.request,i);return oe.extend(u,Es.prototype,i,{allOwnKeys:!0}),oe.extend(u,i,null,{allOwnKeys:!0}),u.create=function(p){return fy(Ss(o,p))},u}const Jt=fy(ta);Jt.Axios=Es;Jt.CanceledError=vr;Jt.CancelToken=jA;Jt.isCancel=sy;Jt.VERSION=dy;Jt.toFormData=bc;Jt.AxiosError=ct;Jt.Cancel=Jt.CanceledError;Jt.all=function(i){return Promise.all(i)};Jt.spread=WA;Jt.isAxiosError=YA;Jt.mergeConfig=Ss;Jt.AxiosHeaders=An;Jt.formToJSON=o=>oy(oe.isHTMLForm(o)?new FormData(o):o);Jt.getAdapter=ly.getAdapter;Jt.HttpStatusCode=qd;Jt.default=Jt;const{Axios:XO,AxiosError:ZO,CanceledError:QO,isCancel:eN,CancelToken:tN,VERSION:nN,all:oN,Cancel:sN,isAxiosError:rN,spread:iN,toFormData:aN,AxiosHeaders:cN,HttpStatusCode:uN,formToJSON:lN,getAdapter:dN,mergeConfig:pN}=Jt;let qo=!1;function cd(o,i){switch(o){case 0:return qo?void 0:(qo=!0,xg.confirm("","",{confirmButtonText:"",cancelButtonText:"",type:"info"}).then(()=>{Wi().logout(),Ai.success({message:""}),qo=!1}).catch(()=>{qo=!1}),!1);case 401:return qo?void 0:(qo=!0,xg.confirm("","",{confirmButtonText:"",cancelButtonText:"",type:"info"}).then(()=>{Wi().logout(),Ai.success({message:""}),qo=!1}).catch(()=>{qo=!1}),!1);case 403:i="";break;case 404:i="";break;case 500:i="";break;default:i=i??`${o}: !`;break}return i}function zA(o){function i(v){if(v.headers["user-type"]=0,v.noNeedToken)return v;const{token:y}=Wi();return y&&(v.headers.Authorization="Bearer "+y),v}function u(v){return Promise.reject(v)}const c=[0,200];function p(v){var k;const{data:y,status:C,config:T,statusText:L,headers:R}=v;if((k=R["content-type"])!=null&&k.includes("json")){if(c.includes(y==null?void 0:y.code))return Promise.resolve(y);const x=(y==null?void 0:y.code)??C,N=cd(x,(y==null?void 0:y.message)??L);return!(T!=null&&T.noNeedTip)&&N&&Ai.error(N),Promise.reject({code:x,message:N,error:y??v})}return Promise.resolve(y??v)}async function f(v){var k;if(!v||!v.response){const x=v==null?void 0:v.code,N=cd(x,v.message);return Ai.error(N),Promise.reject({code:x,message:N,error:v})}const{data:y,status:C,config:T}=v.response,L=(y==null?void 0:y.code)??C,R=cd(L,(y==null?void 0:y.message)??v.message);return!(T!=null&&T.noNeedTip)&&R&&Ai.error(R),Promise.reject({code:L,message:R,error:((k=v.response)==null?void 0:k.data)||v.response})}o.interceptors.request.use(i,u),o.interceptors.response.use(p,f)}function hy(o={}){const i={baseURL:"/api",timeout:12e3},u=Jt.create({...i,...o});return zA(u),u}const sn=hy();hy({baseURL:"/mock-api"});const fN=o=>sn.post("/user/login",o),$A=()=>sn.post("/user/getUserInfo"),hN=o=>sn.post("/user/editUserInfo",o),gN=o=>sn.post("/user/saveProfile",o),_N=o=>sn.post("/sms/send",o),mN=o=>sn.post("/ems/send",o),JA=o=>sn.post("/user/getTLSSig",o),vN=o=>sn.post("/upload/file",o),yN=o=>sn.post("/resume/index",o),IN=o=>sn.post("/resume/detail",o),MN=()=>sn.post("/resume/getResumeList"),CN=o=>sn.post("/resume/createResume",o),TN=o=>sn.post("/resume/getResumeDetail",o),EN=o=>sn.post("/common/getCountryList",o),DN=o=>sn.post("/common/getProvinceList",o),SN=o=>sn.post("/common/getMajorList",o),LN=o=>sn.post("/common/getUniversityList",o),RN=o=>sn.post("/common/getSkillList",o),kN=o=>sn.post("/resume/getSendLogList",o);let XA=1600067517;const Uc=Vv.create({SDKAppID:XA});Uc.setLogLevel(0);Uc.registerPlugin({"tim-upload-plugin":mk});async function ZA(o){let i=await JA(),u=await $A();u.code===0&&(console.log(u),console.log(i),Uc.login({userID:String(u.data.id),userSig:i.data.sign}).then(function(p){console.log(p.data),console.log(""),p.data.repeatLogin===!0&&console.log(p.data.errorInfo)}).catch(function(p){console.warn("login error:",p)}))}const ud={chat:Uc,TencentCloudChat:Vv,loginIm:ZA},QA={__name:"App",setup(o){const i=hk,u=new Map;function c(C){if(console.log(" ~ getLayout ~ name:",C),u.get(C))return u.get(C);const T=pc(wC(()=>YL(Object.assign({"./layouts/empty/index.vue":()=>Cn(()=>import("./index-frCAkURD.js"),__vite__mapDeps([0,1])),"./layouts/normal/index.vue":()=>Cn(()=>import("./index-BIjeLACL.js"),__vite__mapDeps([2,3,4,5,6,7,8,9,1,10,11]))}),`./layouts/${C}/index.vue`,4)));return u.set(C,T),T}const p=Gv(),f=dk(),v=Oe(()=>{var C,T;return(C=p.matched)!=null&&C.length?c(((T=p.meta)==null?void 0:T.layout)||f.layout):null});Do("chat",ud.chat),Do("TencentCloudChat",ud.TencentCloudChat);const{token:y}=Wi();return y&&ud.loginIm(),(C,T)=>{const L=fs("router-view"),R=fS;return be(),Mt(R,{locale:ge(i)},{default:qt(()=>[v.value?(be(),Mt(L,{key:0},{default:qt(({Component:k,route:x})=>[(be(),Mt(Rn(v.value),null,{default:qt(()=>[(be(),Mt(Rn(k),{key:x.fullPath}))]),_:2},1024))]),_:1})):Rt("",!0)]),_:1},8,["locale"])}}},eO=[{path:"/",name:"Index",component:()=>Cn(()=>import("./index-Da_wutfp.js"),__vite__mapDeps([12,13,14,3,4,15,16,17,7,8,18,19,1,9,20])),meta:{title:"",layout:"normal"}},{path:"/detail",name:"detail",component:()=>Cn(()=>import("./detail-CBxfjG0Z.js"),__vite__mapDeps([21,9,1,22])),meta:{title:"",layout:"normal"}},{path:"/home",name:"home",component:()=>Cn(()=>import("./home-L_G3e8fb.js"),__vite__mapDeps([23,5,6,24,15,25,7,8,9,1,26,27,28])),meta:{title:"",layout:"normal"}},{path:"/application",name:"application",component:()=>Cn(()=>import("./application-CljZexRh.js"),__vite__mapDeps([29,14,3,4,15,16,30,31,26,27,1,32])),meta:{title:"",layout:"normal"}},{path:"/applicationHistory",name:"applicationHistory",component:()=>Cn(()=>import("./applicationHistory-DLGz7rJ6.js"),__vite__mapDeps([33,13,14,3,4,15,16,17,7,8,18,19,9,1,34])),meta:{title:"",layout:"normal"}},{path:"/management",name:"management",component:()=>Cn(()=>import("./management-HsV665n9.js"),__vite__mapDeps([35,18,19,1,36])),meta:{title:"",layout:"normal"}},{path:"/preview",name:"preview",component:()=>Cn(()=>import("./preview-Di1yKhVx.js"),__vite__mapDeps([37,1,38])),meta:{title:"",layout:"normal"}},{path:"/modification",name:"modification",component:()=>Cn(()=>import("./modification-C7jEDDc2.js"),__vite__mapDeps([39,3,4,14,15,16,30,31,24,25,26,27,1,10,40])),meta:{title:"",layout:"normal"}},{path:"/login",name:"login",component:()=>Cn(()=>import("./login-wLuivaeD.js"),__vite__mapDeps([41,26,27,1,42])),meta:{title:""}},{path:"/empty",name:"EmptyIndex",component:()=>Cn(()=>import("./index-Da_wutfp.js"),__vite__mapDeps([12,13,14,3,4,15,16,17,7,8,18,19,1,9,20])),meta:{title:"",layout:"empty"}},{path:"/msg",name:"msg",component:()=>Cn(()=>import("./msg-BPGTQxBt.js"),__vite__mapDeps([43,9,1,44])),meta:{title:"",layout:"normal"}},{path:"/404",name:"404",component:()=>Cn(()=>import("./404-0S_-LR7k.js"),__vite__mapDeps([45,46,47,1,48])),meta:{title:"",layout:"empty"}},{path:"/403",name:"403",component:()=>Cn(()=>import("./403-CoPBdEEQ.js"),__vite__mapDeps([49,46,47,1,50])),meta:{title:"",layout:"empty"}}],tO={VITE_TITLE:"Vue"},{VITE_TITLE:nO}=tO;function oO(o){o.afterEach(i=>{var c;const u=(c=i.meta)==null?void 0:c.title;u?document.title=u:document.title=nO})}const y_=["/login","/404","/403"];function sO(o){o.beforeEach(async i=>{const c=Wi().token;return console.log(!c),!c&&y_.includes(i.path)?!0:i.path==="/login"?{path:"/"}:y_.includes(i.path)||o.getRoutes().find(f=>f.name===i.name)||o.hasRoute(i.name)?!0:{name:"404",query:{path:i.fullPath}}})}function rO(o){console.log(" ~ setupRouterGuards ~ "),oO(o),sO(o)}const iO={VITE_PUBLIC_PATH:"/"},{VITE_PUBLIC_PATH:aO="/"}=iO,I_=$R({history:ER(aO),routes:eO,scrollBehavior:()=>({left:0,top:0})});async function cO(o){o.use(I_),rO(I_)}const uO={mounted(o,i){}};function lO(o){o.directive("testDirective",uO)}async function dO(){const o=rT(QA);fk(o),lO(o),await cO(o),o.mount("#app")}dO();export{hO as $,it as A,Rt as B,vO as C,cr as D,ur as E,nt as F,AO as G,_o as H,hL as I,Lo as J,JD as K,Td as L,mv as M,Nn as N,ze as O,Rn as P,or as Q,an as R,So as S,PS as T,UD as U,Ec as V,XR as W,Wi as X,Qn as Y,$A as Z,Ps as _,pt as a,YO as a$,gO as a0,hN as a1,Hm as a2,Ci as a3,Jl as a4,no as a5,tc as a6,lm as a7,ET as a8,Ct as a9,C_ as aA,QE as aB,RO as aC,xa as aD,gN as aE,EN as aF,DN as aG,kN as aH,sv as aI,qD as aJ,NC as aK,FO as aL,BO as aM,xO as aN,vc as aO,TN as aP,dr as aQ,Vn as aR,Mp as aS,SO as aT,zO as aU,He as aV,pO as aW,cS as aX,_p as aY,Jm as aZ,YC as a_,Ti as aa,OO as ab,Ri as ac,yc as ad,NO as ae,mO as af,ks as ag,ap as ah,Ym as ai,HO as aj,AS as ak,MN as al,yN as am,Gv as an,IN as ao,vN as ap,DO as aq,WO as ar,jO as as,Ed as at,FD as au,vv as av,vS as aw,vp as ax,ka as ay,Qm as az,bt as b,TO as b$,UO as b0,bO as b1,CO as b2,Ze as b3,nD as b4,PO as b5,Ig as b6,jD as b7,PD as b8,nS as b9,qO as bA,IO as bB,E_ as bC,LO as bD,EO as bE,gp as bF,PT as bG,ov as bH,cm as bI,ft as bJ,JE as bK,Tt as bL,_t as bM,rS as bN,GD as bO,_O as bP,MO as bQ,$_ as bR,fp as bS,YE as bT,zE as bU,hE as bV,$E as bW,nc as bX,xD as bY,kO as bZ,wM as b_,Dc as ba,ZD as bb,Ba as bc,yT as bd,Pn as be,KD as bf,ML as bg,uv as bh,HS as bi,yO as bj,RN as bk,CN as bl,LN as bm,SN as bn,Km as bo,dE as bp,pp as bq,KT as br,tv as bs,pD as bt,GO as bu,Xm as bv,Wm as bw,cn as bx,VO as by,KO as bz,As as c,jm as c0,Ic as c1,qC as c2,av as c3,eS as c4,es as c5,Xi as c6,jn as c7,ms as c8,_v as c9,FC as ca,XT as cb,Vm as cc,bT as cd,gr as ce,PE as cf,Os as cg,tE as ch,mN as ci,_N as cj,fN as ck,I_ as cl,B_ as cm,hv as cn,oc as co,bD as cp,dS as cq,ec as cr,wD as cs,Zm as ct,$m as cu,wO as cv,ut as d,Ns as e,En as f,Oe as g,Qd as h,hp as i,ki as j,fs as k,Mt as l,be as m,qt as n,so as o,Do as p,kt as q,Tn as r,fO as s,za as t,ge as u,_0 as v,Ht as w,Dd as x,dn as y,Bi as z};
